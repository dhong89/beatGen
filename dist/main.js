/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/dist/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var runtime = function (exports) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.

  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []); // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.

    generator._invoke = makeInvokeMethod(innerFn, self, context);
    return generator;
  }

  exports.wrap = wrap; // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.

  function tryCatch(fn, obj, arg) {
    try {
      return {
        type: "normal",
        arg: fn.call(obj, arg)
      };
    } catch (err) {
      return {
        type: "throw",
        arg: err
      };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed"; // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.

  var ContinueSentinel = {}; // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.

  function Generator() {}

  function GeneratorFunction() {}

  function GeneratorFunctionPrototype() {} // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.


  var IteratorPrototype = {};

  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));

  if (NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] = GeneratorFunction.displayName = "GeneratorFunction"; // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.

  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function (method) {
      prototype[method] = function (arg) {
        return this._invoke(method, arg);
      };
    });
  }

  exports.isGeneratorFunction = function (genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor ? ctor === GeneratorFunction || // For the native GeneratorFunction constructor, the best we can
    // do is to check its .name property.
    (ctor.displayName || ctor.name) === "GeneratorFunction" : false;
  };

  exports.mark = function (genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;

      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }

    genFun.prototype = Object.create(Gp);
    return genFun;
  }; // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.


  exports.awrap = function (arg) {
    return {
      __await: arg
    };
  };

  function AsyncIterator(generator, PromiseImpl) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);

      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;

        if (value && typeof value === "object" && hasOwn.call(value, "__await")) {
          return PromiseImpl.resolve(value.__await).then(function (value) {
            invoke("next", value, resolve, reject);
          }, function (err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return PromiseImpl.resolve(value).then(function (unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration.
          result.value = unwrapped;
          resolve(result);
        }, function (error) {
          // If a rejected Promise was yielded, throw the rejection back
          // into the async generator function so it can be handled there.
          return invoke("throw", error, resolve, reject);
        });
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new PromiseImpl(function (resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise = // If enqueue has been called before, then we want to wait until
      // all previous Promises have been resolved before calling invoke,
      // so that results are always delivered in the correct order. If
      // enqueue has not been called before, then it is important to
      // call invoke immediately, without waiting on a callback to fire,
      // so that the async generator function has the opportunity to do
      // any necessary setup in a predictable way. This predictability
      // is why the Promise constructor synchronously invokes its
      // executor callback, and why async functions synchronously
      // execute code before the first await. Since we implement simple
      // async functions in terms of async generators, it is especially
      // important to get this right, even though it requires care.
      previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, // Avoid propagating failures to Promises returned by later
      // invocations of the iterator.
      callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();
    } // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).


    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);

  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };

  exports.AsyncIterator = AsyncIterator; // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.

  exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {
    if (PromiseImpl === void 0) PromiseImpl = Promise;
    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);
    return exports.isGeneratorFunction(outerFn) ? iter // If outerFn is a generator, return the full iterator.
    : iter.next().then(function (result) {
      return result.done ? result.value : iter.next();
    });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;
    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        } // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume


        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;

        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);

          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;
        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);
        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;
        var record = tryCatch(innerFn, self, context);

        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done ? GenStateCompleted : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };
        } else if (record.type === "throw") {
          state = GenStateCompleted; // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.

          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  } // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.


  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];

    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        // Note: ["return"] must be used for ES3 parsing compatibility.
        if (delegate.iterator["return"]) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError("The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (!info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value; // Resume execution at the desired location (see delegateYield).

      context.next = delegate.nextLoc; // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.

      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }
    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    } // The delegate iterator is finished, so forget it and continue with
    // the outer generator.


    context.delegate = null;
    return ContinueSentinel;
  } // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.


  defineIteratorMethods(Gp);
  Gp[toStringTagSymbol] = "Generator"; // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.

  Gp[iteratorSymbol] = function () {
    return this;
  };

  Gp.toString = function () {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = {
      tryLoc: locs[0]
    };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{
      tryLoc: "root"
    }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  exports.keys = function (object) {
    var keys = [];

    for (var key in object) {
      keys.push(key);
    }

    keys.reverse(); // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.

    return function next() {
      while (keys.length) {
        var key = keys.pop();

        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      } // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.


      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];

      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1,
            next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;
          return next;
        };

        return next.next = next;
      }
    } // Return an iterator with no values.


    return {
      next: doneResult
    };
  }

  exports.values = values;

  function doneResult() {
    return {
      value: undefined,
      done: true
    };
  }

  Context.prototype = {
    constructor: Context,
    reset: function (skipTempReset) {
      this.prev = 0;
      this.next = 0; // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.

      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;
      this.method = "next";
      this.arg = undefined;
      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" && hasOwn.call(this, name) && !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },
    stop: function () {
      this.done = true;
      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;

      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },
    dispatchException: function (exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;

      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !!caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }
          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }
          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }
          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },
    abrupt: function (type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];

        if (entry.tryLoc <= this.prev && hasOwn.call(entry, "finallyLoc") && this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry && (type === "break" || type === "continue") && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },
    complete: function (record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" || record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },
    finish: function (finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];

        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },
    "catch": function (tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];

        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;

          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }

          return thrown;
        }
      } // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.


      throw new Error("illegal catch attempt");
    },
    delegateYield: function (iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  }; // Regardless of whether this script is executing as a CommonJS module
  // or not, return the runtime object so that we can declare the variable
  // regeneratorRuntime in the outer scope, which allows this module to be
  // injected easily by `bin/regenerator --include-runtime script.js`.

  return exports;
}( // If this script is executing as a CommonJS module, use module.exports
// as the regeneratorRuntime namespace. Otherwise create a new empty
// object. Either way, the resulting object will be used to initialize
// the regeneratorRuntime variable at the top of this file.
 true ? module.exports : undefined);

try {
  regeneratorRuntime = runtime;
} catch (accidentalStrictMode) {
  // This module should not be running in strict mode, so the above
  // assignment should always work unless something is misconfigured. Just
  // in case runtime.js accidentally runs in strict mode, we can escape
  // strict mode using a global Function call. This could conceivably fail
  // if a Content Security Policy forbids using Function, but in that case
  // the proper solution is to fix the accidental strict mode problem. If
  // you've misconfigured your bundler to force strict mode and applied a
  // CSP to forbid Function, and you're not willing to fix either of those
  // problems, please detail your unique predicament in a GitHub issue.
  Function("r", "regeneratorRuntime = r")(runtime);
}

/***/ }),

/***/ "./node_modules/tone/build/Tone.js":
/*!*****************************************!*\
  !*** ./node_modules/tone/build/Tone.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

!function (t, e) {
   true ? module.exports = e() : undefined;
}("undefined" != typeof self ? self : this, function () {
  return function (t) {
    var e = {};

    function i(s) {
      if (e[s]) return e[s].exports;
      var n = e[s] = {
        i: s,
        l: !1,
        exports: {}
      };
      return t[s].call(n.exports, n, n.exports, i), n.l = !0, n.exports;
    }

    return i.m = t, i.c = e, i.d = function (t, e, s) {
      i.o(t, e) || Object.defineProperty(t, e, {
        configurable: !1,
        enumerable: !0,
        get: s
      });
    }, i.r = function (t) {
      Object.defineProperty(t, "__esModule", {
        value: !0
      });
    }, i.n = function (t) {
      var e = t && t.__esModule ? function () {
        return t.default;
      } : function () {
        return t;
      };
      return i.d(e, "a", e), e;
    }, i.o = function (t, e) {
      return Object.prototype.hasOwnProperty.call(t, e);
    }, i.p = "", i(i.s = 148);
  }([function (t, e, i) {
    "use strict";

    i.r(e), function (t) {
      var s = i(93),
          n = function () {
        if (!(this instanceof n)) throw new Error("constructor needs to be called with the 'new' keyword");
      };
      /**
       *  Tone.js
       *  @author Yotam Mann
       *  @license http://opensource.org/licenses/MIT MIT License
       *  @copyright 2014-2019 Yotam Mann
       */


      n.prototype.toString = function () {
        for (var t in n) {
          var e = t[0].match(/^[A-Z]$/),
              i = n[t] === this.constructor;
          if (n.isFunction(n[t]) && e && i) return t;
        }

        return "Tone";
      }, n.prototype.dispose = function () {
        return this;
      }, n.prototype.set = function (t, e) {
        if (n.isString(t)) {
          var i = {};
          i[t] = e, t = i;
        }

        t: for (var s in t) {
          e = t[s];
          var o = this;

          if (-1 !== s.indexOf(".")) {
            for (var a = s.split("."), r = 0; r < a.length - 1; r++) if ((o = o[a[r]]) instanceof n) {
              a.splice(0, r + 1);
              var l = a.join(".");
              o.set(l, e);
              continue t;
            }

            s = a[a.length - 1];
          }

          var u = o[s];
          n.isUndef(u) || (n.Signal && u instanceof n.Signal || n.Param && u instanceof n.Param ? u.value !== e && (u.value = e) : u instanceof AudioParam ? u.value !== e && (u.value = e) : n.TimeBase && u instanceof n.TimeBase ? o[s] = e : u instanceof n ? u.set(e) : u !== e && (o[s] = e));
        }

        return this;
      }, n.prototype.get = function (t) {
        n.isUndef(t) ? t = this._collectDefaults(this.constructor) : n.isString(t) && (t = [t]);

        for (var e = {}, i = 0; i < t.length; i++) {
          var s = t[i],
              o = this,
              a = e;

          if (-1 !== s.indexOf(".")) {
            for (var r = s.split("."), l = 0; l < r.length - 1; l++) {
              var u = r[l];
              a[u] = a[u] || {}, a = a[u], o = o[u];
            }

            s = r[r.length - 1];
          }

          var d = o[s];
          n.isObject(t[s]) ? a[s] = d.get() : n.Signal && d instanceof n.Signal ? a[s] = d.value : n.Param && d instanceof n.Param ? a[s] = d.value : d instanceof AudioParam ? a[s] = d.value : d instanceof n ? a[s] = d.get() : !n.isFunction(d) && n.isDefined(d) && (a[s] = d);
        }

        return e;
      }, n.prototype._collectDefaults = function (t) {
        var e = [];
        if (n.isDefined(t.defaults) && (e = Object.keys(t.defaults)), n.isDefined(t._super)) for (var i = this._collectDefaults(t._super), s = 0; s < i.length; s++) -1 === e.indexOf(i[s]) && e.push(i[s]);
        return e;
      }, n.defaults = function (t, e, i) {
        var s = {};
        if (1 === t.length && n.isObject(t[0])) s = t[0];else for (var o = 0; o < e.length; o++) s[e[o]] = t[o];
        return n.isDefined(i.defaults) ? n.defaultArg(s, i.defaults) : n.isObject(i) ? n.defaultArg(s, i) : s;
      }, n.defaultArg = function (t, e) {
        if (n.isObject(t) && n.isObject(e)) {
          var i = {};

          for (var s in t) i[s] = n.defaultArg(e[s], t[s]);

          for (var o in e) i[o] = n.defaultArg(t[o], e[o]);

          return i;
        }

        return n.isUndef(t) ? e : t;
      }, n.prototype.log = function () {
        if (this.debug || this.toString() === n.global.TONE_DEBUG_CLASS) {
          var t = Array.from(arguments);
          t.unshift(this.toString() + ":"), console.log.apply(void 0, t);
        }
      }, n.prototype.assert = function (t, e) {
        if (!t) throw new Error(e);
      }, n.connectSeries = function () {
        for (var t = arguments[0], e = 1; e < arguments.length; e++) {
          var i = arguments[e];
          n.connect(t, i), t = i;
        }

        return n;
      }, n.connect = function (t, e, i, s) {
        for (; n.isDefined(e.input);) n.isArray(e.input) ? (s = n.defaultArg(s, 0), e = e.input[s], s = 0) : e.input && (e = e.input);

        return e instanceof AudioParam ? t.connect(e, i) : e instanceof AudioNode && t.connect(e, i, s), n;
      }, n.disconnect = function (t, e, i, s) {
        if (e) {
          for (var o = !1; !o;) n.isArray(e.input) ? (n.isDefined(s) ? n.disconnect(t, e.input[s], i) : e.input.forEach(function (e) {
            try {
              n.disconnect(t, e, i);
            } catch (t) {}
          }), o = !0) : e.input ? e = e.input : o = !0;

          e instanceof AudioParam ? t.disconnect(e, i) : e instanceof AudioNode && t.disconnect(e, i, s);
        } else t.disconnect();

        return n;
      }, n.isUndef = function (t) {
        return void 0 === t;
      }, n.isDefined = function (t) {
        return !n.isUndef(t);
      }, n.isFunction = function (t) {
        return "function" == typeof t;
      }, n.isNumber = function (t) {
        return "number" == typeof t;
      }, n.isObject = function (t) {
        return "[object Object]" === Object.prototype.toString.call(t) && t.constructor === Object;
      }, n.isBoolean = function (t) {
        return "boolean" == typeof t;
      }, n.isArray = function (t) {
        return Array.isArray(t);
      }, n.isString = function (t) {
        return "string" == typeof t;
      }, n.isNote = function (t) {
        return n.isString(t) && /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t);
      }, n.noOp = function () {}, n.prototype._readOnly = function (t) {
        if (Array.isArray(t)) for (var e = 0; e < t.length; e++) this._readOnly(t[e]);else Object.defineProperty(this, t, {
          writable: !1,
          enumerable: !0
        });
      }, n.prototype._writable = function (t) {
        if (Array.isArray(t)) for (var e = 0; e < t.length; e++) this._writable(t[e]);else Object.defineProperty(this, t, {
          writable: !0
        });
      }, n.State = {
        Started: "started",
        Stopped: "stopped",
        Paused: "paused"
      }, n.global = n.isUndef(t) ? window : t, n.equalPowerScale = function (t) {
        var e = .5 * Math.PI;
        return Math.sin(t * e);
      }, n.dbToGain = function (t) {
        return Math.pow(10, t / 20);
      }, n.gainToDb = function (t) {
        return Math.log(t) / Math.LN10 * 20;
      }, n.intervalToFrequencyRatio = function (t) {
        return Math.pow(2, t / 12);
      }, n.prototype.now = function () {
        return n.context.now();
      }, n.now = function () {
        return n.context.now();
      }, n.prototype.immediate = function () {
        return n.context.currentTime;
      }, n.immediate = function () {
        return n.context.currentTime;
      }, n.extend = function (t, e) {
        function i() {}

        n.isUndef(e) && (e = n), i.prototype = e.prototype, t.prototype = new i(), t.prototype.constructor = t, t._super = e;
      }, n._audioContext = null, n.start = function () {
        return n.context.resume();
      }, Object.defineProperty(n, "context", {
        get: function () {
          return n._audioContext;
        },
        set: function (t) {
          t.isContext ? n._audioContext = t : n._audioContext = new n.Context(t), n.Context.emit("init", n._audioContext);
        }
      }), Object.defineProperty(n.prototype, "context", {
        get: function () {
          return n.context;
        }
      }), n.setContext = function (t) {
        n.context = t;
      }, Object.defineProperty(n.prototype, "blockTime", {
        get: function () {
          return 128 / this.context.sampleRate;
        }
      }), Object.defineProperty(n.prototype, "sampleTime", {
        get: function () {
          return 1 / this.context.sampleRate;
        }
      }), Object.defineProperty(n, "supported", {
        get: function () {
          var t = n.global.hasOwnProperty("AudioContext") || n.global.hasOwnProperty("webkitAudioContext"),
              e = n.global.hasOwnProperty("Promise");
          return t && e;
        }
      }), Object.defineProperty(n, "initialized", {
        get: function () {
          return Boolean(n.context);
        }
      }), n.getContext = function (t) {
        if (n.initialized) t(n.context);else {
          var e = function () {
            t(n.context), n.Context.off("init", e);
          };

          n.Context.on("init", e);
        }
        return n;
      }, n.version = s.a, e.default = n;
    }.call(this, i(147));
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(20);

    if (s.default.supported) {
      var n = new OfflineAudioContext(2, 1, 44100),
          o = n.createGain(),
          a = n.createGain();

      if (o.connect(a) !== a) {
        var r = AudioNode.prototype.connect;

        AudioNode.prototype.connect = function () {
          return r.apply(this, arguments), arguments[0];
        };
      }
    }

    s.default.AudioNode = function () {
      s.default.call(this);
      var t = s.default.defaults(arguments, ["context"], {
        context: s.default.context
      });
      this._context = t.context;
    }, s.default.extend(s.default.AudioNode), Object.defineProperty(s.default.AudioNode.prototype, "context", {
      get: function () {
        return this._context;
      }
    }), s.default.AudioNode.prototype.createInsOuts = function (t, e) {
      1 === t ? this.input = this.context.createGain() : t > 1 && (this.input = new Array(t)), 1 === e ? this.output = this.context.createGain() : e > 1 && (this.output = new Array(e));
    }, Object.defineProperty(s.default.AudioNode.prototype, "channelCount", {
      get: function () {
        return this.output.channelCount;
      },
      set: function (t) {
        return this.output.channelCount = t;
      }
    }), Object.defineProperty(s.default.AudioNode.prototype, "channelCountMode", {
      get: function () {
        return this.output.channelCountMode;
      },
      set: function (t) {
        return this.output.channelCountMode = t;
      }
    }), Object.defineProperty(s.default.AudioNode.prototype, "channelInterpretation", {
      get: function () {
        return this.output.channelInterpretation;
      },
      set: function (t) {
        return this.output.channelInterpretation = t;
      }
    }), Object.defineProperty(s.default.AudioNode.prototype, "numberOfInputs", {
      get: function () {
        return this.input ? s.default.isArray(this.input) ? this.input.length : 1 : 0;
      }
    }), Object.defineProperty(s.default.AudioNode.prototype, "numberOfOutputs", {
      get: function () {
        return this.output ? s.default.isArray(this.output) ? this.output.length : 1 : 0;
      }
    }), s.default.AudioNode.prototype.connect = function (t, e, i) {
      return s.default.isArray(this.output) ? (e = s.default.defaultArg(e, 0), this.output[e].connect(t, 0, i)) : s.default.connect(this.output, t, e, i), this;
    }, s.default.AudioNode.prototype.disconnect = function (t, e, i) {
      return s.default.isArray(this.output) ? (e = s.default.defaultArg(e, 0), this.output[e].disconnect(t, 0, i)) : s.default.disconnect(this.output, t, e, i), this;
    }, s.default.AudioNode.prototype.chain = function () {
      var t = Array.from(arguments);
      return t.unshift(this), s.default.connectSeries.apply(void 0, t), this;
    }, s.default.AudioNode.prototype.fan = function () {
      for (var t = 0; t < arguments.length; t++) this.connect(arguments[t]);

      return this;
    }, s.default.AudioNode.prototype.dispose = function () {
      return s.default.isDefined(this.input) && (this.input instanceof AudioNode && this.input.disconnect(), this.input = null), s.default.isDefined(this.output) && (this.output instanceof AudioNode && this.output.disconnect(), this.output = null), this._context = null, this;
    };
    e.default = s.default.AudioNode;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4), i(14), i(30), i(44), i(20), i(3);

    if (s.default.supported && !s.default.global.AudioContext.prototype.createConstantSource) {
      var n = function (t) {
        this.context = t;

        for (var e = t.createBuffer(1, 128, t.sampleRate), i = e.getChannelData(0), s = 0; s < i.length; s++) i[s] = 1;

        this._bufferSource = t.createBufferSource(), this._bufferSource.channelCount = 1, this._bufferSource.channelCountMode = "explicit", this._bufferSource.buffer = e, this._bufferSource.loop = !0;
        var n = this._output = t.createGain();
        this.offset = n.gain, this._bufferSource.connect(n);
      };

      n.prototype.start = function (t) {
        return this._bufferSource.start(t), this;
      }, n.prototype.stop = function (t) {
        return this._bufferSource.stop(t), this;
      }, n.prototype.connect = function () {
        return this._output.connect.apply(this._output, arguments), this;
      }, n.prototype.disconnect = function () {
        return this._output.disconnect.apply(this._output, arguments), this;
      }, AudioContext.prototype.createConstantSource = function () {
        return new n(this);
      }, s.default.Context.prototype.createConstantSource = function () {
        return new n(this);
      };
    }

    s.default.Signal = function () {
      var t = s.default.defaults(arguments, ["value", "units"], s.default.Signal);
      s.default.Param.call(this, t), this._constantSource = this.context.createConstantSource(), this._constantSource.start(0), this._param = this._constantSource.offset, this.value = t.value, this.output = this._constantSource, this.input = this._param = this.output.offset;
    }, s.default.extend(s.default.Signal, s.default.Param), s.default.Signal.defaults = {
      value: 0,
      units: s.default.Type.Default,
      convert: !0
    }, s.default.Signal.prototype.connect = s.default.SignalBase.prototype.connect, s.default.Signal.prototype.disconnect = s.default.SignalBase.prototype.disconnect, s.default.Signal.prototype.getValueAtTime = function (t) {
      return this._param.getValueAtTime ? this._param.getValueAtTime(t) : s.default.Param.prototype.getValueAtTime.call(this, t);
    }, s.default.Signal.prototype.dispose = function () {
      return s.default.Param.prototype.dispose.call(this), this._constantSource.stop(), this._constantSource.disconnect(), this._constantSource = null, this;
    };
    e.default = s.default.Signal;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(14), i(4), i(1);
    s.default.Gain = function () {
      var t = s.default.defaults(arguments, ["gain", "units"], s.default.Gain);
      s.default.AudioNode.call(this, t), this.input = this.output = this._gainNode = this.context.createGain(), this.gain = new s.default.Param({
        param: this._gainNode.gain,
        units: t.units,
        value: t.gain,
        convert: t.convert
      }), this._readOnly("gain");
    }, s.default.extend(s.default.Gain, s.default.AudioNode), s.default.Gain.defaults = {
      gain: 1,
      convert: !0
    }, s.default.Gain.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this._gainNode.disconnect(), this._gainNode = null, this._writable("gain"), this.gain.dispose(), this.gain = null;
    }, e.default = s.default.Gain;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(63), i(46), i(45), i(20);
    s.default.Type = {
      Default: "number",
      Time: "time",
      Frequency: "frequency",
      TransportTime: "transportTime",
      Ticks: "ticks",
      NormalRange: "normalRange",
      AudioRange: "audioRange",
      Decibels: "db",
      Interval: "interval",
      BPM: "bpm",
      Positive: "positive",
      Gain: "gain",
      Cents: "cents",
      Degrees: "degrees",
      MIDI: "midi",
      BarsBeatsSixteenths: "barsBeatsSixteenths",
      Samples: "samples",
      Hertz: "hertz",
      Note: "note",
      Milliseconds: "milliseconds",
      Seconds: "seconds",
      Notation: "notation"
    }, s.default.prototype.toSeconds = function (t) {
      return s.default.isNumber(t) ? t : s.default.isUndef(t) ? this.now() : s.default.isString(t) || s.default.isObject(t) ? new s.default.Time(t).toSeconds() : t instanceof s.default.TimeBase ? t.toSeconds() : void 0;
    }, s.default.prototype.toFrequency = function (t) {
      return s.default.isNumber(t) ? t : s.default.isString(t) || s.default.isUndef(t) || s.default.isObject(t) ? new s.default.Frequency(t).valueOf() : t instanceof s.default.TimeBase ? t.toFrequency() : void 0;
    }, s.default.prototype.toTicks = function (t) {
      return s.default.isNumber(t) || s.default.isString(t) || s.default.isObject(t) ? new s.default.TransportTime(t).toTicks() : s.default.isUndef(t) ? s.default.Transport.ticks : t instanceof s.default.TimeBase ? t.toTicks() : void 0;
    }, e.default = s.default;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(14), i(3), i(30);
    s.default.Multiply = function (t) {
      s.default.Signal.call(this), this.createInsOuts(2, 0), this._mult = this.input[0] = this.output = new s.default.Gain(), this._param = this.input[1] = this.output.gain, this.value = s.default.defaultArg(t, 0);
    }, s.default.extend(s.default.Multiply, s.default.Signal), s.default.Multiply.prototype.dispose = function () {
      return s.default.Signal.prototype.dispose.call(this), this._mult.dispose(), this._mult = null, this._param = null, this;
    }, e.default = s.default.Multiply;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(16), i(27), i(40), i(4), i(34), i(2), i(1);
    s.default.Source = function (t) {
      t = s.default.defaultArg(t, s.default.Source.defaults), s.default.AudioNode.call(this), this._volume = this.output = new s.default.Volume(t.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._state = new s.default.TimelineState(s.default.State.Stopped), this._state.memory = 100, this._synced = !1, this._scheduled = [], this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = t.mute;
    }, s.default.extend(s.default.Source, s.default.AudioNode), s.default.Source.defaults = {
      volume: 0,
      mute: !1
    }, Object.defineProperty(s.default.Source.prototype, "state", {
      get: function () {
        return this._synced ? s.default.Transport.state === s.default.State.Started ? this._state.getValueAtTime(s.default.Transport.seconds) : s.default.State.Stopped : this._state.getValueAtTime(this.now());
      }
    }), Object.defineProperty(s.default.Source.prototype, "mute", {
      get: function () {
        return this._volume.mute;
      },
      set: function (t) {
        this._volume.mute = t;
      }
    }), s.default.Source.prototype._start = s.default.noOp, s.default.Source.prototype.restart = s.default.noOp, s.default.Source.prototype._stop = s.default.noOp, s.default.Source.prototype.start = function (t, e, i) {
      if (s.default.isUndef(t) && this._synced ? t = s.default.Transport.seconds : (t = this.toSeconds(t), t = Math.max(t, this.context.currentTime)), this._state.getValueAtTime(t) === s.default.State.Started) this._state.cancel(t), this._state.setStateAtTime(s.default.State.Started, t), this.restart(t, e, i);else if (this._state.setStateAtTime(s.default.State.Started, t), this._synced) {
        var n = this._state.get(t);

        n.offset = s.default.defaultArg(e, 0), n.duration = i;
        var o = s.default.Transport.schedule(function (t) {
          this._start(t, e, i);
        }.bind(this), t);
        this._scheduled.push(o), s.default.Transport.state === s.default.State.Started && this._syncedStart(this.now(), s.default.Transport.seconds);
      } else this._start.apply(this, arguments);
      return this;
    }, s.default.Source.prototype.stop = function (t) {
      if (s.default.isUndef(t) && this._synced ? t = s.default.Transport.seconds : (t = this.toSeconds(t), t = Math.max(t, this.context.currentTime)), this._synced) {
        var e = s.default.Transport.schedule(this._stop.bind(this), t);

        this._scheduled.push(e);
      } else this._stop.apply(this, arguments);

      return this._state.cancel(t), this._state.setStateAtTime(s.default.State.Stopped, t), this;
    }, s.default.Source.prototype.sync = function () {
      return this._synced = !0, this._syncedStart = function (t, e) {
        if (e > 0) {
          var i = this._state.get(e);

          if (i && i.state === s.default.State.Started && i.time !== e) {
            var n,
                o = e - this.toSeconds(i.time);
            i.duration && (n = this.toSeconds(i.duration) - o), this._start(t, this.toSeconds(i.offset) + o, n);
          }
        }
      }.bind(this), this._syncedStop = function (t) {
        var e = s.default.Transport.getSecondsAtTime(Math.max(t - this.sampleTime, 0));
        this._state.getValueAtTime(e) === s.default.State.Started && this._stop(t);
      }.bind(this), s.default.Transport.on("start loopStart", this._syncedStart), s.default.Transport.on("stop pause loopEnd", this._syncedStop), this;
    }, s.default.Source.prototype.unsync = function () {
      this._synced && (s.default.Transport.off("stop pause loopEnd", this._syncedStop), s.default.Transport.off("start loopStart", this._syncedStart)), this._synced = !1;

      for (var t = 0; t < this._scheduled.length; t++) {
        var e = this._scheduled[t];
        s.default.Transport.clear(e);
      }

      return this._scheduled = [], this._state.cancel(0), this;
    }, s.default.Source.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this.unsync(), this._scheduled = null, this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this._state.dispose(), this._state = null;
    }, e.default = s.default.Source;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(30), i(44);

    if (s.default.supported && !s.default.global.AudioContext.prototype._native_createWaveShaper) {
      var n = navigator.userAgent.toLowerCase();

      if (n.includes("safari") && !n.includes("chrome")) {
        var o = function (t) {
          for (var e in this._internalNode = this.input = this.output = t._native_createWaveShaper(), this._curve = null, this._internalNode) this._defineProperty(this._internalNode, e);
        };

        Object.defineProperty(o.prototype, "curve", {
          get: function () {
            return this._curve;
          },
          set: function (t) {
            this._curve = t;
            var e = new Float32Array(t.length + 1);
            e.set(t, 1), e[0] = t[0], this._internalNode.curve = e;
          }
        }), o.prototype._defineProperty = function (t, e) {
          s.default.isUndef(this[e]) && Object.defineProperty(this, e, {
            get: function () {
              return "function" == typeof t[e] ? t[e].bind(t) : t[e];
            },
            set: function (i) {
              t[e] = i;
            }
          });
        }, s.default.global.AudioContext.prototype._native_createWaveShaper = s.default.global.AudioContext.prototype.createWaveShaper, s.default.global.AudioContext.prototype.createWaveShaper = function () {
          return new o(this);
        };
      }
    }

    s.default.WaveShaper = function (t, e) {
      s.default.SignalBase.call(this), this._shaper = this.input = this.output = this.context.createWaveShaper(), this._curve = null, Array.isArray(t) ? this.curve = t : isFinite(t) || s.default.isUndef(t) ? this._curve = new Float32Array(s.default.defaultArg(t, 1024)) : s.default.isFunction(t) && (this._curve = new Float32Array(s.default.defaultArg(e, 1024)), this.setMap(t));
    }, s.default.extend(s.default.WaveShaper, s.default.SignalBase), s.default.WaveShaper.prototype.setMap = function (t) {
      for (var e = new Array(this._curve.length), i = 0, s = this._curve.length; i < s; i++) {
        var n = i / (s - 1) * 2 - 1;
        e[i] = t(n, i);
      }

      return this.curve = e, this;
    }, Object.defineProperty(s.default.WaveShaper.prototype, "curve", {
      get: function () {
        return this._shaper.curve;
      },
      set: function (t) {
        this._curve = new Float32Array(t), this._shaper.curve = this._curve;
      }
    }), Object.defineProperty(s.default.WaveShaper.prototype, "oversample", {
      get: function () {
        return this._shaper.oversample;
      },
      set: function (t) {
        if (!["none", "2x", "4x"].includes(t)) throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");
        this._shaper.oversample = t;
      }
    }), s.default.WaveShaper.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._shaper.disconnect(), this._shaper = null, this._curve = null, this;
    };
    e.default = s.default.WaveShaper;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(23), i(1);
    s.default.Effect = function () {
      var t = s.default.defaults(arguments, ["wet"], s.default.Effect);
      s.default.AudioNode.call(this), this.createInsOuts(1, 1), this._dryWet = new s.default.CrossFade(t.wet), this.wet = this._dryWet.fade, this.effectSend = new s.default.Gain(), this.effectReturn = new s.default.Gain(), s.default.connect(this.input, this._dryWet.a), s.default.connect(this.input, this.effectSend), this.effectReturn.connect(this._dryWet.b), this._dryWet.connect(this.output), this._readOnly(["wet"]);
    }, s.default.extend(s.default.Effect, s.default.AudioNode), s.default.Effect.defaults = {
      wet: 1
    }, s.default.Effect.prototype.connectEffect = function (t) {
      return this.effectSend.chain(t, this.effectReturn), this;
    }, s.default.Effect.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this.effectSend.dispose(), this.effectSend = null, this.effectReturn.dispose(), this.effectReturn = null, this._writable(["wet"]), this.wet = null, this;
    }, e.default = s.default.Effect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(1);
    s.default.Filter = function () {
      var t = s.default.defaults(arguments, ["frequency", "type", "rolloff"], s.default.Filter);
      s.default.AudioNode.call(this), this.createInsOuts(1, 1), this._filters = [], this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.detune = new s.default.Signal(0, s.default.Type.Cents), this.gain = new s.default.Signal({
        value: t.gain,
        convert: !0,
        type: s.default.Type.Decibels
      }), this.Q = new s.default.Signal(t.Q), this._type = t.type, this._rolloff = t.rolloff, this.rolloff = t.rolloff, this._readOnly(["detune", "frequency", "gain", "Q"]);
    }, s.default.extend(s.default.Filter, s.default.AudioNode), s.default.Filter.defaults = {
      type: "lowpass",
      frequency: 350,
      rolloff: -12,
      Q: 1,
      gain: 0
    }, Object.defineProperty(s.default.Filter.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        if (-1 === ["lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "notch", "allpass", "peaking"].indexOf(t)) throw new TypeError("Tone.Filter: invalid type " + t);
        this._type = t;

        for (var e = 0; e < this._filters.length; e++) this._filters[e].type = t;
      }
    }), Object.defineProperty(s.default.Filter.prototype, "rolloff", {
      get: function () {
        return this._rolloff;
      },
      set: function (t) {
        t = parseInt(t, 10);
        var e = [-12, -24, -48, -96].indexOf(t);
        if (-1 === e) throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96");
        e += 1, this._rolloff = t, this.input.disconnect();

        for (var i = 0; i < this._filters.length; i++) this._filters[i].disconnect(), this._filters[i] = null;

        this._filters = new Array(e);

        for (var n = 0; n < e; n++) {
          var o = this.context.createBiquadFilter();
          o.type = this._type, this.frequency.connect(o.frequency), this.detune.connect(o.detune), this.Q.connect(o.Q), this.gain.connect(o.gain), this._filters[n] = o;
        }

        var a = [this.input].concat(this._filters).concat([this.output]);
        s.default.connectSeries.apply(s.default, a);
      }
    }), s.default.Filter.prototype.getFrequencyResponse = function (t) {
      t = s.default.defaultArg(t, 128);

      for (var e = new Float32Array(t).map(function () {
        return 1;
      }), i = new Float32Array(t), n = 0; n < t; n++) {
        var o = 19980 * Math.pow(n / t, 2) + 20;
        i[n] = o;
      }

      var a = new Float32Array(t),
          r = new Float32Array(t);
      return this._filters.forEach(function () {
        var t = this.context.createBiquadFilter();
        t.type = this._type, t.Q.value = this.Q.value, t.frequency.value = this.frequency.value, t.gain.value = this.gain.value, t.getFrequencyResponse(i, a, r), a.forEach(function (t, i) {
          e[i] *= t;
        });
      }.bind(this)), e;
    }, s.default.Filter.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this);

      for (var t = 0; t < this._filters.length; t++) this._filters[t].disconnect(), this._filters[t] = null;

      return this._filters = null, this._writable(["detune", "frequency", "gain", "Q"]), this.frequency.dispose(), this.Q.dispose(), this.frequency = null, this.Q = null, this.detune.dispose(), this.detune = null, this.gain.dispose(), this.gain = null, this;
    }, e.default = s.default.Filter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(1);
    s.default.Merge = function (t) {
      t = s.default.defaultArg(t, 2), s.default.AudioNode.call(this), this.createInsOuts(t, 0), this._merger = this.output = this.context.createChannelMerger(t);

      for (var e = 0; e < t; e++) this.input[e] = new s.default.Gain(), this.input[e].connect(this._merger, 0, e), this.input[e].channelCount = 1, this.input[e].channelCountMode = "explicit";

      this.left = this.input[0], this.right = this.input[1];
    }, s.default.extend(s.default.Merge, s.default.AudioNode), s.default.Merge.prototype.dispose = function () {
      return this.input.forEach(function (t) {
        t.dispose();
      }), s.default.AudioNode.prototype.dispose.call(this), this.left = null, this.right = null, this._merger.disconnect(), this._merger = null, this;
    }, e.default = s.default.Merge;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(35), i(4);
    s.default.supported && (AudioBuffer.prototype.copyToChannel || (AudioBuffer.prototype.copyToChannel = function (t, e, i) {
      var s = this.getChannelData(e);
      i = i || 0;

      for (var n = 0; n < s.length; n++) s[n + i] = t[n];
    }, AudioBuffer.prototype.copyFromChannel = function (t, e, i) {
      var s = this.getChannelData(e);
      i = i || 0;

      for (var n = 0; n < t.length; n++) t[n] = s[n + i];
    })), s.default.Buffer = function () {
      var t = s.default.defaults(arguments, ["url", "onload", "onerror"], s.default.Buffer);
      s.default.call(this), this._buffer = null, this._reversed = t.reverse, this._xhr = null, this.onload = s.default.noOp, t.url instanceof AudioBuffer || t.url instanceof s.default.Buffer ? (this.set(t.url), this.loaded || (this.onload = t.onload)) : s.default.isString(t.url) && this.load(t.url).then(t.onload).catch(t.onerror);
    }, s.default.extend(s.default.Buffer), s.default.Buffer.defaults = {
      url: void 0,
      reverse: !1,
      onload: s.default.noOp,
      onerror: s.default.noOp
    }, s.default.Buffer.prototype.set = function (t) {
      return t instanceof s.default.Buffer ? t.loaded ? this._buffer = t.get() : t.onload = function () {
        this.set(t), this.onload(this);
      }.bind(this) : this._buffer = t, this._reversed && this._reverse(), this;
    }, s.default.Buffer.prototype.get = function () {
      return this._buffer;
    }, s.default.Buffer.prototype.load = function (t, e, i) {
      return new Promise(function (n, o) {
        this._xhr = s.default.Buffer.load(t, function (t) {
          this._xhr = null, this.set(t), n(this), this.onload(this), e && e(this);
        }.bind(this), function (t) {
          this._xhr = null, o(t), i && i(t);
        }.bind(this));
      }.bind(this));
    }, s.default.Buffer.prototype.dispose = function () {
      return s.default.prototype.dispose.call(this), this._buffer = null, this._xhr && (s.default.Buffer._removeFromDownloadQueue(this._xhr), this._xhr.abort(), this._xhr = null), this;
    }, Object.defineProperty(s.default.Buffer.prototype, "loaded", {
      get: function () {
        return this.length > 0;
      }
    }), Object.defineProperty(s.default.Buffer.prototype, "duration", {
      get: function () {
        return this._buffer ? this._buffer.duration : 0;
      }
    }), Object.defineProperty(s.default.Buffer.prototype, "length", {
      get: function () {
        return this._buffer ? this._buffer.length : 0;
      }
    }), Object.defineProperty(s.default.Buffer.prototype, "numberOfChannels", {
      get: function () {
        return this._buffer ? this._buffer.numberOfChannels : 0;
      }
    }), s.default.Buffer.prototype.fromArray = function (t) {
      var e = t[0].length > 0,
          i = e ? t.length : 1,
          s = e ? t[0].length : t.length,
          n = this.context.createBuffer(i, s, this.context.sampleRate);
      e || 1 !== i || (t = [t]);

      for (var o = 0; o < i; o++) n.copyToChannel(t[o], o);

      return this._buffer = n, this;
    }, s.default.Buffer.prototype.toMono = function (t) {
      if (s.default.isNumber(t)) this.fromArray(this.toArray(t));else {
        for (var e = new Float32Array(this.length), i = this.numberOfChannels, n = 0; n < i; n++) for (var o = this.toArray(n), a = 0; a < o.length; a++) e[a] += o[a];

        e = e.map(function (t) {
          return t / i;
        }), this.fromArray(e);
      }
      return this;
    }, s.default.Buffer.prototype.toArray = function (t) {
      if (s.default.isNumber(t)) return this.getChannelData(t);
      if (1 === this.numberOfChannels) return this.toArray(0);

      for (var e = [], i = 0; i < this.numberOfChannels; i++) e[i] = this.getChannelData(i);

      return e;
    }, s.default.Buffer.prototype.getChannelData = function (t) {
      return this._buffer.getChannelData(t);
    }, s.default.Buffer.prototype.slice = function (t, e) {
      e = s.default.defaultArg(e, this.duration);

      for (var i = Math.floor(this.context.sampleRate * this.toSeconds(t)), n = Math.floor(this.context.sampleRate * this.toSeconds(e)), o = [], a = 0; a < this.numberOfChannels; a++) o[a] = this.toArray(a).slice(i, n);

      return new s.default.Buffer().fromArray(o);
    }, s.default.Buffer.prototype._reverse = function () {
      if (this.loaded) for (var t = 0; t < this.numberOfChannels; t++) Array.prototype.reverse.call(this.getChannelData(t));
      return this;
    }, Object.defineProperty(s.default.Buffer.prototype, "reverse", {
      get: function () {
        return this._reversed;
      },
      set: function (t) {
        this._reversed !== t && (this._reversed = t, this._reverse());
      }
    }), s.default.Emitter.mixin(s.default.Buffer), s.default.Buffer._downloadQueue = [], s.default.Buffer.baseUrl = "", s.default.Buffer.fromArray = function (t) {
      return new s.default.Buffer().fromArray(t);
    }, s.default.Buffer.fromUrl = function (t) {
      var e = new s.default.Buffer();
      return e.load(t).then(function () {
        return e;
      });
    }, s.default.Buffer._removeFromDownloadQueue = function (t) {
      var e = s.default.Buffer._downloadQueue.indexOf(t);

      -1 !== e && s.default.Buffer._downloadQueue.splice(e, 1);
    }, s.default.Buffer.load = function (t, e, i) {
      e = s.default.defaultArg(e, s.default.noOp);
      var n = t.match(/\[(.+\|?)+\]$/);

      if (n) {
        for (var o = n[1].split("|"), a = o[0], r = 0; r < o.length; r++) if (s.default.Buffer.supportsType(o[r])) {
          a = o[r];
          break;
        }

        t = t.replace(n[0], a);
      }

      function l(t) {
        if (s.default.Buffer._removeFromDownloadQueue(d), s.default.Buffer.emit("error", t), !i) throw t;
        i(t);
      }

      function u() {
        for (var t = 0, e = 0; e < s.default.Buffer._downloadQueue.length; e++) t += s.default.Buffer._downloadQueue[e].progress;

        s.default.Buffer.emit("progress", t / s.default.Buffer._downloadQueue.length);
      }

      var d = new XMLHttpRequest();
      return d.open("GET", s.default.Buffer.baseUrl + t, !0), d.responseType = "arraybuffer", d.progress = 0, s.default.Buffer._downloadQueue.push(d), d.addEventListener("load", function () {
        200 === d.status ? s.default.context.decodeAudioData(d.response).then(function (t) {
          d.progress = 1, u(), e(t), s.default.Buffer._removeFromDownloadQueue(d), 0 === s.default.Buffer._downloadQueue.length && s.default.Buffer.emit("load");
        }).catch(function () {
          s.default.Buffer._removeFromDownloadQueue(d), l("Tone.Buffer: could not decode audio data: " + t);
        }) : l("Tone.Buffer: could not locate file: " + t);
      }), d.addEventListener("error", l), d.addEventListener("progress", function (t) {
        t.lengthComputable && (d.progress = t.loaded / t.total * .95, u());
      }), d.send(), d;
    }, s.default.Buffer.cancelDownloads = function () {
      return s.default.Buffer._downloadQueue.slice().forEach(function (t) {
        s.default.Buffer._removeFromDownloadQueue(t), t.abort();
      }), s.default.Buffer;
    }, s.default.Buffer.supportsType = function (t) {
      var e = t.split(".");
      return e = e[e.length - 1], "" !== document.createElement("audio").canPlayType("audio/" + e);
    }, s.default.loaded = function () {
      var t, e;

      function i() {
        s.default.Buffer.off("load", t), s.default.Buffer.off("error", e);
      }

      return new Promise(function (i, n) {
        t = function () {
          i();
        }, e = function () {
          n();
        }, s.default.Buffer.on("load", t), s.default.Buffer.on("error", e);
      }).then(i).catch(function (t) {
        throw i(), new Error(t);
      });
    };
    e.default = s.default.Buffer;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(17), i(26), i(1), i(2), i(22), i(4), i(28);
    s.default.LFO = function () {
      var t = s.default.defaults(arguments, ["frequency", "min", "max"], s.default.LFO);
      s.default.AudioNode.call(this), this._oscillator = new s.default.Oscillator({
        frequency: t.frequency,
        type: t.type
      }), this.frequency = this._oscillator.frequency, this.amplitude = this._oscillator.volume, this.amplitude.units = s.default.Type.NormalRange, this.amplitude.value = t.amplitude, this._stoppedSignal = new s.default.Signal(0, s.default.Type.AudioRange), this._zeros = new s.default.Zero(), this._stoppedValue = 0, this._a2g = new s.default.AudioToGain(), this._scaler = this.output = new s.default.Scale(t.min, t.max), this._units = s.default.Type.Default, this.units = t.units, this._oscillator.chain(this._a2g, this._scaler), this._zeros.connect(this._a2g), this._stoppedSignal.connect(this._a2g), this._readOnly(["amplitude", "frequency"]), this.phase = t.phase;
    }, s.default.extend(s.default.LFO, s.default.AudioNode), s.default.LFO.defaults = {
      type: "sine",
      min: 0,
      max: 1,
      phase: 0,
      frequency: "4n",
      amplitude: 1,
      units: s.default.Type.Default
    }, s.default.LFO.prototype.start = function (t) {
      return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(0, t), this._oscillator.start(t), this;
    }, s.default.LFO.prototype.stop = function (t) {
      return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(this._stoppedValue, t), this._oscillator.stop(t), this;
    }, s.default.LFO.prototype.sync = function () {
      return this._oscillator.sync(), this._oscillator.syncFrequency(), this;
    }, s.default.LFO.prototype.unsync = function () {
      return this._oscillator.unsync(), this._oscillator.unsyncFrequency(), this;
    }, Object.defineProperty(s.default.LFO.prototype, "min", {
      get: function () {
        return this._toUnits(this._scaler.min);
      },
      set: function (t) {
        t = this._fromUnits(t), this._scaler.min = t;
      }
    }), Object.defineProperty(s.default.LFO.prototype, "max", {
      get: function () {
        return this._toUnits(this._scaler.max);
      },
      set: function (t) {
        t = this._fromUnits(t), this._scaler.max = t;
      }
    }), Object.defineProperty(s.default.LFO.prototype, "type", {
      get: function () {
        return this._oscillator.type;
      },
      set: function (t) {
        this._oscillator.type = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue;
      }
    }), Object.defineProperty(s.default.LFO.prototype, "phase", {
      get: function () {
        return this._oscillator.phase;
      },
      set: function (t) {
        this._oscillator.phase = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue;
      }
    }), Object.defineProperty(s.default.LFO.prototype, "units", {
      get: function () {
        return this._units;
      },
      set: function (t) {
        var e = this.min,
            i = this.max;
        this._units = t, this.min = e, this.max = i;
      }
    }), Object.defineProperty(s.default.LFO.prototype, "state", {
      get: function () {
        return this._oscillator.state;
      }
    }), s.default.LFO.prototype.connect = function (t) {
      return t.constructor !== s.default.Signal && t.constructor !== s.default.Param || (this.convert = t.convert, this.units = t.units), s.default.SignalBase.prototype.connect.apply(this, arguments), this;
    }, s.default.LFO.prototype._fromUnits = s.default.Param.prototype._fromUnits, s.default.LFO.prototype._toUnits = s.default.Param.prototype._toUnits, s.default.LFO.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["amplitude", "frequency"]), this._oscillator.dispose(), this._oscillator = null, this._stoppedSignal.dispose(), this._stoppedSignal = null, this._zeros.dispose(), this._zeros = null, this._scaler.dispose(), this._scaler = null, this._a2g.dispose(), this._a2g = null, this.frequency = null, this.amplitude = null, this;
    }, e.default = s.default.LFO;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(29), i(90), i(2), i(3);
    s.default.Subtract = function (t) {
      s.default.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.output = new s.default.Gain(), this._neg = new s.default.Negate(), this._param = this.input[1] = new s.default.Signal(t), this._param.chain(this._neg, this._sum);
    }, s.default.extend(s.default.Subtract, s.default.Signal), s.default.Subtract.prototype.dispose = function () {
      return s.default.Signal.prototype.dispose.call(this), this._neg.dispose(), this._neg = null, this._sum.disconnect(), this._sum = null, this;
    }, e.default = s.default.Subtract;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4), i(1), i(24);
    s.default.Param = function () {
      var t = s.default.defaults(arguments, ["param", "units", "convert"], s.default.Param);
      s.default.AudioNode.call(this, t), this._param = this.input = t.param, this.units = t.units, this.convert = t.convert, this.overridden = !1, this._events = new s.default.Timeline(1e3), s.default.isDefined(t.value) && this._param && this.setValueAtTime(t.value, 0);
    }, s.default.extend(s.default.Param, s.default.AudioNode), s.default.Param.defaults = {
      units: s.default.Type.Default,
      convert: !0,
      param: void 0
    }, Object.defineProperty(s.default.Param.prototype, "value", {
      get: function () {
        var t = this.now();
        return this._toUnits(this.getValueAtTime(t));
      },
      set: function (t) {
        this._initialValue = this._fromUnits(t), this.cancelScheduledValues(this.now()), this.setValueAtTime(t, this.now());
      }
    }), Object.defineProperty(s.default.Param.prototype, "minValue", {
      get: function () {
        return this.units === s.default.Type.Time || this.units === s.default.Type.Frequency || this.units === s.default.Type.NormalRange || this.units === s.default.Type.Positive || this.units === s.default.Type.BPM ? 0 : this.units === s.default.Type.AudioRange ? -1 : this.units === s.default.Type.Decibels ? -1 / 0 : this._param.minValue;
      }
    }), Object.defineProperty(s.default.Param.prototype, "maxValue", {
      get: function () {
        return this.units === s.default.Type.NormalRange || this.units === s.default.Type.AudioRange ? 1 : this._param.maxValue;
      }
    }), s.default.Param.prototype._fromUnits = function (t) {
      if (!this.convert && !s.default.isUndef(this.convert) || this.overridden) return t;

      switch (this.units) {
        case s.default.Type.Time:
          return this.toSeconds(t);

        case s.default.Type.Frequency:
          return this.toFrequency(t);

        case s.default.Type.Decibels:
          return s.default.dbToGain(t);

        case s.default.Type.NormalRange:
          return Math.min(Math.max(t, 0), 1);

        case s.default.Type.AudioRange:
          return Math.min(Math.max(t, -1), 1);

        case s.default.Type.Positive:
          return Math.max(t, 0);

        default:
          return t;
      }
    }, s.default.Param.prototype._toUnits = function (t) {
      if (!this.convert && !s.default.isUndef(this.convert)) return t;

      switch (this.units) {
        case s.default.Type.Decibels:
          return s.default.gainToDb(t);

        default:
          return t;
      }
    }, s.default.Param.prototype._minOutput = 1e-5, s.default.Param.AutomationType = {
      Linear: "linearRampToValueAtTime",
      Exponential: "exponentialRampToValueAtTime",
      Target: "setTargetAtTime",
      SetValue: "setValueAtTime",
      Cancel: "cancelScheduledValues"
    }, s.default.Param.prototype.setValueAtTime = function (t, e) {
      return e = this.toSeconds(e), t = this._fromUnits(t), this._events.add({
        type: s.default.Param.AutomationType.SetValue,
        value: t,
        time: e
      }), this.log(s.default.Param.AutomationType.SetValue, t, e), this._param.setValueAtTime(t, e), this;
    }, s.default.Param.prototype.getValueAtTime = function (t) {
      t = this.toSeconds(t);

      var e = this._events.getAfter(t),
          i = this._events.get(t),
          n = s.default.defaultArg(this._initialValue, this._param.defaultValue),
          o = n;

      if (null === i) o = n;else if (i.type === s.default.Param.AutomationType.Target) {
        var a,
            r = this._events.getBefore(i.time);

        a = null === r ? n : r.value, o = this._exponentialApproach(i.time, a, i.value, i.constant, t);
      } else o = null === e ? i.value : e.type === s.default.Param.AutomationType.Linear ? this._linearInterpolate(i.time, i.value, e.time, e.value, t) : e.type === s.default.Param.AutomationType.Exponential ? this._exponentialInterpolate(i.time, i.value, e.time, e.value, t) : i.value;
      return o;
    }, s.default.Param.prototype.setRampPoint = function (t) {
      t = this.toSeconds(t);
      var e = this.getValueAtTime(t);
      return this.cancelAndHoldAtTime(t), 0 === e && (e = this._minOutput), this.setValueAtTime(this._toUnits(e), t), this;
    }, s.default.Param.prototype.linearRampToValueAtTime = function (t, e) {
      return t = this._fromUnits(t), e = this.toSeconds(e), this._events.add({
        type: s.default.Param.AutomationType.Linear,
        value: t,
        time: e
      }), this.log(s.default.Param.AutomationType.Linear, t, e), this._param.linearRampToValueAtTime(t, e), this;
    }, s.default.Param.prototype.exponentialRampToValueAtTime = function (t, e) {
      return t = this._fromUnits(t), t = Math.max(this._minOutput, t), e = this.toSeconds(e), this._events.add({
        type: s.default.Param.AutomationType.Exponential,
        time: e,
        value: t
      }), this.log(s.default.Param.AutomationType.Exponential, t, e), this._param.exponentialRampToValueAtTime(t, e), this;
    }, s.default.Param.prototype.exponentialRampTo = function (t, e, i) {
      return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialRampToValueAtTime(t, i + this.toSeconds(e)), this;
    }, s.default.Param.prototype.linearRampTo = function (t, e, i) {
      return i = this.toSeconds(i), this.setRampPoint(i), this.linearRampToValueAtTime(t, i + this.toSeconds(e)), this;
    }, s.default.Param.prototype.targetRampTo = function (t, e, i) {
      return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialApproachValueAtTime(t, i, e), this;
    }, s.default.Param.prototype.exponentialApproachValueAtTime = function (t, e, i) {
      var s = Math.log(this.toSeconds(i) + 1) / Math.log(200);
      return e = this.toSeconds(e), this.setTargetAtTime(t, e, s), this.cancelAndHoldAtTime(e + .9 * i), this.linearRampToValueAtTime(t, e + i), this;
    }, s.default.Param.prototype.setTargetAtTime = function (t, e, i) {
      if (t = this._fromUnits(t), i <= 0) throw new Error("timeConstant must be greater than 0");
      return e = this.toSeconds(e), this._events.add({
        type: s.default.Param.AutomationType.Target,
        value: t,
        time: e,
        constant: i
      }), this.log(s.default.Param.AutomationType.Target, t, e, i), this._param.setTargetAtTime(t, e, i), this;
    }, s.default.Param.prototype.setValueCurveAtTime = function (t, e, i, n) {
      n = s.default.defaultArg(n, 1), i = this.toSeconds(i), e = this.toSeconds(e), this.setValueAtTime(t[0] * n, e);

      for (var o = i / (t.length - 1), a = 1; a < t.length; a++) this.linearRampToValueAtTime(t[a] * n, e + a * o);

      return this;
    }, s.default.Param.prototype.cancelScheduledValues = function (t) {
      return t = this.toSeconds(t), this._events.cancel(t), this._param.cancelScheduledValues(t), this.log(s.default.Param.AutomationType.Cancel, t), this;
    }, s.default.Param.prototype.cancelAndHoldAtTime = function (t) {
      t = this.toSeconds(t);
      var e = this.getValueAtTime(t);
      this.log("cancelAndHoldAtTime", t, "value=" + e), this._param.cancelScheduledValues(t);

      var i = this._events.get(t),
          n = this._events.getAfter(t);

      return i && i.time === t ? n ? this._events.cancel(n.time) : this._events.cancel(t + this.sampleTime) : n && (this._events.cancel(n.time), n.type === s.default.Param.AutomationType.Linear ? this.linearRampToValueAtTime(e, t) : n.type === s.default.Param.AutomationType.Exponential && this.exponentialRampToValueAtTime(e, t)), this._events.add({
        type: s.default.Param.AutomationType.SetValue,
        value: e,
        time: t
      }), this._param.setValueAtTime(e, t), this;
    }, s.default.Param.prototype.rampTo = function (t, e, i) {
      return e = s.default.defaultArg(e, .1), this.units === s.default.Type.Frequency || this.units === s.default.Type.BPM || this.units === s.default.Type.Decibels ? this.exponentialRampTo(t, e, i) : this.linearRampTo(t, e, i), this;
    }, s.default.Param.prototype._exponentialApproach = function (t, e, i, s, n) {
      return i + (e - i) * Math.exp(-(n - t) / s);
    }, s.default.Param.prototype._linearInterpolate = function (t, e, i, s, n) {
      return e + (n - t) / (i - t) * (s - e);
    }, s.default.Param.prototype._exponentialInterpolate = function (t, e, i, s, n) {
      return e * Math.pow(s / e, (n - t) / (i - t));
    }, s.default.Param.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._param = null, this._events = null, this;
    }, e.default = s.default.Param;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(19), i(10), i(23);
    s.default.StereoEffect = function () {
      s.default.AudioNode.call(this);
      var t = s.default.defaults(arguments, ["wet"], s.default.Effect);
      this.createInsOuts(1, 1), this._dryWet = new s.default.CrossFade(t.wet), this.wet = this._dryWet.fade, this._split = new s.default.Split(), this.effectSendL = this._split.left, this.effectSendR = this._split.right, this._merge = new s.default.Merge(), this.effectReturnL = this._merge.left, this.effectReturnR = this._merge.right, s.default.connect(this.input, this._split), s.default.connect(this.input, this._dryWet, 0, 0), this._merge.connect(this._dryWet, 0, 1), this._dryWet.connect(this.output), this._readOnly(["wet"]);
    }, s.default.extend(s.default.StereoEffect, s.default.Effect), s.default.StereoEffect.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this._split.dispose(), this._split = null, this._merge.dispose(), this._merge = null, this.effectSendL = null, this.effectSendR = null, this.effectReturnL = null, this.effectReturnR = null, this._writable(["wet"]), this.wet = null, this;
    }, e.default = s.default.StereoEffect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(83), i(4), i(24), i(35), i(3), i(81), i(80), i(56);
    s.default.Transport = function () {
      s.default.Emitter.call(this), s.default.getContext(function () {
        this.loop = !1, this._loopStart = 0, this._loopEnd = 0, this._ppq = n.defaults.PPQ, this._clock = new s.default.Clock({
          callback: this._processTick.bind(this),
          frequency: 0
        }), this._bindClockEvents(), this.bpm = this._clock.frequency, this.bpm._toUnits = this._toUnits.bind(this), this.bpm._fromUnits = this._fromUnits.bind(this), this.bpm.units = s.default.Type.BPM, this.bpm.value = n.defaults.bpm, this._readOnly("bpm"), this._timeSignature = n.defaults.timeSignature, this._scheduledEvents = {}, this._timeline = new s.default.Timeline(), this._repeatedEvents = new s.default.IntervalTimeline(), this._syncedSignals = [], this._swingTicks = n.defaults.PPQ / 2, this._swingAmount = 0, this.context.transport = this;
      }.bind(this));
    }, s.default.extend(s.default.Transport, s.default.Emitter), s.default.Transport.defaults = {
      bpm: 120,
      swing: 0,
      swingSubdivision: "8n",
      timeSignature: 4,
      loopStart: 0,
      loopEnd: "4m",
      PPQ: 192
    }, s.default.Transport.prototype.isTransport = !0, s.default.Transport.prototype._processTick = function (t, e) {
      if (this._swingAmount > 0 && e % this._ppq != 0 && e % (2 * this._swingTicks) != 0) {
        var i = e % (2 * this._swingTicks) / (2 * this._swingTicks),
            n = Math.sin(i * Math.PI) * this._swingAmount;

        t += s.default.Ticks(2 * this._swingTicks / 3).toSeconds() * n;
      }

      this.loop && e >= this._loopEnd && (this.emit("loopEnd", t), this._clock.setTicksAtTime(this._loopStart, t), e = this._loopStart, this.emit("loopStart", t, this._clock.getSecondsAtTime(t)), this.emit("loop", t)), this._timeline.forEachAtTime(e, function (e) {
        e.invoke(t);
      });
    }, s.default.Transport.prototype.schedule = function (t, e) {
      var i = new s.default.TransportEvent(this, {
        time: s.default.TransportTime(e),
        callback: t
      });
      return this._addEvent(i, this._timeline);
    }, s.default.Transport.prototype.scheduleRepeat = function (t, e, i, n) {
      var o = new s.default.TransportRepeatEvent(this, {
        callback: t,
        interval: s.default.Time(e),
        time: s.default.TransportTime(i),
        duration: s.default.Time(s.default.defaultArg(n, 1 / 0))
      });
      return this._addEvent(o, this._repeatedEvents);
    }, s.default.Transport.prototype.scheduleOnce = function (t, e) {
      var i = new s.default.TransportEvent(this, {
        time: s.default.TransportTime(e),
        callback: t,
        once: !0
      });
      return this._addEvent(i, this._timeline);
    }, s.default.Transport.prototype.clear = function (t) {
      if (this._scheduledEvents.hasOwnProperty(t)) {
        var e = this._scheduledEvents[t.toString()];

        e.timeline.remove(e.event), e.event.dispose(), delete this._scheduledEvents[t.toString()];
      }

      return this;
    }, s.default.Transport.prototype._addEvent = function (t, e) {
      return this._scheduledEvents[t.id.toString()] = {
        event: t,
        timeline: e
      }, e.add(t), t.id;
    }, s.default.Transport.prototype.cancel = function (t) {
      return t = s.default.defaultArg(t, 0), t = this.toTicks(t), this._timeline.forEachFrom(t, function (t) {
        this.clear(t.id);
      }.bind(this)), this._repeatedEvents.forEachFrom(t, function (t) {
        this.clear(t.id);
      }.bind(this)), this;
    }, s.default.Transport.prototype._bindClockEvents = function () {
      this._clock.on("start", function (t, e) {
        e = s.default.Ticks(e).toSeconds(), this.emit("start", t, e);
      }.bind(this)), this._clock.on("stop", function (t) {
        this.emit("stop", t);
      }.bind(this)), this._clock.on("pause", function (t) {
        this.emit("pause", t);
      }.bind(this));
    }, Object.defineProperty(s.default.Transport.prototype, "state", {
      get: function () {
        return this._clock.getStateAtTime(this.now());
      }
    }), s.default.Transport.prototype.start = function (t, e) {
      return s.default.isDefined(e) && (e = this.toTicks(e)), this._clock.start(t, e), this;
    }, s.default.Transport.prototype.stop = function (t) {
      return this._clock.stop(t), this;
    }, s.default.Transport.prototype.pause = function (t) {
      return this._clock.pause(t), this;
    }, s.default.Transport.prototype.toggle = function (t) {
      return t = this.toSeconds(t), this._clock.getStateAtTime(t) !== s.default.State.Started ? this.start(t) : this.stop(t), this;
    }, Object.defineProperty(s.default.Transport.prototype, "timeSignature", {
      get: function () {
        return this._timeSignature;
      },
      set: function (t) {
        s.default.isArray(t) && (t = t[0] / t[1] * 4), this._timeSignature = t;
      }
    }), Object.defineProperty(s.default.Transport.prototype, "loopStart", {
      get: function () {
        return s.default.Ticks(this._loopStart).toSeconds();
      },
      set: function (t) {
        this._loopStart = this.toTicks(t);
      }
    }), Object.defineProperty(s.default.Transport.prototype, "loopEnd", {
      get: function () {
        return s.default.Ticks(this._loopEnd).toSeconds();
      },
      set: function (t) {
        this._loopEnd = this.toTicks(t);
      }
    }), s.default.Transport.prototype.setLoopPoints = function (t, e) {
      return this.loopStart = t, this.loopEnd = e, this;
    }, Object.defineProperty(s.default.Transport.prototype, "swing", {
      get: function () {
        return this._swingAmount;
      },
      set: function (t) {
        this._swingAmount = t;
      }
    }), Object.defineProperty(s.default.Transport.prototype, "swingSubdivision", {
      get: function () {
        return s.default.Ticks(this._swingTicks).toNotation();
      },
      set: function (t) {
        this._swingTicks = this.toTicks(t);
      }
    }), Object.defineProperty(s.default.Transport.prototype, "position", {
      get: function () {
        var t = this.now(),
            e = this._clock.getTicksAtTime(t);

        return s.default.Ticks(e).toBarsBeatsSixteenths();
      },
      set: function (t) {
        var e = this.toTicks(t);
        this.ticks = e;
      }
    }), Object.defineProperty(s.default.Transport.prototype, "seconds", {
      get: function () {
        return this._clock.seconds;
      },
      set: function (t) {
        var e = this.now(),
            i = this.bpm.timeToTicks(t, e);
        this.ticks = i;
      }
    }), Object.defineProperty(s.default.Transport.prototype, "progress", {
      get: function () {
        if (this.loop) {
          var t = this.now();
          return (this._clock.getTicksAtTime(t) - this._loopStart) / (this._loopEnd - this._loopStart);
        }

        return 0;
      }
    }), Object.defineProperty(s.default.Transport.prototype, "ticks", {
      get: function () {
        return this._clock.ticks;
      },
      set: function (t) {
        if (this._clock.ticks !== t) {
          var e = this.now();
          this.state === s.default.State.Started ? (this.emit("stop", e), this._clock.setTicksAtTime(t, e), this.emit("start", e, this.seconds)) : this._clock.setTicksAtTime(t, e);
        }
      }
    }), s.default.Transport.prototype.getTicksAtTime = function (t) {
      return Math.round(this._clock.getTicksAtTime(t));
    }, s.default.Transport.prototype.getSecondsAtTime = function (t) {
      return this._clock.getSecondsAtTime(t);
    }, Object.defineProperty(s.default.Transport.prototype, "PPQ", {
      get: function () {
        return this._ppq;
      },
      set: function (t) {
        var e = this.bpm.value;
        this._ppq = t, this.bpm.value = e;
      }
    }), s.default.Transport.prototype._fromUnits = function (t) {
      return 1 / (60 / t / this.PPQ);
    }, s.default.Transport.prototype._toUnits = function (t) {
      return t / this.PPQ * 60;
    }, s.default.Transport.prototype.nextSubdivision = function (t) {
      if (t = this.toTicks(t), this.state !== s.default.State.Started) return 0;
      var e = this.now(),
          i = t - this.getTicksAtTime(e) % t;
      return this._clock.nextTickTime(i, e);
    }, s.default.Transport.prototype.syncSignal = function (t, e) {
      if (!e) {
        var i = this.now();
        e = 0 !== t.getValueAtTime(i) ? t.getValueAtTime(i) / this.bpm.getValueAtTime(i) : 0;
      }

      var n = new s.default.Gain(e);
      return this.bpm.chain(n, t._param), this._syncedSignals.push({
        ratio: n,
        signal: t,
        initial: t.value
      }), t.value = 0, this;
    }, s.default.Transport.prototype.unsyncSignal = function (t) {
      for (var e = this._syncedSignals.length - 1; e >= 0; e--) {
        var i = this._syncedSignals[e];
        i.signal === t && (i.ratio.dispose(), i.signal.value = i.initial, this._syncedSignals.splice(e, 1));
      }

      return this;
    }, s.default.Transport.prototype.dispose = function () {
      return s.default.Emitter.prototype.dispose.call(this), this._clock.dispose(), this._clock = null, this._writable("bpm"), this.bpm = null, this._timeline.dispose(), this._timeline = null, this._repeatedEvents.dispose(), this._repeatedEvents = null, this;
    };
    var n = s.default.Transport;
    s.default.Transport = new n(), s.default.Context.on("init", function (t) {
      t.transport && t.transport.isTransport ? s.default.Transport = t.transport : s.default.Transport = new n();
    }), s.default.Context.on("close", function (t) {
      t.transport && t.transport.isTransport && t.transport.dispose();
    }), e.default = s.default.Transport;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(6), i(16), i(64);
    s.default.Oscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "type"], s.default.Oscillator);
      s.default.Source.call(this, t), this._oscillator = null, this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this._wave = null, this._partials = t.partials, this._partialCount = t.partialCount, this._phase = t.phase, this._type = t.type, t.partialCount && t.type !== s.default.Oscillator.Type.Custom && (this._type = this.baseType + t.partialCount.toString()), this.phase = this._phase, this._readOnly(["frequency", "detune"]);
    }, s.default.extend(s.default.Oscillator, s.default.Source), s.default.Oscillator.defaults = {
      type: "sine",
      frequency: 440,
      detune: 0,
      phase: 0,
      partials: [],
      partialCount: 0
    }, s.default.Oscillator.Type = {
      Sine: "sine",
      Triangle: "triangle",
      Sawtooth: "sawtooth",
      Square: "square",
      Custom: "custom"
    }, s.default.Oscillator.prototype._start = function (t) {
      this.log("start", t);
      var e = new s.default.OscillatorNode();
      this._oscillator = e, this._wave ? this._oscillator.setPeriodicWave(this._wave) : this._oscillator.type = this._type, this._oscillator.connect(this.output), this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), t = this.toSeconds(t), this._oscillator.start(t);
    }, s.default.Oscillator.prototype._stop = function (t) {
      return this.log("stop", t), this._oscillator && (t = this.toSeconds(t), this._oscillator.stop(t)), this;
    }, s.default.Oscillator.prototype.restart = function (t) {
      return this._oscillator && this._oscillator.cancelStop(), this._state.cancel(this.toSeconds(t)), this;
    }, s.default.Oscillator.prototype.syncFrequency = function () {
      return s.default.Transport.syncSignal(this.frequency), this;
    }, s.default.Oscillator.prototype.unsyncFrequency = function () {
      return s.default.Transport.unsyncSignal(this.frequency), this;
    }, Object.defineProperty(s.default.Oscillator.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        var e = [s.default.Oscillator.Type.Sine, s.default.Oscillator.Type.Square, s.default.Oscillator.Type.Triangle, s.default.Oscillator.Type.Sawtooth].includes(t);
        if (0 === this._phase && e) this._wave = null, this._partialCount = 0, null !== this._oscillator && (this._oscillator.type = t);else {
          var i = this._getRealImaginary(t, this._phase),
              n = this.context.createPeriodicWave(i[0], i[1]);

          this._wave = n, null !== this._oscillator && this._oscillator.setPeriodicWave(this._wave);
        }
        this._type = t;
      }
    }), Object.defineProperty(s.default.Oscillator.prototype, "baseType", {
      get: function () {
        return this._type.replace(this.partialCount, "");
      },
      set: function (t) {
        this.partialCount && this._type !== s.default.Oscillator.Type.Custom && t !== s.default.Oscillator.Type.Custom ? this.type = t + this.partialCount : this.type = t;
      }
    }), Object.defineProperty(s.default.Oscillator.prototype, "partialCount", {
      get: function () {
        return this._partialCount;
      },
      set: function (t) {
        var e = this._type,
            i = /^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);
        i && (e = i[1]), this._type !== s.default.Oscillator.Type.Custom && (this.type = 0 === t ? e : e + t.toString());
      }
    }), s.default.Oscillator.prototype.get = function () {
      var t = s.default.prototype.get.apply(this, arguments);
      return t.type !== s.default.Oscillator.Type.Custom && delete t.partials, t;
    }, s.default.Oscillator.prototype._getRealImaginary = function (t, e) {
      var i = 2048,
          n = new Float32Array(i),
          o = new Float32Array(i),
          a = 1;
      if (t === s.default.Oscillator.Type.Custom) a = this._partials.length + 1, this._partialCount = this._partials.length, i = a;else {
        var r = /^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);
        r ? (a = parseInt(r[2]) + 1, this._partialCount = parseInt(r[2]), t = r[1], i = a = Math.max(a, 2)) : this._partialCount = 0, this._partials = [];
      }

      for (var l = 1; l < i; ++l) {
        var u,
            d = 2 / (l * Math.PI);

        switch (t) {
          case s.default.Oscillator.Type.Sine:
            u = l <= a ? 1 : 0, this._partials[l - 1] = u;
            break;

          case s.default.Oscillator.Type.Square:
            u = 1 & l ? 2 * d : 0, this._partials[l - 1] = u;
            break;

          case s.default.Oscillator.Type.Sawtooth:
            u = d * (1 & l ? 1 : -1), this._partials[l - 1] = u;
            break;

          case s.default.Oscillator.Type.Triangle:
            u = 1 & l ? d * d * 2 * (l - 1 >> 1 & 1 ? -1 : 1) : 0, this._partials[l - 1] = u;
            break;

          case s.default.Oscillator.Type.Custom:
            u = this._partials[l - 1];
            break;

          default:
            throw new TypeError("Tone.Oscillator: invalid type: " + t);
        }

        0 !== u ? (n[l] = -u * Math.sin(e * l), o[l] = u * Math.cos(e * l)) : (n[l] = 0, o[l] = 0);
      }

      return [n, o];
    }, s.default.Oscillator.prototype._inverseFFT = function (t, e, i) {
      for (var s = 0, n = t.length, o = 0; o < n; o++) s += t[o] * Math.cos(o * i) + e[o] * Math.sin(o * i);

      return s;
    }, s.default.Oscillator.prototype._getInitialValue = function () {
      for (var t = this._getRealImaginary(this._type, 0), e = t[0], i = t[1], s = 0, n = 2 * Math.PI, o = 0; o < 8; o++) s = Math.max(this._inverseFFT(e, i, o / 8 * n), s);

      return -this._inverseFFT(e, i, this._phase) / s;
    }, Object.defineProperty(s.default.Oscillator.prototype, "partials", {
      get: function () {
        return this._partials;
      },
      set: function (t) {
        this._partials = t, this.type = s.default.Oscillator.Type.Custom;
      }
    }), Object.defineProperty(s.default.Oscillator.prototype, "phase", {
      get: function () {
        return this._phase * (180 / Math.PI);
      },
      set: function (t) {
        this._phase = t * Math.PI / 180, this.type = this._type;
      }
    }), s.default.Oscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), null !== this._oscillator && (this._oscillator.dispose(), this._oscillator = null), this._wave = null, this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._partials = null, this;
    }, e.default = s.default.Oscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(14), i(1);
    s.default.Delay = function () {
      var t = s.default.defaults(arguments, ["delayTime", "maxDelay"], s.default.Delay);
      s.default.AudioNode.call(this, t), this._maxDelay = Math.max(this.toSeconds(t.maxDelay), this.toSeconds(t.delayTime)), this._delayNode = this.input = this.output = this.context.createDelay(this._maxDelay), this.delayTime = new s.default.Param({
        param: this._delayNode.delayTime,
        units: s.default.Type.Time,
        value: t.delayTime
      }), this._readOnly("delayTime");
    }, s.default.extend(s.default.Delay, s.default.AudioNode), s.default.Delay.defaults = {
      maxDelay: 1,
      delayTime: 0
    }, Object.defineProperty(s.default.Delay.prototype, "maxDelay", {
      get: function () {
        return this._maxDelay;
      }
    }), s.default.Delay.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._delayNode.disconnect(), this._delayNode = null, this._writable("delayTime"), this.delayTime = null, this;
    }, e.default = s.default.Delay;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(3), i(1);
    s.default.Split = function (t) {
      t = s.default.defaultArg(t, 2), s.default.AudioNode.call(this), this.createInsOuts(0, t), this._splitter = this.input = this.context.createChannelSplitter(t);

      for (var e = 0; e < t; e++) this.output[e] = new s.default.Gain(), s.default.connect(this._splitter, this.output[e], e, 0), this.output[e].channelCount = 1, this.output[e].channelCountMode = "explicit";

      this.left = this.output[0], this.right = this.output[1];
    }, s.default.extend(s.default.Split, s.default.AudioNode), s.default.Split.prototype.dispose = function () {
      return this.output.forEach(function (t) {
        t.dispose();
      }), s.default.AudioNode.prototype.dispose.call(this), this._splitter.disconnect(), this.left = null, this.right = null, this._splitter = null, this;
    }, e.default = s.default.Split;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0),
        n = (i(35), i(24), i(44), ["baseLatency", "destination", "currentTime", "sampleRate", "listener", "state"]),
        o = ["suspend", "close", "resume", "getOutputTimestamp", "createMediaElementSource", "createMediaStreamSource", "createMediaStreamDestination", "createBuffer", "decodeAudioData", "createBufferSource", "createConstantSource", "createGain", "createDelay", "createBiquadFilter", "createIIRFilter", "createWaveShaper", "createPanner", "createConvolver", "createDynamicsCompressor", "createAnalyser", "createScriptProcessor", "createStereoPanner", "createOscillator", "createPeriodicWave", "createChannelSplitter", "createChannelMerger", "audioWorklet"];
    s.default.Context = function () {
      s.default.Emitter.call(this);
      var t = s.default.defaults(arguments, ["context"], s.default.Context);
      if (!t.context && (t.context = new s.default.global.AudioContext(), !t.context)) throw new Error("could not create AudioContext. Possibly too many AudioContexts running already.");

      for (this._context = t.context; this._context.rawContext;) this._context = this._context.rawContext;

      n.forEach(function (t) {
        this._defineProperty(this._context, t);
      }.bind(this)), o.forEach(function (t) {
        this._defineMethod(this._context, t);
      }.bind(this)), this._latencyHint = t.latencyHint, this._constants = {}, this.lookAhead = t.lookAhead, this._computedUpdateInterval = 0, this._ticker = new a(this.emit.bind(this, "tick"), t.clockSource, t.updateInterval), this._timeouts = new s.default.Timeline(), this._timeoutIds = 0, this.on("tick", this._timeoutLoop.bind(this)), this._context.onstatechange = function (t) {
        this.emit("statechange", t);
      }.bind(this);
    }, s.default.extend(s.default.Context, s.default.Emitter), s.default.Emitter.mixin(s.default.Context), s.default.Context.defaults = {
      clockSource: "worker",
      latencyHint: "interactive",
      lookAhead: .1,
      updateInterval: .03
    }, s.default.Context.prototype.isContext = !0, s.default.Context.prototype._defineProperty = function (t, e) {
      s.default.isUndef(this[e]) && Object.defineProperty(this, e, {
        get: function () {
          return t[e];
        },
        set: function (i) {
          t[e] = i;
        }
      });
    }, s.default.Context.prototype._defineMethod = function (t, e) {
      s.default.isUndef(this[e]) && Object.defineProperty(this, e, {
        get: function () {
          return t[e].bind(t);
        }
      });
    }, s.default.Context.prototype.now = function () {
      return this._context.currentTime + this.lookAhead;
    }, Object.defineProperty(s.default.Context.prototype, "destination", {
      get: function () {
        return this.master ? this.master : this._context.destination;
      }
    }), s.default.Context.prototype.resume = function () {
      return "suspended" === this._context.state && this._context instanceof AudioContext ? this._context.resume() : Promise.resolve();
    }, s.default.Context.prototype.close = function () {
      var t = Promise.resolve();
      return this !== s.default.global.TONE_AUDIO_CONTEXT && (t = this.rawContext.close()), t.then(function () {
        s.default.Context.emit("close", this);
      }.bind(this));
    }, s.default.Context.prototype.getConstant = function (t) {
      if (this._constants[t]) return this._constants[t];

      for (var e = this._context.createBuffer(1, 128, this._context.sampleRate), i = e.getChannelData(0), s = 0; s < i.length; s++) i[s] = t;

      var n = this._context.createBufferSource();

      return n.channelCount = 1, n.channelCountMode = "explicit", n.buffer = e, n.loop = !0, n.start(0), this._constants[t] = n, n;
    }, s.default.Context.prototype._timeoutLoop = function () {
      for (var t = this.now(); this._timeouts && this._timeouts.length && this._timeouts.peek().time <= t;) this._timeouts.shift().callback();
    }, s.default.Context.prototype.setTimeout = function (t, e) {
      this._timeoutIds++;
      var i = this.now();
      return this._timeouts.add({
        callback: t,
        time: i + e,
        id: this._timeoutIds
      }), this._timeoutIds;
    }, s.default.Context.prototype.clearTimeout = function (t) {
      return this._timeouts.forEach(function (e) {
        e.id === t && this.remove(e);
      }), this;
    }, Object.defineProperty(s.default.Context.prototype, "updateInterval", {
      get: function () {
        return this._ticker.updateInterval;
      },
      set: function (t) {
        this._ticker.updateInterval = t;
      }
    }), Object.defineProperty(s.default.Context.prototype, "rawContext", {
      get: function () {
        return this._context;
      }
    }), Object.defineProperty(s.default.Context.prototype, "clockSource", {
      get: function () {
        return this._ticker.type;
      },
      set: function (t) {
        this._ticker.type = t;
      }
    }), Object.defineProperty(s.default.Context.prototype, "latencyHint", {
      get: function () {
        return this._latencyHint;
      },
      set: function (t) {
        var e = t;
        if (this._latencyHint = t, s.default.isString(t)) switch (t) {
          case "interactive":
            e = .1, this._context.latencyHint = t;
            break;

          case "playback":
            e = .8, this._context.latencyHint = t;
            break;

          case "balanced":
            e = .25, this._context.latencyHint = t;
            break;

          case "fastest":
            this._context.latencyHint = "interactive", e = .01;
        }
        this.lookAhead = e, this.updateInterval = e / 3;
      }
    }), s.default.Context.prototype.dispose = function () {
      return this.close().then(function () {
        for (var t in s.default.Emitter.prototype.dispose.call(this), this._ticker.dispose(), this._ticker = null, this._timeouts.dispose(), this._timeouts = null, this._constants) this._constants[t].disconnect();

        this._constants = null;
      }.bind(this));
    };

    var a = function (t, e, i) {
      this._type = e, this._updateInterval = i, this._callback = s.default.defaultArg(t, s.default.noOp), this._createClock();
    };

    if (a.Type = {
      Worker: "worker",
      Timeout: "timeout",
      Offline: "offline"
    }, a.prototype._createWorker = function () {
      s.default.global.URL = s.default.global.URL || s.default.global.webkitURL;
      var t = new Blob(["var timeoutTime = " + (1e3 * this._updateInterval).toFixed(1) + ";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),
          e = URL.createObjectURL(t),
          i = new Worker(e);
      i.onmessage = this._callback.bind(this), this._worker = i;
    }, a.prototype._createTimeout = function () {
      this._timeout = setTimeout(function () {
        this._createTimeout(), this._callback();
      }.bind(this), 1e3 * this._updateInterval);
    }, a.prototype._createClock = function () {
      if (this._type === a.Type.Worker) try {
        this._createWorker();
      } catch (t) {
        this._type = a.Type.Timeout, this._createClock();
      } else this._type === a.Type.Timeout && this._createTimeout();
    }, Object.defineProperty(a.prototype, "updateInterval", {
      get: function () {
        return this._updateInterval;
      },
      set: function (t) {
        this._updateInterval = Math.max(t, 128 / 44100), this._type === a.Type.Worker && this._worker.postMessage(Math.max(1e3 * t, 1));
      }
    }), Object.defineProperty(a.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        this._disposeClock(), this._type = t, this._createClock();
      }
    }), a.prototype._disposeClock = function () {
      this._timeout && (clearTimeout(this._timeout), this._timeout = null), this._worker && (this._worker.terminate(), this._worker.onmessage = null, this._worker = null);
    }, a.prototype.dispose = function () {
      this._disposeClock(), this._callback = null;
    }, s.default.supported && !s.default.initialized) {
      if (s.default.global.TONE_AUDIO_CONTEXT || (s.default.global.TONE_AUDIO_CONTEXT = new s.default.Context()), s.default.context = s.default.global.TONE_AUDIO_CONTEXT, !s.default.global.TONE_SILENCE_LOGGING) {
        var r = "v";
        "dev" === s.default.version && (r = "");
        var l = " * Tone.js " + r + s.default.version + " * ";
        console.log("%c" + l, "background: #000; color: #fff");
      }
    } else s.default.supported || s.default.global.TONE_SILENCE_LOGGING || console.warn("This browser does not support Tone.js");

    e.default = s.default.Context;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4), i(40);
    s.default.Instrument = function (t) {
      t = s.default.defaultArg(t, s.default.Instrument.defaults), s.default.AudioNode.call(this), this._volume = this.output = new s.default.Volume(t.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._scheduledEvents = [];
    }, s.default.extend(s.default.Instrument, s.default.AudioNode), s.default.Instrument.defaults = {
      volume: 0
    }, s.default.Instrument.prototype.triggerAttack = s.default.noOp, s.default.Instrument.prototype.triggerRelease = s.default.noOp, s.default.Instrument.prototype.sync = function () {
      return this._syncMethod("triggerAttack", 1), this._syncMethod("triggerRelease", 0), this;
    }, s.default.Instrument.prototype._syncMethod = function (t, e) {
      var i = this["_original_" + t] = this[t];

      this[t] = function () {
        var t = Array.prototype.slice.call(arguments),
            n = t[e],
            o = s.default.Transport.schedule(function (s) {
          t[e] = s, i.apply(this, t);
        }.bind(this), n);

        this._scheduledEvents.push(o);
      }.bind(this);
    }, s.default.Instrument.prototype.unsync = function () {
      return this._scheduledEvents.forEach(function (t) {
        s.default.Transport.clear(t);
      }), this._scheduledEvents = [], this._original_triggerAttack && (this.triggerAttack = this._original_triggerAttack, this.triggerRelease = this._original_triggerRelease), this;
    }, s.default.Instrument.prototype.triggerAttackRelease = function (t, e, i, s) {
      return i = this.toSeconds(i), e = this.toSeconds(e), this.triggerAttack(t, i, s), this.triggerRelease(i + e), this;
    }, s.default.Instrument.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable(["volume"]), this.volume = null, this.unsync(), this._scheduledEvents = null, this;
    }, e.default = s.default.Instrument;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7), i(2);
    s.default.AudioToGain = function () {
      s.default.SignalBase.call(this), this._norm = this.input = this.output = new s.default.WaveShaper(function (t) {
        return (t + 1) / 2;
      });
    }, s.default.extend(s.default.AudioToGain, s.default.SignalBase), s.default.AudioToGain.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this;
    }, e.default = s.default.AudioToGain;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(13), i(89), i(3), i(1);
    s.default.CrossFade = function (t) {
      s.default.AudioNode.call(this), this.createInsOuts(2, 1), this.a = this.input[0] = new s.default.Gain(), this.b = this.input[1] = new s.default.Gain(), this.fade = new s.default.Signal(s.default.defaultArg(t, .5), s.default.Type.NormalRange), this._equalPowerA = new s.default.EqualPowerGain(), this._equalPowerB = new s.default.EqualPowerGain(), this._one = this.context.getConstant(1), this._invert = new s.default.Subtract(), this.a.connect(this.output), this.b.connect(this.output), this.fade.chain(this._equalPowerB, this.b.gain), s.default.connect(this._one, this._invert, 0, 0), this.fade.connect(this._invert, 0, 1), this._invert.chain(this._equalPowerA, this.a.gain), this._readOnly("fade");
    }, s.default.extend(s.default.CrossFade, s.default.AudioNode), s.default.CrossFade.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable("fade"), this._equalPowerA.dispose(), this._equalPowerA = null, this._equalPowerB.dispose(), this._equalPowerB = null, this.fade.dispose(), this.fade = null, this._invert.dispose(), this._invert = null, this._one = null, this.a.dispose(), this.a = null, this.b.dispose(), this.b = null, this;
    }, e.default = s.default.CrossFade;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    s.default.Timeline = function () {
      var t = s.default.defaults(arguments, ["memory"], s.default.Timeline);
      s.default.call(this), this._timeline = [], this.memory = t.memory;
    }, s.default.extend(s.default.Timeline), s.default.Timeline.defaults = {
      memory: 1 / 0
    }, Object.defineProperty(s.default.Timeline.prototype, "length", {
      get: function () {
        return this._timeline.length;
      }
    }), s.default.Timeline.prototype.add = function (t) {
      if (s.default.isUndef(t.time)) throw new Error("Tone.Timeline: events must have a time attribute");
      t.time = t.time.valueOf();

      var e = this._search(t.time);

      if (this._timeline.splice(e + 1, 0, t), this.length > this.memory) {
        var i = this.length - this.memory;

        this._timeline.splice(0, i);
      }

      return this;
    }, s.default.Timeline.prototype.remove = function (t) {
      var e = this._timeline.indexOf(t);

      return -1 !== e && this._timeline.splice(e, 1), this;
    }, s.default.Timeline.prototype.get = function (t, e) {
      e = s.default.defaultArg(e, "time");

      var i = this._search(t, e);

      return -1 !== i ? this._timeline[i] : null;
    }, s.default.Timeline.prototype.peek = function () {
      return this._timeline[0];
    }, s.default.Timeline.prototype.shift = function () {
      return this._timeline.shift();
    }, s.default.Timeline.prototype.getAfter = function (t, e) {
      e = s.default.defaultArg(e, "time");

      var i = this._search(t, e);

      return i + 1 < this._timeline.length ? this._timeline[i + 1] : null;
    }, s.default.Timeline.prototype.getBefore = function (t, e) {
      e = s.default.defaultArg(e, "time");
      var i = this._timeline.length;
      if (i > 0 && this._timeline[i - 1][e] < t) return this._timeline[i - 1];

      var n = this._search(t, e);

      return n - 1 >= 0 ? this._timeline[n - 1] : null;
    }, s.default.Timeline.prototype.cancel = function (t) {
      if (this._timeline.length > 1) {
        var e = this._search(t);

        if (e >= 0) {
          if (this._timeline[e].time === t) {
            for (var i = e; i >= 0 && this._timeline[i].time === t; i--) e = i;

            this._timeline = this._timeline.slice(0, e);
          } else this._timeline = this._timeline.slice(0, e + 1);
        } else this._timeline = [];
      } else 1 === this._timeline.length && this._timeline[0].time >= t && (this._timeline = []);

      return this;
    }, s.default.Timeline.prototype.cancelBefore = function (t) {
      var e = this._search(t);

      return e >= 0 && (this._timeline = this._timeline.slice(e + 1)), this;
    }, s.default.Timeline.prototype.previousEvent = function (t) {
      var e = this._timeline.indexOf(t);

      return e > 0 ? this._timeline[e - 1] : null;
    }, s.default.Timeline.prototype._search = function (t, e) {
      if (0 === this._timeline.length) return -1;
      e = s.default.defaultArg(e, "time");
      var i = 0,
          n = this._timeline.length,
          o = n;
      if (n > 0 && this._timeline[n - 1][e] <= t) return n - 1;

      for (; i < o;) {
        var a = Math.floor(i + (o - i) / 2),
            r = this._timeline[a],
            l = this._timeline[a + 1];

        if (r[e] === t) {
          for (var u = a; u < this._timeline.length; u++) {
            this._timeline[u][e] === t && (a = u);
          }

          return a;
        }

        if (r[e] < t && l[e] > t) return a;
        r[e] > t ? o = a : i = a + 1;
      }

      return -1;
    }, s.default.Timeline.prototype._iterate = function (t, e, i) {
      e = s.default.defaultArg(e, 0), i = s.default.defaultArg(i, this._timeline.length - 1), this._timeline.slice(e, i + 1).forEach(function (e) {
        t.call(this, e);
      }.bind(this));
    }, s.default.Timeline.prototype.forEach = function (t) {
      return this._iterate(t), this;
    }, s.default.Timeline.prototype.forEachBefore = function (t, e) {
      var i = this._search(t);

      return -1 !== i && this._iterate(e, 0, i), this;
    }, s.default.Timeline.prototype.forEachAfter = function (t, e) {
      var i = this._search(t);

      return this._iterate(e, i + 1), this;
    }, s.default.Timeline.prototype.forEachBetween = function (t, e, i) {
      var s = this._search(t),
          n = this._search(e);

      return -1 !== s && -1 !== n ? (this._timeline[s].time !== t && (s += 1), this._timeline[n].time === e && (n -= 1), this._iterate(i, s, n)) : -1 === s && this._iterate(i, 0, n), this;
    }, s.default.Timeline.prototype.forEachFrom = function (t, e) {
      for (var i = this._search(t); i >= 0 && this._timeline[i].time >= t;) i--;

      return this._iterate(e, i + 1), this;
    }, s.default.Timeline.prototype.forEachAtTime = function (t, e) {
      var i = this._search(t);

      return -1 !== i && this._iterate(function (i) {
        i.time === t && e.call(this, i);
      }, 0, i), this;
    }, s.default.Timeline.prototype.dispose = function () {
      return s.default.prototype.dispose.call(this), this._timeline = null, this;
    }, e.default = s.default.Timeline;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(21), i(2);
    s.default.Monophonic = function (t) {
      t = s.default.defaultArg(t, s.default.Monophonic.defaults), s.default.Instrument.call(this, t), this.portamento = t.portamento;
    }, s.default.extend(s.default.Monophonic, s.default.Instrument), s.default.Monophonic.defaults = {
      portamento: 0
    }, s.default.Monophonic.prototype.triggerAttack = function (t, e, i) {
      return this.log("triggerAttack", t, e, i), e = this.toSeconds(e), this._triggerEnvelopeAttack(e, i), this.setNote(t, e), this;
    }, s.default.Monophonic.prototype.triggerRelease = function (t) {
      return this.log("triggerRelease", t), t = this.toSeconds(t), this._triggerEnvelopeRelease(t), this;
    }, s.default.Monophonic.prototype._triggerEnvelopeAttack = function () {}, s.default.Monophonic.prototype._triggerEnvelopeRelease = function () {}, s.default.Monophonic.prototype.getLevelAtTime = function (t) {
      return t = this.toSeconds(t), this.envelope.getValueAtTime(t);
    }, s.default.Monophonic.prototype.setNote = function (t, e) {
      if (e = this.toSeconds(e), this.portamento > 0 && this.getLevelAtTime(e) > .05) {
        var i = this.toSeconds(this.portamento);
        this.frequency.exponentialRampTo(t, i, e);
      } else this.frequency.setValueAtTime(t, e);

      return this;
    }, e.default = s.default.Monophonic;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(29), i(5), i(2);
    s.default.Scale = function (t, e) {
      s.default.SignalBase.call(this), this._outputMin = s.default.defaultArg(t, 0), this._outputMax = s.default.defaultArg(e, 1), this._scale = this.input = new s.default.Multiply(1), this._add = this.output = new s.default.Add(0), this._scale.connect(this._add), this._setRange();
    }, s.default.extend(s.default.Scale, s.default.SignalBase), Object.defineProperty(s.default.Scale.prototype, "min", {
      get: function () {
        return this._outputMin;
      },
      set: function (t) {
        this._outputMin = t, this._setRange();
      }
    }), Object.defineProperty(s.default.Scale.prototype, "max", {
      get: function () {
        return this._outputMax;
      },
      set: function (t) {
        this._outputMax = t, this._setRange();
      }
    }), s.default.Scale.prototype._setRange = function () {
      this._add.value = this._outputMin, this._scale.value = this._outputMax - this._outputMin;
    }, s.default.Scale.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._add.dispose(), this._add = null, this._scale.dispose(), this._scale = null, this;
    }, e.default = s.default.Scale;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(3), i(1);
    s.default.Volume = function () {
      var t = s.default.defaults(arguments, ["volume"], s.default.Volume);
      s.default.AudioNode.call(this, t), this.output = this.input = new s.default.Gain(t.volume, s.default.Type.Decibels), this._unmutedVolume = t.volume, this.volume = this.output.gain, this._readOnly("volume"), this.mute = t.mute;
    }, s.default.extend(s.default.Volume, s.default.AudioNode), s.default.Volume.defaults = {
      volume: 0,
      mute: !1
    }, Object.defineProperty(s.default.Volume.prototype, "mute", {
      get: function () {
        return this.volume.value === -1 / 0;
      },
      set: function (t) {
        !this.mute && t ? (this._unmutedVolume = this.volume.value, this.volume.value = -1 / 0) : this.mute && !t && (this.volume.value = this._unmutedVolume);
      }
    }), s.default.Volume.prototype.dispose = function () {
      return this.input.dispose(), s.default.AudioNode.prototype.dispose.call(this), this._writable("volume"), this.volume.dispose(), this.volume = null, this;
    }, e.default = s.default.Volume;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(3), i(30);
    s.default.Zero = function () {
      s.default.SignalBase.call(this), this._gain = this.input = this.output = new s.default.Gain(), s.default.connect(this.context.getConstant(0), this._gain);
    }, s.default.extend(s.default.Zero, s.default.SignalBase), s.default.Zero.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._gain.dispose(), this._gain = null, this;
    }, e.default = s.default.Zero;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(3);
    s.default.Add = function (t) {
      s.default.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.input[1] = this.output = new s.default.Gain(), this._param = this.input[1] = new s.default.Signal(t), this._param.connect(this._sum);
    }, s.default.extend(s.default.Add, s.default.Signal), s.default.Add.prototype.dispose = function () {
      return s.default.Signal.prototype.dispose.call(this), this._sum.dispose(), this._sum = null, this;
    }, e.default = s.default.Add;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(1);
    s.default.SignalBase = function () {
      s.default.AudioNode.call(this);
    }, s.default.extend(s.default.SignalBase, s.default.AudioNode), s.default.SignalBase.prototype.connect = function (t, e, i) {
      return s.default.Signal && s.default.Signal === t.constructor || s.default.Param && s.default.Param === t.constructor ? (t._param.cancelScheduledValues(0), t._param.setValueAtTime(0, 0), t.overridden = !0) : t instanceof AudioParam && (t.cancelScheduledValues(0), t.setValueAtTime(0, 0)), s.default.AudioNode.prototype.connect.call(this, t, e, i), this;
    }, e.default = s.default.SignalBase;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(47), i(3);
    s.default.AmplitudeEnvelope = function () {
      s.default.Envelope.apply(this, arguments), this.input = this.output = new s.default.Gain(), this._sig.connect(this.output.gain);
    }, s.default.extend(s.default.AmplitudeEnvelope, s.default.Envelope), s.default.AmplitudeEnvelope.prototype.dispose = function () {
      return s.default.Envelope.prototype.dispose.call(this), this;
    }, e.default = s.default.AmplitudeEnvelope;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(11), i(6), i(3), i(1);
    s.default.BufferSource = function () {
      var t = s.default.defaults(arguments, ["buffer", "onload"], s.default.BufferSource);
      s.default.AudioNode.call(this, t), this.onended = t.onended, this._startTime = -1, this._sourceStarted = !1, this._sourceStopped = !1, this._stopTime = -1, this._gainNode = this.output = new s.default.Gain(0), this._source = this.context.createBufferSource(), s.default.connect(this._source, this._gainNode), this._source.onended = this._onended.bind(this), this._buffer = new s.default.Buffer(t.buffer, t.onload), this.playbackRate = new s.default.Param({
        param: this._source.playbackRate,
        units: s.default.Type.Positive,
        value: t.playbackRate
      }), this.fadeIn = t.fadeIn, this.fadeOut = t.fadeOut, this.curve = t.curve, this._onendedTimeout = -1, this.loop = t.loop, this.loopStart = t.loopStart, this.loopEnd = t.loopEnd;
    }, s.default.extend(s.default.BufferSource, s.default.AudioNode), s.default.BufferSource.defaults = {
      onended: s.default.noOp,
      onload: s.default.noOp,
      loop: !1,
      loopStart: 0,
      loopEnd: 0,
      fadeIn: 0,
      fadeOut: 0,
      curve: "linear",
      playbackRate: 1
    }, Object.defineProperty(s.default.BufferSource.prototype, "state", {
      get: function () {
        return this.getStateAtTime(this.now());
      }
    }), s.default.BufferSource.prototype.getStateAtTime = function (t) {
      return t = this.toSeconds(t), -1 !== this._startTime && this._startTime <= t && (-1 === this._stopTime || t < this._stopTime) && !this._sourceStopped ? s.default.State.Started : s.default.State.Stopped;
    }, s.default.BufferSource.prototype.start = function (t, e, i, n) {
      this.log("start", t, e, i, n), this.assert(-1 === this._startTime, "can only be started once"), this.assert(this.buffer.loaded, "buffer is either not set or not loaded"), this.assert(!this._sourceStopped, "source is already stopped"), t = this.toSeconds(t), e = this.loop ? s.default.defaultArg(e, this.loopStart) : s.default.defaultArg(e, 0), e = this.toSeconds(e), e = Math.max(e, 0), n = s.default.defaultArg(n, 1);
      var o = this.toSeconds(this.fadeIn);

      if (o > 0 ? (this._gainNode.gain.setValueAtTime(0, t), "linear" === this.curve ? this._gainNode.gain.linearRampToValueAtTime(n, t + o) : this._gainNode.gain.exponentialApproachValueAtTime(n, t, o)) : this._gainNode.gain.setValueAtTime(n, t), this._startTime = t, s.default.isDefined(i)) {
        var a = this.toSeconds(i);
        a = Math.max(a, 0), this.stop(t + a);
      }

      if (this.loop) {
        var r = this.loopEnd || this.buffer.duration,
            l = this.loopStart;
        e >= r && (e = (e - l) % (r - l) + l);
      }

      return this._source.buffer = this.buffer.get(), this._source.loopEnd = this.loopEnd || this.buffer.duration, e < this.buffer.duration && (this._sourceStarted = !0, this._source.start(t, e)), this;
    }, s.default.BufferSource.prototype.stop = function (t) {
      this.log("stop", t), this.assert(this.buffer.loaded, "buffer is either not set or not loaded"), this.assert(!this._sourceStopped, "source is already stopped"), t = this.toSeconds(t), -1 !== this._stopTime && this.cancelStop();
      var e = this.toSeconds(this.fadeOut);
      return this._stopTime = t + e, e > 0 ? "linear" === this.curve ? this._gainNode.gain.linearRampTo(0, e, t) : this._gainNode.gain.targetRampTo(0, e, t) : (this._gainNode.gain.cancelAndHoldAtTime(t), this._gainNode.gain.setValueAtTime(0, t)), s.default.context.clearTimeout(this._onendedTimeout), this._onendedTimeout = s.default.context.setTimeout(this._onended.bind(this), this._stopTime - this.now()), this;
    }, s.default.BufferSource.prototype.cancelStop = function () {
      if (-1 !== this._startTime && !this._sourceStopped) {
        var t = this.toSeconds(this.fadeIn);
        this._gainNode.gain.cancelScheduledValues(this._startTime + t + this.sampleTime), this.context.clearTimeout(this._onendedTimeout), this._stopTime = -1;
      }

      return this;
    }, s.default.BufferSource.prototype._onended = function () {
      if (!this._sourceStopped) {
        this._sourceStopped = !0;
        var t = "exponential" === this.curve ? 2 * this.fadeOut : 0;
        this._sourceStarted && -1 !== this._stopTime && this._source.stop(this._stopTime + t), this.onended(this), setTimeout(function () {
          this._source && (this._source.disconnect(), this._gainNode.disconnect());
        }.bind(this), 1e3 * t + 100);
      }
    }, Object.defineProperty(s.default.BufferSource.prototype, "loopStart", {
      get: function () {
        return this._source.loopStart;
      },
      set: function (t) {
        this._source.loopStart = this.toSeconds(t);
      }
    }), Object.defineProperty(s.default.BufferSource.prototype, "loopEnd", {
      get: function () {
        return this._source.loopEnd;
      },
      set: function (t) {
        this._source.loopEnd = this.toSeconds(t);
      }
    }), Object.defineProperty(s.default.BufferSource.prototype, "buffer", {
      get: function () {
        return this._buffer;
      },
      set: function (t) {
        this._buffer.set(t);
      }
    }), Object.defineProperty(s.default.BufferSource.prototype, "loop", {
      get: function () {
        return this._source.loop;
      },
      set: function (t) {
        this._source.loop = t, this.cancelStop();
      }
    }), s.default.BufferSource.prototype.dispose = function () {
      return this._wasDisposed || (this._wasDisposed = !0, s.default.AudioNode.prototype.dispose.call(this), this.onended = null, this._source.onended = null, this._source.disconnect(), this._source = null, this._gainNode.dispose(), this._gainNode = null, this._buffer.dispose(), this._buffer = null, this._startTime = -1, this.playbackRate = null, s.default.context.clearTimeout(this._onendedTimeout)), this;
    }, e.default = s.default.BufferSource;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(2), i(5), i(3);
    s.default.FeedbackEffect = function () {
      var t = s.default.defaults(arguments, ["feedback"], s.default.FeedbackEffect);
      s.default.Effect.call(this, t), this._feedbackGain = new s.default.Gain(t.feedback, s.default.Type.NormalRange), this.feedback = this._feedbackGain.gain, this.effectReturn.chain(this._feedbackGain, this.effectSend), this._readOnly(["feedback"]);
    }, s.default.extend(s.default.FeedbackEffect, s.default.Effect), s.default.FeedbackEffect.defaults = {
      feedback: .125
    }, s.default.FeedbackEffect.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._writable(["feedback"]), this._feedbackGain.dispose(), this._feedbackGain = null, this.feedback = null, this;
    }, e.default = s.default.FeedbackEffect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(24), i(4);
    s.default.TimelineState = function (t) {
      s.default.Timeline.call(this), this._initial = t;
    }, s.default.extend(s.default.TimelineState, s.default.Timeline), s.default.TimelineState.prototype.getValueAtTime = function (t) {
      var e = this.get(t);
      return null !== e ? e.state : this._initial;
    }, s.default.TimelineState.prototype.setStateAtTime = function (t, e) {
      return this.add({
        state: t,
        time: e
      }), this;
    }, s.default.TimelineState.prototype.getLastState = function (t, e) {
      e = this.toSeconds(e);

      for (var i = this._search(e); i >= 0; i--) {
        var s = this._timeline[i];
        if (s.state === t) return s;
      }
    }, s.default.TimelineState.prototype.getNextState = function (t, e) {
      e = this.toSeconds(e);

      var i = this._search(e);

      if (-1 !== i) for (var s = i; s < this._timeline.length; s++) {
        var n = this._timeline[s];
        if (n.state === t) return n;
      }
    }, e.default = s.default.TimelineState;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    s.default.Emitter = function () {
      s.default.call(this), this._events = {};
    }, s.default.extend(s.default.Emitter), s.default.Emitter.prototype.on = function (t, e) {
      for (var i = t.split(/\W+/), s = 0; s < i.length; s++) {
        var n = i[s];
        this._events.hasOwnProperty(n) || (this._events[n] = []), this._events[n].push(e);
      }

      return this;
    }, s.default.Emitter.prototype.once = function (t, e) {
      var i = function () {
        e.apply(this, arguments), this.off(t, i);
      }.bind(this);

      return this.on(t, i), this;
    }, s.default.Emitter.prototype.off = function (t, e) {
      for (var i = t.split(/\W+/), n = 0; n < i.length; n++) if (t = i[n], this._events.hasOwnProperty(t)) if (s.default.isUndef(e)) this._events[t] = [];else for (var o = this._events[t], a = 0; a < o.length; a++) o[a] === e && o.splice(a, 1);

      return this;
    }, s.default.Emitter.prototype.emit = function (t) {
      if (this._events) {
        var e = Array.apply(null, arguments).slice(1);
        if (this._events.hasOwnProperty(t)) for (var i = this._events[t].slice(0), s = 0, n = i.length; s < n; s++) i[s].apply(this, e);
      }

      return this;
    }, s.default.Emitter.mixin = function (t) {
      var e = ["on", "once", "off", "emit"];
      t._events = {};

      for (var i = 0; i < e.length; i++) {
        var n = e[i],
            o = s.default.Emitter.prototype[n];
        t[n] = o;
      }

      return s.default.Emitter;
    }, s.default.Emitter.prototype.dispose = function () {
      return s.default.prototype.dispose.call(this), this._events = null, this;
    }, e.default = s.default.Emitter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(1), i(44);
    s.default.supported && (AnalyserNode.prototype.getFloatTimeDomainData || (AnalyserNode.prototype.getFloatTimeDomainData = function (t) {
      var e = new Uint8Array(t.length);
      this.getByteTimeDomainData(e);

      for (var i = 0; i < e.length; i++) t[i] = (e[i] - 128) / 128;
    })), s.default.Analyser = function () {
      var t = s.default.defaults(arguments, ["type", "size"], s.default.Analyser);
      s.default.AudioNode.call(this), this._analyser = this.input = this.output = this.context.createAnalyser(), this._type = t.type, this._buffer = null, this.size = t.size, this.type = t.type;
    }, s.default.extend(s.default.Analyser, s.default.AudioNode), s.default.Analyser.defaults = {
      size: 1024,
      type: "fft",
      smoothing: .8
    }, s.default.Analyser.Type = {
      Waveform: "waveform",
      FFT: "fft"
    }, s.default.Analyser.prototype.getValue = function () {
      return this._type === s.default.Analyser.Type.FFT ? this._analyser.getFloatFrequencyData(this._buffer) : this._type === s.default.Analyser.Type.Waveform && this._analyser.getFloatTimeDomainData(this._buffer), this._buffer;
    }, Object.defineProperty(s.default.Analyser.prototype, "size", {
      get: function () {
        return this._analyser.frequencyBinCount;
      },
      set: function (t) {
        this._analyser.fftSize = 2 * t, this._buffer = new Float32Array(t);
      }
    }), Object.defineProperty(s.default.Analyser.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        if (t !== s.default.Analyser.Type.Waveform && t !== s.default.Analyser.Type.FFT) throw new TypeError("Tone.Analyser: invalid type: " + t);
        this._type = t;
      }
    }), Object.defineProperty(s.default.Analyser.prototype, "smoothing", {
      get: function () {
        return this._analyser.smoothingTimeConstant;
      },
      set: function (t) {
        this._analyser.smoothingTimeConstant = t;
      }
    }), s.default.Analyser.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this._analyser.disconnect(), this._analyser = null, this._buffer = null;
    };
    e.default = s.default.Analyser;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(17), i(50), i(69), i(49), i(68), i(67);
    s.default.OmniOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "type"], s.default.OmniOscillator);
      s.default.Source.call(this, t), this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this._sourceType = void 0, this._oscillator = null, this.type = t.type, this._readOnly(["frequency", "detune"]), this.set(t);
    }, s.default.extend(s.default.OmniOscillator, s.default.Source), s.default.OmniOscillator.defaults = {
      frequency: 440,
      detune: 0,
      type: "sine",
      phase: 0
    };
    var n = "PulseOscillator",
        o = "PWMOscillator",
        a = "Oscillator",
        r = "FMOscillator",
        l = "AMOscillator",
        u = "FatOscillator";
    s.default.OmniOscillator.prototype._start = function (t) {
      this._oscillator.start(t);
    }, s.default.OmniOscillator.prototype._stop = function (t) {
      this._oscillator.stop(t);
    }, s.default.OmniOscillator.prototype.restart = function (t) {
      this._oscillator.restart(t);
    }, Object.defineProperty(s.default.OmniOscillator.prototype, "type", {
      get: function () {
        var t = "";
        return this._sourceType === r ? t = "fm" : this._sourceType === l ? t = "am" : this._sourceType === u && (t = "fat"), t + this._oscillator.type;
      },
      set: function (t) {
        "fm" === t.substr(0, 2) ? (this._createNewOscillator(r), this._oscillator.type = t.substr(2)) : "am" === t.substr(0, 2) ? (this._createNewOscillator(l), this._oscillator.type = t.substr(2)) : "fat" === t.substr(0, 3) ? (this._createNewOscillator(u), this._oscillator.type = t.substr(3)) : "pwm" === t ? this._createNewOscillator(o) : "pulse" === t ? this._createNewOscillator(n) : (this._createNewOscillator(a), this._oscillator.type = t);
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "partials", {
      get: function () {
        return this._oscillator.partials;
      },
      set: function (t) {
        this._oscillator.partials = t;
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "partialCount", {
      get: function () {
        return this._oscillator.partialCount;
      },
      set: function (t) {
        this._oscillator.partialCount = t;
      }
    }), s.default.OmniOscillator.prototype.set = function (t, e) {
      return "type" === t ? this.type = e : s.default.isObject(t) && t.hasOwnProperty("type") && (this.type = t.type), s.default.prototype.set.apply(this, arguments), this;
    }, s.default.OmniOscillator.prototype.get = function (t) {
      var e = this._oscillator.get(t);

      return e.type = this.type, e;
    }, s.default.OmniOscillator.prototype._createNewOscillator = function (t) {
      if (t !== this._sourceType) {
        this._sourceType = t;
        var e = s.default[t],
            i = this.now();

        if (null !== this._oscillator) {
          var n = this._oscillator;
          n.stop(i), this.context.setTimeout(function () {
            n.dispose(), n = null;
          }, this.blockTime);
        }

        this._oscillator = new e(), this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), this._oscillator.connect(this.output), this.state === s.default.State.Started && this._oscillator.start(i);
      }
    }, Object.defineProperty(s.default.OmniOscillator.prototype, "phase", {
      get: function () {
        return this._oscillator.phase;
      },
      set: function (t) {
        this._oscillator.phase = t;
      }
    });
    var d = {
      PulseOscillator: "pulse",
      PWMOscillator: "pwm",
      Oscillator: "oscillator",
      FMOscillator: "fm",
      AMOscillator: "am",
      FatOscillator: "fat"
    };
    Object.defineProperty(s.default.OmniOscillator.prototype, "sourceType", {
      get: function () {
        return d[this._sourceType];
      },
      set: function (t) {
        var e = "sine";
        "pwm" !== this._oscillator.type && "pulse" !== this._oscillator.type && (e = this._oscillator.type), t === d.FMOscillator ? this.type = "fm" + e : t === d.AMOscillator ? this.type = "am" + e : t === d.FatOscillator ? this.type = "fat" + e : t === d.Oscillator ? this.type = e : t === d.PulseOscillator ? this.type = "pulse" : t === d.PWMOscillator && (this.type = "pwm");
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "baseType", {
      get: function () {
        return this._oscillator.baseType;
      },
      set: function (t) {
        this.sourceType !== d.PulseOscillator && this.sourceType !== d.PWMOscillator && (this._oscillator.baseType = t);
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "width", {
      get: function () {
        return this._sourceType === n ? this._oscillator.width : void 0;
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "count", {
      get: function () {
        return this._sourceType === u ? this._oscillator.count : void 0;
      },
      set: function (t) {
        this._sourceType === u && (this._oscillator.count = t);
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "spread", {
      get: function () {
        return this._sourceType === u ? this._oscillator.spread : void 0;
      },
      set: function (t) {
        this._sourceType === u && (this._oscillator.spread = t);
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "modulationType", {
      get: function () {
        return this._sourceType === r || this._sourceType === l ? this._oscillator.modulationType : void 0;
      },
      set: function (t) {
        this._sourceType !== r && this._sourceType !== l || (this._oscillator.modulationType = t);
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "modulationIndex", {
      get: function () {
        return this._sourceType === r ? this._oscillator.modulationIndex : void 0;
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "harmonicity", {
      get: function () {
        return this._sourceType === r || this._sourceType === l ? this._oscillator.harmonicity : void 0;
      }
    }), Object.defineProperty(s.default.OmniOscillator.prototype, "modulationFrequency", {
      get: function () {
        return this._sourceType === o ? this._oscillator.modulationFrequency : void 0;
      }
    }), s.default.OmniOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.detune.dispose(), this.detune = null, this.frequency.dispose(), this.frequency = null, this._oscillator.dispose(), this._oscillator = null, this._sourceType = null, this;
    }, e.default = s.default.OmniOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(31), i(37), i(25);
    s.default.Synth = function (t) {
      t = s.default.defaultArg(t, s.default.Synth.defaults), s.default.Monophonic.call(this, t), this.oscillator = new s.default.OmniOscillator(t.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.envelope = new s.default.AmplitudeEnvelope(t.envelope), this.oscillator.chain(this.envelope, this.output), this._readOnly(["oscillator", "frequency", "detune", "envelope"]);
    }, s.default.extend(s.default.Synth, s.default.Monophonic), s.default.Synth.defaults = {
      oscillator: {
        type: "triangle"
      },
      envelope: {
        attack: .005,
        decay: .1,
        sustain: .3,
        release: 1
      }
    }, s.default.Synth.prototype._triggerEnvelopeAttack = function (t, e) {
      return this.envelope.triggerAttack(t, e), this.oscillator.start(t), 0 === this.envelope.sustain && this.oscillator.stop(t + this.toSeconds(this.envelope.attack) + this.toSeconds(this.envelope.decay)), this;
    }, s.default.Synth.prototype._triggerEnvelopeRelease = function (t) {
      return t = this.toSeconds(t), this.envelope.triggerRelease(t), this.oscillator.stop(t + this.toSeconds(this.envelope.release)), this;
    }, s.default.Synth.prototype.dispose = function () {
      return s.default.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.frequency = null, this.detune = null, this;
    }, e.default = s.default.Synth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(11), i(32);
    s.default.Noise = function () {
      var t = s.default.defaults(arguments, ["type"], s.default.Noise);
      s.default.Source.call(this, t), this._source = null, this._type = t.type, this._playbackRate = t.playbackRate;
    }, s.default.extend(s.default.Noise, s.default.Source), s.default.Noise.defaults = {
      type: "white",
      playbackRate: 1
    }, Object.defineProperty(s.default.Noise.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        if (this._type !== t) {
          if (!(t in n)) throw new TypeError("Tone.Noise: invalid type: " + t);

          if (this._type = t, this.state === s.default.State.Started) {
            var e = this.now();
            this._stop(e), this._start(e);
          }
        }
      }
    }), Object.defineProperty(s.default.Noise.prototype, "playbackRate", {
      get: function () {
        return this._playbackRate;
      },
      set: function (t) {
        this._playbackRate = t, this._source && (this._source.playbackRate.value = t);
      }
    }), s.default.Noise.prototype._start = function (t) {
      var e = n[this._type];
      this._source = new s.default.BufferSource(e).connect(this.output), this._source.loop = !0, this._source.playbackRate.value = this._playbackRate, this._source.start(this.toSeconds(t), Math.random() * (e.duration - .001));
    }, s.default.Noise.prototype._stop = function (t) {
      this._source && (this._source.stop(this.toSeconds(t)), this._source = null);
    }, s.default.Noise.prototype.restart = function (t) {
      return this._stop(t), this._start(t), this;
    }, s.default.Noise.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), null !== this._source && (this._source.disconnect(), this._source = null), this._buffer = null, this;
    };
    var n = {},
        o = {};
    Object.defineProperty(n, "pink", {
      get: function () {
        if (!o.pink) {
          for (var t = [], e = 0; e < 2; e++) {
            var i,
                n,
                a,
                r,
                l,
                u,
                d,
                f = new Float32Array(220500);
            t[e] = f, i = n = a = r = l = u = d = 0;

            for (var h = 0; h < 220500; h++) {
              var c = 2 * Math.random() - 1;
              i = .99886 * i + .0555179 * c, n = .99332 * n + .0750759 * c, a = .969 * a + .153852 * c, r = .8665 * r + .3104856 * c, l = .55 * l + .5329522 * c, u = -.7616 * u - .016898 * c, f[h] = i + n + a + r + l + u + d + .5362 * c, f[h] *= .11, d = .115926 * c;
            }
          }

          o.pink = new s.default.Buffer().fromArray(t);
        }

        return o.pink;
      }
    }), Object.defineProperty(n, "brown", {
      get: function () {
        if (!o.brown) {
          for (var t = [], e = 0; e < 2; e++) {
            var i = new Float32Array(220500);
            t[e] = i;

            for (var n = 0, a = 0; a < 220500; a++) {
              var r = 2 * Math.random() - 1;
              i[a] = (n + .02 * r) / 1.02, n = i[a], i[a] *= 3.5;
            }
          }

          o.brown = new s.default.Buffer().fromArray(t);
        }

        return o.brown;
      }
    }), Object.defineProperty(n, "white", {
      get: function () {
        if (!o.white) {
          for (var t = [], e = 0; e < 2; e++) {
            var i = new Float32Array(220500);
            t[e] = i;

            for (var n = 0; n < 220500; n++) i[n] = 2 * Math.random() - 1;
          }

          o.white = new s.default.Buffer().fromArray(t);
        }

        return o.white;
      }
    }), e.default = s.default.Noise;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(27), i(20), i(1);
    s.default.Master = function () {
      s.default.AudioNode.call(this), s.default.getContext(function () {
        this.createInsOuts(1, 0), this._volume = this.output = new s.default.Volume(), this.volume = this._volume.volume, this._readOnly("volume"), s.default.connectSeries(this.input, this.output, this.context.destination), this.context.master = this;
      }.bind(this));
    }, s.default.extend(s.default.Master, s.default.AudioNode), s.default.Master.defaults = {
      volume: 0,
      mute: !1
    }, s.default.Master.prototype.isMaster = !0, Object.defineProperty(s.default.Master.prototype, "mute", {
      get: function () {
        return this._volume.mute;
      },
      set: function (t) {
        this._volume.mute = t;
      }
    }), s.default.Master.prototype.chain = function () {
      this.input.disconnect();
      var t = Array.from(arguments);
      t.unshift(this.input), t.push(this.output), s.default.connectSeries.apply(void 0, t);
    }, s.default.Master.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null;
    }, s.default.AudioNode.prototype.toMaster = function () {
      return this.connect(this.context.master), this;
    };
    var n = s.default.Master;
    s.default.Master = new n(), s.default.Context.on("init", function (t) {
      t.master && t.master.isMaster ? s.default.Master = t.master : s.default.Master = new n();
    }), s.default.Context.on("close", function (t) {
      t.master && t.master.isMaster && t.master.dispose();
    }), e.default = s.default.Master;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(86), i(47);
    s.default.FrequencyEnvelope = function () {
      var t = s.default.defaults(arguments, ["attack", "decay", "sustain", "release"], s.default.Envelope);
      t = s.default.defaultArg(t, s.default.FrequencyEnvelope.defaults), s.default.ScaledEnvelope.call(this, t), this._octaves = t.octaves, this.baseFrequency = t.baseFrequency, this.octaves = t.octaves, this.exponent = t.exponent;
    }, s.default.extend(s.default.FrequencyEnvelope, s.default.Envelope), s.default.FrequencyEnvelope.defaults = {
      baseFrequency: 200,
      octaves: 4,
      exponent: 1
    }, Object.defineProperty(s.default.FrequencyEnvelope.prototype, "baseFrequency", {
      get: function () {
        return this._scale.min;
      },
      set: function (t) {
        this._scale.min = this.toFrequency(t), this.octaves = this._octaves;
      }
    }), Object.defineProperty(s.default.FrequencyEnvelope.prototype, "octaves", {
      get: function () {
        return this._octaves;
      },
      set: function (t) {
        this._octaves = t, this._scale.max = this.baseFrequency * Math.pow(2, t);
      }
    }), Object.defineProperty(s.default.FrequencyEnvelope.prototype, "exponent", {
      get: function () {
        return this._exp.value;
      },
      set: function (t) {
        this._exp.value = t;
      }
    }), s.default.FrequencyEnvelope.prototype.dispose = function () {
      return s.default.ScaledEnvelope.prototype.dispose.call(this), this;
    }, e.default = s.default.FrequencyEnvelope;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(26), i(61);
    s.default.ScaleExp = function (t, e, i) {
      s.default.SignalBase.call(this), this._scale = this.output = new s.default.Scale(t, e), this._exp = this.input = new s.default.Pow(s.default.defaultArg(i, 2)), this._exp.connect(this._scale);
    }, s.default.extend(s.default.ScaleExp, s.default.SignalBase), Object.defineProperty(s.default.ScaleExp.prototype, "exponent", {
      get: function () {
        return this._exp.value;
      },
      set: function (t) {
        this._exp.value = t;
      }
    }), Object.defineProperty(s.default.ScaleExp.prototype, "min", {
      get: function () {
        return this._scale.min;
      },
      set: function (t) {
        this._scale.min = t;
      }
    }), Object.defineProperty(s.default.ScaleExp.prototype, "max", {
      get: function () {
        return this._scale.max;
      },
      set: function (t) {
        this._scale.max = t;
      }
    }), s.default.ScaleExp.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this;
    }, e.default = s.default.ScaleExp;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(14), i(1);
    s.default.Compressor = function () {
      var t = s.default.defaults(arguments, ["threshold", "ratio"], s.default.Compressor);
      s.default.AudioNode.call(this), this._compressor = this.input = this.output = this.context.createDynamicsCompressor(), this.threshold = new s.default.Param({
        param: this._compressor.threshold,
        units: s.default.Type.Decibels,
        convert: !1
      }), this.attack = new s.default.Param(this._compressor.attack, s.default.Type.Time), this.release = new s.default.Param(this._compressor.release, s.default.Type.Time), this.knee = new s.default.Param({
        param: this._compressor.knee,
        units: s.default.Type.Decibels,
        convert: !1
      }), this.ratio = new s.default.Param({
        param: this._compressor.ratio,
        convert: !1
      }), this._readOnly(["knee", "release", "attack", "ratio", "threshold"]), this.set(t);
    }, s.default.extend(s.default.Compressor, s.default.AudioNode), s.default.Compressor.defaults = {
      ratio: 12,
      threshold: -24,
      release: .25,
      attack: .003,
      knee: 30
    }, s.default.Compressor.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["knee", "release", "attack", "ratio", "threshold"]), this._compressor.disconnect(), this._compressor = null, this.attack.dispose(), this.attack = null, this.release.dispose(), this.release = null, this.threshold.dispose(), this.threshold = null, this.ratio.dispose(), this.ratio = null, this.knee.dispose(), this.knee = null, this;
    }, e.default = s.default.Compressor;
  }, function (t, e, i) {
    "use strict";

    var s = i(0);
    i(92);

    if (s.default.supported) {
      !s.default.global.hasOwnProperty("AudioContext") && s.default.global.hasOwnProperty("webkitAudioContext") && (s.default.global.AudioContext = s.default.global.webkitAudioContext), AudioContext.prototype.close || (AudioContext.prototype.close = function () {
        return s.default.isFunction(this.suspend) && this.suspend(), Promise.resolve();
      }), AudioContext.prototype.resume || (AudioContext.prototype.resume = function () {
        var t = this.createBuffer(1, 1, this.sampleRate),
            e = this.createBufferSource();
        return e.buffer = t, e.connect(this.destination), e.start(0), Promise.resolve();
      }), !AudioContext.prototype.createGain && AudioContext.prototype.createGainNode && (AudioContext.prototype.createGain = AudioContext.prototype.createGainNode), !AudioContext.prototype.createDelay && AudioContext.prototype.createDelayNode && (AudioContext.prototype.createDelay = AudioContext.prototype.createDelayNode);
      var n = !1,
          o = new OfflineAudioContext(1, 1, 44100),
          a = new Uint32Array([1179011410, 48, 1163280727, 544501094, 16, 131073, 44100, 176400, 1048580, 1635017060, 8, 0, 0, 0, 0]).buffer;

      try {
        var r = o.decodeAudioData(a);
        r && s.default.isFunction(r.then) && (n = !0);
      } catch (t) {
        n = !1;
      }

      n || (AudioContext.prototype._native_decodeAudioData = AudioContext.prototype.decodeAudioData, AudioContext.prototype.decodeAudioData = function (t) {
        return new Promise(function (e, i) {
          this._native_decodeAudioData(t, e, i);
        }.bind(this));
      });
    }
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(63);
    s.default.TransportTime = function (t, e) {
      if (!(this instanceof s.default.TransportTime)) return new s.default.TransportTime(t, e);
      s.default.Time.call(this, t, e);
    }, s.default.extend(s.default.TransportTime, s.default.Time), s.default.TransportTime.prototype._now = function () {
      return s.default.Transport.seconds;
    }, e.default = s.default.TransportTime;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(62);
    s.default.Frequency = function (t, e) {
      if (!(this instanceof s.default.Frequency)) return new s.default.Frequency(t, e);
      s.default.TimeBase.call(this, t, e);
    }, s.default.extend(s.default.Frequency, s.default.TimeBase), s.default.Frequency.prototype._expressions = Object.assign({}, s.default.TimeBase.prototype._expressions, {
      midi: {
        regexp: /^(\d+(?:\.\d+)?midi)/,
        method: function (t) {
          return "midi" === this._defaultUnits ? t : s.default.Frequency.mtof(t);
        }
      },
      note: {
        regexp: /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,
        method: function (t, e) {
          var i = n[t.toLowerCase()] + 12 * (parseInt(e) + 1);
          return "midi" === this._defaultUnits ? i : s.default.Frequency.mtof(i);
        }
      },
      tr: {
        regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,
        method: function (t, e, i) {
          var s = 1;
          return t && "0" !== t && (s *= this._beatsToUnits(this._getTimeSignature() * parseFloat(t))), e && "0" !== e && (s *= this._beatsToUnits(parseFloat(e))), i && "0" !== i && (s *= this._beatsToUnits(parseFloat(i) / 4)), s;
        }
      }
    }), s.default.Frequency.prototype.transpose = function (t) {
      return new this.constructor(this.valueOf() * s.default.intervalToFrequencyRatio(t));
    }, s.default.Frequency.prototype.harmonize = function (t) {
      return t.map(function (t) {
        return this.transpose(t);
      }.bind(this));
    }, s.default.Frequency.prototype.toMidi = function () {
      return s.default.Frequency.ftom(this.valueOf());
    }, s.default.Frequency.prototype.toNote = function () {
      var t = this.toFrequency(),
          e = Math.log2(t / s.default.Frequency.A4),
          i = Math.round(12 * e) + 57,
          n = Math.floor(i / 12);
      return n < 0 && (i += -12 * n), o[i % 12] + n.toString();
    }, s.default.Frequency.prototype.toSeconds = function () {
      return 1 / s.default.TimeBase.prototype.toSeconds.call(this);
    }, s.default.Frequency.prototype.toFrequency = function () {
      return s.default.TimeBase.prototype.toFrequency.call(this);
    }, s.default.Frequency.prototype.toTicks = function () {
      var t = this._beatsToUnits(1),
          e = this.valueOf() / t;

      return Math.floor(e * s.default.Transport.PPQ);
    }, s.default.Frequency.prototype._noArg = function () {
      return 0;
    }, s.default.Frequency.prototype._frequencyToUnits = function (t) {
      return t;
    }, s.default.Frequency.prototype._ticksToUnits = function (t) {
      return 1 / (60 * t / (s.default.Transport.bpm.value * s.default.Transport.PPQ));
    }, s.default.Frequency.prototype._beatsToUnits = function (t) {
      return 1 / s.default.TimeBase.prototype._beatsToUnits.call(this, t);
    }, s.default.Frequency.prototype._secondsToUnits = function (t) {
      return 1 / t;
    }, s.default.Frequency.prototype._defaultUnits = "hz";
    var n = {
      cbb: -2,
      cb: -1,
      c: 0,
      "c#": 1,
      cx: 2,
      dbb: 0,
      db: 1,
      d: 2,
      "d#": 3,
      dx: 4,
      ebb: 2,
      eb: 3,
      e: 4,
      "e#": 5,
      ex: 6,
      fbb: 3,
      fb: 4,
      f: 5,
      "f#": 6,
      fx: 7,
      gbb: 5,
      gb: 6,
      g: 7,
      "g#": 8,
      gx: 9,
      abb: 7,
      ab: 8,
      a: 9,
      "a#": 10,
      ax: 11,
      bbb: 9,
      bb: 10,
      b: 11,
      "b#": 12,
      bx: 13
    },
        o = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    s.default.Frequency.A4 = 440, s.default.Frequency.mtof = function (t) {
      return s.default.Frequency.A4 * Math.pow(2, (t - 69) / 12);
    }, s.default.Frequency.ftom = function (t) {
      return 69 + Math.round(12 * Math.log2(t / s.default.Frequency.A4));
    }, e.default = s.default.Frequency;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(61), i(4), i(1);
    s.default.Envelope = function () {
      var t = s.default.defaults(arguments, ["attack", "decay", "sustain", "release"], s.default.Envelope);
      s.default.AudioNode.call(this), this.attack = t.attack, this.decay = t.decay, this.sustain = t.sustain, this.release = t.release, this._attackCurve = "linear", this._releaseCurve = "exponential", this._sig = this.output = new s.default.Signal(0), this.attackCurve = t.attackCurve, this.releaseCurve = t.releaseCurve, this.decayCurve = t.decayCurve;
    }, s.default.extend(s.default.Envelope, s.default.AudioNode), s.default.Envelope.defaults = {
      attack: .01,
      decay: .1,
      sustain: .5,
      release: 1,
      attackCurve: "linear",
      decayCurve: "exponential",
      releaseCurve: "exponential"
    }, Object.defineProperty(s.default.Envelope.prototype, "value", {
      get: function () {
        return this.getValueAtTime(this.now());
      }
    }), s.default.Envelope.prototype._getCurve = function (t, e) {
      if (s.default.isString(t)) return t;
      if (s.default.isArray(t)) for (var i in s.default.Envelope.Type) if (s.default.Envelope.Type[i][e] === t) return i;
    }, s.default.Envelope.prototype._setCurve = function (t, e, i) {
      if (s.default.Envelope.Type.hasOwnProperty(i)) {
        var n = s.default.Envelope.Type[i];
        s.default.isObject(n) ? this[t] = n[e] : this[t] = n;
      } else {
        if (!s.default.isArray(i)) throw new Error("Tone.Envelope: invalid curve: " + i);
        this[t] = i;
      }
    }, Object.defineProperty(s.default.Envelope.prototype, "attackCurve", {
      get: function () {
        return this._getCurve(this._attackCurve, "In");
      },
      set: function (t) {
        this._setCurve("_attackCurve", "In", t);
      }
    }), Object.defineProperty(s.default.Envelope.prototype, "releaseCurve", {
      get: function () {
        return this._getCurve(this._releaseCurve, "Out");
      },
      set: function (t) {
        this._setCurve("_releaseCurve", "Out", t);
      }
    }), Object.defineProperty(s.default.Envelope.prototype, "decayCurve", {
      get: function () {
        return this._decayCurve;
      },
      set: function (t) {
        if (!["linear", "exponential"].includes(t)) throw new Error("Tone.Envelope: invalid curve: " + t);
        this._decayCurve = t;
      }
    }), s.default.Envelope.prototype.triggerAttack = function (t, e) {
      this.log("triggerAttack", t, e), t = this.toSeconds(t);
      var i = this.toSeconds(this.attack),
          n = this.toSeconds(this.decay);
      e = s.default.defaultArg(e, 1);
      var o = this.getValueAtTime(t);
      o > 0 && (i = (1 - o) / (1 / i));
      if (0 === i) this._sig.setValueAtTime(e, t);else if ("linear" === this._attackCurve) this._sig.linearRampTo(e, i, t);else if ("exponential" === this._attackCurve) this._sig.targetRampTo(e, i, t);else if (i > 0) {
        this._sig.cancelAndHoldAtTime(t);

        for (var a = this._attackCurve, r = 1; r < a.length; r++) if (a[r - 1] <= o && o <= a[r]) {
          (a = this._attackCurve.slice(r))[0] = o;
          break;
        }

        this._sig.setValueCurveAtTime(a, t, i, e);
      }

      if (n) {
        var l = e * this.sustain,
            u = t + i;
        this.log("decay", u), "linear" === this._decayCurve ? this._sig.linearRampTo(l, n, u + this.sampleTime) : "exponential" === this._decayCurve && this._sig.exponentialApproachValueAtTime(l, u, n);
      }

      return this;
    }, s.default.Envelope.prototype.triggerRelease = function (t) {
      this.log("triggerRelease", t), t = this.toSeconds(t);
      var e = this.getValueAtTime(t);

      if (e > 0) {
        var i = this.toSeconds(this.release);
        if ("linear" === this._releaseCurve) this._sig.linearRampTo(0, i, t);else if ("exponential" === this._releaseCurve) this._sig.targetRampTo(0, i, t);else {
          var n = this._releaseCurve;
          s.default.isArray(n) && (this._sig.cancelAndHoldAtTime(t), this._sig.setValueCurveAtTime(n, t, i, e));
        }
      }

      return this;
    }, s.default.Envelope.prototype.getValueAtTime = function (t) {
      return this._sig.getValueAtTime(t);
    }, s.default.Envelope.prototype.triggerAttackRelease = function (t, e, i) {
      return e = this.toSeconds(e), this.triggerAttack(e, i), this.triggerRelease(e + this.toSeconds(t)), this;
    }, s.default.Envelope.prototype.cancel = function (t) {
      return this._sig.cancelScheduledValues(t), this;
    }, s.default.Envelope.prototype.connect = s.default.SignalBase.prototype.connect, function () {
      var t,
          e,
          i = [];

      for (t = 0; t < 128; t++) i[t] = Math.sin(t / 127 * (Math.PI / 2));

      var n = [];

      for (t = 0; t < 127; t++) {
        e = t / 127;
        var o = Math.sin(e * (2 * Math.PI) * 6.4 - Math.PI / 2) + 1;
        n[t] = o / 10 + .83 * e;
      }

      n[127] = 1;
      var a = [];

      for (t = 0; t < 128; t++) a[t] = Math.ceil(t / 127 * 5) / 5;

      var r = [];

      for (t = 0; t < 128; t++) e = t / 127, r[t] = .5 * (1 - Math.cos(Math.PI * e));

      var l,
          u = [];

      for (t = 0; t < 128; t++) {
        e = t / 127;
        var d = 4 * Math.pow(e, 3) + .2,
            f = Math.cos(d * Math.PI * 2 * e);
        u[t] = Math.abs(f * (1 - e));
      }

      function h(t) {
        for (var e = new Array(t.length), i = 0; i < t.length; i++) e[i] = 1 - t[i];

        return e;
      }

      s.default.Envelope.Type = {
        linear: "linear",
        exponential: "exponential",
        bounce: {
          In: h(u),
          Out: u
        },
        cosine: {
          In: i,
          Out: (l = i, l.slice(0).reverse())
        },
        step: {
          In: a,
          Out: h(a)
        },
        ripple: {
          In: n,
          Out: h(n)
        },
        sine: {
          In: r,
          Out: h(r)
        }
      };
    }(), s.default.Envelope.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._sig.dispose(), this._sig = null, this._attackCurve = null, this._releaseCurve = null, this;
    }, e.default = s.default.Envelope;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(23), i(10), i(19), i(7), i(28), i(3), i(2), i(20);

    if (s.default.supported && !s.default.global.AudioContext.prototype.createStereoPanner) {
      var n = function (t) {
        this.context = t, this.pan = new s.default.Signal(0, s.default.Type.AudioRange);
        var e = new s.default.WaveShaper(function (t) {
          return s.default.equalPowerScale((t + 1) / 2);
        }, 4096),
            i = new s.default.WaveShaper(function (t) {
          return s.default.equalPowerScale(1 - (t + 1) / 2);
        }, 4096),
            n = new s.default.Gain(),
            o = new s.default.Gain(),
            a = this.input = new s.default.Split();
        a._splitter.channelCountMode = "explicit", new s.default.Zero().fan(e, i);
        var r = this.output = new s.default.Merge();
        a.left.chain(n, r.left), a.right.chain(o, r.right), this.pan.chain(i, n.gain), this.pan.chain(e, o.gain);
      };

      n.prototype.disconnect = function () {
        this.output.disconnect.apply(this.output, arguments);
      }, n.prototype.connect = function () {
        this.output.connect.apply(this.output, arguments);
      }, AudioContext.prototype.createStereoPanner = function () {
        return new n(this);
      }, s.default.Context.prototype.createStereoPanner = function () {
        return new n(this);
      };
    }

    i(22), i(1);
    s.default.Panner = function () {
      var t = s.default.defaults(arguments, ["pan"], s.default.Panner);
      s.default.AudioNode.call(this), this._panner = this.input = this.output = this.context.createStereoPanner(), this.pan = this._panner.pan, this.pan.value = t.pan, this._readOnly("pan");
    }, s.default.extend(s.default.Panner, s.default.AudioNode), s.default.Panner.defaults = {
      pan: 0
    }, s.default.Panner.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable("pan"), this._panner.disconnect(), this._panner = null, this.pan = null, this;
    };
    e.default = s.default.Panner;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(17), i(5), i(3);
    s.default.FMOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "type", "modulationType"], s.default.FMOscillator);
      s.default.Source.call(this, t), this._carrier = new s.default.Oscillator(t.frequency, t.type), this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.detune = this._carrier.detune, this.detune.value = t.detune, this.modulationIndex = new s.default.Multiply(t.modulationIndex), this.modulationIndex.units = s.default.Type.Positive, this._modulator = new s.default.Oscillator(t.frequency, t.modulationType), this.harmonicity = new s.default.Multiply(t.harmonicity), this.harmonicity.units = s.default.Type.Positive, this._modulationNode = new s.default.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this.detune.connect(this._modulator.detune), this.phase = t.phase, this._readOnly(["modulationIndex", "frequency", "detune", "harmonicity"]);
    }, s.default.extend(s.default.FMOscillator, s.default.Source), s.default.FMOscillator.defaults = {
      frequency: 440,
      detune: 0,
      phase: 0,
      type: "sine",
      modulationIndex: 2,
      modulationType: "square",
      harmonicity: 1
    }, s.default.FMOscillator.prototype._start = function (t) {
      this._modulator.start(t), this._carrier.start(t);
    }, s.default.FMOscillator.prototype._stop = function (t) {
      this._modulator.stop(t), this._carrier.stop(t);
    }, s.default.FMOscillator.prototype.restart = function (t) {
      this._modulator.restart(t), this._carrier.restart(t);
    }, Object.defineProperty(s.default.FMOscillator.prototype, "type", {
      get: function () {
        return this._carrier.type;
      },
      set: function (t) {
        this._carrier.type = t;
      }
    }), Object.defineProperty(s.default.FMOscillator.prototype, "baseType", {
      get: function () {
        return this._carrier.baseType;
      },
      set: function (t) {
        this._carrier.baseType = t;
      }
    }), Object.defineProperty(s.default.FMOscillator.prototype, "partialCount", {
      get: function () {
        return this._carrier.partialCount;
      },
      set: function (t) {
        this._carrier.partialCount = t;
      }
    }), Object.defineProperty(s.default.FMOscillator.prototype, "modulationType", {
      get: function () {
        return this._modulator.type;
      },
      set: function (t) {
        this._modulator.type = t;
      }
    }), Object.defineProperty(s.default.FMOscillator.prototype, "phase", {
      get: function () {
        return this._carrier.phase;
      },
      set: function (t) {
        this._carrier.phase = t, this._modulator.phase = t;
      }
    }), Object.defineProperty(s.default.FMOscillator.prototype, "partials", {
      get: function () {
        return this._carrier.partials;
      },
      set: function (t) {
        this._carrier.partials = t;
      }
    }), s.default.FMOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._writable(["modulationIndex", "frequency", "detune", "harmonicity"]), this.frequency.dispose(), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this.modulationIndex.dispose(), this.modulationIndex = null, this;
    }, e.default = s.default.FMOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(17), i(2), i(7), i(3);
    s.default.PulseOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "width"], s.default.Oscillator);
      s.default.Source.call(this, t), this.width = new s.default.Signal(t.width, s.default.Type.NormalRange), this._widthGate = new s.default.Gain(0), this._sawtooth = new s.default.Oscillator({
        frequency: t.frequency,
        detune: t.detune,
        type: "sawtooth",
        phase: t.phase
      }), this.frequency = this._sawtooth.frequency, this.detune = this._sawtooth.detune, this._thresh = new s.default.WaveShaper(function (t) {
        return t < 0 ? -1 : 1;
      }), this._sawtooth.chain(this._thresh, this.output), this.width.chain(this._widthGate, this._thresh), this._readOnly(["width", "frequency", "detune"]);
    }, s.default.extend(s.default.PulseOscillator, s.default.Source), s.default.PulseOscillator.defaults = {
      frequency: 440,
      detune: 0,
      phase: 0,
      width: .2
    }, s.default.PulseOscillator.prototype._start = function (t) {
      t = this.toSeconds(t), this._sawtooth.start(t), this._widthGate.gain.setValueAtTime(1, t);
    }, s.default.PulseOscillator.prototype._stop = function (t) {
      t = this.toSeconds(t), this._sawtooth.stop(t), this._widthGate.gain.setValueAtTime(0, t);
    }, s.default.PulseOscillator.prototype.restart = function (t) {
      this._sawtooth.restart(t), this._widthGate.gain.cancelScheduledValues(t), this._widthGate.gain.setValueAtTime(1, t);
    }, Object.defineProperty(s.default.PulseOscillator.prototype, "phase", {
      get: function () {
        return this._sawtooth.phase;
      },
      set: function (t) {
        this._sawtooth.phase = t;
      }
    }), Object.defineProperty(s.default.PulseOscillator.prototype, "type", {
      get: function () {
        return "pulse";
      }
    }), Object.defineProperty(s.default.PulseOscillator.prototype, "baseType", {
      get: function () {
        return "pulse";
      }
    }), Object.defineProperty(s.default.PulseOscillator.prototype, "partials", {
      get: function () {
        return [];
      }
    }), s.default.PulseOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._sawtooth.dispose(), this._sawtooth = null, this._writable(["width", "frequency", "detune"]), this.width.dispose(), this.width = null, this._widthGate.dispose(), this._widthGate = null, this._thresh.dispose(), this._thresh = null, this.frequency = null, this.detune = null, this;
    }, e.default = s.default.PulseOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(16), i(4), i(34);
    s.default.Event = function () {
      var t = s.default.defaults(arguments, ["callback", "value"], s.default.Event);
      s.default.call(this), this._loop = t.loop, this.callback = t.callback, this.value = t.value, this._loopStart = this.toTicks(t.loopStart), this._loopEnd = this.toTicks(t.loopEnd), this._state = new s.default.TimelineState(s.default.State.Stopped), this._playbackRate = 1, this._startOffset = 0, this._probability = t.probability, this._humanize = t.humanize, this.mute = t.mute, this.playbackRate = t.playbackRate;
    }, s.default.extend(s.default.Event), s.default.Event.defaults = {
      callback: s.default.noOp,
      loop: !1,
      loopEnd: "1m",
      loopStart: 0,
      playbackRate: 1,
      value: null,
      probability: 1,
      mute: !1,
      humanize: !1
    }, s.default.Event.prototype._rescheduleEvents = function (t) {
      return t = s.default.defaultArg(t, -1), this._state.forEachFrom(t, function (t) {
        var e;

        if (t.state === s.default.State.Started) {
          s.default.isDefined(t.id) && s.default.Transport.clear(t.id);
          var i = t.time + Math.round(this.startOffset / this._playbackRate);

          if (!0 === this._loop || s.default.isNumber(this._loop) && this._loop > 1) {
            e = 1 / 0, s.default.isNumber(this._loop) && (e = this._loop * this._getLoopDuration());

            var n = this._state.getAfter(i);

            null !== n && (e = Math.min(e, n.time - i)), e !== 1 / 0 && (this._state.setStateAtTime(s.default.State.Stopped, i + e + 1), e = s.default.Ticks(e));
            var o = s.default.Ticks(this._getLoopDuration());
            t.id = s.default.Transport.scheduleRepeat(this._tick.bind(this), o, s.default.Ticks(i), e);
          } else t.id = s.default.Transport.schedule(this._tick.bind(this), s.default.Ticks(i));
        }
      }.bind(this)), this;
    }, Object.defineProperty(s.default.Event.prototype, "state", {
      get: function () {
        return this._state.getValueAtTime(s.default.Transport.ticks);
      }
    }), Object.defineProperty(s.default.Event.prototype, "startOffset", {
      get: function () {
        return this._startOffset;
      },
      set: function (t) {
        this._startOffset = t;
      }
    }), Object.defineProperty(s.default.Event.prototype, "probability", {
      get: function () {
        return this._probability;
      },
      set: function (t) {
        this._probability = t;
      }
    }), Object.defineProperty(s.default.Event.prototype, "humanize", {
      get: function () {
        return this._humanize;
      },
      set: function (t) {
        this._humanize = t;
      }
    }), s.default.Event.prototype.start = function (t) {
      return t = this.toTicks(t), this._state.getValueAtTime(t) === s.default.State.Stopped && (this._state.add({
        state: s.default.State.Started,
        time: t,
        id: void 0
      }), this._rescheduleEvents(t)), this;
    }, s.default.Event.prototype.stop = function (t) {
      if (this.cancel(t), t = this.toTicks(t), this._state.getValueAtTime(t) === s.default.State.Started) {
        this._state.setStateAtTime(s.default.State.Stopped, t);

        var e = this._state.getBefore(t),
            i = t;

        null !== e && (i = e.time), this._rescheduleEvents(i);
      }

      return this;
    }, s.default.Event.prototype.cancel = function (t) {
      return t = s.default.defaultArg(t, -1 / 0), t = this.toTicks(t), this._state.forEachFrom(t, function (t) {
        s.default.Transport.clear(t.id);
      }), this._state.cancel(t), this;
    }, s.default.Event.prototype._tick = function (t) {
      var e = s.default.Transport.getTicksAtTime(t);

      if (!this.mute && this._state.getValueAtTime(e) === s.default.State.Started) {
        if (this.probability < 1 && Math.random() > this.probability) return;

        if (this.humanize) {
          var i = .02;
          s.default.isBoolean(this.humanize) || (i = this.toSeconds(this.humanize)), t += (2 * Math.random() - 1) * i;
        }

        this.callback(t, this.value);
      }
    }, s.default.Event.prototype._getLoopDuration = function () {
      return Math.round((this._loopEnd - this._loopStart) / this._playbackRate);
    }, Object.defineProperty(s.default.Event.prototype, "loop", {
      get: function () {
        return this._loop;
      },
      set: function (t) {
        this._loop = t, this._rescheduleEvents();
      }
    }), Object.defineProperty(s.default.Event.prototype, "playbackRate", {
      get: function () {
        return this._playbackRate;
      },
      set: function (t) {
        this._playbackRate = t, this._rescheduleEvents();
      }
    }), Object.defineProperty(s.default.Event.prototype, "loopEnd", {
      get: function () {
        return s.default.Ticks(this._loopEnd).toSeconds();
      },
      set: function (t) {
        this._loopEnd = this.toTicks(t), this._loop && this._rescheduleEvents();
      }
    }), Object.defineProperty(s.default.Event.prototype, "loopStart", {
      get: function () {
        return s.default.Ticks(this._loopStart).toSeconds();
      },
      set: function (t) {
        this._loopStart = this.toTicks(t), this._loop && this._rescheduleEvents();
      }
    }), Object.defineProperty(s.default.Event.prototype, "progress", {
      get: function () {
        if (this._loop) {
          var t = s.default.Transport.ticks,
              e = this._state.get(t);

          if (null !== e && e.state === s.default.State.Started) {
            var i = this._getLoopDuration();

            return (t - e.time) % i / i;
          }

          return 0;
        }

        return 0;
      }
    }), s.default.Event.prototype.dispose = function () {
      this.cancel(), this._state.dispose(), this._state = null, this.callback = null, this.value = null;
    }, e.default = s.default.Event;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(13), i(29), i(10), i(3), i(1);
    s.default.MidSideMerge = function () {
      s.default.AudioNode.call(this), this.createInsOuts(2, 0), this.mid = this.input[0] = new s.default.Gain(), this._left = new s.default.Add(), this._timesTwoLeft = new s.default.Multiply(Math.SQRT1_2), this.side = this.input[1] = new s.default.Gain(), this._right = new s.default.Subtract(), this._timesTwoRight = new s.default.Multiply(Math.SQRT1_2), this._merge = this.output = new s.default.Merge(), this.mid.connect(this._left, 0, 0), this.side.connect(this._left, 0, 1), this.mid.connect(this._right, 0, 0), this.side.connect(this._right, 0, 1), this._left.connect(this._timesTwoLeft), this._right.connect(this._timesTwoRight), this._timesTwoLeft.connect(this._merge, 0, 0), this._timesTwoRight.connect(this._merge, 0, 1);
    }, s.default.extend(s.default.MidSideMerge, s.default.AudioNode), s.default.MidSideMerge.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._left.dispose(), this._left = null, this._timesTwoLeft.dispose(), this._timesTwoLeft = null, this._right.dispose(), this._right = null, this._timesTwoRight.dispose(), this._timesTwoRight = null, this._merge.dispose(), this._merge = null, this;
    }, e.default = s.default.MidSideMerge;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(29), i(13), i(2), i(19), i(1);
    s.default.MidSideSplit = function () {
      s.default.AudioNode.call(this), this.createInsOuts(0, 2), this._split = this.input = new s.default.Split(), this._midAdd = new s.default.Add(), this.mid = this.output[0] = new s.default.Multiply(Math.SQRT1_2), this._sideSubtract = new s.default.Subtract(), this.side = this.output[1] = new s.default.Multiply(Math.SQRT1_2), this._split.connect(this._midAdd, 0, 0), this._split.connect(this._midAdd, 1, 1), this._split.connect(this._sideSubtract, 0, 0), this._split.connect(this._sideSubtract, 1, 1), this._midAdd.connect(this.mid), this._sideSubtract.connect(this.side);
    }, s.default.extend(s.default.MidSideSplit, s.default.AudioNode), s.default.MidSideSplit.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midAdd.dispose(), this._midAdd = null, this._sideSubtract.dispose(), this._sideSubtract = null, this._split.dispose(), this._split = null, this;
    }, e.default = s.default.MidSideSplit;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(9), i(1), i(59);
    s.default.LowpassCombFilter = function () {
      var t = s.default.defaults(arguments, ["delayTime", "resonance", "dampening"], s.default.LowpassCombFilter);
      s.default.AudioNode.call(this), this._combFilter = this.output = new s.default.FeedbackCombFilter(t.delayTime, t.resonance), this.delayTime = this._combFilter.delayTime, this._lowpass = this.input = new s.default.Filter({
        frequency: t.dampening,
        type: "lowpass",
        Q: 0,
        rolloff: -12
      }), this.dampening = this._lowpass.frequency, this.resonance = this._combFilter.resonance, this._lowpass.connect(this._combFilter), this._readOnly(["dampening", "resonance", "delayTime"]);
    }, s.default.extend(s.default.LowpassCombFilter, s.default.AudioNode), s.default.LowpassCombFilter.defaults = {
      delayTime: .1,
      resonance: .5,
      dampening: 3e3
    }, s.default.LowpassCombFilter.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["dampening", "resonance", "delayTime"]), this._combFilter.dispose(), this._combFilter = null, this.resonance = null, this.delayTime = null, this._lowpass.dispose(), this._lowpass = null, this.dampening = null, this;
    }, e.default = s.default.LowpassCombFilter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(45);
    s.default.Ticks = function (t, e) {
      if (!(this instanceof s.default.Ticks)) return new s.default.Ticks(t, e);
      s.default.TransportTime.call(this, t, e);
    }, s.default.extend(s.default.Ticks, s.default.TransportTime), s.default.Ticks.prototype._defaultUnits = "i", s.default.Ticks.prototype._now = function () {
      return s.default.Transport.ticks;
    }, s.default.Ticks.prototype._beatsToUnits = function (t) {
      return this._getPPQ() * t;
    }, s.default.Ticks.prototype._secondsToUnits = function (t) {
      return Math.floor(t / (60 / this._getBpm()) * this._getPPQ());
    }, s.default.Ticks.prototype._ticksToUnits = function (t) {
      return t;
    }, s.default.Ticks.prototype.toTicks = function () {
      return this.valueOf();
    }, s.default.Ticks.prototype.toSeconds = function () {
      return this.valueOf() / this._getPPQ() * (60 / this._getBpm());
    }, e.default = s.default.Ticks;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(55);
    s.default.TransportEvent = function (t, e) {
      e = s.default.defaultArg(e, s.default.TransportEvent.defaults), s.default.call(this), this.Transport = t, this.id = s.default.TransportEvent._eventId++, this.time = s.default.Ticks(e.time), this.callback = e.callback, this._once = e.once;
    }, s.default.extend(s.default.TransportEvent), s.default.TransportEvent.defaults = {
      once: !1,
      callback: s.default.noOp
    }, s.default.TransportEvent._eventId = 0, s.default.TransportEvent.prototype.invoke = function (t) {
      this.callback && (this.callback(t), this._once && this.Transport && this.Transport.clear(this.id));
    }, s.default.TransportEvent.prototype.dispose = function () {
      return s.default.prototype.dispose.call(this), this.Transport = null, this.callback = null, this.time = null, this;
    }, e.default = s.default.TransportEvent;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(82), i(34), i(24), i(14);
    s.default.TickSource = function () {
      var t = s.default.defaults(arguments, ["frequency"], s.default.TickSource);
      this.frequency = new s.default.TickSignal(t.frequency), this._readOnly("frequency"), this._state = new s.default.TimelineState(s.default.State.Stopped), this._state.setStateAtTime(s.default.State.Stopped, 0), this._tickOffset = new s.default.Timeline(), this.setTicksAtTime(0, 0);
    }, s.default.extend(s.default.TickSource), s.default.TickSource.defaults = {
      frequency: 1
    }, Object.defineProperty(s.default.TickSource.prototype, "state", {
      get: function () {
        return this._state.getValueAtTime(this.now());
      }
    }), s.default.TickSource.prototype.start = function (t, e) {
      return t = this.toSeconds(t), this._state.getValueAtTime(t) !== s.default.State.Started && (this._state.setStateAtTime(s.default.State.Started, t), s.default.isDefined(e) && this.setTicksAtTime(e, t)), this;
    }, s.default.TickSource.prototype.stop = function (t) {
      if (t = this.toSeconds(t), this._state.getValueAtTime(t) === s.default.State.Stopped) {
        var e = this._state.get(t);

        e.time > 0 && (this._tickOffset.cancel(e.time), this._state.cancel(e.time));
      }

      return this._state.cancel(t), this._state.setStateAtTime(s.default.State.Stopped, t), this.setTicksAtTime(0, t), this;
    }, s.default.TickSource.prototype.pause = function (t) {
      return t = this.toSeconds(t), this._state.getValueAtTime(t) === s.default.State.Started && this._state.setStateAtTime(s.default.State.Paused, t), this;
    }, s.default.TickSource.prototype.cancel = function (t) {
      return t = this.toSeconds(t), this._state.cancel(t), this._tickOffset.cancel(t), this;
    }, s.default.TickSource.prototype.getTicksAtTime = function (t) {
      t = this.toSeconds(t);

      var e = this._state.getLastState(s.default.State.Stopped, t),
          i = {
        state: s.default.State.Paused,
        time: t
      };

      this._state.add(i);

      var n = e,
          o = 0;
      return this._state.forEachBetween(e.time, t + this.sampleTime, function (t) {
        var e = n.time,
            i = this._tickOffset.get(t.time);

        i.time >= n.time && (o = i.ticks, e = i.time), n.state === s.default.State.Started && t.state !== s.default.State.Started && (o += this.frequency.getTicksAtTime(t.time) - this.frequency.getTicksAtTime(e)), n = t;
      }.bind(this)), this._state.remove(i), o;
    }, Object.defineProperty(s.default.TickSource.prototype, "ticks", {
      get: function () {
        return this.getTicksAtTime(this.now());
      },
      set: function (t) {
        this.setTicksAtTime(t, this.now());
      }
    }), Object.defineProperty(s.default.TickSource.prototype, "seconds", {
      get: function () {
        return this.getSecondsAtTime(this.now());
      },
      set: function (t) {
        var e = this.now(),
            i = this.frequency.timeToTicks(t, e);
        this.setTicksAtTime(i, e);
      }
    }), s.default.TickSource.prototype.getSecondsAtTime = function (t) {
      t = this.toSeconds(t);

      var e = this._state.getLastState(s.default.State.Stopped, t),
          i = {
        state: s.default.State.Paused,
        time: t
      };

      this._state.add(i);

      var n = e,
          o = 0;
      return this._state.forEachBetween(e.time, t + this.sampleTime, function (t) {
        var e = n.time,
            i = this._tickOffset.get(t.time);

        i.time >= n.time && (o = i.seconds, e = i.time), n.state === s.default.State.Started && t.state !== s.default.State.Started && (o += t.time - e), n = t;
      }.bind(this)), this._state.remove(i), o;
    }, s.default.TickSource.prototype.setTicksAtTime = function (t, e) {
      return e = this.toSeconds(e), this._tickOffset.cancel(e), this._tickOffset.add({
        time: e,
        ticks: t,
        seconds: this.frequency.getDurationOfTicks(t, e)
      }), this;
    }, s.default.TickSource.prototype.getStateAtTime = function (t) {
      return t = this.toSeconds(t), this._state.getValueAtTime(t);
    }, s.default.TickSource.prototype.getTimeOfTick = function (t, e) {
      e = s.default.defaultArg(e, this.now());

      var i = this._tickOffset.get(e),
          n = this._state.get(e),
          o = Math.max(i.time, n.time),
          a = this.frequency.getTicksAtTime(o) + t - i.ticks;

      return this.frequency.getTimeOfTick(a);
    }, s.default.TickSource.prototype.forEachTickBetween = function (t, e, i) {
      var n = this._state.get(t);

      if (this._state.forEachBetween(t, e, function (e) {
        n.state === s.default.State.Started && e.state !== s.default.State.Started && this.forEachTickBetween(Math.max(n.time, t), e.time - this.sampleTime, i), n = e;
      }.bind(this)), t = Math.max(n.time, t), n.state === s.default.State.Started && this._state) {
        var o = this.frequency.getTicksAtTime(t),
            a = (o - this.frequency.getTicksAtTime(n.time)) % 1;
        0 !== a && (a = 1 - a);

        for (var r = this.frequency.getTimeOfTick(o + a), l = null; r < e && this._state;) {
          try {
            i(r, Math.round(this.getTicksAtTime(r)));
          } catch (t) {
            l = t;
            break;
          }

          this._state && (r += this.frequency.getDurationOfTicks(1, r));
        }
      }

      if (l) throw l;
      return this;
    }, s.default.TickSource.prototype.dispose = function () {
      return s.default.Param.prototype.dispose.call(this), this._state.dispose(), this._state = null, this._tickOffset.dispose(), this._tickOffset = null, this._writable("frequency"), this.frequency.dispose(), this.frequency = null, this;
    }, e.default = s.default.TickSource;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(87), i(13), i(2), i(4), i(18), i(1);
    s.default.Follower = function () {
      var t = s.default.defaults(arguments, ["smoothing"], s.default.Follower);
      s.default.AudioNode.call(this), this.createInsOuts(1, 1), this._abs = new s.default.Abs(), this._filter = this.context.createBiquadFilter(), this._filter.type = "lowpass", this._filter.frequency.value = 0, this._filter.Q.value = 0, this._sub = new s.default.Subtract(), this._delay = new s.default.Delay(this.blockTime), this._smoothing = t.smoothing, s.default.connect(this.input, this._delay), s.default.connect(this.input, this._sub, 0, 1), this._sub.chain(this._abs, this._filter, this.output), this.smoothing = t.smoothing;
    }, s.default.extend(s.default.Follower, s.default.AudioNode), s.default.Follower.defaults = {
      smoothing: .05
    }, Object.defineProperty(s.default.Follower.prototype, "smoothing", {
      get: function () {
        return this._smoothing;
      },
      set: function (t) {
        this._smoothing = t, this._filter.frequency.value = .5 * s.default.Time(t).toFrequency();
      }
    }), s.default.Follower.prototype.connect = s.default.SignalBase.prototype.connect, s.default.Follower.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._filter.disconnect(), this._filter = null, this._delay.dispose(), this._delay = null, this._sub.disconnect(), this._sub = null, this._abs.dispose(), this._abs = null, this;
    }, e.default = s.default.Follower;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(42), i(2), i(14), i(18), i(3), i(1);
    s.default.FeedbackCombFilter = function () {
      var t = s.default.defaults(arguments, ["delayTime", "resonance"], s.default.FeedbackCombFilter);
      s.default.AudioNode.call(this), this._delay = this.input = this.output = new s.default.Delay(t.delayTime), this.delayTime = this._delay.delayTime, this._feedback = new s.default.Gain(t.resonance, s.default.Type.NormalRange), this.resonance = this._feedback.gain, this._delay.chain(this._feedback, this._delay), this._readOnly(["resonance", "delayTime"]);
    }, s.default.extend(s.default.FeedbackCombFilter, s.default.AudioNode), s.default.FeedbackCombFilter.defaults = {
      delayTime: .1,
      resonance: .5
    }, s.default.FeedbackCombFilter.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["resonance", "delayTime"]), this._delay.dispose(), this._delay = null, this.delayTime = null, this._feedback.dispose(), this._feedback = null, this.resonance = null, this;
    }, e.default = s.default.FeedbackCombFilter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(9), i(2), i(3), i(1);
    s.default.MultibandSplit = function () {
      var t = s.default.defaults(arguments, ["lowFrequency", "highFrequency"], s.default.MultibandSplit);
      s.default.AudioNode.call(this), this.input = new s.default.Gain(), this.output = new Array(3), this.low = this.output[0] = new s.default.Filter(0, "lowpass"), this._lowMidFilter = new s.default.Filter(0, "highpass"), this.mid = this.output[1] = new s.default.Filter(0, "lowpass"), this.high = this.output[2] = new s.default.Filter(0, "highpass"), this.lowFrequency = new s.default.Signal(t.lowFrequency, s.default.Type.Frequency), this.highFrequency = new s.default.Signal(t.highFrequency, s.default.Type.Frequency), this.Q = new s.default.Signal(t.Q), this.input.fan(this.low, this.high), this.input.chain(this._lowMidFilter, this.mid), this.lowFrequency.connect(this.low.frequency), this.lowFrequency.connect(this._lowMidFilter.frequency), this.highFrequency.connect(this.mid.frequency), this.highFrequency.connect(this.high.frequency), this.Q.connect(this.low.Q), this.Q.connect(this._lowMidFilter.Q), this.Q.connect(this.mid.Q), this.Q.connect(this.high.Q), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]);
    }, s.default.extend(s.default.MultibandSplit, s.default.AudioNode), s.default.MultibandSplit.defaults = {
      lowFrequency: 400,
      highFrequency: 2500,
      Q: 1
    }, s.default.MultibandSplit.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.low = null, this._lowMidFilter.dispose(), this._lowMidFilter = null, this.mid.dispose(), this.mid = null, this.high.dispose(), this.high = null, this.lowFrequency.dispose(), this.lowFrequency = null, this.highFrequency.dispose(), this.highFrequency = null, this.Q.dispose(), this.Q = null, this;
    }, e.default = s.default.MultibandSplit;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7);
    s.default.Pow = function (t) {
      s.default.SignalBase.call(this), this._exp = s.default.defaultArg(t, 1), this._expScaler = this.input = this.output = new s.default.WaveShaper(this._expFunc(this._exp), 8192);
    }, s.default.extend(s.default.Pow, s.default.SignalBase), Object.defineProperty(s.default.Pow.prototype, "value", {
      get: function () {
        return this._exp;
      },
      set: function (t) {
        this._exp = t, this._expScaler.setMap(this._expFunc(this._exp));
      }
    }), s.default.Pow.prototype._expFunc = function (t) {
      return function (e) {
        return Math.pow(Math.abs(e), t);
      };
    }, s.default.Pow.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._expScaler.dispose(), this._expScaler = null, this;
    }, e.default = s.default.Pow;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    s.default.TimeBase = function (t, e) {
      if (!(this instanceof s.default.TimeBase)) return new s.default.TimeBase(t, e);
      if (this._val = t, this._units = e, s.default.isUndef(this._units) && s.default.isString(this._val) && parseFloat(this._val) == this._val && "+" !== this._val.charAt(0)) this._val = parseFloat(this._val), this._units = this._defaultUnits;else if (t && t.constructor === this.constructor) this._val = t._val, this._units = t._units;else if (t instanceof s.default.TimeBase) switch (this._defaultUnits) {
        case "s":
          this._val = t.toSeconds();
          break;

        case "i":
          this._val = t.toTicks();
          break;

        case "hz":
          this._val = t.toFrequency();
          break;

        case "midi":
          this._val = t.toMidi();
          break;

        default:
          throw new Error("Unrecognized default units " + this._defaultUnits);
      }
    }, s.default.extend(s.default.TimeBase), s.default.TimeBase.prototype._expressions = {
      n: {
        regexp: /^(\d+)n(\.?)$/i,
        method: function (t, e) {
          t = parseInt(t);
          var i = "." === e ? 1.5 : 1;
          return 1 === t ? this._beatsToUnits(this._getTimeSignature()) * i : this._beatsToUnits(4 / t) * i;
        }
      },
      t: {
        regexp: /^(\d+)t$/i,
        method: function (t) {
          return t = parseInt(t), this._beatsToUnits(8 / (3 * parseInt(t)));
        }
      },
      m: {
        regexp: /^(\d+)m$/i,
        method: function (t) {
          return this._beatsToUnits(parseInt(t) * this._getTimeSignature());
        }
      },
      i: {
        regexp: /^(\d+)i$/i,
        method: function (t) {
          return this._ticksToUnits(parseInt(t));
        }
      },
      hz: {
        regexp: /^(\d+(?:\.\d+)?)hz$/i,
        method: function (t) {
          return this._frequencyToUnits(parseFloat(t));
        }
      },
      tr: {
        regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/,
        method: function (t, e, i) {
          var s = 0;
          return t && "0" !== t && (s += this._beatsToUnits(this._getTimeSignature() * parseFloat(t))), e && "0" !== e && (s += this._beatsToUnits(parseFloat(e))), i && "0" !== i && (s += this._beatsToUnits(parseFloat(i) / 4)), s;
        }
      },
      s: {
        regexp: /^(\d+(?:\.\d+)?)s$/,
        method: function (t) {
          return this._secondsToUnits(parseFloat(t));
        }
      },
      samples: {
        regexp: /^(\d+)samples$/,
        method: function (t) {
          return parseInt(t) / this.context.sampleRate;
        }
      },
      default: {
        regexp: /^(\d+(?:\.\d+)?)$/,
        method: function (t) {
          return this._expressions[this._defaultUnits].method.call(this, t);
        }
      }
    }, s.default.TimeBase.prototype._defaultUnits = "s", s.default.TimeBase.prototype._getBpm = function () {
      return s.default.Transport ? s.default.Transport.bpm.value : 120;
    }, s.default.TimeBase.prototype._getTimeSignature = function () {
      return s.default.Transport ? s.default.Transport.timeSignature : 4;
    }, s.default.TimeBase.prototype._getPPQ = function () {
      return s.default.Transport ? s.default.Transport.PPQ : 192;
    }, s.default.TimeBase.prototype._now = function () {
      return this.now();
    }, s.default.TimeBase.prototype._frequencyToUnits = function (t) {
      return 1 / t;
    }, s.default.TimeBase.prototype._beatsToUnits = function (t) {
      return 60 / this._getBpm() * t;
    }, s.default.TimeBase.prototype._secondsToUnits = function (t) {
      return t;
    }, s.default.TimeBase.prototype._ticksToUnits = function (t) {
      return t * (this._beatsToUnits(1) / this._getPPQ());
    }, s.default.TimeBase.prototype._noArg = function () {
      return this._now();
    }, s.default.TimeBase.prototype.valueOf = function () {
      if (s.default.isUndef(this._val)) return this._noArg();

      if (s.default.isString(this._val) && s.default.isUndef(this._units)) {
        for (var t in this._expressions) if (this._expressions[t].regexp.test(this._val.trim())) {
          this._units = t;
          break;
        }
      } else if (s.default.isObject(this._val)) {
        var e = 0;

        for (var i in this._val) {
          var n = this._val[i];
          e += new this.constructor(i).valueOf() * n;
        }

        return e;
      }

      if (s.default.isDefined(this._units)) {
        var o = this._expressions[this._units],
            a = this._val.toString().trim().match(o.regexp);

        return a ? o.method.apply(this, a.slice(1)) : o.method.call(this, parseFloat(this._val));
      }

      return this._val;
    }, s.default.TimeBase.prototype.toSeconds = function () {
      return this.valueOf();
    }, s.default.TimeBase.prototype.toFrequency = function () {
      return 1 / this.toSeconds();
    }, s.default.TimeBase.prototype.toSamples = function () {
      return this.toSeconds() * this.context.sampleRate;
    }, s.default.TimeBase.prototype.toMilliseconds = function () {
      return 1e3 * this.toSeconds();
    }, s.default.TimeBase.prototype.dispose = function () {
      this._val = null, this._units = null;
    }, e.default = s.default.TimeBase;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(62), i(46);
    s.default.Time = function (t, e) {
      if (!(this instanceof s.default.Time)) return new s.default.Time(t, e);
      s.default.TimeBase.call(this, t, e);
    }, s.default.extend(s.default.Time, s.default.TimeBase), s.default.Time.prototype._expressions = Object.assign({}, s.default.TimeBase.prototype._expressions, {
      quantize: {
        regexp: /^@(.+)/,
        method: function (t) {
          if (s.default.Transport) {
            var e = new this.constructor(t);
            return this._secondsToUnits(s.default.Transport.nextSubdivision(e));
          }

          return 0;
        }
      },
      now: {
        regexp: /^\+(.+)/,
        method: function (t) {
          return this._now() + new this.constructor(t);
        }
      }
    }), s.default.Time.prototype.quantize = function (t, e) {
      e = s.default.defaultArg(e, 1);
      var i = new this.constructor(t),
          n = this.valueOf();
      return n + (Math.round(n / i) * i - n) * e;
    }, s.default.Time.prototype.toNotation = function () {
      for (var t = this.toSeconds(), e = ["1m"], i = 1; i < 8; i++) {
        var n = Math.pow(2, i);
        e.push(n + "n."), e.push(n + "n"), e.push(n + "t");
      }

      e.push("0");
      var o = e[0],
          a = s.default.Time(e[0]).toSeconds();
      return e.forEach(function (e) {
        var i = s.default.Time(e).toSeconds();
        Math.abs(i - t) < Math.abs(a - t) && (o = e, a = i);
      }), o;
    }, s.default.Time.prototype.toBarsBeatsSixteenths = function () {
      var t = this._beatsToUnits(1),
          e = this.valueOf() / t;

      e = parseFloat(e.toFixed(4));
      var i = Math.floor(e / this._getTimeSignature()),
          s = e % 1 * 4;
      return e = Math.floor(e) % this._getTimeSignature(), (s = s.toString()).length > 3 && (s = parseFloat(parseFloat(s).toFixed(3))), [i, e, s].join(":");
    }, s.default.Time.prototype.toTicks = function () {
      var t = this._beatsToUnits(1),
          e = this.valueOf() / t;

      return Math.round(e * this._getPPQ());
    }, s.default.Time.prototype.toSeconds = function () {
      return this.valueOf();
    }, s.default.Time.prototype.toMidi = function () {
      return s.default.Frequency.ftom(this.toFrequency());
    }, e.default = s.default.Time;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(11), i(6), i(3), i(1);
    s.default.supported && (OscillatorNode.prototype.setPeriodicWave || (OscillatorNode.prototype.setPeriodicWave = OscillatorNode.prototype.setWaveTable), AudioContext.prototype.createPeriodicWave || (AudioContext.prototype.createPeriodicWave = AudioContext.prototype.createWaveTable)), s.default.OscillatorNode = function () {
      var t = s.default.defaults(arguments, ["frequency", "type"], s.default.OscillatorNode);
      s.default.AudioNode.call(this, t), this.onended = t.onended, this._startTime = -1, this._stopTime = -1, this._gainNode = this.output = new s.default.Gain(0), this._oscillator = this.context.createOscillator(), s.default.connect(this._oscillator, this._gainNode), this.type = t.type, this.frequency = new s.default.Param({
        param: this._oscillator.frequency,
        units: s.default.Type.Frequency,
        value: t.frequency
      }), this.detune = new s.default.Param({
        param: this._oscillator.detune,
        units: s.default.Type.Cents,
        value: t.detune
      }), this._gain = 1;
    }, s.default.extend(s.default.OscillatorNode, s.default.AudioNode), s.default.OscillatorNode.defaults = {
      frequency: 440,
      detune: 0,
      type: "sine",
      onended: s.default.noOp
    }, Object.defineProperty(s.default.OscillatorNode.prototype, "state", {
      get: function () {
        return this.getStateAtTime(this.now());
      }
    }), s.default.OscillatorNode.prototype.getStateAtTime = function (t) {
      return t = this.toSeconds(t), -1 !== this._startTime && t >= this._startTime && (-1 === this._stopTime || t <= this._stopTime) ? s.default.State.Started : s.default.State.Stopped;
    }, s.default.OscillatorNode.prototype.start = function (t) {
      if (this.log("start", t), -1 !== this._startTime) throw new Error("cannot call OscillatorNode.start more than once");
      return this._startTime = this.toSeconds(t), this._startTime = Math.max(this._startTime, this.context.currentTime), this._oscillator.start(this._startTime), this._gainNode.gain.setValueAtTime(1, this._startTime), this;
    }, s.default.OscillatorNode.prototype.setPeriodicWave = function (t) {
      return this._oscillator.setPeriodicWave(t), this;
    }, s.default.OscillatorNode.prototype.stop = function (t) {
      return this.log("stop", t), this.assert(-1 !== this._startTime, "'start' must be called before 'stop'"), this.cancelStop(), this._stopTime = this.toSeconds(t), this._stopTime = Math.max(this._stopTime, this.context.currentTime), this._stopTime > this._startTime ? (this._gainNode.gain.setValueAtTime(0, this._stopTime), this.context.clearTimeout(this._timeout), this._timeout = this.context.setTimeout(function () {
        this._oscillator.stop(this.now()), this.onended(), setTimeout(function () {
          this._oscillator && (this._oscillator.disconnect(), this._gainNode.disconnect());
        }.bind(this), 100);
      }.bind(this), this._stopTime - this.context.currentTime)) : this._gainNode.gain.cancelScheduledValues(this._startTime), this;
    }, s.default.OscillatorNode.prototype.cancelStop = function () {
      return -1 !== this._startTime && (this._gainNode.gain.cancelScheduledValues(this._startTime + this.sampleTime), this.context.clearTimeout(this._timeout), this._stopTime = -1), this;
    }, Object.defineProperty(s.default.OscillatorNode.prototype, "type", {
      get: function () {
        return this._oscillator.type;
      },
      set: function (t) {
        this._oscillator.type = t;
      }
    }), s.default.OscillatorNode.prototype.dispose = function () {
      return this._wasDisposed || (this._wasDisposed = !0, this.context.clearTimeout(this._timeout), s.default.AudioNode.prototype.dispose.call(this), this.onended = null, this._oscillator.disconnect(), this._oscillator = null, this._gainNode.dispose(), this._gainNode = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null), this;
    };
    e.default = s.default.OscillatorNode;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(11), i(6), i(57), i(32);
    s.default.Player = function (t) {
      var e;
      t instanceof s.default.Buffer && t.loaded ? (t = t.get(), e = s.default.Player.defaults) : e = s.default.defaults(arguments, ["url", "onload"], s.default.Player), s.default.Source.call(this, e), this.autostart = e.autostart, this._buffer = new s.default.Buffer({
        url: e.url,
        onload: this._onload.bind(this, e.onload),
        reverse: e.reverse
      }), t instanceof AudioBuffer && this._buffer.set(t), this._loop = e.loop, this._loopStart = e.loopStart, this._loopEnd = e.loopEnd, this._playbackRate = e.playbackRate, this._activeSources = [], this.fadeIn = e.fadeIn, this.fadeOut = e.fadeOut;
    }, s.default.extend(s.default.Player, s.default.Source), s.default.Player.defaults = {
      onload: s.default.noOp,
      playbackRate: 1,
      loop: !1,
      autostart: !1,
      loopStart: 0,
      loopEnd: 0,
      reverse: !1,
      fadeIn: 0,
      fadeOut: 0
    }, s.default.Player.prototype.load = function (t, e) {
      return this._buffer.load(t, this._onload.bind(this, e));
    }, s.default.Player.prototype._onload = function (t) {
      (t = s.default.defaultArg(t, s.default.noOp))(this), this.autostart && this.start();
    }, s.default.Player.prototype._onSourceEnd = function (t) {
      var e = this._activeSources.indexOf(t);

      this._activeSources.splice(e, 1), 0 !== this._activeSources.length || this._synced || this._state.setStateAtTime(s.default.State.Stopped, s.default.now());
    }, s.default.Player.prototype._start = function (t, e, i) {
      e = this._loop ? s.default.defaultArg(e, this._loopStart) : s.default.defaultArg(e, 0), e = this.toSeconds(e), this._synced && (e *= this._playbackRate);
      var n = s.default.defaultArg(i, Math.max(this._buffer.duration - e, 0));
      n = this.toSeconds(n), n /= this._playbackRate, t = this.toSeconds(t);
      var o = new s.default.BufferSource({
        buffer: this._buffer,
        loop: this._loop,
        loopStart: this._loopStart,
        loopEnd: this._loopEnd,
        onended: this._onSourceEnd.bind(this),
        playbackRate: this._playbackRate,
        fadeIn: this.fadeIn,
        fadeOut: this.fadeOut
      }).connect(this.output);
      return this._loop || this._synced || this._state.setStateAtTime(s.default.State.Stopped, t + n), this._activeSources.push(o), this._loop && s.default.isUndef(i) ? o.start(t, e) : o.start(t, e, n - this.toSeconds(this.fadeOut)), this;
    }, s.default.Player.prototype._stop = function (t) {
      return t = this.toSeconds(t), this._activeSources.forEach(function (e) {
        e.stop(t);
      }), this;
    }, s.default.Player.prototype.restart = function (t, e, i) {
      return this._stop(t), this._start(t, e, i), this;
    }, s.default.Player.prototype.seek = function (t, e) {
      return e = this.toSeconds(e), this._state.getValueAtTime(e) === s.default.State.Started && (t = this.toSeconds(t), this._stop(e), this._start(e, t)), this;
    }, s.default.Player.prototype.setLoopPoints = function (t, e) {
      return this.loopStart = t, this.loopEnd = e, this;
    }, Object.defineProperty(s.default.Player.prototype, "loopStart", {
      get: function () {
        return this._loopStart;
      },
      set: function (t) {
        this._loopStart = t, this._activeSources.forEach(function (e) {
          e.loopStart = t;
        });
      }
    }), Object.defineProperty(s.default.Player.prototype, "loopEnd", {
      get: function () {
        return this._loopEnd;
      },
      set: function (t) {
        this._loopEnd = t, this._activeSources.forEach(function (e) {
          e.loopEnd = t;
        });
      }
    }), Object.defineProperty(s.default.Player.prototype, "buffer", {
      get: function () {
        return this._buffer;
      },
      set: function (t) {
        this._buffer.set(t);
      }
    }), Object.defineProperty(s.default.Player.prototype, "loop", {
      get: function () {
        return this._loop;
      },
      set: function (t) {
        if (this._loop !== t && (this._loop = t, this._activeSources.forEach(function (e) {
          e.loop = t;
        }), t)) {
          var e = this._state.getNextState(s.default.State.Stopped, this.now());

          e && this._state.cancel(e.time);
        }
      }
    }), Object.defineProperty(s.default.Player.prototype, "playbackRate", {
      get: function () {
        return this._playbackRate;
      },
      set: function (t) {
        this._playbackRate = t;

        var e = this.now(),
            i = this._state.getNextState(s.default.State.Stopped, e);

        i && this._state.cancel(i.time), this._activeSources.forEach(function (i) {
          i.cancelStop(), i.playbackRate.setValueAtTime(t, e);
        });
      }
    }), Object.defineProperty(s.default.Player.prototype, "reverse", {
      get: function () {
        return this._buffer.reverse;
      },
      set: function (t) {
        this._buffer.reverse = t;
      }
    }), Object.defineProperty(s.default.Player.prototype, "loaded", {
      get: function () {
        return this._buffer.loaded;
      }
    }), s.default.Player.prototype.dispose = function () {
      return this._activeSources.forEach(function (t) {
        t.dispose();
      }), this._activeSources = null, s.default.Source.prototype.dispose.call(this), this._buffer.dispose(), this._buffer = null, this;
    }, e.default = s.default.Player;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(31), i(41), i(37), i(2), i(9), i(25);
    s.default.MonoSynth = function (t) {
      t = s.default.defaultArg(t, s.default.MonoSynth.defaults), s.default.Monophonic.call(this, t), this.oscillator = new s.default.OmniOscillator(t.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.filter = new s.default.Filter(t.filter), this.filter.frequency.value = 5e3, this.filterEnvelope = new s.default.FrequencyEnvelope(t.filterEnvelope), this.envelope = new s.default.AmplitudeEnvelope(t.envelope), this.oscillator.chain(this.filter, this.envelope, this.output), this.filterEnvelope.connect(this.filter.frequency), this._readOnly(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]);
    }, s.default.extend(s.default.MonoSynth, s.default.Monophonic), s.default.MonoSynth.defaults = {
      frequency: "C4",
      detune: 0,
      oscillator: {
        type: "square"
      },
      filter: {
        Q: 6,
        type: "lowpass",
        rolloff: -24
      },
      envelope: {
        attack: .005,
        decay: .1,
        sustain: .9,
        release: 1
      },
      filterEnvelope: {
        attack: .06,
        decay: .2,
        sustain: .5,
        release: 2,
        baseFrequency: 200,
        octaves: 7,
        exponent: 2
      }
    }, s.default.MonoSynth.prototype._triggerEnvelopeAttack = function (t, e) {
      return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.filterEnvelope.triggerAttack(t), this.oscillator.start(t), 0 === this.envelope.sustain && this.oscillator.stop(t + this.envelope.attack + this.envelope.decay), this;
    }, s.default.MonoSynth.prototype._triggerEnvelopeRelease = function (t) {
      return this.envelope.triggerRelease(t), this.filterEnvelope.triggerRelease(t), this.oscillator.stop(t + this.envelope.release), this;
    }, s.default.MonoSynth.prototype.dispose = function () {
      return s.default.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.filterEnvelope.dispose(), this.filterEnvelope = null, this.filter.dispose(), this.filter = null, this.frequency = null, this.detune = null, this;
    }, e.default = s.default.MonoSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(17), i(5), i(3);
    s.default.FatOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "type", "spread"], s.default.FatOscillator);
      s.default.Source.call(this, t), this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this._oscillators = [], this._spread = t.spread, this._type = t.type, this._phase = t.phase, this._partials = t.partials, this._partialCount = t.partialCount, this.count = t.count, this._readOnly(["frequency", "detune"]);
    }, s.default.extend(s.default.FatOscillator, s.default.Source), s.default.FatOscillator.defaults = {
      frequency: 440,
      detune: 0,
      phase: 0,
      spread: 20,
      count: 3,
      type: "sawtooth",
      partials: [],
      partialCount: 0
    }, s.default.FatOscillator.prototype._start = function (t) {
      t = this.toSeconds(t), this._forEach(function (e) {
        e.start(t);
      });
    }, s.default.FatOscillator.prototype._stop = function (t) {
      t = this.toSeconds(t), this._forEach(function (e) {
        e.stop(t);
      });
    }, s.default.FatOscillator.prototype.restart = function (t) {
      t = this.toSeconds(t), this._forEach(function (e) {
        e.restart(t);
      });
    }, s.default.FatOscillator.prototype._forEach = function (t) {
      for (var e = 0; e < this._oscillators.length; e++) t.call(this, this._oscillators[e], e);
    }, Object.defineProperty(s.default.FatOscillator.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        this._type = t, this._forEach(function (e) {
          e.type = t;
        });
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "spread", {
      get: function () {
        return this._spread;
      },
      set: function (t) {
        if (this._spread = t, this._oscillators.length > 1) {
          var e = -t / 2,
              i = t / (this._oscillators.length - 1);

          this._forEach(function (t, s) {
            t.detune.value = e + i * s;
          });
        }
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "count", {
      get: function () {
        return this._oscillators.length;
      },
      set: function (t) {
        if (t = Math.max(t, 1), this._oscillators.length !== t) {
          this._forEach(function (t) {
            t.dispose();
          }), this._oscillators = [];

          for (var e = 0; e < t; e++) {
            var i = new s.default.Oscillator();
            this.type === s.default.Oscillator.Type.Custom ? i.partials = this._partials : i.type = this._type, i.partialCount = this._partialCount, i.phase = this._phase + e / t * 360, i.volume.value = -6 - 1.1 * t, this.frequency.connect(i.frequency), this.detune.connect(i.detune), i.connect(this.output), this._oscillators[e] = i;
          }

          this.spread = this._spread, this.state === s.default.State.Started && this._forEach(function (t) {
            t.start();
          });
        }
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "phase", {
      get: function () {
        return this._phase;
      },
      set: function (t) {
        this._phase = t, this._forEach(function (e) {
          e.phase = t;
        });
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "baseType", {
      get: function () {
        return this._oscillators[0].baseType;
      },
      set: function (t) {
        this._forEach(function (e) {
          e.baseType = t;
        }), this._type = this._oscillators[0].type;
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "partials", {
      get: function () {
        return this._oscillators[0].partials;
      },
      set: function (t) {
        this._partials = t, this._type = s.default.Oscillator.Type.Custom, this._forEach(function (e) {
          e.partials = t;
        });
      }
    }), Object.defineProperty(s.default.FatOscillator.prototype, "partialCount", {
      get: function () {
        return this._oscillators[0].partialCount;
      },
      set: function (t) {
        this._partialCount = t, this._forEach(function (e) {
          e.partialCount = t;
        }), this._type = this._oscillators[0].type;
      }
    }), s.default.FatOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._forEach(function (t) {
        t.dispose();
      }), this._oscillators = null, this._partials = null, this;
    }, e.default = s.default.FatOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(17), i(5), i(3), i(22);
    s.default.AMOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "type", "modulationType"], s.default.AMOscillator);
      s.default.Source.call(this, t), this._carrier = new s.default.Oscillator(t.frequency, t.type), this.frequency = this._carrier.frequency, this.detune = this._carrier.detune, this.detune.value = t.detune, this._modulator = new s.default.Oscillator(t.frequency, t.modulationType), this._modulationScale = new s.default.AudioToGain(), this.harmonicity = new s.default.Multiply(t.harmonicity), this.harmonicity.units = s.default.Type.Positive, this._modulationNode = new s.default.Gain(0), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.connect(this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this.phase = t.phase, this._readOnly(["frequency", "detune", "harmonicity"]);
    }, s.default.extend(s.default.AMOscillator, s.default.Oscillator), s.default.AMOscillator.defaults = {
      frequency: 440,
      detune: 0,
      phase: 0,
      type: "sine",
      modulationType: "square",
      harmonicity: 1
    }, s.default.AMOscillator.prototype._start = function (t) {
      this._modulator.start(t), this._carrier.start(t);
    }, s.default.AMOscillator.prototype._stop = function (t) {
      this._modulator.stop(t), this._carrier.stop(t);
    }, s.default.AMOscillator.prototype.restart = function (t) {
      this._modulator.restart(t), this._carrier.restart(t);
    }, Object.defineProperty(s.default.AMOscillator.prototype, "type", {
      get: function () {
        return this._carrier.type;
      },
      set: function (t) {
        this._carrier.type = t;
      }
    }), Object.defineProperty(s.default.AMOscillator.prototype, "baseType", {
      get: function () {
        return this._carrier.baseType;
      },
      set: function (t) {
        this._carrier.baseType = t;
      }
    }), Object.defineProperty(s.default.AMOscillator.prototype, "partialCount", {
      get: function () {
        return this._carrier.partialCount;
      },
      set: function (t) {
        this._carrier.partialCount = t;
      }
    }), Object.defineProperty(s.default.AMOscillator.prototype, "modulationType", {
      get: function () {
        return this._modulator.type;
      },
      set: function (t) {
        this._modulator.type = t;
      }
    }), Object.defineProperty(s.default.AMOscillator.prototype, "phase", {
      get: function () {
        return this._carrier.phase;
      },
      set: function (t) {
        this._carrier.phase = t, this._modulator.phase = t;
      }
    }), Object.defineProperty(s.default.AMOscillator.prototype, "partials", {
      get: function () {
        return this._carrier.partials;
      },
      set: function (t) {
        this._carrier.partials = t;
      }
    }), s.default.AMOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._writable(["frequency", "detune", "harmonicity"]), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this._modulationScale.dispose(), this._modulationScale = null, this;
    }, e.default = s.default.AMOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(50), i(17), i(5);
    s.default.PWMOscillator = function () {
      var t = s.default.defaults(arguments, ["frequency", "modulationFrequency"], s.default.PWMOscillator);
      s.default.Source.call(this, t), this._pulse = new s.default.PulseOscillator(t.modulationFrequency), this._pulse._sawtooth.type = "sine", this._modulator = new s.default.Oscillator({
        frequency: t.frequency,
        detune: t.detune,
        phase: t.phase
      }), this._scale = new s.default.Multiply(2), this.frequency = this._modulator.frequency, this.detune = this._modulator.detune, this.modulationFrequency = this._pulse.frequency, this._modulator.chain(this._scale, this._pulse.width), this._pulse.connect(this.output), this._readOnly(["modulationFrequency", "frequency", "detune"]);
    }, s.default.extend(s.default.PWMOscillator, s.default.Source), s.default.PWMOscillator.defaults = {
      frequency: 440,
      detune: 0,
      phase: 0,
      modulationFrequency: .4
    }, s.default.PWMOscillator.prototype._start = function (t) {
      t = this.toSeconds(t), this._modulator.start(t), this._pulse.start(t);
    }, s.default.PWMOscillator.prototype._stop = function (t) {
      t = this.toSeconds(t), this._modulator.stop(t), this._pulse.stop(t);
    }, s.default.PWMOscillator.prototype.restart = function (t) {
      this._modulator.restart(t), this._pulse.restart(t);
    }, Object.defineProperty(s.default.PWMOscillator.prototype, "type", {
      get: function () {
        return "pwm";
      }
    }), Object.defineProperty(s.default.PWMOscillator.prototype, "baseType", {
      get: function () {
        return "pwm";
      }
    }), Object.defineProperty(s.default.PWMOscillator.prototype, "partials", {
      get: function () {
        return [];
      }
    }), Object.defineProperty(s.default.PWMOscillator.prototype, "phase", {
      get: function () {
        return this._modulator.phase;
      },
      set: function (t) {
        this._modulator.phase = t;
      }
    }), s.default.PWMOscillator.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this._pulse.dispose(), this._pulse = null, this._scale.dispose(), this._scale = null, this._modulator.dispose(), this._modulator = null, this._writable(["modulationFrequency", "frequency", "detune"]), this.frequency = null, this.detune = null, this.modulationFrequency = null, this;
    }, e.default = s.default.PWMOscillator;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(51), i(4), i(16);
    s.default.Part = function () {
      var t = s.default.defaults(arguments, ["callback", "events"], s.default.Part);
      s.default.Event.call(this, t), this._events = [];

      for (var e = 0; e < t.events.length; e++) Array.isArray(t.events[e]) ? this.add(t.events[e][0], t.events[e][1]) : this.add(t.events[e]);
    }, s.default.extend(s.default.Part, s.default.Event), s.default.Part.defaults = {
      callback: s.default.noOp,
      loop: !1,
      loopEnd: "1m",
      loopStart: 0,
      playbackRate: 1,
      probability: 1,
      humanize: !1,
      mute: !1,
      events: []
    }, s.default.Part.prototype.start = function (t, e) {
      var i = this.toTicks(t);
      return this._state.getValueAtTime(i) !== s.default.State.Started && (e = this._loop ? s.default.defaultArg(e, this._loopStart) : s.default.defaultArg(e, 0), e = this.toTicks(e), this._state.add({
        state: s.default.State.Started,
        time: i,
        offset: e
      }), this._forEach(function (t) {
        this._startNote(t, i, e);
      })), this;
    }, s.default.Part.prototype._startNote = function (t, e, i) {
      e -= i, this._loop ? t.startOffset >= this._loopStart && t.startOffset < this._loopEnd ? (t.startOffset < i && (e += this._getLoopDuration()), t.start(s.default.Ticks(e))) : t.startOffset < this._loopStart && t.startOffset >= i && (t.loop = !1, t.start(s.default.Ticks(e))) : t.startOffset >= i && t.start(s.default.Ticks(e));
    }, Object.defineProperty(s.default.Part.prototype, "startOffset", {
      get: function () {
        return this._startOffset;
      },
      set: function (t) {
        this._startOffset = t, this._forEach(function (t) {
          t.startOffset += this._startOffset;
        });
      }
    }), s.default.Part.prototype.stop = function (t) {
      var e = this.toTicks(t);
      return this._state.cancel(e), this._state.setStateAtTime(s.default.State.Stopped, e), this._forEach(function (e) {
        e.stop(t);
      }), this;
    }, s.default.Part.prototype.at = function (t, e) {
      t = s.default.TransportTime(t);

      for (var i = s.default.Ticks(1).toSeconds(), n = 0; n < this._events.length; n++) {
        var o = this._events[n];
        if (Math.abs(t.toTicks() - o.startOffset) < i) return s.default.isDefined(e) && (o.value = e), o;
      }

      return s.default.isDefined(e) ? (this.add(t, e), this._events[this._events.length - 1]) : null;
    }, s.default.Part.prototype.add = function (t, e) {
      var i;
      return t.hasOwnProperty("time") && (t = (e = t).time), t = this.toTicks(t), e instanceof s.default.Event ? (i = e).callback = this._tick.bind(this) : i = new s.default.Event({
        callback: this._tick.bind(this),
        value: e
      }), i.startOffset = t, i.set({
        loopEnd: this.loopEnd,
        loopStart: this.loopStart,
        loop: this.loop,
        humanize: this.humanize,
        playbackRate: this.playbackRate,
        probability: this.probability
      }), this._events.push(i), this._restartEvent(i), this;
    }, s.default.Part.prototype._restartEvent = function (t) {
      this._state.forEach(function (e) {
        e.state === s.default.State.Started ? this._startNote(t, e.time, e.offset) : t.stop(s.default.Ticks(e.time));
      }.bind(this));
    }, s.default.Part.prototype.remove = function (t, e) {
      t.hasOwnProperty("time") && (t = (e = t).time), t = this.toTicks(t);

      for (var i = this._events.length - 1; i >= 0; i--) {
        var n = this._events[i];
        n.startOffset === t && (s.default.isUndef(e) || s.default.isDefined(e) && n.value === e) && (this._events.splice(i, 1), n.dispose());
      }

      return this;
    }, s.default.Part.prototype.removeAll = function () {
      return this._forEach(function (t) {
        t.dispose();
      }), this._events = [], this;
    }, s.default.Part.prototype.cancel = function (t) {
      return this._forEach(function (e) {
        e.cancel(t);
      }), this._state.cancel(this.toTicks(t)), this;
    }, s.default.Part.prototype._forEach = function (t, e) {
      if (this._events) {
        e = s.default.defaultArg(e, this);

        for (var i = this._events.length - 1; i >= 0; i--) {
          var n = this._events[i];
          n instanceof s.default.Part ? n._forEach(t, e) : t.call(e, n);
        }
      }

      return this;
    }, s.default.Part.prototype._setAll = function (t, e) {
      this._forEach(function (i) {
        i[t] = e;
      });
    }, s.default.Part.prototype._tick = function (t, e) {
      this.mute || this.callback(t, e);
    }, s.default.Part.prototype._testLoopBoundries = function (t) {
      this._loop && (t.startOffset < this._loopStart || t.startOffset >= this._loopEnd) ? t.cancel(0) : t.state === s.default.State.Stopped && this._restartEvent(t);
    }, Object.defineProperty(s.default.Part.prototype, "probability", {
      get: function () {
        return this._probability;
      },
      set: function (t) {
        this._probability = t, this._setAll("probability", t);
      }
    }), Object.defineProperty(s.default.Part.prototype, "humanize", {
      get: function () {
        return this._humanize;
      },
      set: function (t) {
        this._humanize = t, this._setAll("humanize", t);
      }
    }), Object.defineProperty(s.default.Part.prototype, "loop", {
      get: function () {
        return this._loop;
      },
      set: function (t) {
        this._loop = t, this._forEach(function (e) {
          e._loopStart = this._loopStart, e._loopEnd = this._loopEnd, e.loop = t, this._testLoopBoundries(e);
        });
      }
    }), Object.defineProperty(s.default.Part.prototype, "loopEnd", {
      get: function () {
        return s.default.Ticks(this._loopEnd).toSeconds();
      },
      set: function (t) {
        this._loopEnd = this.toTicks(t), this._loop && this._forEach(function (e) {
          e.loopEnd = t, this._testLoopBoundries(e);
        });
      }
    }), Object.defineProperty(s.default.Part.prototype, "loopStart", {
      get: function () {
        return s.default.Ticks(this._loopStart).toSeconds();
      },
      set: function (t) {
        this._loopStart = this.toTicks(t), this._loop && this._forEach(function (t) {
          t.loopStart = this.loopStart, this._testLoopBoundries(t);
        });
      }
    }), Object.defineProperty(s.default.Part.prototype, "playbackRate", {
      get: function () {
        return this._playbackRate;
      },
      set: function (t) {
        this._playbackRate = t, this._setAll("playbackRate", t);
      }
    }), Object.defineProperty(s.default.Part.prototype, "length", {
      get: function () {
        return this._events.length;
      }
    }), s.default.Part.prototype.dispose = function () {
      return s.default.Event.prototype.dispose.call(this), this.removeAll(), this.callback = null, this._events = null, this;
    }, e.default = s.default.Part;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(51);
    s.default.Loop = function () {
      var t = s.default.defaults(arguments, ["callback", "interval"], s.default.Loop);
      s.default.call(this), this._event = new s.default.Event({
        callback: this._tick.bind(this),
        loop: !0,
        loopEnd: t.interval,
        playbackRate: t.playbackRate,
        probability: t.probability
      }), this.callback = t.callback, this.iterations = t.iterations;
    }, s.default.extend(s.default.Loop), s.default.Loop.defaults = {
      interval: "4n",
      callback: s.default.noOp,
      playbackRate: 1,
      iterations: 1 / 0,
      probability: !0,
      mute: !1
    }, s.default.Loop.prototype.start = function (t) {
      return this._event.start(t), this;
    }, s.default.Loop.prototype.stop = function (t) {
      return this._event.stop(t), this;
    }, s.default.Loop.prototype.cancel = function (t) {
      return this._event.cancel(t), this;
    }, s.default.Loop.prototype._tick = function (t) {
      this.callback(t);
    }, Object.defineProperty(s.default.Loop.prototype, "state", {
      get: function () {
        return this._event.state;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "progress", {
      get: function () {
        return this._event.progress;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "interval", {
      get: function () {
        return this._event.loopEnd;
      },
      set: function (t) {
        this._event.loopEnd = t;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "playbackRate", {
      get: function () {
        return this._event.playbackRate;
      },
      set: function (t) {
        this._event.playbackRate = t;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "humanize", {
      get: function () {
        return this._event.humanize;
      },
      set: function (t) {
        this._event.humanize = t;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "probability", {
      get: function () {
        return this._event.probability;
      },
      set: function (t) {
        this._event.probability = t;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "mute", {
      get: function () {
        return this._event.mute;
      },
      set: function (t) {
        this._event.mute = t;
      }
    }), Object.defineProperty(s.default.Loop.prototype, "iterations", {
      get: function () {
        return !0 === this._event.loop ? 1 / 0 : this._event.loop;
      },
      set: function (t) {
        this._event.loop = t === 1 / 0 || t;
      }
    }), s.default.Loop.prototype.dispose = function () {
      this._event.dispose(), this._event = null, this.callback = null;
    }, e.default = s.default.Loop;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(15), i(33);
    s.default.StereoXFeedbackEffect = function () {
      var t = s.default.defaults(arguments, ["feedback"], s.default.FeedbackEffect);
      s.default.StereoEffect.call(this, t), this.feedback = new s.default.Signal(t.feedback, s.default.Type.NormalRange), this._feedbackLR = new s.default.Gain(), this._feedbackRL = new s.default.Gain(), this.effectReturnL.chain(this._feedbackLR, this.effectSendR), this.effectReturnR.chain(this._feedbackRL, this.effectSendL), this.feedback.fan(this._feedbackLR.gain, this._feedbackRL.gain), this._readOnly(["feedback"]);
    }, s.default.extend(s.default.StereoXFeedbackEffect, s.default.StereoEffect), s.default.StereoXFeedbackEffect.prototype.dispose = function () {
      return s.default.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackLR.dispose(), this._feedbackLR = null, this._feedbackRL.dispose(), this._feedbackRL = null, this;
    }, e.default = s.default.StereoXFeedbackEffect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(53), i(52);
    s.default.MidSideEffect = function () {
      s.default.Effect.apply(this, arguments), this._midSideSplit = new s.default.MidSideSplit(), this._midSideMerge = new s.default.MidSideMerge(), this.midSend = this._midSideSplit.mid, this.sideSend = this._midSideSplit.side, this.midReturn = this._midSideMerge.mid, this.sideReturn = this._midSideMerge.side, this.effectSend.connect(this._midSideSplit), this._midSideMerge.connect(this.effectReturn);
    }, s.default.extend(s.default.MidSideEffect, s.default.Effect), s.default.MidSideEffect.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this.midSend = null, this.sideSend = null, this.midReturn = null, this.sideReturn = null, this;
    }, e.default = s.default.MidSideEffect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(11), i(8);
    s.default.Convolver = function () {
      var t = s.default.defaults(arguments, ["url", "onload"], s.default.Convolver);
      s.default.Effect.call(this, t), this._convolver = this.context.createConvolver(), this._buffer = new s.default.Buffer(t.url, function (e) {
        this.buffer = e.get(), t.onload();
      }.bind(this)), this._buffer.loaded && (this.buffer = this._buffer), this.normalize = t.normalize, this.connectEffect(this._convolver);
    }, s.default.extend(s.default.Convolver, s.default.Effect), s.default.Convolver.defaults = {
      onload: s.default.noOp,
      normalize: !0
    }, Object.defineProperty(s.default.Convolver.prototype, "buffer", {
      get: function () {
        return this._buffer.length ? this._buffer : null;
      },
      set: function (t) {
        this._buffer.set(t), this._convolver.buffer && (this.effectSend.disconnect(), this._convolver.disconnect(), this._convolver = this.context.createConvolver(), this.connectEffect(this._convolver)), this._convolver.buffer = this._buffer.get();
      }
    }), Object.defineProperty(s.default.Convolver.prototype, "normalize", {
      get: function () {
        return this._convolver.normalize;
      },
      set: function (t) {
        this._convolver.normalize = t;
      }
    }), s.default.Convolver.prototype.load = function (t, e) {
      return this._buffer.load(t, function (t) {
        this.buffer = t, e && e();
      }.bind(this));
    }, s.default.Convolver.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._buffer.dispose(), this._buffer = null, this._convolver.disconnect(), this._convolver = null, this;
    }, e.default = s.default.Convolver;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7), i(5), i(13);
    s.default.Modulo = function (t) {
      s.default.SignalBase.call(this), this.createInsOuts(1, 0), this._shaper = new s.default.WaveShaper(Math.pow(2, 16)), this._multiply = new s.default.Multiply(), this._subtract = this.output = new s.default.Subtract(), this._modSignal = new s.default.Signal(t), s.default.connect(this.input, this._shaper), s.default.connect(this.input, this._subtract), this._modSignal.connect(this._multiply, 0, 0), this._shaper.connect(this._multiply, 0, 1), this._multiply.connect(this._subtract, 0, 1), this._setWaveShaper(t);
    }, s.default.extend(s.default.Modulo, s.default.SignalBase), s.default.Modulo.prototype._setWaveShaper = function (t) {
      this._shaper.setMap(function (e) {
        return Math.floor((e + 1e-4) / t);
      });
    }, Object.defineProperty(s.default.Modulo.prototype, "value", {
      get: function () {
        return this._modSignal.value;
      },
      set: function (t) {
        this._modSignal.value = t, this._setWaveShaper(t);
      }
    }), s.default.Modulo.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this._multiply.dispose(), this._multiply = null, this._subtract.dispose(), this._subtract = null, this._modSignal.dispose(), this._modSignal = null, this;
    }, e.default = s.default.Modulo;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(20), i(92);
    s.default.OfflineContext = function (t, e, i) {
      var n = new OfflineAudioContext(t, e * i, i);
      s.default.Context.call(this, {
        context: n,
        clockSource: "offline",
        lookAhead: 0,
        updateInterval: 128 / i
      }), this._duration = e, this._currentTime = 0;
    }, s.default.extend(s.default.OfflineContext, s.default.Context), s.default.OfflineContext.prototype.now = function () {
      return this._currentTime;
    }, s.default.OfflineContext.prototype.resume = function () {
      return Promise.resolve();
    }, s.default.OfflineContext.prototype.render = function () {
      for (; this._duration - this._currentTime >= 0;) this.emit("tick"), this._currentTime += .005;

      return this._context.startRendering();
    }, s.default.OfflineContext.prototype.close = function () {
      return this._context = null, Promise.resolve();
    }, e.default = s.default.OfflineContext;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(16), i(11), i(76), i(40);
    s.default.Offline = function (t, e) {
      var i = s.default.context.sampleRate,
          n = s.default.context,
          o = new s.default.OfflineContext(2, e, i);
      s.default.context = o;
      var a = t(s.default.Transport),
          r = null;
      return r = a && s.default.isFunction(a.then) ? a.then(function () {
        return o.render();
      }) : o.render(), s.default.context = n, r.then(function (t) {
        return new s.default.Buffer(t);
      });
    }, e.default = s.default.Offline;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(11);
    s.default.Buffers = function (t) {
      var e = Array.prototype.slice.call(arguments);
      e.shift();
      var i = s.default.defaults(e, ["onload", "baseUrl"], s.default.Buffers);

      for (var n in s.default.call(this), this._buffers = {}, this.baseUrl = i.baseUrl, this._loadingCount = 0, t) this._loadingCount++, this.add(n, t[n], this._bufferLoaded.bind(this, i.onload));
    }, s.default.extend(s.default.Buffers), s.default.Buffers.defaults = {
      onload: s.default.noOp,
      baseUrl: ""
    }, s.default.Buffers.prototype.has = function (t) {
      return this._buffers.hasOwnProperty(t);
    }, s.default.Buffers.prototype.get = function (t) {
      if (this.has(t)) return this._buffers[t];
      throw new Error("Tone.Buffers: no buffer named " + t);
    }, s.default.Buffers.prototype._bufferLoaded = function (t) {
      this._loadingCount--, 0 === this._loadingCount && t && t(this);
    }, Object.defineProperty(s.default.Buffers.prototype, "loaded", {
      get: function () {
        var t = !0;

        for (var e in this._buffers) {
          var i = this.get(e);
          t = t && i.loaded;
        }

        return t;
      }
    }), s.default.Buffers.prototype.add = function (t, e, i) {
      return i = s.default.defaultArg(i, s.default.noOp), e instanceof s.default.Buffer ? (this._buffers[t] = e, i(this)) : e instanceof AudioBuffer ? (this._buffers[t] = new s.default.Buffer(e), i(this)) : s.default.isString(e) && (this._buffers[t] = new s.default.Buffer(this.baseUrl + e, i)), this;
    }, s.default.Buffers.prototype.dispose = function () {
      for (var t in s.default.prototype.dispose.call(this), this._buffers) this._buffers[t].dispose();

      return this._buffers = null, this;
    }, e.default = s.default.Buffers;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    s.default.CtrlPattern = function () {
      var t = s.default.defaults(arguments, ["values", "type"], s.default.CtrlPattern);
      s.default.call(this), this.values = t.values, this.index = 0, this._type = null, this._shuffled = null, this._direction = null, this.type = t.type;
    }, s.default.extend(s.default.CtrlPattern), s.default.CtrlPattern.Type = {
      Up: "up",
      Down: "down",
      UpDown: "upDown",
      DownUp: "downUp",
      AlternateUp: "alternateUp",
      AlternateDown: "alternateDown",
      Random: "random",
      RandomWalk: "randomWalk",
      RandomOnce: "randomOnce"
    }, s.default.CtrlPattern.defaults = {
      type: s.default.CtrlPattern.Type.Up,
      values: []
    }, Object.defineProperty(s.default.CtrlPattern.prototype, "value", {
      get: function () {
        if (0 !== this.values.length) {
          if (1 === this.values.length) return this.values[0];
          this.index = Math.min(this.index, this.values.length - 1);
          var t = this.values[this.index];
          return this.type === s.default.CtrlPattern.Type.RandomOnce && (this.values.length !== this._shuffled.length && this._shuffleValues(), t = this.values[this._shuffled[this.index]]), t;
        }
      }
    }), Object.defineProperty(s.default.CtrlPattern.prototype, "type", {
      get: function () {
        return this._type;
      },
      set: function (t) {
        this._type = t, this._shuffled = null, this._type === s.default.CtrlPattern.Type.Up || this._type === s.default.CtrlPattern.Type.UpDown || this._type === s.default.CtrlPattern.Type.RandomOnce || this._type === s.default.CtrlPattern.Type.AlternateUp ? this.index = 0 : this._type !== s.default.CtrlPattern.Type.Down && this._type !== s.default.CtrlPattern.Type.DownUp && this._type !== s.default.CtrlPattern.Type.AlternateDown || (this.index = this.values.length - 1), this._type === s.default.CtrlPattern.Type.UpDown || this._type === s.default.CtrlPattern.Type.AlternateUp ? this._direction = s.default.CtrlPattern.Type.Up : this._type !== s.default.CtrlPattern.Type.DownUp && this._type !== s.default.CtrlPattern.Type.AlternateDown || (this._direction = s.default.CtrlPattern.Type.Down), this._type === s.default.CtrlPattern.Type.RandomOnce ? this._shuffleValues() : this._type === s.default.CtrlPattern.Type.Random && (this.index = Math.floor(Math.random() * this.values.length));
      }
    }), s.default.CtrlPattern.prototype.next = function () {
      var t = this.type;
      return t === s.default.CtrlPattern.Type.Up ? (this.index++, this.index >= this.values.length && (this.index = 0)) : t === s.default.CtrlPattern.Type.Down ? (this.index--, this.index < 0 && (this.index = this.values.length - 1)) : t === s.default.CtrlPattern.Type.UpDown || t === s.default.CtrlPattern.Type.DownUp ? (this._direction === s.default.CtrlPattern.Type.Up ? this.index++ : this.index--, this.index < 0 ? (this.index = 1, this._direction = s.default.CtrlPattern.Type.Up) : this.index >= this.values.length && (this.index = this.values.length - 2, this._direction = s.default.CtrlPattern.Type.Down)) : t === s.default.CtrlPattern.Type.Random ? this.index = Math.floor(Math.random() * this.values.length) : t === s.default.CtrlPattern.Type.RandomWalk ? Math.random() < .5 ? (this.index--, this.index = Math.max(this.index, 0)) : (this.index++, this.index = Math.min(this.index, this.values.length - 1)) : t === s.default.CtrlPattern.Type.RandomOnce ? (this.index++, this.index >= this.values.length && (this.index = 0, this._shuffleValues())) : t === s.default.CtrlPattern.Type.AlternateUp ? (this._direction === s.default.CtrlPattern.Type.Up ? (this.index += 2, this._direction = s.default.CtrlPattern.Type.Down) : (this.index -= 1, this._direction = s.default.CtrlPattern.Type.Up), this.index >= this.values.length && (this.index = 0, this._direction = s.default.CtrlPattern.Type.Up)) : t === s.default.CtrlPattern.Type.AlternateDown && (this._direction === s.default.CtrlPattern.Type.Up ? (this.index += 1, this._direction = s.default.CtrlPattern.Type.Down) : (this.index -= 2, this._direction = s.default.CtrlPattern.Type.Up), this.index < 0 && (this.index = this.values.length - 1, this._direction = s.default.CtrlPattern.Type.Down)), this.value;
    }, s.default.CtrlPattern.prototype._shuffleValues = function () {
      var t = [];
      this._shuffled = [];

      for (var e = 0; e < this.values.length; e++) t[e] = e;

      for (; t.length > 0;) {
        var i = t.splice(Math.floor(t.length * Math.random()), 1);

        this._shuffled.push(i[0]);
      }
    }, s.default.CtrlPattern.prototype.dispose = function () {
      this._shuffled = null, this.values = null;
    }, e.default = s.default.CtrlPattern;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(56), i(55);
    s.default.TransportRepeatEvent = function (t, e) {
      s.default.TransportEvent.call(this, t, e), e = s.default.defaultArg(e, s.default.TransportRepeatEvent.defaults), this.duration = s.default.Ticks(e.duration), this._interval = s.default.Ticks(e.interval), this._currentId = -1, this._nextId = -1, this._nextTick = this.time, this._boundRestart = this._restart.bind(this), this.Transport.on("start loopStart", this._boundRestart), this._restart();
    }, s.default.extend(s.default.TransportRepeatEvent, s.default.TransportEvent), s.default.TransportRepeatEvent.defaults = {
      duration: 1 / 0,
      interval: 1
    }, s.default.TransportRepeatEvent.prototype.invoke = function (t) {
      this._createEvents(t), s.default.TransportEvent.prototype.invoke.call(this, t);
    }, s.default.TransportRepeatEvent.prototype._createEvents = function (t) {
      var e = this.Transport.getTicksAtTime(t);
      e >= this.time && e >= this._nextTick && this._nextTick + this._interval < this.time + this.duration && (this._nextTick += this._interval, this._currentId = this._nextId, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), s.default.Ticks(this._nextTick)));
    }, s.default.TransportRepeatEvent.prototype._restart = function (t) {
      this.Transport.clear(this._currentId), this.Transport.clear(this._nextId), this._nextTick = this.time;
      var e = this.Transport.getTicksAtTime(t);
      e > this.time && (this._nextTick = this.time + Math.ceil((e - this.time) / this._interval) * this._interval), this._currentId = this.Transport.scheduleOnce(this.invoke.bind(this), s.default.Ticks(this._nextTick)), this._nextTick += this._interval, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), s.default.Ticks(this._nextTick));
    }, s.default.TransportRepeatEvent.prototype.dispose = function () {
      return this.Transport.clear(this._currentId), this.Transport.clear(this._nextId), this.Transport.off("start loopStart", this._boundRestart), this._boundCreateEvents = null, s.default.TransportEvent.prototype.dispose.call(this), this.duration = null, this._interval = null, this;
    }, e.default = s.default.TransportRepeatEvent;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4);
    s.default.IntervalTimeline = function () {
      s.default.call(this), this._root = null, this._length = 0;
    }, s.default.extend(s.default.IntervalTimeline), s.default.IntervalTimeline.prototype.add = function (t) {
      if (s.default.isUndef(t.time) || s.default.isUndef(t.duration)) throw new Error("Tone.IntervalTimeline: events must have time and duration parameters");
      t.time = t.time.valueOf();
      var e = new n(t.time, t.time + t.duration, t);

      for (null === this._root ? this._root = e : this._root.insert(e), this._length++; null !== e;) e.updateHeight(), e.updateMax(), this._rebalance(e), e = e.parent;

      return this;
    }, s.default.IntervalTimeline.prototype.remove = function (t) {
      if (null !== this._root) {
        var e = [];

        this._root.search(t.time, e);

        for (var i = 0; i < e.length; i++) {
          var s = e[i];

          if (s.event === t) {
            this._removeNode(s), this._length--;
            break;
          }
        }
      }

      return this;
    }, Object.defineProperty(s.default.IntervalTimeline.prototype, "length", {
      get: function () {
        return this._length;
      }
    }), s.default.IntervalTimeline.prototype.cancel = function (t) {
      return this.forEachFrom(t, function (t) {
        this.remove(t);
      }.bind(this)), this;
    }, s.default.IntervalTimeline.prototype._setRoot = function (t) {
      this._root = t, null !== this._root && (this._root.parent = null);
    }, s.default.IntervalTimeline.prototype._replaceNodeInParent = function (t, e) {
      null !== t.parent ? (t.isLeftChild() ? t.parent.left = e : t.parent.right = e, this._rebalance(t.parent)) : this._setRoot(e);
    }, s.default.IntervalTimeline.prototype._removeNode = function (t) {
      if (null === t.left && null === t.right) this._replaceNodeInParent(t, null);else if (null === t.right) this._replaceNodeInParent(t, t.left);else if (null === t.left) this._replaceNodeInParent(t, t.right);else {
        var e, i;
        if (t.getBalance() > 0) {
          if (null === t.left.right) (e = t.left).right = t.right, i = e;else {
            for (e = t.left.right; null !== e.right;) e = e.right;

            e.parent.right = e.left, i = e.parent, e.left = t.left, e.right = t.right;
          }
        } else if (null === t.right.left) (e = t.right).left = t.left, i = e;else {
          for (e = t.right.left; null !== e.left;) e = e.left;

          e.parent.left = e.right, i = e.parent, e.left = t.left, e.right = t.right;
        }
        null !== t.parent ? t.isLeftChild() ? t.parent.left = e : t.parent.right = e : this._setRoot(e), this._rebalance(i);
      }
      t.dispose();
    }, s.default.IntervalTimeline.prototype._rotateLeft = function (t) {
      var e = t.parent,
          i = t.isLeftChild(),
          s = t.right;
      t.right = s.left, s.left = t, null !== e ? i ? e.left = s : e.right = s : this._setRoot(s);
    }, s.default.IntervalTimeline.prototype._rotateRight = function (t) {
      var e = t.parent,
          i = t.isLeftChild(),
          s = t.left;
      t.left = s.right, s.right = t, null !== e ? i ? e.left = s : e.right = s : this._setRoot(s);
    }, s.default.IntervalTimeline.prototype._rebalance = function (t) {
      var e = t.getBalance();
      e > 1 ? t.left.getBalance() < 0 ? this._rotateLeft(t.left) : this._rotateRight(t) : e < -1 && (t.right.getBalance() > 0 ? this._rotateRight(t.right) : this._rotateLeft(t));
    }, s.default.IntervalTimeline.prototype.get = function (t) {
      if (null !== this._root) {
        var e = [];

        if (this._root.search(t, e), e.length > 0) {
          for (var i = e[0], s = 1; s < e.length; s++) e[s].low > i.low && (i = e[s]);

          return i.event;
        }
      }

      return null;
    }, s.default.IntervalTimeline.prototype.forEach = function (t) {
      if (null !== this._root) {
        var e = [];

        this._root.traverse(function (t) {
          e.push(t);
        });

        for (var i = 0; i < e.length; i++) {
          var s = e[i].event;
          s && t(s);
        }
      }

      return this;
    }, s.default.IntervalTimeline.prototype.forEachAtTime = function (t, e) {
      if (null !== this._root) {
        var i = [];

        this._root.search(t, i);

        for (var s = i.length - 1; s >= 0; s--) {
          var n = i[s].event;
          n && e(n);
        }
      }

      return this;
    }, s.default.IntervalTimeline.prototype.forEachFrom = function (t, e) {
      if (null !== this._root) {
        var i = [];

        this._root.searchAfter(t, i);

        for (var s = i.length - 1; s >= 0; s--) {
          e(i[s].event);
        }
      }

      return this;
    }, s.default.IntervalTimeline.prototype.dispose = function () {
      var t = [];
      null !== this._root && this._root.traverse(function (e) {
        t.push(e);
      });

      for (var e = 0; e < t.length; e++) t[e].dispose();

      return t = null, this._root = null, this;
    };

    var n = function (t, e, i) {
      this.event = i, this.low = t, this.high = e, this.max = this.high, this._left = null, this._right = null, this.parent = null, this.height = 0;
    };

    n.prototype.insert = function (t) {
      t.low <= this.low ? null === this.left ? this.left = t : this.left.insert(t) : null === this.right ? this.right = t : this.right.insert(t);
    }, n.prototype.search = function (t, e) {
      t > this.max || (null !== this.left && this.left.search(t, e), this.low <= t && this.high > t && e.push(this), this.low > t || null !== this.right && this.right.search(t, e));
    }, n.prototype.searchAfter = function (t, e) {
      this.low >= t && (e.push(this), null !== this.left && this.left.searchAfter(t, e)), null !== this.right && this.right.searchAfter(t, e);
    }, n.prototype.traverse = function (t) {
      t(this), null !== this.left && this.left.traverse(t), null !== this.right && this.right.traverse(t);
    }, n.prototype.updateHeight = function () {
      null !== this.left && null !== this.right ? this.height = Math.max(this.left.height, this.right.height) + 1 : null !== this.right ? this.height = this.right.height + 1 : null !== this.left ? this.height = this.left.height + 1 : this.height = 0;
    }, n.prototype.updateMax = function () {
      this.max = this.high, null !== this.left && (this.max = Math.max(this.max, this.left.max)), null !== this.right && (this.max = Math.max(this.max, this.right.max));
    }, n.prototype.getBalance = function () {
      var t = 0;
      return null !== this.left && null !== this.right ? t = this.left.height - this.right.height : null !== this.left ? t = this.left.height + 1 : null !== this.right && (t = -(this.right.height + 1)), t;
    }, n.prototype.isLeftChild = function () {
      return null !== this.parent && this.parent.left === this;
    }, Object.defineProperty(n.prototype, "left", {
      get: function () {
        return this._left;
      },
      set: function (t) {
        this._left = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax();
      }
    }), Object.defineProperty(n.prototype, "right", {
      get: function () {
        return this._right;
      },
      set: function (t) {
        this._right = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax();
      }
    }), n.prototype.dispose = function () {
      this.parent = null, this._left = null, this._right = null, this.event = null;
    }, e.default = s.default.IntervalTimeline;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2);

    function n(t) {
      return function (e, i) {
        i = this.toSeconds(i), t.apply(this, arguments);

        var s = this._events.get(i),
            n = this._events.previousEvent(s),
            o = this._getTicksUntilEvent(n, i);

        return s.ticks = Math.max(o, 0), this;
      };
    }

    s.default.TickSignal = function (t) {
      t = s.default.defaultArg(t, 1), s.default.Signal.call(this, {
        units: s.default.Type.Ticks,
        value: t
      }), this._events.memory = 1 / 0, this.cancelScheduledValues(0), this._events.add({
        type: s.default.Param.AutomationType.SetValue,
        time: 0,
        value: t
      });
    }, s.default.extend(s.default.TickSignal, s.default.Signal), s.default.TickSignal.prototype.setValueAtTime = n(s.default.Signal.prototype.setValueAtTime), s.default.TickSignal.prototype.linearRampToValueAtTime = n(s.default.Signal.prototype.linearRampToValueAtTime), s.default.TickSignal.prototype.setTargetAtTime = function (t, e, i) {
      e = this.toSeconds(e), this.setRampPoint(e), t = this._fromUnits(t);

      for (var s = this._events.get(e), n = Math.round(Math.max(1 / i, 1)), o = 0; o <= n; o++) {
        var a = i * o + e,
            r = this._exponentialApproach(s.time, s.value, t, i, a);

        this.linearRampToValueAtTime(this._toUnits(r), a);
      }

      return this;
    }, s.default.TickSignal.prototype.exponentialRampToValueAtTime = function (t, e) {
      e = this.toSeconds(e), t = this._fromUnits(t);

      for (var i = this._events.get(e), s = Math.round(Math.max(10 * (e - i.time), 1)), n = (e - i.time) / s, o = 0; o <= s; o++) {
        var a = n * o + i.time,
            r = this._exponentialInterpolate(i.time, i.value, e, t, a);

        this.linearRampToValueAtTime(this._toUnits(r), a);
      }

      return this;
    }, s.default.TickSignal.prototype._getTicksUntilEvent = function (t, e) {
      if (null === t) t = {
        ticks: 0,
        time: 0
      };else if (s.default.isUndef(t.ticks)) {
        var i = this._events.previousEvent(t);

        t.ticks = this._getTicksUntilEvent(i, t.time);
      }
      var n = this.getValueAtTime(t.time),
          o = this.getValueAtTime(e);
      return this._events.get(e).time === e && this._events.get(e).type === s.default.Param.AutomationType.SetValue && (o = this.getValueAtTime(e - this.sampleTime)), .5 * (e - t.time) * (n + o) + t.ticks;
    }, s.default.TickSignal.prototype.getTicksAtTime = function (t) {
      t = this.toSeconds(t);

      var e = this._events.get(t);

      return Math.max(this._getTicksUntilEvent(e, t), 0);
    }, s.default.TickSignal.prototype.getDurationOfTicks = function (t, e) {
      e = this.toSeconds(e);
      var i = this.getTicksAtTime(e);
      return this.getTimeOfTick(i + t) - e;
    }, s.default.TickSignal.prototype.getTimeOfTick = function (t) {
      var e = this._events.get(t, "ticks"),
          i = this._events.getAfter(t, "ticks");

      if (e && e.ticks === t) return e.time;

      if (e && i && i.type === s.default.Param.AutomationType.Linear && e.value !== i.value) {
        var n = this.getValueAtTime(e.time),
            o = (this.getValueAtTime(i.time) - n) / (i.time - e.time),
            a = Math.sqrt(Math.pow(n, 2) - 2 * o * (e.ticks - t)),
            r = (-n + a) / o;
        return (r > 0 ? r : (-n - a) / o) + e.time;
      }

      return e ? 0 === e.value ? 1 / 0 : e.time + (t - e.ticks) / e.value : t / this._initialValue;
    }, s.default.TickSignal.prototype.ticksToTime = function (t, e) {
      return e = this.toSeconds(e), new s.default.Time(this.getDurationOfTicks(t, e));
    }, s.default.TickSignal.prototype.timeToTicks = function (t, e) {
      e = this.toSeconds(e), t = this.toSeconds(t);
      var i = this.getTicksAtTime(e),
          n = this.getTicksAtTime(e + t);
      return new s.default.Ticks(n - i);
    }, e.default = s.default.TickSignal;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(57), i(34), i(35), i(20);
    s.default.Clock = function () {
      var t = s.default.defaults(arguments, ["callback", "frequency"], s.default.Clock);
      s.default.Emitter.call(this), this.callback = t.callback, this._nextTick = 0, this._tickSource = new s.default.TickSource(t.frequency), this._lastUpdate = 0, this.frequency = this._tickSource.frequency, this._readOnly("frequency"), this._state = new s.default.TimelineState(s.default.State.Stopped), this._state.setStateAtTime(s.default.State.Stopped, 0), this._boundLoop = this._loop.bind(this), this.context.on("tick", this._boundLoop);
    }, s.default.extend(s.default.Clock, s.default.Emitter), s.default.Clock.defaults = {
      callback: s.default.noOp,
      frequency: 1
    }, Object.defineProperty(s.default.Clock.prototype, "state", {
      get: function () {
        return this._state.getValueAtTime(this.now());
      }
    }), s.default.Clock.prototype.start = function (t, e) {
      return this.context.resume(), t = this.toSeconds(t), this._state.getValueAtTime(t) !== s.default.State.Started && (this._state.setStateAtTime(s.default.State.Started, t), this._tickSource.start(t, e), t < this._lastUpdate && this.emit("start", t, e)), this;
    }, s.default.Clock.prototype.stop = function (t) {
      return t = this.toSeconds(t), this._state.cancel(t), this._state.setStateAtTime(s.default.State.Stopped, t), this._tickSource.stop(t), t < this._lastUpdate && this.emit("stop", t), this;
    }, s.default.Clock.prototype.pause = function (t) {
      return t = this.toSeconds(t), this._state.getValueAtTime(t) === s.default.State.Started && (this._state.setStateAtTime(s.default.State.Paused, t), this._tickSource.pause(t), t < this._lastUpdate && this.emit("pause", t)), this;
    }, Object.defineProperty(s.default.Clock.prototype, "ticks", {
      get: function () {
        return Math.ceil(this.getTicksAtTime(this.now()));
      },
      set: function (t) {
        this._tickSource.ticks = t;
      }
    }), Object.defineProperty(s.default.Clock.prototype, "seconds", {
      get: function () {
        return this._tickSource.seconds;
      },
      set: function (t) {
        this._tickSource.seconds = t;
      }
    }), s.default.Clock.prototype.getSecondsAtTime = function (t) {
      return this._tickSource.getSecondsAtTime(t);
    }, s.default.Clock.prototype.setTicksAtTime = function (t, e) {
      return this._tickSource.setTicksAtTime(t, e), this;
    }, s.default.Clock.prototype.getTicksAtTime = function (t) {
      return this._tickSource.getTicksAtTime(t);
    }, s.default.Clock.prototype.nextTickTime = function (t, e) {
      e = this.toSeconds(e);
      var i = this.getTicksAtTime(e);
      return this._tickSource.getTimeOfTick(i + t, e);
    }, s.default.Clock.prototype._loop = function () {
      var t = this._lastUpdate,
          e = this.now();
      this._lastUpdate = e, t !== e && (this._state.forEachBetween(t, e, function (t) {
        switch (t.state) {
          case s.default.State.Started:
            var e = this._tickSource.getTicksAtTime(t.time);

            this.emit("start", t.time, e);
            break;

          case s.default.State.Stopped:
            0 !== t.time && this.emit("stop", t.time);
            break;

          case s.default.State.Paused:
            this.emit("pause", t.time);
        }
      }.bind(this)), this._tickSource.forEachTickBetween(t, e, function (t, e) {
        this.callback(t, e);
      }.bind(this)));
    }, s.default.Clock.prototype.getStateAtTime = function (t) {
      return t = this.toSeconds(t), this._state.getValueAtTime(t);
    }, s.default.Clock.prototype.dispose = function () {
      s.default.Emitter.prototype.dispose.call(this), this.context.off("tick", this._boundLoop), this._writable("frequency"), this._tickSource.dispose(), this._tickSource = null, this.frequency = null, this._boundLoop = null, this._nextTick = 1 / 0, this.callback = null, this._state.dispose(), this._state = null;
    }, e.default = s.default.Clock;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(2), i(5), i(7);
    s.default.GreaterThanZero = function () {
      s.default.SignalBase.call(this), this._thresh = this.output = new s.default.WaveShaper(function (t) {
        return t <= 0 ? 0 : 1;
      }, 127), this._scale = this.input = new s.default.Multiply(1e4), this._scale.connect(this._thresh);
    }, s.default.extend(s.default.GreaterThanZero, s.default.SignalBase), s.default.GreaterThanZero.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._thresh.dispose(), this._thresh = null, this;
    }, e.default = s.default.GreaterThanZero;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(84), i(13), i(2);
    s.default.GreaterThan = function (t) {
      s.default.Signal.call(this), this.createInsOuts(2, 0), this._param = this.input[0] = new s.default.Subtract(t), this.input[1] = this._param.input[1], this._gtz = this.output = new s.default.GreaterThanZero(), this._param.connect(this._gtz);
    }, s.default.extend(s.default.GreaterThan, s.default.Signal), s.default.GreaterThan.prototype.dispose = function () {
      return s.default.Signal.prototype.dispose.call(this), this._gtz.dispose(), this._gtz = null, this;
    }, e.default = s.default.GreaterThan;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(47), i(26);
    s.default.ScaledEnvelope = function () {
      var t = s.default.defaults(arguments, ["attack", "decay", "sustain", "release"], s.default.Envelope);
      s.default.Envelope.call(this, t), t = s.default.defaultArg(t, s.default.ScaledEnvelope.defaults), this._exp = this.output = new s.default.Pow(t.exponent), this._scale = this.output = new s.default.Scale(t.min, t.max), this._sig.chain(this._exp, this._scale);
    }, s.default.extend(s.default.ScaledEnvelope, s.default.Envelope), s.default.ScaledEnvelope.defaults = {
      min: 0,
      max: 1,
      exponent: 1
    }, Object.defineProperty(s.default.ScaledEnvelope.prototype, "min", {
      get: function () {
        return this._scale.min;
      },
      set: function (t) {
        this._scale.min = t;
      }
    }), Object.defineProperty(s.default.ScaledEnvelope.prototype, "max", {
      get: function () {
        return this._scale.max;
      },
      set: function (t) {
        this._scale.max = t;
      }
    }), Object.defineProperty(s.default.ScaledEnvelope.prototype, "exponent", {
      get: function () {
        return this._exp.value;
      },
      set: function (t) {
        this._exp.value = t;
      }
    }), s.default.ScaledEnvelope.prototype.dispose = function () {
      return s.default.Envelope.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this;
    }, e.default = s.default.ScaledEnvelope;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7), i(30);
    s.default.Abs = function () {
      s.default.SignalBase.call(this), this._abs = this.input = this.output = new s.default.WaveShaper(function (t) {
        return Math.abs(t) < .001 ? 0 : Math.abs(t);
      }, 1024);
    }, s.default.extend(s.default.Abs, s.default.SignalBase), s.default.Abs.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._abs.dispose(), this._abs = null, this;
    }, e.default = s.default.Abs;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(3), i(1);
    s.default.Solo = function () {
      var t = s.default.defaults(arguments, ["solo"], s.default.Solo);
      s.default.AudioNode.call(this), this.input = this.output = new s.default.Gain(), this._soloBind = this._soloed.bind(this), this.context.on("solo", this._soloBind), this.solo = t.solo;
    }, s.default.extend(s.default.Solo, s.default.AudioNode), s.default.Solo.defaults = {
      solo: !1
    }, Object.defineProperty(s.default.Solo.prototype, "solo", {
      get: function () {
        return this._isSoloed();
      },
      set: function (t) {
        t ? this._addSolo() : this._removeSolo(), this.context.emit("solo", this);
      }
    }), Object.defineProperty(s.default.Solo.prototype, "muted", {
      get: function () {
        return 0 === this.input.gain.value;
      }
    }), s.default.Solo.prototype._addSolo = function () {
      s.default.isArray(this.context._currentSolo) || (this.context._currentSolo = []), this._isSoloed() || this.context._currentSolo.push(this);
    }, s.default.Solo.prototype._removeSolo = function () {
      if (this._isSoloed()) {
        var t = this.context._currentSolo.indexOf(this);

        this.context._currentSolo.splice(t, 1);
      }
    }, s.default.Solo.prototype._isSoloed = function () {
      return !!s.default.isArray(this.context._currentSolo) && 0 !== this.context._currentSolo.length && -1 !== this.context._currentSolo.indexOf(this);
    }, s.default.Solo.prototype._noSolos = function () {
      return !s.default.isArray(this.context._currentSolo) || 0 === this.context._currentSolo.length;
    }, s.default.Solo.prototype._soloed = function () {
      this._isSoloed() ? this.input.gain.value = 1 : this._noSolos() ? this.input.gain.value = 1 : this.input.gain.value = 0;
    }, s.default.Solo.prototype.dispose = function () {
      return this.context.off("solo", this._soloBind), this._removeSolo(), this._soloBind = null, s.default.AudioNode.prototype.dispose.call(this), this;
    }, e.default = s.default.Solo;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7);
    s.default.EqualPowerGain = function () {
      s.default.SignalBase.call(this), this._eqPower = this.input = this.output = new s.default.WaveShaper(function (t) {
        return Math.abs(t) < .001 ? 0 : s.default.equalPowerScale(t);
      }.bind(this), 4096);
    }, s.default.extend(s.default.EqualPowerGain, s.default.SignalBase), s.default.EqualPowerGain.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._eqPower.dispose(), this._eqPower = null, this;
    }, e.default = s.default.EqualPowerGain;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(5), i(2);
    s.default.Negate = function () {
      s.default.SignalBase.call(this), this._multiply = this.input = this.output = new s.default.Multiply(-1);
    }, s.default.extend(s.default.Negate, s.default.SignalBase), s.default.Negate.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._multiply.dispose(), this._multiply = null, this;
    }, e.default = s.default.Negate;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(48), i(27), i(1);
    s.default.PanVol = function () {
      var t = s.default.defaults(arguments, ["pan", "volume"], s.default.PanVol);
      s.default.AudioNode.call(this), this._panner = this.input = new s.default.Panner(t.pan), this.pan = this._panner.pan, this._volume = this.output = new s.default.Volume(t.volume), this.volume = this._volume.volume, this._panner.connect(this._volume), this.mute = t.mute, this._readOnly(["pan", "volume"]);
    }, s.default.extend(s.default.PanVol, s.default.AudioNode), s.default.PanVol.defaults = {
      pan: 0,
      volume: 0,
      mute: !1
    }, Object.defineProperty(s.default.PanVol.prototype, "mute", {
      get: function () {
        return this._volume.mute;
      },
      set: function (t) {
        this._volume.mute = t;
      }
    }), s.default.PanVol.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["pan", "volume"]), this._panner.dispose(), this._panner = null, this.pan = null, this._volume.dispose(), this._volume = null, this.volume = null, this;
    }, e.default = s.default.PanVol;
  }, function (t, e, i) {
    "use strict";

    var s = i(0);

    if (s.default.supported) {
      !s.default.global.hasOwnProperty("OfflineAudioContext") && s.default.global.hasOwnProperty("webkitOfflineAudioContext") && (s.default.global.OfflineAudioContext = s.default.global.webkitOfflineAudioContext);
      var n = new OfflineAudioContext(1, 1, 44100).startRendering();
      n && s.default.isFunction(n.then) || (OfflineAudioContext.prototype._native_startRendering = OfflineAudioContext.prototype.startRendering, OfflineAudioContext.prototype.startRendering = function () {
        return new Promise(function (t) {
          this.oncomplete = function (e) {
            t(e.renderedBuffer);
          }, this._native_startRendering();
        }.bind(this));
      });
    }
  }, function (t, e, i) {
    "use strict";

    e.a = "13.8.25";
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(46);
    s.default.Midi = function (t, e) {
      if (!(this instanceof s.default.Midi)) return new s.default.Midi(t, e);
      s.default.Frequency.call(this, t, e);
    }, s.default.extend(s.default.Midi, s.default.Frequency), s.default.Midi.prototype._defaultUnits = "midi", s.default.Midi.prototype._frequencyToUnits = function (t) {
      return s.default.Frequency.ftom(s.default.Frequency.prototype._frequencyToUnits.call(this, t));
    }, s.default.Midi.prototype._ticksToUnits = function (t) {
      return s.default.Frequency.ftom(s.default.Frequency.prototype._ticksToUnits.call(this, t));
    }, s.default.Midi.prototype._beatsToUnits = function (t) {
      return s.default.Frequency.ftom(s.default.Frequency.prototype._beatsToUnits.call(this, t));
    }, s.default.Midi.prototype._secondsToUnits = function (t) {
      return s.default.Frequency.ftom(s.default.Frequency.prototype._secondsToUnits.call(this, t));
    }, s.default.Midi.prototype.toMidi = function () {
      return this.valueOf();
    }, s.default.Midi.prototype.toFrequency = function () {
      return s.default.Frequency.mtof(this.toMidi());
    }, s.default.Midi.prototype.transpose = function (t) {
      return new this.constructor(this.toMidi() + t);
    }, e.default = s.default.Midi;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(27), i(1);
    s.default.UserMedia = function () {
      var t = s.default.defaults(arguments, ["volume"], s.default.UserMedia);
      s.default.AudioNode.call(this), this._mediaStream = null, this._stream = null, this._device = null, this._volume = this.output = new s.default.Volume(t.volume), this.volume = this._volume.volume, this._readOnly("volume"), this.mute = t.mute;
    }, s.default.extend(s.default.UserMedia, s.default.AudioNode), s.default.UserMedia.defaults = {
      volume: 0,
      mute: !1
    }, s.default.UserMedia.prototype.open = function (t) {
      return this.state === s.default.State.Started && this.close(), s.default.UserMedia.enumerateDevices().then(function (e) {
        var i;
        if (s.default.isNumber(t)) i = e[t];else if (!(i = e.find(function (e) {
          return e.label === t || e.deviceId === t;
        })) && e.length > 0) i = e[0];else if (!i && s.default.isDefined(t)) throw new Error("Tone.UserMedia: no matching device: " + t);
        this._device = i;
        var n = {
          audio: {
            echoCancellation: !1,
            sampleRate: this.context.sampleRate,
            noiseSuppression: !1,
            mozNoiseSuppression: !1
          }
        };
        return i && (n.audio.deviceId = i.deviceId), navigator.mediaDevices.getUserMedia(n).then(function (t) {
          return this._stream || (this._stream = t, this._mediaStream = this.context.createMediaStreamSource(t), s.default.connect(this._mediaStream, this.output)), this;
        }.bind(this));
      }.bind(this));
    }, s.default.UserMedia.prototype.close = function () {
      return this._stream && (this._stream.getAudioTracks().forEach(function (t) {
        t.stop();
      }), this._stream = null, this._mediaStream.disconnect(), this._mediaStream = null), this._device = null, this;
    }, s.default.UserMedia.enumerateDevices = function () {
      return navigator.mediaDevices.enumerateDevices().then(function (t) {
        return t.filter(function (t) {
          return "audioinput" === t.kind;
        });
      });
    }, Object.defineProperty(s.default.UserMedia.prototype, "state", {
      get: function () {
        return this._stream && this._stream.active ? s.default.State.Started : s.default.State.Stopped;
      }
    }), Object.defineProperty(s.default.UserMedia.prototype, "deviceId", {
      get: function () {
        return this._device ? this._device.deviceId : null;
      }
    }), Object.defineProperty(s.default.UserMedia.prototype, "groupId", {
      get: function () {
        return this._device ? this._device.groupId : null;
      }
    }), Object.defineProperty(s.default.UserMedia.prototype, "label", {
      get: function () {
        return this._device ? this._device.label : null;
      }
    }), Object.defineProperty(s.default.UserMedia.prototype, "mute", {
      get: function () {
        return this._volume.mute;
      },
      set: function (t) {
        this._volume.mute = t;
      }
    }), s.default.UserMedia.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this.close(), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this;
    }, Object.defineProperty(s.default.UserMedia, "supported", {
      get: function () {
        return s.default.isDefined(navigator.mediaDevices) && s.default.isFunction(navigator.mediaDevices.getUserMedia);
      }
    }), e.default = s.default.UserMedia;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(65), i(27), i(1);
    s.default.Players = function (t) {
      var e = Array.prototype.slice.call(arguments);
      e.shift();
      var i = s.default.defaults(e, ["onload"], s.default.Players);

      for (var n in s.default.AudioNode.call(this, i), this._volume = this.output = new s.default.Volume(i.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = i.mute, this._players = {}, this._loadingCount = 0, this._fadeIn = i.fadeIn, this._fadeOut = i.fadeOut, t) this._loadingCount++, this.add(n, t[n], this._bufferLoaded.bind(this, i.onload));
    }, s.default.extend(s.default.Players, s.default.AudioNode), s.default.Players.defaults = {
      volume: 0,
      mute: !1,
      onload: s.default.noOp,
      fadeIn: 0,
      fadeOut: 0
    }, s.default.Players.prototype._bufferLoaded = function (t) {
      this._loadingCount--, 0 === this._loadingCount && t && t(this);
    }, Object.defineProperty(s.default.Players.prototype, "mute", {
      get: function () {
        return this._volume.mute;
      },
      set: function (t) {
        this._volume.mute = t;
      }
    }), Object.defineProperty(s.default.Players.prototype, "fadeIn", {
      get: function () {
        return this._fadeIn;
      },
      set: function (t) {
        this._fadeIn = t, this._forEach(function (e) {
          e.fadeIn = t;
        });
      }
    }), Object.defineProperty(s.default.Players.prototype, "fadeOut", {
      get: function () {
        return this._fadeOut;
      },
      set: function (t) {
        this._fadeOut = t, this._forEach(function (e) {
          e.fadeOut = t;
        });
      }
    }), Object.defineProperty(s.default.Players.prototype, "state", {
      get: function () {
        var t = !1;
        return this._forEach(function (e) {
          t = t || e.state === s.default.State.Started;
        }), t ? s.default.State.Started : s.default.State.Stopped;
      }
    }), s.default.Players.prototype.has = function (t) {
      return this._players.hasOwnProperty(t);
    }, s.default.Players.prototype.get = function (t) {
      if (this.has(t)) return this._players[t];
      throw new Error("Tone.Players: no player named " + t);
    }, s.default.Players.prototype._forEach = function (t) {
      for (var e in this._players) t(this._players[e], e);

      return this;
    }, Object.defineProperty(s.default.Players.prototype, "loaded", {
      get: function () {
        var t = !0;
        return this._forEach(function (e) {
          t = t && e.loaded;
        }), t;
      }
    }), s.default.Players.prototype.add = function (t, e, i) {
      return this._players[t] = new s.default.Player(e, i).connect(this.output), this._players[t].fadeIn = this._fadeIn, this._players[t].fadeOut = this._fadeOut, this;
    }, s.default.Players.prototype.stopAll = function (t) {
      this._forEach(function (e) {
        e.stop(t);
      });
    }, s.default.Players.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable("volume"), this.volume = null, this.output = null, this._forEach(function (t) {
        t.dispose();
      }), this._players = null, this;
    }, e.default = s.default.Players;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(6), i(11), i(32);
    s.default.GrainPlayer = function () {
      var t = s.default.defaults(arguments, ["url", "onload"], s.default.GrainPlayer);
      s.default.Source.call(this, t), this.buffer = new s.default.Buffer(t.url, t.onload.bind(void 0, this)), this._clock = new s.default.Clock(this._tick.bind(this), t.grainSize), this._loopStart = 0, this._loopEnd = 0, this._activeSources = [], this._playbackRate = t.playbackRate, this._grainSize = t.grainSize, this._overlap = t.overlap, this.detune = t.detune, this.overlap = t.overlap, this.loop = t.loop, this.playbackRate = t.playbackRate, this.grainSize = t.grainSize, this.loopStart = t.loopStart, this.loopEnd = t.loopEnd, this.reverse = t.reverse, this._clock.on("stop", this._onstop.bind(this));
    }, s.default.extend(s.default.GrainPlayer, s.default.Source), s.default.GrainPlayer.defaults = {
      onload: s.default.noOp,
      overlap: .1,
      grainSize: .2,
      playbackRate: 1,
      detune: 0,
      loop: !1,
      loopStart: 0,
      loopEnd: 0,
      reverse: !1
    }, s.default.GrainPlayer.prototype._start = function (t, e, i) {
      e = s.default.defaultArg(e, 0), e = this.toSeconds(e), t = this.toSeconds(t), this._offset = e, this._clock.start(t), i && this.stop(t + this.toSeconds(i));
    }, s.default.GrainPlayer.prototype._stop = function (t) {
      this._clock.stop(t);
    }, s.default.GrainPlayer.prototype._onstop = function (t) {
      this._activeSources.forEach(function (e) {
        e.fadeOut = 0, e.stop(t);
      });
    }, s.default.GrainPlayer.prototype._tick = function (t) {
      if (!this.loop && this._offset > this.buffer.duration) this.stop(t);else {
        var e = this._offset < this._overlap ? 0 : this._overlap,
            i = new s.default.BufferSource({
          buffer: this.buffer,
          fadeIn: e,
          fadeOut: this._overlap,
          loop: this.loop,
          loopStart: this._loopStart,
          loopEnd: this._loopEnd,
          playbackRate: s.default.intervalToFrequencyRatio(this.detune / 100)
        }).connect(this.output);
        i.start(t, this._offset), this._offset += this.grainSize, i.stop(t + this.grainSize / this.playbackRate), this._activeSources.push(i), i.onended = function () {
          var t = this._activeSources.indexOf(i);

          -1 !== t && this._activeSources.splice(t, 1);
        }.bind(this);
      }
    }, Object.defineProperty(s.default.GrainPlayer.prototype, "playbackRate", {
      get: function () {
        return this._playbackRate;
      },
      set: function (t) {
        this._playbackRate = t, this.grainSize = this._grainSize;
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "loopStart", {
      get: function () {
        return this._loopStart;
      },
      set: function (t) {
        this._loopStart = this.toSeconds(t);
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "loopEnd", {
      get: function () {
        return this._loopEnd;
      },
      set: function (t) {
        this._loopEnd = this.toSeconds(t);
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "reverse", {
      get: function () {
        return this.buffer.reverse;
      },
      set: function (t) {
        this.buffer.reverse = t;
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "grainSize", {
      get: function () {
        return this._grainSize;
      },
      set: function (t) {
        this._grainSize = this.toSeconds(t), this._clock.frequency.value = this._playbackRate / this._grainSize;
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "overlap", {
      get: function () {
        return this._overlap;
      },
      set: function (t) {
        this._overlap = this.toSeconds(t);
      }
    }), Object.defineProperty(s.default.GrainPlayer.prototype, "loaded", {
      get: function () {
        return this.buffer.loaded;
      }
    }), s.default.GrainPlayer.prototype.dispose = function () {
      return s.default.Source.prototype.dispose.call(this), this.buffer.dispose(), this.buffer = null, this._clock.dispose(), this._clock = null, this._activeSources.forEach(function (t) {
        t.dispose();
      }), this._activeSources = null, this;
    }, e.default = s.default.GrainPlayer;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(16), i(2), i(45);
    s.default.TransportTimelineSignal = function () {
      s.default.Signal.apply(this, arguments), this.output = this._outputSig = new s.default.Signal(this._initialValue), this._lastVal = this.value, this._synced = s.default.Transport.scheduleRepeat(this._onTick.bind(this), "1i"), this._bindAnchorValue = this._anchorValue.bind(this), s.default.Transport.on("start stop pause", this._bindAnchorValue), this._events.memory = 1 / 0;
    }, s.default.extend(s.default.TransportTimelineSignal, s.default.Signal), s.default.TransportTimelineSignal.prototype._onTick = function (t) {
      var e = this.getValueAtTime(s.default.Transport.seconds);
      this._lastVal !== e && (this._lastVal = e, this._outputSig.linearRampToValueAtTime(e, t));
    }, s.default.TransportTimelineSignal.prototype._anchorValue = function (t) {
      var e = this.getValueAtTime(s.default.Transport.seconds);
      return this._lastVal = e, this._outputSig.cancelScheduledValues(t), this._outputSig.setValueAtTime(e, t), this;
    }, s.default.TransportTimelineSignal.prototype.getValueAtTime = function (t) {
      return t = s.default.TransportTime(t), s.default.Signal.prototype.getValueAtTime.call(this, t);
    }, s.default.TransportTimelineSignal.prototype.setValueAtTime = function (t, e) {
      return e = s.default.TransportTime(e), s.default.Signal.prototype.setValueAtTime.call(this, t, e), this;
    }, s.default.TransportTimelineSignal.prototype.linearRampToValueAtTime = function (t, e) {
      return e = s.default.TransportTime(e), s.default.Signal.prototype.linearRampToValueAtTime.call(this, t, e), this;
    }, s.default.TransportTimelineSignal.prototype.exponentialRampToValueAtTime = function (t, e) {
      return e = s.default.TransportTime(e), s.default.Signal.prototype.exponentialRampToValueAtTime.call(this, t, e), this;
    }, s.default.TransportTimelineSignal.prototype.setTargetAtTime = function (t, e, i) {
      return e = s.default.TransportTime(e), s.default.Signal.prototype.setTargetAtTime.call(this, t, e, i), this;
    }, s.default.TransportTimelineSignal.prototype.cancelScheduledValues = function (t) {
      return t = s.default.TransportTime(t), s.default.Signal.prototype.cancelScheduledValues.call(this, t), this;
    }, s.default.TransportTimelineSignal.prototype.setValueCurveAtTime = function (t, e, i, n) {
      return e = s.default.TransportTime(e), i = s.default.TransportTime(i), s.default.Signal.prototype.setValueCurveAtTime.call(this, t, e, i, n), this;
    }, s.default.TransportTimelineSignal.prototype.cancelAndHoldAtTime = function (t) {
      return s.default.Signal.prototype.cancelAndHoldAtTime.call(this, s.default.TransportTime(t));
    }, s.default.TransportTimelineSignal.prototype.dispose = function () {
      s.default.Transport.clear(this._synced), s.default.Transport.off("start stop pause", this._syncedCallback), this._events.cancel(0), s.default.Signal.prototype.dispose.call(this), this._outputSig.dispose(), this._outputSig = null;
    }, e.default = s.default.TransportTimelineSignal;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(29), i(5);
    s.default.Normalize = function (t, e) {
      s.default.SignalBase.call(this), this._inputMin = s.default.defaultArg(t, 0), this._inputMax = s.default.defaultArg(e, 1), this._sub = this.input = new s.default.Add(0), this._div = this.output = new s.default.Multiply(1), this._sub.connect(this._div), this._setRange();
    }, s.default.extend(s.default.Normalize, s.default.SignalBase), Object.defineProperty(s.default.Normalize.prototype, "min", {
      get: function () {
        return this._inputMin;
      },
      set: function (t) {
        this._inputMin = t, this._setRange();
      }
    }), Object.defineProperty(s.default.Normalize.prototype, "max", {
      get: function () {
        return this._inputMax;
      },
      set: function (t) {
        this._inputMax = t, this._setRange();
      }
    }), s.default.Normalize.prototype._setRange = function () {
      this._sub.value = -this._inputMin, this._div.value = 1 / (this._inputMax - this._inputMin);
    }, s.default.Normalize.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._sub.dispose(), this._sub = null, this._div.dispose(), this._div = null, this;
    }, e.default = s.default.Normalize;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(7), i(2);
    s.default.GainToAudio = function () {
      s.default.SignalBase.call(this), this._norm = this.input = this.output = new s.default.WaveShaper(function (t) {
        return 2 * Math.abs(t) - 1;
      });
    }, s.default.extend(s.default.GainToAudio, s.default.SignalBase), s.default.GainToAudio.prototype.dispose = function () {
      return s.default.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this;
    }, e.default = s.default.GainToAudio;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(21), i(78), i(32);
    s.default.Sampler = function (t) {
      var e = Array.prototype.slice.call(arguments);
      e.shift();
      var i = s.default.defaults(e, ["onload", "baseUrl"], s.default.Sampler);
      s.default.Instrument.call(this, i);
      var n = {};

      for (var o in t) if (s.default.isNote(o)) {
        n[s.default.Frequency(o).toMidi()] = t[o];
      } else {
        if (isNaN(parseFloat(o))) throw new Error("Tone.Sampler: url keys must be the note's pitch");
        n[o] = t[o];
      }

      this._buffers = new s.default.Buffers(n, i.onload, i.baseUrl), this._activeSources = {}, this.attack = i.attack, this.release = i.release, this.curve = i.curve;
    }, s.default.extend(s.default.Sampler, s.default.Instrument), s.default.Sampler.defaults = {
      attack: 0,
      release: .1,
      onload: s.default.noOp,
      baseUrl: "",
      curve: "exponential"
    }, s.default.Sampler.prototype._findClosest = function (t) {
      for (var e = 0; e < 96;) {
        if (this._buffers.has(t + e)) return -e;
        if (this._buffers.has(t - e)) return e;
        e++;
      }

      throw new Error("No available buffers for note: " + t);
    }, s.default.Sampler.prototype.triggerAttack = function (t, e, i) {
      this.log("triggerAttack", t, e, i), Array.isArray(t) || (t = [t]);

      for (var n = 0; n < t.length; n++) {
        var o = s.default.Frequency(t[n]).toMidi(),
            a = this._findClosest(o),
            r = o - a,
            l = this._buffers.get(r),
            u = s.default.intervalToFrequencyRatio(a),
            d = new s.default.BufferSource({
          buffer: l,
          playbackRate: u,
          fadeIn: this.attack,
          fadeOut: this.release,
          curve: this.curve
        }).connect(this.output);

        d.start(e, 0, l.duration / u, i), s.default.isArray(this._activeSources[o]) || (this._activeSources[o] = []), this._activeSources[o].push(d), d.onended = function () {
          if (this._activeSources && this._activeSources[o]) {
            var t = this._activeSources[o].indexOf(d);

            -1 !== t && this._activeSources[o].splice(t, 1);
          }
        }.bind(this);
      }

      return this;
    }, s.default.Sampler.prototype.triggerRelease = function (t, e) {
      this.log("triggerRelease", t, e), Array.isArray(t) || (t = [t]);

      for (var i = 0; i < t.length; i++) {
        var n = s.default.Frequency(t[i]).toMidi();
        this._activeSources[n] && this._activeSources[n].length && (e = this.toSeconds(e), this._activeSources[n].forEach(function (t) {
          t.stop(e);
        }), this._activeSources[n] = []);
      }

      return this;
    }, s.default.Sampler.prototype.releaseAll = function (t) {
      for (var e in t = this.toSeconds(t), this._activeSources) for (var i = this._activeSources[e]; i.length;) {
        i.shift().stop(t);
      }

      return this;
    }, s.default.Sampler.prototype.sync = function () {
      return this._syncMethod("triggerAttack", 1), this._syncMethod("triggerRelease", 1), this;
    }, s.default.Sampler.prototype.triggerAttackRelease = function (t, e, i, n) {
      if (i = this.toSeconds(i), this.triggerAttack(t, i, n), s.default.isArray(e) && s.default.isArray(t)) for (var o = 0; o < t.length; o++) {
        var a = e[Math.min(o, e.length - 1)];
        this.triggerRelease(t[o], i + this.toSeconds(a));
      } else this.triggerRelease(t, i + this.toSeconds(e));
      return this;
    }, s.default.Sampler.prototype.add = function (t, e, i) {
      if (s.default.isNote(t)) {
        var n = s.default.Frequency(t).toMidi();

        this._buffers.add(n, e, i);
      } else {
        if (isNaN(parseFloat(t))) throw new Error("Tone.Sampler: note must be the note's pitch. Instead got " + t);

        this._buffers.add(t, e, i);
      }
    }, Object.defineProperty(s.default.Sampler.prototype, "loaded", {
      get: function () {
        return this._buffers.loaded;
      }
    }), s.default.Sampler.prototype.dispose = function () {
      for (var t in s.default.Instrument.prototype.dispose.call(this), this._buffers.dispose(), this._buffers = null, this._activeSources) this._activeSources[t].forEach(function (t) {
        t.dispose();
      });

      return this._activeSources = null, this;
    }, e.default = s.default.Sampler;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(38), i(6);
    s.default.PolySynth = function () {
      var t = s.default.defaults(arguments, ["polyphony", "voice"], s.default.PolySynth);
      s.default.Instrument.call(this, t), (t = s.default.defaultArg(t, s.default.Instrument.defaults)).polyphony = Math.min(s.default.PolySynth.MAX_POLYPHONY, t.polyphony), this.voices = new Array(t.polyphony), this.assert(t.polyphony > 0, "polyphony must be greater than 0"), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this._readOnly("detune");

      for (var e = 0; e < t.polyphony; e++) {
        var i = new t.voice(arguments[2], arguments[3]);
        if (!(i instanceof s.default.Monophonic)) throw new Error("Synth constructor must be instance of Tone.Monophonic");
        this.voices[e] = i, i.index = e, i.connect(this.output), i.hasOwnProperty("detune") && this.detune.connect(i.detune);
      }
    }, s.default.extend(s.default.PolySynth, s.default.Instrument), s.default.PolySynth.defaults = {
      polyphony: 4,
      volume: 0,
      detune: 0,
      voice: s.default.Synth
    }, s.default.PolySynth.prototype._getClosestVoice = function (t, e) {
      var i = this.voices.find(function (i) {
        if (Math.abs(i.frequency.getValueAtTime(t) - s.default.Frequency(e)) < 1e-4 && i.getLevelAtTime(t) > 1e-5) return i;
      });
      return i || this.voices.slice().sort(function (e, i) {
        var s = e.getLevelAtTime(t + this.blockTime),
            n = i.getLevelAtTime(t + this.blockTime);
        return s < 1e-5 && (s = 0), n < 1e-5 && (n = 0), s - n;
      }.bind(this))[0];
    }, s.default.PolySynth.prototype.triggerAttack = function (t, e, i) {
      return Array.isArray(t) || (t = [t]), e = this.toSeconds(e), t.forEach(function (t) {
        var s = this._getClosestVoice(e, t);

        s.triggerAttack(t, e, i), this.log("triggerAttack", s.index, t);
      }.bind(this)), this;
    }, s.default.PolySynth.prototype.triggerRelease = function (t, e) {
      return Array.isArray(t) || (t = [t]), e = this.toSeconds(e), t.forEach(function (t) {
        var i = this._getClosestVoice(e, t);

        this.log("triggerRelease", i.index, t), i.triggerRelease(e);
      }.bind(this)), this;
    }, s.default.PolySynth.prototype.triggerAttackRelease = function (t, e, i, n) {
      if (i = this.toSeconds(i), this.triggerAttack(t, i, n), s.default.isArray(e) && s.default.isArray(t)) for (var o = 0; o < t.length; o++) {
        var a = e[Math.min(o, e.length - 1)];
        this.triggerRelease(t[o], i + this.toSeconds(a));
      } else this.triggerRelease(t, i + this.toSeconds(e));
      return this;
    }, s.default.PolySynth.prototype.sync = function () {
      return this._syncMethod("triggerAttack", 1), this._syncMethod("triggerRelease", 1), this;
    }, s.default.PolySynth.prototype.set = function (t, e, i) {
      for (var s = 0; s < this.voices.length; s++) this.voices[s].set(t, e, i);

      return this;
    }, s.default.PolySynth.prototype.get = function (t) {
      return this.voices[0].get(t);
    }, s.default.PolySynth.prototype.releaseAll = function (t) {
      return t = this.toSeconds(t), this.voices.forEach(function (e) {
        e.triggerRelease(t);
      }), this;
    }, s.default.PolySynth.prototype.dispose = function () {
      return s.default.Instrument.prototype.dispose.call(this), this.voices.forEach(function (t) {
        t.dispose();
      }), this._writable("detune"), this.detune.dispose(), this.detune = null, this.voices = null, this;
    }, s.default.PolySynth.MAX_POLYPHONY = 20, e.default = s.default.PolySynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(21), i(39), i(54);
    s.default.PluckSynth = function (t) {
      t = s.default.defaultArg(t, s.default.PluckSynth.defaults), s.default.Instrument.call(this, t), this._noise = new s.default.Noise("pink"), this.attackNoise = t.attackNoise, this._lfcf = new s.default.LowpassCombFilter({
        resonance: t.resonance,
        dampening: t.dampening
      }), this.resonance = this._lfcf.resonance, this.dampening = this._lfcf.dampening, this._noise.connect(this._lfcf), this._lfcf.connect(this.output), this._readOnly(["resonance", "dampening"]);
    }, s.default.extend(s.default.PluckSynth, s.default.Instrument), s.default.PluckSynth.defaults = {
      attackNoise: 1,
      dampening: 4e3,
      resonance: .7
    }, s.default.PluckSynth.prototype.triggerAttack = function (t, e) {
      t = this.toFrequency(t), e = this.toSeconds(e);
      var i = 1 / t;
      return this._lfcf.delayTime.setValueAtTime(i, e), this._noise.start(e), this._noise.stop(e + i * this.attackNoise), this;
    }, s.default.PluckSynth.prototype.dispose = function () {
      return s.default.Instrument.prototype.dispose.call(this), this._noise.dispose(), this._lfcf.dispose(), this._noise = null, this._lfcf = null, this._writable(["resonance", "dampening"]), this.dampening = null, this.resonance = null, this;
    }, e.default = s.default.PluckSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(31), i(41), i(39), i(2), i(9), i(21);
    s.default.NoiseSynth = function (t) {
      t = s.default.defaultArg(t, s.default.NoiseSynth.defaults), s.default.Instrument.call(this, t), this.noise = new s.default.Noise(t.noise), this.envelope = new s.default.AmplitudeEnvelope(t.envelope), this.noise.chain(this.envelope, this.output), this._readOnly(["noise", "envelope"]);
    }, s.default.extend(s.default.NoiseSynth, s.default.Instrument), s.default.NoiseSynth.defaults = {
      noise: {
        type: "white"
      },
      envelope: {
        attack: .005,
        decay: .1,
        sustain: 0
      }
    }, s.default.NoiseSynth.prototype.triggerAttack = function (t, e) {
      return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.noise.start(t), 0 === this.envelope.sustain && this.noise.stop(t + this.envelope.attack + this.envelope.decay), this;
    }, s.default.NoiseSynth.prototype.triggerRelease = function (t) {
      return t = this.toSeconds(t), this.envelope.triggerRelease(t), this.noise.stop(t + this.envelope.release), this;
    }, s.default.NoiseSynth.prototype.sync = function () {
      return this._syncMethod("triggerAttack", 0), this._syncMethod("triggerRelease", 0), this;
    }, s.default.NoiseSynth.prototype.triggerAttackRelease = function (t, e, i) {
      return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this;
    }, s.default.NoiseSynth.prototype.dispose = function () {
      return s.default.Instrument.prototype.dispose.call(this), this._writable(["noise", "envelope"]), this.noise.dispose(), this.noise = null, this.envelope.dispose(), this.envelope = null, this;
    }, e.default = s.default.NoiseSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0),
        n = (i(21), i(49), i(9), i(41), i(31), i(3), i(26), i(5), [1, 1.483, 1.932, 2.546, 2.63, 3.897]);
    s.default.MetalSynth = function (t) {
      t = s.default.defaultArg(t, s.default.MetalSynth.defaults), s.default.Instrument.call(this, t), this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this._oscillators = [], this._freqMultipliers = [], this._amplitue = new s.default.Gain(0).connect(this.output), this._highpass = new s.default.Filter({
        type: "highpass",
        Q: -3.0102999566398125
      }).connect(this._amplitue), this._octaves = t.octaves, this._filterFreqScaler = new s.default.Scale(t.resonance, 7e3), this.envelope = new s.default.Envelope({
        attack: t.envelope.attack,
        attackCurve: "linear",
        decay: t.envelope.decay,
        sustain: 0,
        release: t.envelope.release
      }).chain(this._filterFreqScaler, this._highpass.frequency), this.envelope.connect(this._amplitue.gain);

      for (var e = 0; e < n.length; e++) {
        var i = new s.default.FMOscillator({
          type: "square",
          modulationType: "square",
          harmonicity: t.harmonicity,
          modulationIndex: t.modulationIndex
        });
        i.connect(this._highpass), this._oscillators[e] = i;
        var o = new s.default.Multiply(n[e]);
        this._freqMultipliers[e] = o, this.frequency.chain(o, i.frequency);
      }

      this.octaves = t.octaves;
    }, s.default.extend(s.default.MetalSynth, s.default.Instrument), s.default.MetalSynth.defaults = {
      frequency: 200,
      envelope: {
        attack: .001,
        decay: 1.4,
        release: .2
      },
      harmonicity: 5.1,
      modulationIndex: 32,
      resonance: 4e3,
      octaves: 1.5
    }, s.default.MetalSynth.prototype.triggerAttack = function (t, e) {
      return t = this.toSeconds(t), e = s.default.defaultArg(e, 1), this.envelope.triggerAttack(t, e), this._oscillators.forEach(function (e) {
        e.start(t);
      }), 0 === this.envelope.sustain && this._oscillators.forEach(function (e) {
        e.stop(t + this.envelope.attack + this.envelope.decay);
      }.bind(this)), this;
    }, s.default.MetalSynth.prototype.triggerRelease = function (t) {
      return t = this.toSeconds(t), this.envelope.triggerRelease(t), this._oscillators.forEach(function (e) {
        e.stop(t + this.envelope.release);
      }.bind(this)), this;
    }, s.default.MetalSynth.prototype.sync = function () {
      return this._syncMethod("triggerAttack", 0), this._syncMethod("triggerRelease", 0), this;
    }, s.default.MetalSynth.prototype.triggerAttackRelease = function (t, e, i) {
      return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this;
    }, Object.defineProperty(s.default.MetalSynth.prototype, "modulationIndex", {
      get: function () {
        return this._oscillators[0].modulationIndex.value;
      },
      set: function (t) {
        for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].modulationIndex.value = t;
      }
    }), Object.defineProperty(s.default.MetalSynth.prototype, "harmonicity", {
      get: function () {
        return this._oscillators[0].harmonicity.value;
      },
      set: function (t) {
        for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].harmonicity.value = t;
      }
    }), Object.defineProperty(s.default.MetalSynth.prototype, "resonance", {
      get: function () {
        return this._filterFreqScaler.min;
      },
      set: function (t) {
        this._filterFreqScaler.min = t, this.octaves = this._octaves;
      }
    }), Object.defineProperty(s.default.MetalSynth.prototype, "octaves", {
      get: function () {
        return this._octaves;
      },
      set: function (t) {
        this._octaves = t, this._filterFreqScaler.max = this._filterFreqScaler.min * Math.pow(2, t);
      }
    }), s.default.MetalSynth.prototype.dispose = function () {
      s.default.Instrument.prototype.dispose.call(this);

      for (var t = 0; t < this._oscillators.length; t++) this._oscillators[t].dispose(), this._freqMultipliers[t].dispose();

      this._oscillators = null, this._freqMultipliers = null, this.frequency.dispose(), this.frequency = null, this._filterFreqScaler.dispose(), this._filterFreqScaler = null, this._amplitue.dispose(), this._amplitue = null, this.envelope.dispose(), this.envelope = null, this._highpass.dispose(), this._highpass = null;
    }, e.default = s.default.MetalSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(37), i(21), i(31);
    s.default.MembraneSynth = function (t) {
      t = s.default.defaultArg(t, s.default.MembraneSynth.defaults), s.default.Instrument.call(this, t), this.oscillator = new s.default.OmniOscillator(t.oscillator), this.envelope = new s.default.AmplitudeEnvelope(t.envelope), this.octaves = t.octaves, this.pitchDecay = t.pitchDecay, this.oscillator.chain(this.envelope, this.output), this._readOnly(["oscillator", "envelope"]);
    }, s.default.extend(s.default.MembraneSynth, s.default.Instrument), s.default.MembraneSynth.defaults = {
      pitchDecay: .05,
      octaves: 10,
      oscillator: {
        type: "sine"
      },
      envelope: {
        attack: .001,
        decay: .4,
        sustain: .01,
        release: 1.4,
        attackCurve: "exponential"
      }
    }, s.default.MembraneSynth.prototype.triggerAttack = function (t, e, i) {
      e = this.toSeconds(e);
      var s = (t = this.toFrequency(t)) * this.octaves;
      return this.oscillator.frequency.setValueAtTime(s, e), this.oscillator.frequency.exponentialRampToValueAtTime(t, e + this.toSeconds(this.pitchDecay)), this.envelope.triggerAttack(e, i), this.oscillator.start(e), 0 === this.envelope.sustain && this.oscillator.stop(e + this.envelope.attack + this.envelope.decay), this;
    }, s.default.MembraneSynth.prototype.triggerRelease = function (t) {
      return t = this.toSeconds(t), this.envelope.triggerRelease(t), this.oscillator.stop(t + this.envelope.release), this;
    }, s.default.MembraneSynth.prototype.dispose = function () {
      return s.default.Instrument.prototype.dispose.call(this), this._writable(["oscillator", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this;
    }, e.default = s.default.MembraneSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(38), i(2), i(5), i(25);
    s.default.FMSynth = function (t) {
      t = s.default.defaultArg(t, s.default.FMSynth.defaults), s.default.Monophonic.call(this, t), this._carrier = new s.default.Synth(t.carrier), this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator, this.envelope = this._carrier.envelope.set(t.envelope), this._modulator = new s.default.Synth(t.modulator), this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(t.modulation), this.modulationEnvelope = this._modulator.envelope.set(t.modulationEnvelope), this.frequency = new s.default.Signal(440, s.default.Type.Frequency), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this.harmonicity = new s.default.Multiply(t.harmonicity), this.harmonicity.units = s.default.Type.Positive, this.modulationIndex = new s.default.Multiply(t.modulationIndex), this.modulationIndex.units = s.default.Type.Positive, this._modulationNode = new s.default.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this._readOnly(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]);
    }, s.default.extend(s.default.FMSynth, s.default.Monophonic), s.default.FMSynth.defaults = {
      harmonicity: 3,
      modulationIndex: 10,
      detune: 0,
      oscillator: {
        type: "sine"
      },
      envelope: {
        attack: .01,
        decay: .01,
        sustain: 1,
        release: .5
      },
      modulation: {
        type: "square"
      },
      modulationEnvelope: {
        attack: .5,
        decay: 0,
        sustain: 1,
        release: .5
      }
    }, s.default.FMSynth.prototype._triggerEnvelopeAttack = function (t, e) {
      return t = this.toSeconds(t), this._carrier._triggerEnvelopeAttack(t, e), this._modulator._triggerEnvelopeAttack(t), this;
    }, s.default.FMSynth.prototype._triggerEnvelopeRelease = function (t) {
      return t = this.toSeconds(t), this._carrier._triggerEnvelopeRelease(t), this._modulator._triggerEnvelopeRelease(t), this;
    }, s.default.FMSynth.prototype.dispose = function () {
      return s.default.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.modulationIndex.dispose(), this.modulationIndex = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this;
    }, e.default = s.default.FMSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(66), i(12), i(2), i(5), i(25), i(14);
    s.default.DuoSynth = function (t) {
      t = s.default.defaultArg(t, s.default.DuoSynth.defaults), s.default.Monophonic.call(this, t), this.voice0 = new s.default.MonoSynth(t.voice0), this.voice0.volume.value = -10, this.voice1 = new s.default.MonoSynth(t.voice1), this.voice1.volume.value = -10, this._vibrato = new s.default.LFO(t.vibratoRate, -50, 50), this._vibrato.start(), this.vibratoRate = this._vibrato.frequency, this._vibratoGain = new s.default.Gain(t.vibratoAmount, s.default.Type.Positive), this.vibratoAmount = this._vibratoGain.gain, this.frequency = new s.default.Signal(440, s.default.Type.Frequency), this.harmonicity = new s.default.Multiply(t.harmonicity), this.harmonicity.units = s.default.Type.Positive, this.frequency.connect(this.voice0.frequency), this.frequency.chain(this.harmonicity, this.voice1.frequency), this._vibrato.connect(this._vibratoGain), this._vibratoGain.fan(this.voice0.detune, this.voice1.detune), this.voice0.connect(this.output), this.voice1.connect(this.output), this._readOnly(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]);
    }, s.default.extend(s.default.DuoSynth, s.default.Monophonic), s.default.DuoSynth.defaults = {
      vibratoAmount: .5,
      vibratoRate: 5,
      harmonicity: 1.5,
      voice0: {
        volume: -10,
        portamento: 0,
        oscillator: {
          type: "sine"
        },
        filterEnvelope: {
          attack: .01,
          decay: 0,
          sustain: 1,
          release: .5
        },
        envelope: {
          attack: .01,
          decay: 0,
          sustain: 1,
          release: .5
        }
      },
      voice1: {
        volume: -10,
        portamento: 0,
        oscillator: {
          type: "sine"
        },
        filterEnvelope: {
          attack: .01,
          decay: 0,
          sustain: 1,
          release: .5
        },
        envelope: {
          attack: .01,
          decay: 0,
          sustain: 1,
          release: .5
        }
      }
    }, s.default.DuoSynth.prototype._triggerEnvelopeAttack = function (t, e) {
      return t = this.toSeconds(t), this.voice0._triggerEnvelopeAttack(t, e), this.voice1._triggerEnvelopeAttack(t, e), this;
    }, s.default.DuoSynth.prototype._triggerEnvelopeRelease = function (t) {
      return this.voice0._triggerEnvelopeRelease(t), this.voice1._triggerEnvelopeRelease(t), this;
    }, s.default.DuoSynth.prototype.getLevelAtTime = function (t) {
      return (this.voice0.getLevelAtTime(t) + this.voice1.getLevelAtTime(t)) / 2;
    }, s.default.DuoSynth.prototype.dispose = function () {
      return s.default.Monophonic.prototype.dispose.call(this), this._writable(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]), this.voice0.dispose(), this.voice0 = null, this.voice1.dispose(), this.voice1 = null, this.frequency.dispose(), this.frequency = null, this._vibratoGain.dispose(), this._vibratoGain = null, this._vibrato = null, this.harmonicity.dispose(), this.harmonicity = null, this.vibratoAmount.dispose(), this.vibratoAmount = null, this.vibratoRate = null, this;
    }, e.default = s.default.DuoSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(38), i(2), i(5), i(25), i(22), i(3);
    s.default.AMSynth = function (t) {
      t = s.default.defaultArg(t, s.default.AMSynth.defaults), s.default.Monophonic.call(this, t), this._carrier = new s.default.Synth(), this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator.set(t.oscillator), this.envelope = this._carrier.envelope.set(t.envelope), this._modulator = new s.default.Synth(), this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(t.modulation), this.modulationEnvelope = this._modulator.envelope.set(t.modulationEnvelope), this.frequency = new s.default.Signal(440, s.default.Type.Frequency), this.detune = new s.default.Signal(t.detune, s.default.Type.Cents), this.harmonicity = new s.default.Multiply(t.harmonicity), this.harmonicity.units = s.default.Type.Positive, this._modulationScale = new s.default.AudioToGain(), this._modulationNode = new s.default.Gain(), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this._readOnly(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]);
    }, s.default.extend(s.default.AMSynth, s.default.Monophonic), s.default.AMSynth.defaults = {
      harmonicity: 3,
      detune: 0,
      oscillator: {
        type: "sine"
      },
      envelope: {
        attack: .01,
        decay: .01,
        sustain: 1,
        release: .5
      },
      modulation: {
        type: "square"
      },
      modulationEnvelope: {
        attack: .5,
        decay: 0,
        sustain: 1,
        release: .5
      }
    }, s.default.AMSynth.prototype._triggerEnvelopeAttack = function (t, e) {
      return t = this.toSeconds(t), this._carrier._triggerEnvelopeAttack(t, e), this._modulator._triggerEnvelopeAttack(t), this;
    }, s.default.AMSynth.prototype._triggerEnvelopeRelease = function (t) {
      return this._carrier._triggerEnvelopeRelease(t), this._modulator._triggerEnvelopeRelease(t), this;
    }, s.default.AMSynth.prototype.dispose = function () {
      return s.default.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationScale.dispose(), this._modulationScale = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this;
    }, e.default = s.default.AMSynth;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(70), i(16);
    s.default.Sequence = function () {
      var t = s.default.defaults(arguments, ["callback", "events", "subdivision"], s.default.Sequence),
          e = t.events;
      if (delete t.events, s.default.Part.call(this, t), this._subdivision = this.toTicks(t.subdivision), s.default.isUndef(t.loopEnd) && s.default.isDefined(e) && (this._loopEnd = e.length * this._subdivision), this._loop = !0, s.default.isDefined(e)) for (var i = 0; i < e.length; i++) this.add(i, e[i]);
    }, s.default.extend(s.default.Sequence, s.default.Part), s.default.Sequence.defaults = {
      subdivision: "4n"
    }, Object.defineProperty(s.default.Sequence.prototype, "subdivision", {
      get: function () {
        return s.default.Ticks(this._subdivision).toSeconds();
      }
    }), s.default.Sequence.prototype.at = function (t, e) {
      return s.default.isArray(e) && this.remove(t), s.default.Part.prototype.at.call(this, this._indexTime(t), e);
    }, s.default.Sequence.prototype.add = function (t, e) {
      if (null === e) return this;

      if (s.default.isArray(e)) {
        var i = Math.round(this._subdivision / e.length);
        e = new s.default.Sequence(this._tick.bind(this), e, s.default.Ticks(i));
      }

      return s.default.Part.prototype.add.call(this, this._indexTime(t), e), this;
    }, s.default.Sequence.prototype.remove = function (t, e) {
      return s.default.Part.prototype.remove.call(this, this._indexTime(t), e), this;
    }, s.default.Sequence.prototype._indexTime = function (t) {
      return t instanceof s.default.TransportTime ? t : s.default.Ticks(t * this._subdivision + this.startOffset).toSeconds();
    }, s.default.Sequence.prototype.dispose = function () {
      return s.default.Part.prototype.dispose.call(this), this;
    }, e.default = s.default.Sequence;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(71), i(79);
    s.default.Pattern = function () {
      var t = s.default.defaults(arguments, ["callback", "values", "pattern"], s.default.Pattern);
      s.default.Loop.call(this, t), this._pattern = new s.default.CtrlPattern({
        values: t.values,
        type: t.pattern,
        index: t.index
      });
    }, s.default.extend(s.default.Pattern, s.default.Loop), s.default.Pattern.defaults = {
      pattern: s.default.CtrlPattern.Type.Up,
      callback: s.default.noOp,
      values: []
    }, s.default.Pattern.prototype._tick = function (t) {
      this.callback(t, this._pattern.value), this._pattern.next();
    }, Object.defineProperty(s.default.Pattern.prototype, "index", {
      get: function () {
        return this._pattern.index;
      },
      set: function (t) {
        this._pattern.index = t;
      }
    }), Object.defineProperty(s.default.Pattern.prototype, "values", {
      get: function () {
        return this._pattern.values;
      },
      set: function (t) {
        this._pattern.values = t;
      }
    }), Object.defineProperty(s.default.Pattern.prototype, "value", {
      get: function () {
        return this._pattern.value;
      }
    }), Object.defineProperty(s.default.Pattern.prototype, "pattern", {
      get: function () {
        return this._pattern.type;
      },
      set: function (t) {
        this._pattern.type = t;
      }
    }), s.default.Pattern.prototype.dispose = function () {
      s.default.Loop.prototype.dispose.call(this), this._pattern.dispose(), this._pattern = null;
    }, e.default = s.default.Pattern;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(18), i(12);
    s.default.Vibrato = function () {
      var t = s.default.defaults(arguments, ["frequency", "depth"], s.default.Vibrato);
      s.default.Effect.call(this, t), this._delayNode = new s.default.Delay(0, t.maxDelay), this._lfo = new s.default.LFO({
        type: t.type,
        min: 0,
        max: t.maxDelay,
        frequency: t.frequency,
        phase: -90
      }).start().connect(this._delayNode.delayTime), this.frequency = this._lfo.frequency, this.depth = this._lfo.amplitude, this.depth.value = t.depth, this._readOnly(["frequency", "depth"]), this.effectSend.chain(this._delayNode, this.effectReturn);
    }, s.default.extend(s.default.Vibrato, s.default.Effect), s.default.Vibrato.defaults = {
      maxDelay: .005,
      frequency: 5,
      depth: .1,
      type: "sine"
    }, Object.defineProperty(s.default.Vibrato.prototype, "type", {
      get: function () {
        return this._lfo.type;
      },
      set: function (t) {
        this._lfo.type = t;
      }
    }), s.default.Vibrato.prototype.dispose = function () {
      s.default.Effect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._lfo.dispose(), this._lfo = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null;
    }, e.default = s.default.Vibrato;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(12), i(15);
    s.default.Tremolo = function () {
      var t = s.default.defaults(arguments, ["frequency", "depth"], s.default.Tremolo);
      s.default.StereoEffect.call(this, t), this._lfoL = new s.default.LFO({
        phase: t.spread,
        min: 1,
        max: 0
      }), this._lfoR = new s.default.LFO({
        phase: t.spread,
        min: 1,
        max: 0
      }), this._amplitudeL = new s.default.Gain(), this._amplitudeR = new s.default.Gain(), this.frequency = new s.default.Signal(t.frequency, s.default.Type.Frequency), this.depth = new s.default.Signal(t.depth, s.default.Type.NormalRange), this._readOnly(["frequency", "depth"]), this.effectSendL.chain(this._amplitudeL, this.effectReturnL), this.effectSendR.chain(this._amplitudeR, this.effectReturnR), this._lfoL.connect(this._amplitudeL.gain), this._lfoR.connect(this._amplitudeR.gain), this.frequency.fan(this._lfoL.frequency, this._lfoR.frequency), this.depth.fan(this._lfoR.amplitude, this._lfoL.amplitude), this.type = t.type, this.spread = t.spread;
    }, s.default.extend(s.default.Tremolo, s.default.StereoEffect), s.default.Tremolo.defaults = {
      frequency: 10,
      type: "sine",
      depth: .5,
      spread: 180
    }, s.default.Tremolo.prototype.start = function (t) {
      return this._lfoL.start(t), this._lfoR.start(t), this;
    }, s.default.Tremolo.prototype.stop = function (t) {
      return this._lfoL.stop(t), this._lfoR.stop(t), this;
    }, s.default.Tremolo.prototype.sync = function (t) {
      return this._lfoL.sync(t), this._lfoR.sync(t), s.default.Transport.syncSignal(this.frequency), this;
    }, s.default.Tremolo.prototype.unsync = function () {
      return this._lfoL.unsync(), this._lfoR.unsync(), s.default.Transport.unsyncSignal(this.frequency), this;
    }, Object.defineProperty(s.default.Tremolo.prototype, "type", {
      get: function () {
        return this._lfoL.type;
      },
      set: function (t) {
        this._lfoL.type = t, this._lfoR.type = t;
      }
    }), Object.defineProperty(s.default.Tremolo.prototype, "spread", {
      get: function () {
        return this._lfoR.phase - this._lfoL.phase;
      },
      set: function (t) {
        this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90;
      }
    }), s.default.Tremolo.prototype.dispose = function () {
      return s.default.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "depth"]), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._amplitudeL.dispose(), this._amplitudeL = null, this._amplitudeR.dispose(), this._amplitudeR = null, this.frequency = null, this.depth = null, this;
    }, e.default = s.default.Tremolo;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(73), i(2), i(5), i(13);
    s.default.StereoWidener = function () {
      var t = s.default.defaults(arguments, ["width"], s.default.StereoWidener);
      s.default.MidSideEffect.call(this, t), this.width = new s.default.Signal(t.width, s.default.Type.NormalRange), this._readOnly(["width"]), this._twoTimesWidthMid = new s.default.Multiply(2), this._twoTimesWidthSide = new s.default.Multiply(2), this._midMult = new s.default.Multiply(), this._twoTimesWidthMid.connect(this._midMult, 0, 1), this.midSend.chain(this._midMult, this.midReturn), this._oneMinusWidth = new s.default.Subtract(), this._oneMinusWidth.connect(this._twoTimesWidthMid), s.default.connect(this.context.getConstant(1), this._oneMinusWidth, 0, 0), this.width.connect(this._oneMinusWidth, 0, 1), this._sideMult = new s.default.Multiply(), this.width.connect(this._twoTimesWidthSide), this._twoTimesWidthSide.connect(this._sideMult, 0, 1), this.sideSend.chain(this._sideMult, this.sideReturn);
    }, s.default.extend(s.default.StereoWidener, s.default.MidSideEffect), s.default.StereoWidener.defaults = {
      width: .5
    }, s.default.StereoWidener.prototype.dispose = function () {
      return s.default.MidSideEffect.prototype.dispose.call(this), this._writable(["width"]), this.width.dispose(), this.width = null, this._midMult.dispose(), this._midMult = null, this._sideMult.dispose(), this._sideMult = null, this._twoTimesWidthMid.dispose(), this._twoTimesWidthMid = null, this._twoTimesWidthSide.dispose(), this._twoTimesWidthSide = null, this._oneMinusWidth.dispose(), this._oneMinusWidth = null, this;
    }, e.default = s.default.StereoWidener;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(15), i(33), i(3);
    s.default.StereoFeedbackEffect = function () {
      var t = s.default.defaults(arguments, ["feedback"], s.default.FeedbackEffect);
      s.default.StereoEffect.call(this, t), this.feedback = new s.default.Signal(t.feedback, s.default.Type.NormalRange), this._feedbackL = new s.default.Gain(), this._feedbackR = new s.default.Gain(), this.effectReturnL.chain(this._feedbackL, this.effectSendL), this.effectReturnR.chain(this._feedbackR, this.effectSendR), this.feedback.fan(this._feedbackL.gain, this._feedbackR.gain), this._readOnly(["feedback"]);
    }, s.default.extend(s.default.StereoFeedbackEffect, s.default.StereoEffect), s.default.StereoFeedbackEffect.prototype.dispose = function () {
      return s.default.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackL.dispose(), this._feedbackL = null, this._feedbackR.dispose(), this._feedbackR = null, this;
    }, e.default = s.default.StereoFeedbackEffect;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(77), i(9), i(10), i(39), i(3), i(74);
    s.default.Reverb = function () {
      var t = s.default.defaults(arguments, ["decay"], s.default.Reverb);
      s.default.Effect.call(this, t), this._convolver = this.context.createConvolver(), this.decay = t.decay, this.preDelay = t.preDelay, this.connectEffect(this._convolver);
    }, s.default.extend(s.default.Reverb, s.default.Effect), s.default.Reverb.defaults = {
      decay: 1.5,
      preDelay: .01
    }, s.default.Reverb.prototype.generate = function () {
      return s.default.Offline(function () {
        var t = new s.default.Noise(),
            e = new s.default.Noise(),
            i = new s.default.Merge();
        t.connect(i.left), e.connect(i.right);
        var n = new s.default.Gain().toMaster();
        i.connect(n), t.start(0), e.start(0), n.gain.setValueAtTime(0, 0), n.gain.setValueAtTime(1, this.preDelay), n.gain.exponentialApproachValueAtTime(0, this.preDelay, this.decay + this.preDelay);
      }.bind(this), this.decay + this.preDelay).then(function (t) {
        return this._convolver.buffer = t.get(), this;
      }.bind(this));
    }, s.default.Reverb.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._convolver.disconnect(), this._convolver = null, this;
    }, e.default = s.default.Reverb;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(12), i(23), i(2), i(33), i(18);
    s.default.PitchShift = function () {
      var t = s.default.defaults(arguments, ["pitch"], s.default.PitchShift);
      s.default.FeedbackEffect.call(this, t), this._frequency = new s.default.Signal(0), this._delayA = new s.default.Delay(0, 1), this._lfoA = new s.default.LFO({
        min: 0,
        max: .1,
        type: "sawtooth"
      }).connect(this._delayA.delayTime), this._delayB = new s.default.Delay(0, 1), this._lfoB = new s.default.LFO({
        min: 0,
        max: .1,
        type: "sawtooth",
        phase: 180
      }).connect(this._delayB.delayTime), this._crossFade = new s.default.CrossFade(), this._crossFadeLFO = new s.default.LFO({
        min: 0,
        max: 1,
        type: "triangle",
        phase: 90
      }).connect(this._crossFade.fade), this._feedbackDelay = new s.default.Delay(t.delayTime), this.delayTime = this._feedbackDelay.delayTime, this._readOnly("delayTime"), this._pitch = t.pitch, this._windowSize = t.windowSize, this._delayA.connect(this._crossFade.a), this._delayB.connect(this._crossFade.b), this._frequency.fan(this._lfoA.frequency, this._lfoB.frequency, this._crossFadeLFO.frequency), this.effectSend.fan(this._delayA, this._delayB), this._crossFade.chain(this._feedbackDelay, this.effectReturn);
      var e = this.now();
      this._lfoA.start(e), this._lfoB.start(e), this._crossFadeLFO.start(e), this.windowSize = this._windowSize;
    }, s.default.extend(s.default.PitchShift, s.default.FeedbackEffect), s.default.PitchShift.defaults = {
      pitch: 0,
      windowSize: .1,
      delayTime: 0,
      feedback: 0
    }, Object.defineProperty(s.default.PitchShift.prototype, "pitch", {
      get: function () {
        return this._pitch;
      },
      set: function (t) {
        this._pitch = t;
        var e = 0;
        t < 0 ? (this._lfoA.min = 0, this._lfoA.max = this._windowSize, this._lfoB.min = 0, this._lfoB.max = this._windowSize, e = s.default.intervalToFrequencyRatio(t - 1) + 1) : (this._lfoA.min = this._windowSize, this._lfoA.max = 0, this._lfoB.min = this._windowSize, this._lfoB.max = 0, e = s.default.intervalToFrequencyRatio(t) - 1), this._frequency.value = e * (1.2 / this._windowSize);
      }
    }), Object.defineProperty(s.default.PitchShift.prototype, "windowSize", {
      get: function () {
        return this._windowSize;
      },
      set: function (t) {
        this._windowSize = this.toSeconds(t), this.pitch = this._pitch;
      }
    }), s.default.PitchShift.prototype.dispose = function () {
      return s.default.FeedbackEffect.prototype.dispose.call(this), this._frequency.dispose(), this._frequency = null, this._delayA.disconnect(), this._delayA = null, this._delayB.disconnect(), this._delayB = null, this._lfoA.dispose(), this._lfoA = null, this._lfoB.dispose(), this._lfoB = null, this._crossFade.dispose(), this._crossFade = null, this._crossFadeLFO.dispose(), this._crossFadeLFO = null, this._writable("delayTime"), this._feedbackDelay.dispose(), this._feedbackDelay = null, this.delayTime = null, this;
    }, e.default = s.default.PitchShift;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(72), i(2), i(18);
    s.default.PingPongDelay = function () {
      var t = s.default.defaults(arguments, ["delayTime", "feedback"], s.default.PingPongDelay);
      s.default.StereoXFeedbackEffect.call(this, t), this._leftDelay = new s.default.Delay(0, t.maxDelayTime), this._rightDelay = new s.default.Delay(0, t.maxDelayTime), this._rightPreDelay = new s.default.Delay(0, t.maxDelayTime), this.delayTime = new s.default.Signal(t.delayTime, s.default.Type.Time), this.effectSendL.chain(this._leftDelay, this.effectReturnL), this.effectSendR.chain(this._rightPreDelay, this._rightDelay, this.effectReturnR), this.delayTime.fan(this._leftDelay.delayTime, this._rightDelay.delayTime, this._rightPreDelay.delayTime), this._feedbackLR.disconnect(), this._feedbackLR.connect(this._rightDelay), this._readOnly(["delayTime"]);
    }, s.default.extend(s.default.PingPongDelay, s.default.StereoXFeedbackEffect), s.default.PingPongDelay.defaults = {
      delayTime: .25,
      maxDelayTime: 1
    }, s.default.PingPongDelay.prototype.dispose = function () {
      return s.default.StereoXFeedbackEffect.prototype.dispose.call(this), this._leftDelay.dispose(), this._leftDelay = null, this._rightDelay.dispose(), this._rightDelay = null, this._rightPreDelay.dispose(), this._rightPreDelay = null, this._writable(["delayTime"]), this.delayTime.dispose(), this.delayTime = null, this;
    }, e.default = s.default.PingPongDelay;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(12), i(9), i(15);
    s.default.Phaser = function () {
      var t = s.default.defaults(arguments, ["frequency", "octaves", "baseFrequency"], s.default.Phaser);
      s.default.StereoEffect.call(this, t), this._lfoL = new s.default.LFO(t.frequency, 0, 1), this._lfoR = new s.default.LFO(t.frequency, 0, 1), this._lfoR.phase = 180, this._baseFrequency = t.baseFrequency, this._octaves = t.octaves, this.Q = new s.default.Signal(t.Q, s.default.Type.Positive), this._filtersL = this._makeFilters(t.stages, this._lfoL, this.Q), this._filtersR = this._makeFilters(t.stages, this._lfoR, this.Q), this.frequency = this._lfoL.frequency, this.frequency.value = t.frequency, this.effectSendL.connect(this._filtersL[0]), this.effectSendR.connect(this._filtersR[0]), s.default.connect(this._filtersL[t.stages - 1], this.effectReturnL), s.default.connect(this._filtersR[t.stages - 1], this.effectReturnR), this._lfoL.frequency.connect(this._lfoR.frequency), this.baseFrequency = t.baseFrequency, this.octaves = t.octaves, this._lfoL.start(), this._lfoR.start(), this._readOnly(["frequency", "Q"]);
    }, s.default.extend(s.default.Phaser, s.default.StereoEffect), s.default.Phaser.defaults = {
      frequency: .5,
      octaves: 3,
      stages: 10,
      Q: 10,
      baseFrequency: 350
    }, s.default.Phaser.prototype._makeFilters = function (t, e, i) {
      for (var n = new Array(t), o = 0; o < t; o++) {
        var a = this.context.createBiquadFilter();
        a.type = "allpass", i.connect(a.Q), e.connect(a.frequency), n[o] = a;
      }

      return s.default.connectSeries.apply(s.default, n), n;
    }, Object.defineProperty(s.default.Phaser.prototype, "octaves", {
      get: function () {
        return this._octaves;
      },
      set: function (t) {
        this._octaves = t;
        var e = this._baseFrequency * Math.pow(2, t);
        this._lfoL.max = e, this._lfoR.max = e;
      }
    }), Object.defineProperty(s.default.Phaser.prototype, "baseFrequency", {
      get: function () {
        return this._baseFrequency;
      },
      set: function (t) {
        this._baseFrequency = t, this._lfoL.min = t, this._lfoR.min = t, this.octaves = this._octaves;
      }
    }), s.default.Phaser.prototype.dispose = function () {
      s.default.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "Q"]), this.Q.dispose(), this.Q = null, this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null;

      for (var t = 0; t < this._filtersL.length; t++) this._filtersL[t].disconnect(), this._filtersL[t] = null;

      this._filtersL = null;

      for (var e = 0; e < this._filtersR.length; e++) this._filtersR[e].disconnect(), this._filtersR[e] = null;

      return this._filtersR = null, this.frequency = null, this;
    }, e.default = s.default.Phaser;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0),
        n = (i(59), i(15), i(26), [.06748, .06404, .08212, .09004]),
        o = [.773, .802, .753, .733],
        a = [347, 113, 37];
    s.default.JCReverb = function () {
      var t = s.default.defaults(arguments, ["roomSize"], s.default.JCReverb);
      s.default.StereoEffect.call(this, t), this.roomSize = new s.default.Signal(t.roomSize, s.default.Type.NormalRange), this._scaleRoomSize = new s.default.Scale(-.733, .197), this._allpassFilters = [], this._feedbackCombFilters = [];

      for (var e = 0; e < a.length; e++) {
        var i = this.context.createBiquadFilter();
        i.type = "allpass", i.frequency.value = a[e], this._allpassFilters.push(i);
      }

      for (var r = 0; r < n.length; r++) {
        var l = new s.default.FeedbackCombFilter(n[r], .1);
        this._scaleRoomSize.connect(l.resonance), l.resonance.value = o[r], s.default.connect(this._allpassFilters[this._allpassFilters.length - 1], l), r < n.length / 2 ? l.connect(this.effectReturnL) : l.connect(this.effectReturnR), this._feedbackCombFilters.push(l);
      }

      this.roomSize.connect(this._scaleRoomSize), s.default.connectSeries.apply(s.default, this._allpassFilters), this.effectSendL.connect(this._allpassFilters[0]), this.effectSendR.connect(this._allpassFilters[0]), this._readOnly(["roomSize"]);
    }, s.default.extend(s.default.JCReverb, s.default.StereoEffect), s.default.JCReverb.defaults = {
      roomSize: .5
    }, s.default.JCReverb.prototype.dispose = function () {
      s.default.StereoEffect.prototype.dispose.call(this);

      for (var t = 0; t < this._allpassFilters.length; t++) this._allpassFilters[t].disconnect(), this._allpassFilters[t] = null;

      this._allpassFilters = null;

      for (var e = 0; e < this._feedbackCombFilters.length; e++) this._feedbackCombFilters[e].dispose(), this._feedbackCombFilters[e] = null;

      return this._feedbackCombFilters = null, this._writable(["roomSize"]), this.roomSize.dispose(), this.roomSize = null, this._scaleRoomSize.dispose(), this._scaleRoomSize = null, this;
    }, e.default = s.default.JCReverb;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0),
        n = (i(54), i(15), i(2), i(19), i(10), i(42), [1557 / 44100, 1617 / 44100, 1491 / 44100, 1422 / 44100, 1277 / 44100, 1356 / 44100, 1188 / 44100, 1116 / 44100]),
        o = [225, 556, 441, 341];
    s.default.Freeverb = function () {
      var t = s.default.defaults(arguments, ["roomSize", "dampening"], s.default.Freeverb);
      s.default.StereoEffect.call(this, t), this.roomSize = new s.default.Signal(t.roomSize, s.default.Type.NormalRange), this.dampening = new s.default.Signal(t.dampening, s.default.Type.Frequency), this._combFilters = [], this._allpassFiltersL = [], this._allpassFiltersR = [];

      for (var e = 0; e < o.length; e++) {
        var i = this.context.createBiquadFilter();
        i.type = "allpass", i.frequency.value = o[e], this._allpassFiltersL.push(i);
      }

      for (var a = 0; a < o.length; a++) {
        var r = this.context.createBiquadFilter();
        r.type = "allpass", r.frequency.value = o[a], this._allpassFiltersR.push(r);
      }

      for (var l = 0; l < n.length; l++) {
        var u = new s.default.LowpassCombFilter(n[l]);
        l < n.length / 2 ? this.effectSendL.chain(u, this._allpassFiltersL[0]) : this.effectSendR.chain(u, this._allpassFiltersR[0]), this.roomSize.connect(u.resonance), this.dampening.connect(u.dampening), this._combFilters.push(u);
      }

      s.default.connectSeries.apply(s.default, this._allpassFiltersL), s.default.connectSeries.apply(s.default, this._allpassFiltersR), s.default.connect(this._allpassFiltersL[this._allpassFiltersL.length - 1], this.effectReturnL), s.default.connect(this._allpassFiltersR[this._allpassFiltersR.length - 1], this.effectReturnR), this._readOnly(["roomSize", "dampening"]);
    }, s.default.extend(s.default.Freeverb, s.default.StereoEffect), s.default.Freeverb.defaults = {
      roomSize: .7,
      dampening: 3e3
    }, s.default.Freeverb.prototype.dispose = function () {
      s.default.StereoEffect.prototype.dispose.call(this);

      for (var t = 0; t < this._allpassFiltersL.length; t++) this._allpassFiltersL[t].disconnect(), this._allpassFiltersL[t] = null;

      this._allpassFiltersL = null;

      for (var e = 0; e < this._allpassFiltersR.length; e++) this._allpassFiltersR[e].disconnect(), this._allpassFiltersR[e] = null;

      this._allpassFiltersR = null;

      for (var i = 0; i < this._combFilters.length; i++) this._combFilters[i].dispose(), this._combFilters[i] = null;

      return this._combFilters = null, this._writable(["roomSize", "dampening"]), this.roomSize.dispose(), this.roomSize = null, this.dampening.dispose(), this.dampening = null, this;
    }, e.default = s.default.Freeverb;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(33), i(2), i(18);
    s.default.FeedbackDelay = function () {
      var t = s.default.defaults(arguments, ["delayTime", "feedback"], s.default.FeedbackDelay);
      s.default.FeedbackEffect.call(this, t), this._delayNode = new s.default.Delay(t.delayTime, t.maxDelay), this.delayTime = this._delayNode.delayTime, this.connectEffect(this._delayNode), this._readOnly(["delayTime"]);
    }, s.default.extend(s.default.FeedbackDelay, s.default.FeedbackEffect), s.default.FeedbackDelay.defaults = {
      delayTime: .25,
      maxDelay: 1
    }, s.default.FeedbackDelay.prototype.dispose = function () {
      return s.default.FeedbackEffect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._writable(["delayTime"]), this.delayTime = null, this;
    }, e.default = s.default.FeedbackDelay;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(7);
    s.default.Distortion = function () {
      var t = s.default.defaults(arguments, ["distortion"], s.default.Distortion);
      s.default.Effect.call(this, t), this._shaper = new s.default.WaveShaper(4096), this._distortion = t.distortion, this.connectEffect(this._shaper), this.distortion = t.distortion, this.oversample = t.oversample;
    }, s.default.extend(s.default.Distortion, s.default.Effect), s.default.Distortion.defaults = {
      distortion: .4,
      oversample: "none"
    }, Object.defineProperty(s.default.Distortion.prototype, "distortion", {
      get: function () {
        return this._distortion;
      },
      set: function (t) {
        this._distortion = t;
        var e = 100 * t,
            i = Math.PI / 180;

        this._shaper.setMap(function (t) {
          return Math.abs(t) < .001 ? 0 : (3 + e) * t * 20 * i / (Math.PI + e * Math.abs(t));
        });
      }
    }), Object.defineProperty(s.default.Distortion.prototype, "oversample", {
      get: function () {
        return this._shaper.oversample;
      },
      set: function (t) {
        this._shaper.oversample = t;
      }
    }), s.default.Distortion.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this;
    }, e.default = s.default.Distortion;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(12), i(15), i(18);
    s.default.Chorus = function () {
      var t = s.default.defaults(arguments, ["frequency", "delayTime", "depth"], s.default.Chorus);
      s.default.StereoEffect.call(this, t), this._depth = t.depth, this._delayTime = t.delayTime / 1e3, this._lfoL = new s.default.LFO({
        frequency: t.frequency,
        min: 0,
        max: 1
      }), this._lfoR = new s.default.LFO({
        frequency: t.frequency,
        min: 0,
        max: 1,
        phase: 180
      }), this._delayNodeL = new s.default.Delay(), this._delayNodeR = new s.default.Delay(), this.frequency = this._lfoL.frequency, this.effectSendL.chain(this._delayNodeL, this.effectReturnL), this.effectSendR.chain(this._delayNodeR, this.effectReturnR), this.effectSendL.connect(this.effectReturnL), this.effectSendR.connect(this.effectReturnR), this._lfoL.connect(this._delayNodeL.delayTime), this._lfoR.connect(this._delayNodeR.delayTime), this._lfoL.start(), this._lfoR.start(), this._lfoL.frequency.connect(this._lfoR.frequency), this.depth = this._depth, this.frequency.value = t.frequency, this.type = t.type, this._readOnly(["frequency"]), this.spread = t.spread;
    }, s.default.extend(s.default.Chorus, s.default.StereoEffect), s.default.Chorus.defaults = {
      frequency: 1.5,
      delayTime: 3.5,
      depth: .7,
      type: "sine",
      spread: 180
    }, Object.defineProperty(s.default.Chorus.prototype, "depth", {
      get: function () {
        return this._depth;
      },
      set: function (t) {
        this._depth = t;
        var e = this._delayTime * t;
        this._lfoL.min = Math.max(this._delayTime - e, 0), this._lfoL.max = this._delayTime + e, this._lfoR.min = Math.max(this._delayTime - e, 0), this._lfoR.max = this._delayTime + e;
      }
    }), Object.defineProperty(s.default.Chorus.prototype, "delayTime", {
      get: function () {
        return 1e3 * this._delayTime;
      },
      set: function (t) {
        this._delayTime = t / 1e3, this.depth = this._depth;
      }
    }), Object.defineProperty(s.default.Chorus.prototype, "type", {
      get: function () {
        return this._lfoL.type;
      },
      set: function (t) {
        this._lfoL.type = t, this._lfoR.type = t;
      }
    }), Object.defineProperty(s.default.Chorus.prototype, "spread", {
      get: function () {
        return this._lfoR.phase - this._lfoL.phase;
      },
      set: function (t) {
        this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90;
      }
    }), s.default.Chorus.prototype.dispose = function () {
      return s.default.StereoEffect.prototype.dispose.call(this), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._delayNodeL.dispose(), this._delayNodeL = null, this._delayNodeR.dispose(), this._delayNodeR = null, this._writable("frequency"), this.frequency = null, this;
    }, e.default = s.default.Chorus;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(7);
    s.default.Chebyshev = function () {
      var t = s.default.defaults(arguments, ["order"], s.default.Chebyshev);
      s.default.Effect.call(this, t), this._shaper = new s.default.WaveShaper(4096), this._order = t.order, this.connectEffect(this._shaper), this.order = t.order, this.oversample = t.oversample;
    }, s.default.extend(s.default.Chebyshev, s.default.Effect), s.default.Chebyshev.defaults = {
      order: 1,
      oversample: "none"
    }, s.default.Chebyshev.prototype._getCoefficient = function (t, e, i) {
      return i.hasOwnProperty(e) ? i[e] : (i[e] = 0 === e ? 0 : 1 === e ? t : 2 * t * this._getCoefficient(t, e - 1, i) - this._getCoefficient(t, e - 2, i), i[e]);
    }, Object.defineProperty(s.default.Chebyshev.prototype, "order", {
      get: function () {
        return this._order;
      },
      set: function (t) {
        this._order = t;

        for (var e = new Array(4096), i = e.length, s = 0; s < i; ++s) {
          var n = 2 * s / i - 1;
          e[s] = 0 === n ? 0 : this._getCoefficient(n, t, {});
        }

        this._shaper.curve = e;
      }
    }), Object.defineProperty(s.default.Chebyshev.prototype, "oversample", {
      get: function () {
        return this._shaper.oversample;
      },
      set: function (t) {
        this._shaper.oversample = t;
      }
    }), s.default.Chebyshev.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this;
    }, e.default = s.default.Chebyshev;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(13), i(75);
    s.default.BitCrusher = function () {
      var t = s.default.defaults(arguments, ["bits"], s.default.BitCrusher);
      s.default.Effect.call(this, t);
      var e = 1 / Math.pow(2, t.bits - 1);
      this._subtract = new s.default.Subtract(), this._modulo = new s.default.Modulo(e), this._bits = t.bits, this.effectSend.fan(this._subtract, this._modulo), this._modulo.connect(this._subtract, 0, 1), this._subtract.connect(this.effectReturn);
    }, s.default.extend(s.default.BitCrusher, s.default.Effect), s.default.BitCrusher.defaults = {
      bits: 4
    }, Object.defineProperty(s.default.BitCrusher.prototype, "bits", {
      get: function () {
        return this._bits;
      },
      set: function (t) {
        this._bits = t;
        var e = 1 / Math.pow(2, t - 1);
        this._modulo.value = e;
      }
    }), s.default.BitCrusher.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._subtract.dispose(), this._subtract = null, this._modulo.dispose(), this._modulo = null, this;
    }, e.default = s.default.BitCrusher;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(58), i(42), i(8), i(9);
    s.default.AutoWah = function () {
      var t = s.default.defaults(arguments, ["baseFrequency", "octaves", "sensitivity"], s.default.AutoWah);
      s.default.Effect.call(this, t), this.follower = new s.default.Follower(t.follower), this._sweepRange = new s.default.ScaleExp(0, 1, .5), this._baseFrequency = t.baseFrequency, this._octaves = t.octaves, this._inputBoost = new s.default.Gain(), this._bandpass = new s.default.Filter({
        rolloff: -48,
        frequency: 0,
        Q: t.Q
      }), this._peaking = new s.default.Filter(0, "peaking"), this._peaking.gain.value = t.gain, this.gain = this._peaking.gain, this.Q = this._bandpass.Q, this.effectSend.chain(this._inputBoost, this.follower, this._sweepRange), this._sweepRange.connect(this._bandpass.frequency), this._sweepRange.connect(this._peaking.frequency), this.effectSend.chain(this._bandpass, this._peaking, this.effectReturn), this._setSweepRange(), this.sensitivity = t.sensitivity, this._readOnly(["gain", "Q"]);
    }, s.default.extend(s.default.AutoWah, s.default.Effect), s.default.AutoWah.defaults = {
      baseFrequency: 100,
      octaves: 6,
      sensitivity: 0,
      Q: 2,
      gain: 2,
      follower: {
        attack: .3,
        release: .5
      }
    }, Object.defineProperty(s.default.AutoWah.prototype, "octaves", {
      get: function () {
        return this._octaves;
      },
      set: function (t) {
        this._octaves = t, this._setSweepRange();
      }
    }), Object.defineProperty(s.default.AutoWah.prototype, "baseFrequency", {
      get: function () {
        return this._baseFrequency;
      },
      set: function (t) {
        this._baseFrequency = t, this._setSweepRange();
      }
    }), Object.defineProperty(s.default.AutoWah.prototype, "sensitivity", {
      get: function () {
        return s.default.gainToDb(1 / this._inputBoost.gain.value);
      },
      set: function (t) {
        this._inputBoost.gain.value = 1 / s.default.dbToGain(t);
      }
    }), s.default.AutoWah.prototype._setSweepRange = function () {
      this._sweepRange.min = this._baseFrequency, this._sweepRange.max = Math.min(this._baseFrequency * Math.pow(2, this._octaves), this.context.sampleRate / 2);
    }, s.default.AutoWah.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this.follower.dispose(), this.follower = null, this._sweepRange.dispose(), this._sweepRange = null, this._bandpass.dispose(), this._bandpass = null, this._peaking.dispose(), this._peaking = null, this._inputBoost.dispose(), this._inputBoost = null, this._writable(["gain", "Q"]), this.gain = null, this.Q = null, this;
    }, e.default = s.default.AutoWah;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(12), i(48);
    s.default.AutoPanner = function () {
      var t = s.default.defaults(arguments, ["frequency"], s.default.AutoPanner);
      s.default.Effect.call(this, t), this._lfo = new s.default.LFO({
        frequency: t.frequency,
        amplitude: t.depth,
        min: -1,
        max: 1
      }), this.depth = this._lfo.amplitude, this._panner = new s.default.Panner(), this.frequency = this._lfo.frequency, this.connectEffect(this._panner), this._lfo.connect(this._panner.pan), this.type = t.type, this._readOnly(["depth", "frequency"]);
    }, s.default.extend(s.default.AutoPanner, s.default.Effect), s.default.AutoPanner.defaults = {
      frequency: 1,
      type: "sine",
      depth: 1
    }, s.default.AutoPanner.prototype.start = function (t) {
      return this._lfo.start(t), this;
    }, s.default.AutoPanner.prototype.stop = function (t) {
      return this._lfo.stop(t), this;
    }, s.default.AutoPanner.prototype.sync = function (t) {
      return this._lfo.sync(t), this;
    }, s.default.AutoPanner.prototype.unsync = function () {
      return this._lfo.unsync(), this;
    }, Object.defineProperty(s.default.AutoPanner.prototype, "type", {
      get: function () {
        return this._lfo.type;
      },
      set: function (t) {
        this._lfo.type = t;
      }
    }), s.default.AutoPanner.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this._panner.dispose(), this._panner = null, this._writable(["depth", "frequency"]), this.frequency = null, this.depth = null, this;
    }, e.default = s.default.AutoPanner;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(8), i(12), i(9);
    s.default.AutoFilter = function () {
      var t = s.default.defaults(arguments, ["frequency", "baseFrequency", "octaves"], s.default.AutoFilter);
      s.default.Effect.call(this, t), this._lfo = new s.default.LFO({
        frequency: t.frequency,
        amplitude: t.depth
      }), this.depth = this._lfo.amplitude, this.frequency = this._lfo.frequency, this.filter = new s.default.Filter(t.filter), this._octaves = 0, this.connectEffect(this.filter), this._lfo.connect(this.filter.frequency), this.type = t.type, this._readOnly(["frequency", "depth"]), this.octaves = t.octaves, this.baseFrequency = t.baseFrequency;
    }, s.default.extend(s.default.AutoFilter, s.default.Effect), s.default.AutoFilter.defaults = {
      frequency: 1,
      type: "sine",
      depth: 1,
      baseFrequency: 200,
      octaves: 2.6,
      filter: {
        type: "lowpass",
        rolloff: -12,
        Q: 1
      }
    }, s.default.AutoFilter.prototype.start = function (t) {
      return this._lfo.start(t), this;
    }, s.default.AutoFilter.prototype.stop = function (t) {
      return this._lfo.stop(t), this;
    }, s.default.AutoFilter.prototype.sync = function (t) {
      return this._lfo.sync(t), this;
    }, s.default.AutoFilter.prototype.unsync = function () {
      return this._lfo.unsync(), this;
    }, Object.defineProperty(s.default.AutoFilter.prototype, "type", {
      get: function () {
        return this._lfo.type;
      },
      set: function (t) {
        this._lfo.type = t;
      }
    }), Object.defineProperty(s.default.AutoFilter.prototype, "baseFrequency", {
      get: function () {
        return this._lfo.min;
      },
      set: function (t) {
        this._lfo.min = this.toFrequency(t), this.octaves = this._octaves;
      }
    }), Object.defineProperty(s.default.AutoFilter.prototype, "octaves", {
      get: function () {
        return this._octaves;
      },
      set: function (t) {
        this._octaves = t, this._lfo.max = this.baseFrequency * Math.pow(2, t);
      }
    }), s.default.AutoFilter.prototype.dispose = function () {
      return s.default.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this.filter.dispose(), this.filter = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null, this;
    }, e.default = s.default.AutoFilter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(23), i(10), i(19), i(2), i(22), i(28);
    s.default.Listener = function () {
      s.default.call(this), this._orientation = [0, 0, 0, 0, 0, 0], this._position = [0, 0, 0], s.default.getContext(function () {
        this.set(n.defaults);
      }.bind(this));
    }, s.default.extend(s.default.Listener), s.default.Listener.defaults = {
      positionX: 0,
      positionY: 0,
      positionZ: 0,
      forwardX: 0,
      forwardY: 0,
      forwardZ: 1,
      upX: 0,
      upY: 1,
      upZ: 0
    }, s.default.Listener.prototype.isListener = !0, s.default.Listener.prototype._rampTimeConstant = .01, s.default.Listener.prototype.setPosition = function (t, e, i) {
      if (this.context.rawContext.listener.positionX) {
        var s = this.now();
        this.context.rawContext.listener.positionX.setTargetAtTime(t, s, this._rampTimeConstant), this.context.rawContext.listener.positionY.setTargetAtTime(e, s, this._rampTimeConstant), this.context.rawContext.listener.positionZ.setTargetAtTime(i, s, this._rampTimeConstant);
      } else this.context.rawContext.listener.setPosition(t, e, i);

      return this._position = Array.prototype.slice.call(arguments), this;
    }, s.default.Listener.prototype.setOrientation = function (t, e, i, s, n, o) {
      if (this.context.rawContext.listener.forwardX) {
        var a = this.now();
        this.context.rawContext.listener.forwardX.setTargetAtTime(t, a, this._rampTimeConstant), this.context.rawContext.listener.forwardY.setTargetAtTime(e, a, this._rampTimeConstant), this.context.rawContext.listener.forwardZ.setTargetAtTime(i, a, this._rampTimeConstant), this.context.rawContext.listener.upX.setTargetAtTime(s, a, this._rampTimeConstant), this.context.rawContext.listener.upY.setTargetAtTime(n, a, this._rampTimeConstant), this.context.rawContext.listener.upZ.setTargetAtTime(o, a, this._rampTimeConstant);
      } else this.context.rawContext.listener.setOrientation(t, e, i, s, n, o);

      return this._orientation = Array.prototype.slice.call(arguments), this;
    }, Object.defineProperty(s.default.Listener.prototype, "positionX", {
      set: function (t) {
        this._position[0] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[0];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "positionY", {
      set: function (t) {
        this._position[1] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[1];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "positionZ", {
      set: function (t) {
        this._position[2] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[2];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "forwardX", {
      set: function (t) {
        this._orientation[0] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[0];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "forwardY", {
      set: function (t) {
        this._orientation[1] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[1];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "forwardZ", {
      set: function (t) {
        this._orientation[2] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[2];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "upX", {
      set: function (t) {
        this._orientation[3] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[3];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "upY", {
      set: function (t) {
        this._orientation[4] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[4];
      }
    }), Object.defineProperty(s.default.Listener.prototype, "upZ", {
      set: function (t) {
        this._orientation[5] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[5];
      }
    }), s.default.Listener.prototype.dispose = function () {
      return this._orientation = null, this._position = null, this;
    };
    var n = s.default.Listener;
    s.default.Listener = new n(), s.default.Context.on("init", function (t) {
      t.listener && t.listener.isListener ? s.default.Listener = t.listener : s.default.Listener = new n();
    }), e.default = s.default.Listener;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(24);
    s.default.Draw = function () {
      s.default.call(this), this._events = new s.default.Timeline(), this.expiration = .25, this.anticipation = .008, this._boundDrawLoop = this._drawLoop.bind(this);
    }, s.default.extend(s.default.Draw), s.default.Draw.prototype.schedule = function (t, e) {
      return this._events.add({
        callback: t,
        time: this.toSeconds(e)
      }), 1 === this._events.length && requestAnimationFrame(this._boundDrawLoop), this;
    }, s.default.Draw.prototype.cancel = function (t) {
      return this._events.cancel(this.toSeconds(t)), this;
    }, s.default.Draw.prototype._drawLoop = function () {
      for (var t = s.default.context.currentTime; this._events.length && this._events.peek().time - this.anticipation <= t;) {
        var e = this._events.shift();

        t - e.time <= this.expiration && e.callback();
      }

      this._events.length > 0 && requestAnimationFrame(this._boundDrawLoop);
    }, s.default.Draw = new s.default.Draw(), e.default = s.default.Draw;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0),
        n = (i(3), {});
    s.default.prototype.send = function (t, e) {
      n.hasOwnProperty(t) || (n[t] = this.context.createGain()), e = s.default.defaultArg(e, 0);
      var i = new s.default.Gain(e, s.default.Type.Decibels);
      return this.connect(i), i.connect(n[t]), i;
    }, s.default.prototype.receive = function (t, e) {
      return n.hasOwnProperty(t) || (n[t] = this.context.createGain()), s.default.connect(n[t], this, 0, e), this;
    }, s.default.Context.on("init", function (t) {
      t.buses ? n = t.buses : (n = {}, t.buses = n);
    }), e.default = s.default;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4);
    s.default.CtrlRandom = function () {
      var t = s.default.defaults(arguments, ["min", "max"], s.default.CtrlRandom);
      s.default.call(this), this.min = t.min, this.max = t.max, this.integer = t.integer;
    }, s.default.extend(s.default.CtrlRandom), s.default.CtrlRandom.defaults = {
      min: 0,
      max: 1,
      integer: !1
    }, Object.defineProperty(s.default.CtrlRandom.prototype, "value", {
      get: function () {
        var t = this.toSeconds(this.min),
            e = this.toSeconds(this.max),
            i = Math.random(),
            s = i * t + (1 - i) * e;
        return this.integer && (s = Math.floor(s)), s;
      }
    }), e.default = s.default.CtrlRandom;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    s.default.CtrlMarkov = function (t, e) {
      s.default.call(this), this.values = s.default.defaultArg(t, {}), this.value = s.default.defaultArg(e, Object.keys(this.values)[0]);
    }, s.default.extend(s.default.CtrlMarkov), s.default.CtrlMarkov.prototype.next = function () {
      if (this.values.hasOwnProperty(this.value)) {
        var t = this.values[this.value];
        if (s.default.isArray(t)) for (var e = this._getProbDistribution(t), i = Math.random(), n = 0, o = 0; o < e.length; o++) {
          var a = e[o];

          if (i > n && i < n + a) {
            var r = t[o];
            s.default.isObject(r) ? this.value = r.value : this.value = r;
          }

          n += a;
        } else this.value = t;
      }

      return this.value;
    }, s.default.CtrlMarkov.prototype._getProbDistribution = function (t) {
      for (var e = [], i = 0, n = !1, o = 0; o < t.length; o++) {
        var a = t[o];
        s.default.isObject(a) ? (n = !0, e[o] = a.probability) : e[o] = 1 / t.length, i += e[o];
      }

      if (n) for (var r = 0; r < e.length; r++) e[r] = e[r] / i;
      return e;
    }, s.default.CtrlMarkov.prototype.dispose = function () {
      this.values = null;
    }, e.default = s.default.CtrlMarkov;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(4);
    s.default.CtrlInterpolate = function () {
      var t = s.default.defaults(arguments, ["values", "index"], s.default.CtrlInterpolate);
      s.default.call(this), this.values = t.values, this.index = t.index;
    }, s.default.extend(s.default.CtrlInterpolate), s.default.CtrlInterpolate.defaults = {
      index: 0,
      values: []
    }, Object.defineProperty(s.default.CtrlInterpolate.prototype, "value", {
      get: function () {
        var t = this.index;
        t = Math.min(t, this.values.length - 1);
        var e = Math.floor(t),
            i = this.values[e],
            s = this.values[Math.ceil(t)];
        return this._interpolate(t - e, i, s);
      }
    }), s.default.CtrlInterpolate.prototype._interpolate = function (t, e, i) {
      if (s.default.isArray(e)) {
        for (var n = [], o = 0; o < e.length; o++) n[o] = this._interpolate(t, e[o], i[o]);

        return n;
      }

      if (s.default.isObject(e)) {
        var a = {};

        for (var r in e) a[r] = this._interpolate(t, e[r], i[r]);

        return a;
      }

      return (1 - t) * (e = this._toNumber(e)) + t * (i = this._toNumber(i));
    }, s.default.CtrlInterpolate.prototype._toNumber = function (t) {
      return s.default.isNumber(t) ? t : this.toSeconds(t);
    }, s.default.CtrlInterpolate.prototype.dispose = function () {
      this.values = null;
    }, e.default = s.default.CtrlInterpolate;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(36), i(1);
    s.default.Waveform = function () {
      var t = s.default.defaults(arguments, ["size"], s.default.Waveform);
      t.type = s.default.Analyser.Type.Waveform, s.default.AudioNode.call(this), this._analyser = this.input = this.output = new s.default.Analyser(t);
    }, s.default.extend(s.default.Waveform, s.default.AudioNode), s.default.Waveform.defaults = {
      size: 1024
    }, s.default.Waveform.prototype.getValue = function () {
      return this._analyser.getValue();
    }, Object.defineProperty(s.default.Waveform.prototype, "size", {
      get: function () {
        return this._analyser.size;
      },
      set: function (t) {
        this._analyser.size = t;
      }
    }), s.default.Waveform.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null;
    }, e.default = s.default.Waveform;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(23), i(10), i(19), i(2), i(22), i(28), i(1);
    s.default.Panner3D = function () {
      var t = s.default.defaults(arguments, ["positionX", "positionY", "positionZ"], s.default.Panner3D);
      s.default.AudioNode.call(this), this._panner = this.input = this.output = this.context.createPanner(), this._panner.panningModel = t.panningModel, this._panner.maxDistance = t.maxDistance, this._panner.distanceModel = t.distanceModel, this._panner.coneOuterGain = t.coneOuterGain, this._panner.coneOuterAngle = t.coneOuterAngle, this._panner.coneInnerAngle = t.coneInnerAngle, this._panner.refDistance = t.refDistance, this._panner.rolloffFactor = t.rolloffFactor, this._orientation = [t.orientationX, t.orientationY, t.orientationZ], this._position = [t.positionX, t.positionY, t.positionZ], this.orientationX = t.orientationX, this.orientationY = t.orientationY, this.orientationZ = t.orientationZ, this.positionX = t.positionX, this.positionY = t.positionY, this.positionZ = t.positionZ;
    }, s.default.extend(s.default.Panner3D, s.default.AudioNode), s.default.Panner3D.defaults = {
      positionX: 0,
      positionY: 0,
      positionZ: 0,
      orientationX: 0,
      orientationY: 0,
      orientationZ: 0,
      panningModel: "equalpower",
      maxDistance: 1e4,
      distanceModel: "inverse",
      coneOuterGain: 0,
      coneOuterAngle: 360,
      coneInnerAngle: 360,
      refDistance: 1,
      rolloffFactor: 1
    }, s.default.Panner3D.prototype._rampTimeConstant = .01, s.default.Panner3D.prototype.setPosition = function (t, e, i) {
      if (this._panner.positionX) {
        var s = this.now();
        this._panner.positionX.setTargetAtTime(t, s, this._rampTimeConstant), this._panner.positionY.setTargetAtTime(e, s, this._rampTimeConstant), this._panner.positionZ.setTargetAtTime(i, s, this._rampTimeConstant);
      } else this._panner.setPosition(t, e, i);

      return this._position = Array.prototype.slice.call(arguments), this;
    }, s.default.Panner3D.prototype.setOrientation = function (t, e, i) {
      if (this._panner.orientationX) {
        var s = this.now();
        this._panner.orientationX.setTargetAtTime(t, s, this._rampTimeConstant), this._panner.orientationY.setTargetAtTime(e, s, this._rampTimeConstant), this._panner.orientationZ.setTargetAtTime(i, s, this._rampTimeConstant);
      } else this._panner.setOrientation(t, e, i);

      return this._orientation = Array.prototype.slice.call(arguments), this;
    }, Object.defineProperty(s.default.Panner3D.prototype, "positionX", {
      set: function (t) {
        this._position[0] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[0];
      }
    }), Object.defineProperty(s.default.Panner3D.prototype, "positionY", {
      set: function (t) {
        this._position[1] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[1];
      }
    }), Object.defineProperty(s.default.Panner3D.prototype, "positionZ", {
      set: function (t) {
        this._position[2] = t, this.setPosition.apply(this, this._position);
      },
      get: function () {
        return this._position[2];
      }
    }), Object.defineProperty(s.default.Panner3D.prototype, "orientationX", {
      set: function (t) {
        this._orientation[0] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[0];
      }
    }), Object.defineProperty(s.default.Panner3D.prototype, "orientationY", {
      set: function (t) {
        this._orientation[1] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[1];
      }
    }), Object.defineProperty(s.default.Panner3D.prototype, "orientationZ", {
      set: function (t) {
        this._orientation[2] = t, this.setOrientation.apply(this, this._orientation);
      },
      get: function () {
        return this._orientation[2];
      }
    }), s.default.Panner3D._aliasProperty = function (t) {
      Object.defineProperty(s.default.Panner3D.prototype, t, {
        set: function (e) {
          this._panner[t] = e;
        },
        get: function () {
          return this._panner[t];
        }
      });
    }, s.default.Panner3D._aliasProperty("panningModel"), s.default.Panner3D._aliasProperty("refDistance"), s.default.Panner3D._aliasProperty("rolloffFactor"), s.default.Panner3D._aliasProperty("distanceModel"), s.default.Panner3D._aliasProperty("coneInnerAngle"), s.default.Panner3D._aliasProperty("coneOuterAngle"), s.default.Panner3D._aliasProperty("coneOuterGain"), s.default.Panner3D._aliasProperty("maxDistance"), s.default.Panner3D.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._panner.disconnect(), this._panner = null, this._orientation = null, this._position = null, this;
    }, e.default = s.default.Panner3D;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(60), i(43), i(1);
    s.default.MultibandCompressor = function (t) {
      s.default.AudioNode.call(this), t = s.default.defaultArg(arguments, s.default.MultibandCompressor.defaults), this._splitter = this.input = new s.default.MultibandSplit({
        lowFrequency: t.lowFrequency,
        highFrequency: t.highFrequency
      }), this.lowFrequency = this._splitter.lowFrequency, this.highFrequency = this._splitter.highFrequency, this.output = new s.default.Gain(), this.low = new s.default.Compressor(t.low), this.mid = new s.default.Compressor(t.mid), this.high = new s.default.Compressor(t.high), this._splitter.low.chain(this.low, this.output), this._splitter.mid.chain(this.mid, this.output), this._splitter.high.chain(this.high, this.output), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]);
    }, s.default.extend(s.default.MultibandCompressor, s.default.AudioNode), s.default.MultibandCompressor.defaults = {
      low: s.default.Compressor.defaults,
      mid: s.default.Compressor.defaults,
      high: s.default.Compressor.defaults,
      lowFrequency: 250,
      highFrequency: 2e3
    }, s.default.MultibandCompressor.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._splitter.dispose(), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.mid.dispose(), this.high.dispose(), this._splitter = null, this.low = null, this.mid = null, this.high = null, this.lowFrequency = null, this.highFrequency = null, this;
    }, e.default = s.default.MultibandCompressor;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(10), i(1);
    s.default.Mono = function () {
      s.default.AudioNode.call(this), this.createInsOuts(1, 0), this._merge = this.output = new s.default.Merge(), s.default.connect(this.input, this._merge, 0, 0), s.default.connect(this.input, this._merge, 0, 1);
    }, s.default.extend(s.default.Mono, s.default.AudioNode), s.default.Mono.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._merge.dispose(), this._merge = null, this;
    }, e.default = s.default.Mono;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(53), i(52), i(43), i(1);
    s.default.MidSideCompressor = function (t) {
      s.default.AudioNode.call(this), t = s.default.defaultArg(t, s.default.MidSideCompressor.defaults), this._midSideSplit = this.input = new s.default.MidSideSplit(), this._midSideMerge = this.output = new s.default.MidSideMerge(), this.mid = new s.default.Compressor(t.mid), this.side = new s.default.Compressor(t.side), this._midSideSplit.mid.chain(this.mid, this._midSideMerge.mid), this._midSideSplit.side.chain(this.side, this._midSideMerge.side), this._readOnly(["mid", "side"]);
    }, s.default.extend(s.default.MidSideCompressor, s.default.AudioNode), s.default.MidSideCompressor.defaults = {
      mid: {
        ratio: 3,
        threshold: -24,
        release: .03,
        attack: .02,
        knee: 16
      },
      side: {
        ratio: 6,
        threshold: -30,
        release: .25,
        attack: .03,
        knee: 10
      }
    }, s.default.MidSideCompressor.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["mid", "side"]), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this;
    }, e.default = s.default.MidSideCompressor;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(36), i(1);
    s.default.Meter = function () {
      var t = s.default.defaults(arguments, ["smoothing"], s.default.Meter);
      s.default.AudioNode.call(this), this.smoothing = t.smoothing, this._rms = 0, this.input = this.output = this._analyser = new s.default.Analyser("waveform", 256);
    }, s.default.extend(s.default.Meter, s.default.AudioNode), s.default.Meter.defaults = {
      smoothing: .8
    }, s.default.Meter.prototype.getLevel = function () {
      for (var t = this._analyser.getValue(), e = 0, i = 0; i < t.length; i++) {
        var n = t[i];
        e += n * n;
      }

      var o = Math.sqrt(e / t.length);
      return this._rms = Math.max(o, this._rms * this.smoothing), s.default.gainToDb(this._rms);
    }, s.default.Meter.prototype.getValue = function () {
      return this._analyser.getValue()[0];
    }, s.default.Meter.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null, this;
    }, e.default = s.default.Meter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(43), i(1);
    s.default.Limiter = function () {
      var t = s.default.defaults(arguments, ["threshold"], s.default.Limiter);
      s.default.AudioNode.call(this), this._compressor = this.input = this.output = new s.default.Compressor({
        attack: .001,
        decay: .001,
        threshold: t.threshold
      }), this.threshold = this._compressor.threshold, this._readOnly("threshold");
    }, s.default.extend(s.default.Limiter, s.default.AudioNode), s.default.Limiter.defaults = {
      threshold: -12
    }, s.default.Limiter.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._compressor.dispose(), this._compressor = null, this._writable("threshold"), this.threshold = null, this;
    }, e.default = s.default.Limiter;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(58), i(85), i(1);
    s.default.Gate = function () {
      var t = s.default.defaults(arguments, ["threshold", "smoothing"], s.default.Gate);
      s.default.AudioNode.call(this), this.createInsOuts(1, 1), this._follower = new s.default.Follower(t.smoothing), this._gt = new s.default.GreaterThan(s.default.dbToGain(t.threshold)), s.default.connect(this.input, this.output), s.default.connectSeries(this.input, this._follower, this._gt, this.output.gain);
    }, s.default.extend(s.default.Gate, s.default.AudioNode), s.default.Gate.defaults = {
      smoothing: .1,
      threshold: -40
    }, Object.defineProperty(s.default.Gate.prototype, "threshold", {
      get: function () {
        return s.default.gainToDb(this._gt.value);
      },
      set: function (t) {
        this._gt.value = s.default.dbToGain(t);
      }
    }), Object.defineProperty(s.default.Gate.prototype, "smoothing", {
      get: function () {
        return this._follower.smoothing;
      },
      set: function (t) {
        this._follower.smoothing = t;
      }
    }), s.default.Gate.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._follower.dispose(), this._gt.dispose(), this._follower = null, this._gt = null, this;
    }, e.default = s.default.Gate;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(36), i(1);
    s.default.FFT = function () {
      var t = s.default.defaults(arguments, ["size"], s.default.FFT);
      t.type = s.default.Analyser.Type.FFT, s.default.AudioNode.call(this), this._analyser = this.input = this.output = new s.default.Analyser(t);
    }, s.default.extend(s.default.FFT, s.default.AudioNode), s.default.FFT.defaults = {
      size: 1024
    }, s.default.FFT.prototype.getValue = function () {
      return this._analyser.getValue();
    }, Object.defineProperty(s.default.FFT.prototype, "size", {
      get: function () {
        return this._analyser.size;
      },
      set: function (t) {
        this._analyser.size = t;
      }
    }), s.default.FFT.prototype.dispose = function () {
      s.default.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null;
    }, e.default = s.default.FFT;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(60), i(3), i(1);
    s.default.EQ3 = function () {
      var t = s.default.defaults(arguments, ["low", "mid", "high"], s.default.EQ3);
      s.default.AudioNode.call(this), this.output = new s.default.Gain(), this._multibandSplit = this.input = new s.default.MultibandSplit({
        lowFrequency: t.lowFrequency,
        highFrequency: t.highFrequency
      }), this._lowGain = new s.default.Gain(t.low, s.default.Type.Decibels), this._midGain = new s.default.Gain(t.mid, s.default.Type.Decibels), this._highGain = new s.default.Gain(t.high, s.default.Type.Decibels), this.low = this._lowGain.gain, this.mid = this._midGain.gain, this.high = this._highGain.gain, this.Q = this._multibandSplit.Q, this.lowFrequency = this._multibandSplit.lowFrequency, this.highFrequency = this._multibandSplit.highFrequency, this._multibandSplit.low.chain(this._lowGain, this.output), this._multibandSplit.mid.chain(this._midGain, this.output), this._multibandSplit.high.chain(this._highGain, this.output), this._readOnly(["low", "mid", "high", "lowFrequency", "highFrequency"]);
    }, s.default.extend(s.default.EQ3, s.default.AudioNode), s.default.EQ3.defaults = {
      low: 0,
      mid: 0,
      high: 0,
      lowFrequency: 400,
      highFrequency: 2500
    }, s.default.EQ3.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["low", "mid", "high", "lowFrequency", "highFrequency"]), this._multibandSplit.dispose(), this._multibandSplit = null, this.lowFrequency = null, this.highFrequency = null, this._lowGain.dispose(), this._lowGain = null, this._midGain.dispose(), this._midGain = null, this._highGain.dispose(), this._highGain = null, this.low = null, this.mid = null, this.high = null, this.Q = null, this;
    }, e.default = s.default.EQ3;
  }, function (t, e, i) {
    "use strict";

    i.r(e);
    var s = i(0);
    i(91), i(88), i(1);
    s.default.Channel = function () {
      var t = s.default.defaults(arguments, ["volume", "pan"], s.default.PanVol);
      s.default.AudioNode.call(this, t), this._solo = this.input = new s.default.Solo(t.solo), this._panVol = this.output = new s.default.PanVol({
        pan: t.pan,
        volume: t.volume,
        mute: t.mute
      }), this.pan = this._panVol.pan, this.volume = this._panVol.volume, this._solo.connect(this._panVol), this._readOnly(["pan", "volume"]);
    }, s.default.extend(s.default.Channel, s.default.AudioNode), s.default.Channel.defaults = {
      pan: 0,
      volume: 0,
      mute: !1,
      solo: !1
    }, Object.defineProperty(s.default.Channel.prototype, "solo", {
      get: function () {
        return this._solo.solo;
      },
      set: function (t) {
        this._solo.solo = t;
      }
    }), Object.defineProperty(s.default.Channel.prototype, "muted", {
      get: function () {
        return this._solo.muted || this.mute;
      }
    }), Object.defineProperty(s.default.Channel.prototype, "mute", {
      get: function () {
        return this._panVol.mute;
      },
      set: function (t) {
        this._panVol.mute = t;
      }
    }), s.default.Channel.prototype.dispose = function () {
      return s.default.AudioNode.prototype.dispose.call(this), this._writable(["pan", "volume"]), this._panVol.dispose(), this._panVol = null, this.pan = null, this.volume = null, this._solo.dispose(), this._solo = null, this;
    }, e.default = s.default.Channel;
  }, function (t, e) {
    var i;

    i = function () {
      return this;
    }();

    try {
      i = i || Function("return this")() || (0, eval)("this");
    } catch (t) {
      "object" == typeof window && (i = window);
    }

    t.exports = i;
  }, function (t, e, i) {
    i(31), i(36), i(146), i(43), i(23), i(47), i(145), i(59), i(144), i(9), i(58), i(41), i(143), i(12), i(142), i(54), i(10), i(141), i(140), i(52), i(53), i(139), i(138), i(60), i(48), i(137), i(91), i(86), i(88), i(19), i(27), i(136), i(135), i(134), i(79), i(133), i(1), i(11), i(78), i(132), i(83), i(20), i(18), i(131), i(35), i(3), i(81), i(130), i(40), i(77), i(76), i(14), i(24), i(34), i(16), i(56), i(80), i(129), i(128), i(127), i(126), i(125), i(124), i(74), i(123), i(8), i(122), i(33), i(121), i(120), i(73), i(119), i(118), i(117), i(116), i(15), i(115), i(114), i(72), i(113), i(112), i(51), i(71), i(70), i(111), i(110), i(109), i(108), i(107), i(21), i(106), i(105), i(25), i(66), i(104), i(103), i(102), i(101), i(38), i(87), i(29), i(22), i(89), i(100), i(85), i(84), i(75), i(5), i(90), i(99), i(61), i(26), i(42), i(2), i(30), i(13), i(82), i(98), i(7), i(28), i(68), i(32), i(67), i(49), i(97), i(39), i(37), i(17), i(64), i(65), i(96), i(50), i(69), i(6), i(57), i(95), i(46), i(94), i(55), i(63), i(62), i(45), i(4), t.exports = i(0).default;
  }]);
});

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _styles_index_scss__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./styles/index.scss */ "./src/styles/index.scss");
/* harmony import */ var _styles_index_scss__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_styles_index_scss__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! regenerator-runtime/runtime.js */ "./node_modules/regenerator-runtime/runtime.js");
/* harmony import */ var regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var tone__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tone */ "./node_modules/tone/build/Tone.js");
/* harmony import */ var tone__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(tone__WEBPACK_IMPORTED_MODULE_2__);
function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }





function sequencer() {
  /////////
  // const audio = document.querySelector('audio');
  // const actx  = Tone.context;
  // const dest  = actx.createMediaStreamDestination();
  // const recorder = new MediaRecorder(dest.stream);
  // const chunks = [];
  // recorder.ondataavailable = evt => chunks.push(evt.data);
  // recorder.onstop = evt => {
  //     let blob = new Blob(chunks, { type: 'audio/ogg; codecs=opus' });
  //     audio.src = URL.createObjectURL(blob);
  // }
  // Tone.Transport.start();
  /////////
  var kick = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/kick-808.wav").toMaster();
  var snare = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/snare-808.wav").toMaster();
  var hat = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/hihat-analog.wav").toMaster();
  var clap = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/clap-tape.wav").toMaster();
  var perc = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/perc-808.wav").toMaster();
  var shaker = new tone__WEBPACK_IMPORTED_MODULE_2__["Player"]("./src/sounds/drums/shaker-shuffle.wav").toMaster();
  var $kickRows = document.body.querySelectorAll("div.kick");
  var $snareRows = document.body.querySelectorAll("div.snare");
  var $hatsRows = document.body.querySelectorAll("div.hat");
  var $clapsRows = document.body.querySelectorAll("div.clap");
  var $percsRows = document.body.querySelectorAll("div.perc");
  var $shakersRows = document.body.querySelectorAll("div.shaker");
  var kickInput = document.body.querySelectorAll('div.drums  div.kick  input');
  var snareInput = document.body.querySelectorAll('div.drums  div.snare  input');
  var hatInput = document.body.querySelectorAll('div.drums  div.hat  input');
  var clapInput = document.body.querySelectorAll('div.drums  div.clap  input');
  var percInput = document.body.querySelectorAll('div.drums  div.perc  input');
  var shakerInput = document.body.querySelectorAll('div.drums  div.shaker  input');
  var check = document.querySelectorAll("input[type=checkbox]");
  var index = 0;
  var play = document.body.querySelector(".play-btn");
  play.addEventListener("click",
  /*#__PURE__*/
  _asyncToGenerator(
  /*#__PURE__*/
  regeneratorRuntime.mark(function _callee() {
    return regeneratorRuntime.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            tone__WEBPACK_IMPORTED_MODULE_2__["start"]();
            tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].start(); // recorder.start();

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })));
  var stop = document.body.querySelector(".stop-btn");
  stop.addEventListener("click",
  /*#__PURE__*/
  _asyncToGenerator(
  /*#__PURE__*/
  regeneratorRuntime.mark(function _callee2() {
    return regeneratorRuntime.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].toggle(); // recorder.stop();

          case 1:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2);
  })));
  var clear = document.body.querySelector('.clear-btn');
  clear.addEventListener("click",
  /*#__PURE__*/
  _asyncToGenerator(
  /*#__PURE__*/
  regeneratorRuntime.mark(function _callee3() {
    var i, j;
    return regeneratorRuntime.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            for (i = 0; i < check.length; i++) {
              if (check[i].checked) {
                check[i].checked = false;
              }
            }

            for (j = 0; j < check.length; j++) {
              if (j !== 0) {
                kickInput[j - 1].style.boxShadow = "";
                snareInput[j - 1].style.boxShadow = "";
                hatInput[j - 1].style.boxShadow = "";
                clapInput[j - 1].style.boxShadow = "";
                percInput[j - 1].style.boxShadow = "";
                shakerInput[j - 1].style.boxShadow = "";
              } else if (j === 0) {
                kickInput[kickInput.length - 1].style.boxShadow = "";
                snareInput[kickInput.length - 1].style.boxShadow = "";
                hatInput[kickInput.length - 1].style.boxShadow = "";
                clapInput[kickInput.length - 1].style.boxShadow = "";
                percInput[kickInput.length - 1].style.boxShadow = "";
                shakerInput[kickInput.length - 1].style.boxShadow = "";
              }
            }

          case 2:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3);
  })));
  tone__WEBPACK_IMPORTED_MODULE_2__["Transport"].scheduleRepeat(repeat, "8n");

  function repeat() {
    var step = index % 16;

    for (var i = 0; i < $kickRows.length; i++) {
      var $kickRow = $kickRows[i];
      var $snareRow = $snareRows[i];
      var $hatRow = $hatsRows[i];
      var $clapRow = $clapsRows[i];
      var $percRow = $percsRows[i];
      var $shakerRow = $shakersRows[i],
          $kickInput = $kickRow.querySelector("input:nth-child(".concat(step + 1, ")")),
          $snareInput = $snareRow.querySelector("input:nth-child(".concat(step + 1, ")")),
          $hatInput = $hatRow.querySelector("input:nth-child(".concat(step + 1, ")")),
          $clapInput = $clapRow.querySelector("input:nth-child(".concat(step + 1, ")")),
          $percInput = $percRow.querySelector("input:nth-child(".concat(step + 1, ")")),
          $shakerInput = $shakerRow.querySelector("input:nth-child(".concat(step + 1, ")"));
      $kickInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";
      $snareInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";
      $hatInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";
      $clapInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";
      $percInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";
      $shakerInput.style.boxShadow = "0 0 1px grey,0 0 2px grey, 0 0 4px grey";

      if (step !== 0) {
        kickInput[step - 1].style.boxShadow = "";
        snareInput[step - 1].style.boxShadow = "";
        hatInput[step - 1].style.boxShadow = "";
        clapInput[step - 1].style.boxShadow = "";
        percInput[step - 1].style.boxShadow = "";
        shakerInput[step - 1].style.boxShadow = "";
      } else if (step === 0) {
        kickInput[kickInput.length - 1].style.boxShadow = "";
        snareInput[kickInput.length - 1].style.boxShadow = "";
        hatInput[kickInput.length - 1].style.boxShadow = "";
        clapInput[kickInput.length - 1].style.boxShadow = "";
        percInput[kickInput.length - 1].style.boxShadow = "";
        shakerInput[kickInput.length - 1].style.boxShadow = "";
      }

      if ($kickInput.checked) {
        kick.start();
      }

      if ($snareInput.checked) {
        snare.start();
      }

      if ($hatInput.checked) {
        hat.start();
      }

      if ($clapInput.checked) {
        clap.start();
      }

      if ($percInput.checked) {
        perc.start();
      }

      if ($shakerInput.checked) {
        shaker.start();
      }
    }

    index++;
  }
}

window.addEventListener('DOMContentLoaded', function () {
  sequencer();
});

/***/ }),

/***/ "./src/styles/index.scss":
/*!*******************************!*\
  !*** ./src/styles/index.scss ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdG9uZS9idWlsZC9Ub25lLmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3R5bGVzL2luZGV4LnNjc3MiXSwibmFtZXMiOlsic2VxdWVuY2VyIiwia2ljayIsIlRvbmUiLCJ0b01hc3RlciIsInNuYXJlIiwiaGF0IiwiY2xhcCIsInBlcmMiLCJzaGFrZXIiLCIka2lja1Jvd3MiLCJkb2N1bWVudCIsImJvZHkiLCJxdWVyeVNlbGVjdG9yQWxsIiwiJHNuYXJlUm93cyIsIiRoYXRzUm93cyIsIiRjbGFwc1Jvd3MiLCIkcGVyY3NSb3dzIiwiJHNoYWtlcnNSb3dzIiwia2lja0lucHV0Iiwic25hcmVJbnB1dCIsImhhdElucHV0IiwiY2xhcElucHV0IiwicGVyY0lucHV0Iiwic2hha2VySW5wdXQiLCJjaGVjayIsImluZGV4IiwicGxheSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwic3RhcnQiLCJzdG9wIiwidG9nZ2xlIiwiY2xlYXIiLCJpIiwibGVuZ3RoIiwiY2hlY2tlZCIsImoiLCJzdHlsZSIsImJveFNoYWRvdyIsInNjaGVkdWxlUmVwZWF0IiwicmVwZWF0Iiwic3RlcCIsIiRraWNrUm93IiwiJHNuYXJlUm93IiwiJGhhdFJvdyIsIiRjbGFwUm93IiwiJHBlcmNSb3ciLCIkc2hha2VyUm93IiwiJGtpY2tJbnB1dCIsIiRzbmFyZUlucHV0IiwiJGhhdElucHV0IiwiJGNsYXBJbnB1dCIsIiRwZXJjSW5wdXQiLCIkc2hha2VySW5wdXQiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiI7UUFBQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTs7O1FBR0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDBDQUEwQyxnQ0FBZ0M7UUFDMUU7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSx3REFBd0Qsa0JBQWtCO1FBQzFFO1FBQ0EsaURBQWlELGNBQWM7UUFDL0Q7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLHlDQUF5QyxpQ0FBaUM7UUFDMUUsZ0hBQWdILG1CQUFtQixFQUFFO1FBQ3JJO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMkJBQTJCLDBCQUEwQixFQUFFO1FBQ3ZELGlDQUFpQyxlQUFlO1FBQ2hEO1FBQ0E7UUFDQTs7UUFFQTtRQUNBLHNEQUFzRCwrREFBK0Q7O1FBRXJIO1FBQ0E7OztRQUdBO1FBQ0E7Ozs7Ozs7Ozs7OztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7O0FBRWhCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDOztBQUVBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsMENBQTBDO0FBQzFDOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esc0dBQXNHO0FBQ3RHOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFdBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0Esd0NBQXdDLFdBQVc7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0NBQXdDO0FBQ3hDLDJCQUEyQjtBQUMzQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Qsb0NBQW9DO0FBQ3BDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsb0NBQW9DLGNBQWM7QUFDbEQ7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDs7QUFFaEQsc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7QUFDQTtBQUNBLEdBQUcsZ0NBQWdDLGtCQUFrQjtBQUNyRDs7O0FBR0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUI7QUFDbkI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsOENBQThDLFFBQVE7QUFDdEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw4Q0FBOEMsUUFBUTtBQUN0RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDhDQUE4QyxRQUFRO0FBQ3REOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDhDQUE4QyxRQUFRO0FBQ3REOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDs7O0FBR0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsS0FBMEIsb0JBQW9CLFNBQUU7O0FBRWhEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDOzs7Ozs7Ozs7OztBQ2pzQkE7QUFDQSxFQUFFLEtBQXVELDBCQUEwQixTQUEwSDtBQUM3TSxDQUFDO0FBQ0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw2Q0FBNkMsa0JBQWtCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPO0FBQ1A7O0FBRUEsdUJBQXVCLFFBQVEsY0FBYztBQUM3QztBQUNBO0FBQ0E7O0FBRUE7QUFDQSw2Q0FBNkMsa0JBQWtCO0FBQy9EO0FBQ0EsK0JBQStCO0FBQy9COztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsaUpBQWlKLGNBQWM7QUFDL0o7QUFDQSxPQUFPO0FBQ1A7QUFDQSx5REFBeUQsb0JBQW9CLGNBQWM7QUFDM0Y7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLHlDQUF5QyxzQkFBc0I7QUFDL0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQLGNBQWMsc0JBQXNCOztBQUVwQztBQUNBLE9BQU87QUFDUDtBQUNBLDBCQUEwQixJQUFJO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsV0FBVzs7QUFFWDtBQUNBLFNBQVM7O0FBRVQ7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AseUNBQXlDLEVBQUU7QUFDM0MsT0FBTyx5QkFBeUI7QUFDaEMsNkNBQTZDLGNBQWMsMkJBQTJCO0FBQ3RGO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLDZDQUE2QyxjQUFjLDJCQUEyQjtBQUN0RjtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wscUJBQXFCLHNCQUFzQjs7QUFFM0M7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsMEZBQTBGLGNBQWM7O0FBRXhHO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHVUQUF1VDtBQUN2VDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLE9BQU87O0FBRVA7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQSxxQkFBcUIsNEJBQTRCO0FBQ2pEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTCxnRkFBZ0YsT0FBTztBQUN2RjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCLDBCQUEwQjtBQUNqRDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCLDBCQUEwQjs7QUFFakQ7O0FBRUEsdUJBQXVCLE9BQU87QUFDOUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0EsT0FBTyxrQ0FBa0MsT0FBTztBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUEscUJBQXFCLDBCQUEwQjs7QUFFL0M7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLE9BQU87O0FBRTVCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLGNBQWM7QUFDbkMsS0FBSztBQUNMO0FBQ0E7O0FBRUEscUJBQXFCLGNBQWM7QUFDbkMsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLE9BQU87O0FBRTVCO0FBQ0EsS0FBSztBQUNMLGlFQUFpRTtBQUNqRSxxRkFBcUYsT0FBTywwQ0FBMEMsY0FBYzs7QUFFcEo7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUEsNkJBQTZCLDJCQUEyQjs7QUFFeEQ7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUEsdUpBQXVKLDJCQUEyQjs7QUFFbEw7QUFDQSxLQUFLO0FBQ0wsc0NBQXNDLDJCQUEyQjtBQUNqRTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxzREFBc0QsY0FBYztBQUNwRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhCQUE4Qiw0Q0FBNEM7O0FBRTFFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw0QkFBNEI7QUFDNUI7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUEsNkNBQTZDLGNBQWM7O0FBRTNEO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHFVQUFxVTtBQUM5VSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLGtEQUFrRCxRQUFRO0FBQzFEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLHdJQUF3STtBQUN4STtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUlBQW1JO0FBQ25JO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsT0FBTztBQUM1QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCwwQ0FBMEMsT0FBTzs7QUFFakQ7QUFDQSxLQUFLO0FBQ0wsNEdBQTRHLE9BQU87O0FBRW5IO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixPQUFPOztBQUU1QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQ0FBcUMsMEJBQTBCOztBQUUvRDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTyxxRUFBcUU7QUFDNUU7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQSxnSEFBZ0gsY0FBYzs7QUFFOUg7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsOEJBQThCLDRFQUE0RTtBQUMxRyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMkZBQTJGLCtCQUErQixxQ0FBcUMsZ0JBQWdCLGdDQUFnQyw0QkFBNEIsT0FBTztBQUNsUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSxLQUFLOztBQUVMO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkJBQTJCLHdDQUF3Qzs7QUFFbkU7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5QkFBeUIsMkJBQTJCO0FBQ3BEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxtQ0FBbUMsdUNBQXVDOztBQUUxRTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUssd0VBQXdFLHlFQUF5RTtBQUN0SjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQSxtQ0FBbUMsUUFBUTtBQUMzQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7O0FBRUEsbUNBQW1DLDJCQUEyQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHlDQUF5QyxjQUFjO0FBQ3ZEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBLEtBQUs7QUFDTCx5Q0FBeUMsY0FBYyxtR0FBbUcseUNBQXlDLGNBQWM7O0FBRWpOO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSx1R0FBdUcsT0FBTztBQUM5Rzs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLGNBQWM7QUFDbkMsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxPQUFPO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQkFBMkIsWUFBWTtBQUN2QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGlDQUFpQyxPQUFPO0FBQ3hDO0FBQ0E7O0FBRUEsa0NBQWtDLFlBQVk7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QztBQUNBOztBQUVBLDJCQUEyQixZQUFZO0FBQ3ZDOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssMEhBQTBIO0FBQy9IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSx5QkFBeUIsRUFBRTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QseUVBQXlFLDhFQUE4RTtBQUN6TTs7QUFFQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDZFQUE2RSwrRUFBK0U7QUFDNUo7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBLGlCQUFpQixTQUFTOztBQUUxQjs7QUFFQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGlCQUFpQixTQUFTOztBQUUxQjs7QUFFQSxpQkFBaUIsU0FBUzs7QUFFMUI7QUFDQTs7QUFFQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0RBQWdELGNBQWM7O0FBRTlEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUEsbUVBQW1FLHNCQUFzQjtBQUN6RjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb1BBQW9QLDZGQUE2RjtBQUNqVjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdIQUFnSDtBQUNySDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx1REFBdUQsT0FBTztBQUM5RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxxQkFBcUIsOEJBQThCO0FBQ25ELEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWCx5QkFBeUIsT0FBTztBQUNoQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLHFCQUFxQjtBQUMxQyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUEseURBQXlELHlCQUF5QjtBQUNsRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDs7QUFFQSwyQ0FBMkMsUUFBUTtBQUNuRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTs7QUFFQSw2Q0FBNkMsUUFBUTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsWUFBWSx5Q0FBeUM7O0FBRXJEO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw0REFBNEQ7QUFDNUQsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUEscUJBQXFCLHdCQUF3Qjs7QUFFN0MsWUFBWSxjQUFjO0FBQzFCOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUEsdUZBQXVGLFlBQVk7O0FBRW5HO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUEsdUJBQXVCLGNBQWM7QUFDckM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxrRkFBa0YsZ0VBQWdFLGdFQUFnRTtBQUNsTjtBQUNBO0FBQ0EseUVBQXlFO0FBQ3pFLGtDQUFrQyxrQkFBa0I7O0FBRXBEO0FBQ0E7QUFDQSxTQUFTLG9FQUFvRTtBQUM3RSxnQ0FBZ0MsaUJBQWlCOztBQUVqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQyxjQUFjOztBQUVqRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVCx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBLGtDQUFrQyxRQUFRO0FBQzFDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUEsa0NBQWtDLFFBQVE7QUFDMUM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVAscUJBQXFCLGNBQWM7O0FBRW5DO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7O0FBRUEsa0ZBQWtGLFFBQVE7QUFDMUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMOztBQUVBLG9IQUFvSCxRQUFRO0FBQzVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0EsU0FBUyw2QkFBNkI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDhUQUE4VDtBQUM5VCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUEsNkZBQTZGO0FBQzdGLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLHFCQUFxQixRQUFRO0FBQzdCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMOztBQUVBLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0EsS0FBSztBQUNMOztBQUVBLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLEtBQUs7QUFDTCxvR0FBb0csVUFBVTtBQUM5RztBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLDJIQUEySCxjQUFjO0FBQ3pJO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixpQkFBaUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsMkhBQTJILGNBQWM7QUFDekk7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxxQkFBcUIsd0JBQXdCOztBQUU3QztBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUCxxQkFBcUIsY0FBYztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLHVCQUF1Qiw4QkFBOEI7QUFDckQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLHVCQUF1Qiw4QkFBOEI7QUFDckQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUEscUJBQXFCLDhCQUE4Qjs7QUFFbkQ7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0UUFBNFEsY0FBYztBQUMxUixLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsdUNBQXVDLE9BQU87QUFDOUM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQSxxQkFBcUIsMkJBQTJCOztBQUVoRDs7QUFFQSxxQkFBcUIsMkJBQTJCOztBQUVoRDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsY0FBYztBQUNuQztBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLGNBQWM7QUFDbkM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMOztBQUVBLHFCQUFxQixpQ0FBaUM7O0FBRXREOztBQUVBLHFCQUFxQixzQ0FBc0M7O0FBRTNEO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsY0FBYztBQUNuQztBQUNBO0FBQ0E7O0FBRUEscUJBQXFCLGNBQWM7QUFDbkM7QUFDQTtBQUNBOztBQUVBLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBLHFCQUFxQixrQ0FBa0M7O0FBRXZEOztBQUVBLHFCQUFxQixrQ0FBa0M7O0FBRXZEOztBQUVBLHFCQUFxQiw4QkFBOEI7O0FBRW5EO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUEsMERBQTBELE9BQU87QUFDakU7QUFDQSw0REFBNEQ7QUFDNUQ7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxpREFBaUQsMEVBQTBFO0FBQzNIOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wscUNBQXFDO0FBQ3JDLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FO0FBQ3BFLEtBQUs7QUFDTDtBQUNBO0FBQ0EsNkdBQTZHLGNBQWM7QUFDM0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsNENBQTRDLGNBQWM7QUFDMUQ7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixjQUFjO0FBQzFDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsK0JBQStCLGNBQWM7O0FBRTdDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsMkRBQTJELGNBQWM7QUFDekU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0gsQ0FBQyxFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2xwT0Q7QUFDQTtBQUNBOztBQUdBLFNBQVNBLFNBQVQsR0FBcUI7QUFFckI7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHRSxNQUFNQyxJQUFJLEdBQUcsSUFBSUMsMkNBQUosQ0FBZ0IsaUNBQWhCLEVBQW1EQyxRQUFuRCxFQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHLElBQUlGLDJDQUFKLENBQWdCLGtDQUFoQixFQUFvREMsUUFBcEQsRUFBZDtBQUNBLE1BQU1FLEdBQUcsR0FBRyxJQUFJSCwyQ0FBSixDQUFnQixxQ0FBaEIsRUFBdURDLFFBQXZELEVBQVo7QUFDQSxNQUFNRyxJQUFJLEdBQUcsSUFBSUosMkNBQUosQ0FBZ0Isa0NBQWhCLEVBQW9EQyxRQUFwRCxFQUFiO0FBQ0EsTUFBTUksSUFBSSxHQUFHLElBQUlMLDJDQUFKLENBQWdCLGlDQUFoQixFQUFtREMsUUFBbkQsRUFBYjtBQUNBLE1BQU1LLE1BQU0sR0FBRyxJQUFJTiwyQ0FBSixDQUFnQix1Q0FBaEIsRUFBeURDLFFBQXpELEVBQWY7QUFFQSxNQUFNTSxTQUFTLEdBQUdDLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQixVQUEvQixDQUFsQjtBQUNBLE1BQU1DLFVBQVUsR0FBR0gsUUFBUSxDQUFDQyxJQUFULENBQWNDLGdCQUFkLENBQStCLFdBQS9CLENBQW5CO0FBQ0EsTUFBTUUsU0FBUyxHQUFHSixRQUFRLENBQUNDLElBQVQsQ0FBY0MsZ0JBQWQsQ0FBK0IsU0FBL0IsQ0FBbEI7QUFDQSxNQUFNRyxVQUFVLEdBQUdMLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQixVQUEvQixDQUFuQjtBQUNBLE1BQU1JLFVBQVUsR0FBR04sUUFBUSxDQUFDQyxJQUFULENBQWNDLGdCQUFkLENBQStCLFVBQS9CLENBQW5CO0FBQ0EsTUFBTUssWUFBWSxHQUFHUCxRQUFRLENBQUNDLElBQVQsQ0FBY0MsZ0JBQWQsQ0FBK0IsWUFBL0IsQ0FBckI7QUFFQSxNQUFNTSxTQUFTLEdBQUdSLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiw0QkFBL0IsQ0FBbEI7QUFDQSxNQUFNTyxVQUFVLEdBQUdULFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiw2QkFBL0IsQ0FBbkI7QUFDQSxNQUFNUSxRQUFRLEdBQUdWLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiwyQkFBL0IsQ0FBakI7QUFDQSxNQUFNUyxTQUFTLEdBQUdYLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiw0QkFBL0IsQ0FBbEI7QUFDQSxNQUFNVSxTQUFTLEdBQUdaLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiw0QkFBL0IsQ0FBbEI7QUFDQSxNQUFNVyxXQUFXLEdBQUdiLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjQyxnQkFBZCxDQUErQiw4QkFBL0IsQ0FBcEI7QUFDQSxNQUFNWSxLQUFLLEdBQUdkLFFBQVEsQ0FBQ0UsZ0JBQVQsQ0FBMEIsc0JBQTFCLENBQWQ7QUFFQSxNQUFJYSxLQUFLLEdBQUcsQ0FBWjtBQUVBLE1BQU1DLElBQUksR0FBR2hCLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjZ0IsYUFBZCxDQUE0QixXQUE1QixDQUFiO0FBRUFELE1BQUksQ0FBQ0UsZ0JBQUwsQ0FBc0IsT0FBdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSwwQkFBK0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUM3QjFCLHNEQUFBO0FBQ0FBLDBEQUFBLENBQWUyQixLQUFmLEdBRjZCLENBRzdCOztBQUg2QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUEvQjtBQU1BLE1BQU1DLElBQUksR0FBR3BCLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjZ0IsYUFBZCxDQUE0QixXQUE1QixDQUFiO0FBRUFHLE1BQUksQ0FBQ0YsZ0JBQUwsQ0FBc0IsT0FBdEI7QUFBQTtBQUFBO0FBQUE7QUFBQSwwQkFBK0I7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUM3QjFCLDBEQUFBLENBQWU2QixNQUFmLEdBRDZCLENBRTdCOztBQUY2QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxHQUEvQjtBQUtBLE1BQU1DLEtBQUssR0FBR3RCLFFBQVEsQ0FBQ0MsSUFBVCxDQUFjZ0IsYUFBZCxDQUE0QixZQUE1QixDQUFkO0FBR0FLLE9BQUssQ0FBQ0osZ0JBQU4sQ0FBdUIsT0FBdkI7QUFBQTtBQUFBO0FBQUE7QUFBQSwwQkFBZ0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQzVCLGlCQUFTSyxDQUFULEdBQWEsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHVCxLQUFLLENBQUNVLE1BQTFCLEVBQWtDRCxDQUFDLEVBQW5DLEVBQXNDO0FBQ3BDLGtCQUFHVCxLQUFLLENBQUNTLENBQUQsQ0FBTCxDQUFTRSxPQUFaLEVBQW9CO0FBQ2hCWCxxQkFBSyxDQUFDUyxDQUFELENBQUwsQ0FBU0UsT0FBVCxHQUFtQixLQUFuQjtBQUNIO0FBQ0Y7O0FBRUQsaUJBQVNDLENBQVQsR0FBYSxDQUFiLEVBQWdCQSxDQUFDLEdBQUdaLEtBQUssQ0FBQ1UsTUFBMUIsRUFBa0NFLENBQUMsRUFBbkMsRUFBdUM7QUFDdEMsa0JBQUlBLENBQUMsS0FBSyxDQUFWLEVBQWE7QUFDWGxCLHlCQUFTLENBQUNrQixDQUFDLEdBQUcsQ0FBTCxDQUFULENBQWlCQyxLQUFqQixDQUF1QkMsU0FBdkIsR0FBbUMsRUFBbkM7QUFDQW5CLDBCQUFVLENBQUNpQixDQUFDLEdBQUcsQ0FBTCxDQUFWLENBQWtCQyxLQUFsQixDQUF3QkMsU0FBeEIsR0FBb0MsRUFBcEM7QUFDQWxCLHdCQUFRLENBQUNnQixDQUFDLEdBQUcsQ0FBTCxDQUFSLENBQWdCQyxLQUFoQixDQUFzQkMsU0FBdEIsR0FBa0MsRUFBbEM7QUFDQWpCLHlCQUFTLENBQUNlLENBQUMsR0FBRyxDQUFMLENBQVQsQ0FBaUJDLEtBQWpCLENBQXVCQyxTQUF2QixHQUFtQyxFQUFuQztBQUNBaEIseUJBQVMsQ0FBQ2MsQ0FBQyxHQUFHLENBQUwsQ0FBVCxDQUFpQkMsS0FBakIsQ0FBdUJDLFNBQXZCLEdBQW1DLEVBQW5DO0FBQ0FmLDJCQUFXLENBQUNhLENBQUMsR0FBRyxDQUFMLENBQVgsQ0FBbUJDLEtBQW5CLENBQXlCQyxTQUF6QixHQUFxQyxFQUFyQztBQUNELGVBUEQsTUFPTyxJQUFJRixDQUFDLEtBQUssQ0FBVixFQUFhO0FBQ2xCbEIseUJBQVMsQ0FBQ0EsU0FBUyxDQUFDZ0IsTUFBVixHQUFtQixDQUFwQixDQUFULENBQWdDRyxLQUFoQyxDQUFzQ0MsU0FBdEMsR0FBa0QsRUFBbEQ7QUFDQW5CLDBCQUFVLENBQUNELFNBQVMsQ0FBQ2dCLE1BQVYsR0FBbUIsQ0FBcEIsQ0FBVixDQUFpQ0csS0FBakMsQ0FBdUNDLFNBQXZDLEdBQW1ELEVBQW5EO0FBQ0FsQix3QkFBUSxDQUFDRixTQUFTLENBQUNnQixNQUFWLEdBQW1CLENBQXBCLENBQVIsQ0FBK0JHLEtBQS9CLENBQXFDQyxTQUFyQyxHQUFpRCxFQUFqRDtBQUNBakIseUJBQVMsQ0FBQ0gsU0FBUyxDQUFDZ0IsTUFBVixHQUFtQixDQUFwQixDQUFULENBQWdDRyxLQUFoQyxDQUFzQ0MsU0FBdEMsR0FBa0QsRUFBbEQ7QUFDQWhCLHlCQUFTLENBQUNKLFNBQVMsQ0FBQ2dCLE1BQVYsR0FBbUIsQ0FBcEIsQ0FBVCxDQUFnQ0csS0FBaEMsQ0FBc0NDLFNBQXRDLEdBQWtELEVBQWxEO0FBQ0FmLDJCQUFXLENBQUNMLFNBQVMsQ0FBQ2dCLE1BQVYsR0FBbUIsQ0FBcEIsQ0FBWCxDQUFrQ0csS0FBbEMsQ0FBd0NDLFNBQXhDLEdBQW9ELEVBQXBEO0FBQ0Q7QUFDRDs7QUF2QjJCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQWhDO0FBMEJBcEMsZ0RBQUEsQ0FBZXFDLGNBQWYsQ0FBOEJDLE1BQTlCLEVBQXNDLElBQXRDOztBQUVBLFdBQVNBLE1BQVQsR0FBa0I7QUFDaEIsUUFBSUMsSUFBSSxHQUFHaEIsS0FBSyxHQUFHLEVBQW5COztBQUNBLFNBQUssSUFBSVEsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR3hCLFNBQVMsQ0FBQ3lCLE1BQTlCLEVBQXNDRCxDQUFDLEVBQXZDLEVBQTJDO0FBQ3pDLFVBQUlTLFFBQVEsR0FBR2pDLFNBQVMsQ0FBQ3dCLENBQUQsQ0FBeEI7QUFDQSxVQUFJVSxTQUFTLEdBQUc5QixVQUFVLENBQUNvQixDQUFELENBQTFCO0FBQ0EsVUFBSVcsT0FBTyxHQUFHOUIsU0FBUyxDQUFDbUIsQ0FBRCxDQUF2QjtBQUNBLFVBQUlZLFFBQVEsR0FBRzlCLFVBQVUsQ0FBQ2tCLENBQUQsQ0FBekI7QUFDQSxVQUFJYSxRQUFRLEdBQUc5QixVQUFVLENBQUNpQixDQUFELENBQXpCO0FBQ0EsVUFBSWMsVUFBVSxHQUFHOUIsWUFBWSxDQUFDZ0IsQ0FBRCxDQUE3QjtBQUFBLFVBQ0FlLFVBQVUsR0FBR04sUUFBUSxDQUFDZixhQUFULDJCQUEwQ2MsSUFBSSxHQUFHLENBQWpELE9BRGI7QUFBQSxVQUVBUSxXQUFXLEdBQUdOLFNBQVMsQ0FBQ2hCLGFBQVYsMkJBQTJDYyxJQUFJLEdBQUcsQ0FBbEQsT0FGZDtBQUFBLFVBR0FTLFNBQVMsR0FBR04sT0FBTyxDQUFDakIsYUFBUiwyQkFBeUNjLElBQUksR0FBRyxDQUFoRCxPQUhaO0FBQUEsVUFJQVUsVUFBVSxHQUFHTixRQUFRLENBQUNsQixhQUFULDJCQUEwQ2MsSUFBSSxHQUFHLENBQWpELE9BSmI7QUFBQSxVQUtBVyxVQUFVLEdBQUdOLFFBQVEsQ0FBQ25CLGFBQVQsMkJBQTBDYyxJQUFJLEdBQUcsQ0FBakQsT0FMYjtBQUFBLFVBTUFZLFlBQVksR0FBR04sVUFBVSxDQUFDcEIsYUFBWCwyQkFBNENjLElBQUksR0FBRyxDQUFuRCxPQU5mO0FBU0FPLGdCQUFVLENBQUNYLEtBQVgsQ0FBaUJDLFNBQWpCLEdBQTZCLHlDQUE3QjtBQUNBVyxpQkFBVyxDQUFDWixLQUFaLENBQWtCQyxTQUFsQixHQUE4Qix5Q0FBOUI7QUFDQVksZUFBUyxDQUFDYixLQUFWLENBQWdCQyxTQUFoQixHQUE0Qix5Q0FBNUI7QUFDQWEsZ0JBQVUsQ0FBQ2QsS0FBWCxDQUFpQkMsU0FBakIsR0FBNkIseUNBQTdCO0FBQ0FjLGdCQUFVLENBQUNmLEtBQVgsQ0FBaUJDLFNBQWpCLEdBQTZCLHlDQUE3QjtBQUNBZSxrQkFBWSxDQUFDaEIsS0FBYixDQUFtQkMsU0FBbkIsR0FBK0IseUNBQS9COztBQUVBLFVBQUlHLElBQUksS0FBSyxDQUFiLEVBQWdCO0FBQ2R2QixpQkFBUyxDQUFDdUIsSUFBSSxHQUFHLENBQVIsQ0FBVCxDQUFvQkosS0FBcEIsQ0FBMEJDLFNBQTFCLEdBQXNDLEVBQXRDO0FBQ0FuQixrQkFBVSxDQUFDc0IsSUFBSSxHQUFHLENBQVIsQ0FBVixDQUFxQkosS0FBckIsQ0FBMkJDLFNBQTNCLEdBQXVDLEVBQXZDO0FBQ0FsQixnQkFBUSxDQUFDcUIsSUFBSSxHQUFHLENBQVIsQ0FBUixDQUFtQkosS0FBbkIsQ0FBeUJDLFNBQXpCLEdBQXFDLEVBQXJDO0FBQ0FqQixpQkFBUyxDQUFDb0IsSUFBSSxHQUFHLENBQVIsQ0FBVCxDQUFvQkosS0FBcEIsQ0FBMEJDLFNBQTFCLEdBQXNDLEVBQXRDO0FBQ0FoQixpQkFBUyxDQUFDbUIsSUFBSSxHQUFHLENBQVIsQ0FBVCxDQUFvQkosS0FBcEIsQ0FBMEJDLFNBQTFCLEdBQXNDLEVBQXRDO0FBQ0FmLG1CQUFXLENBQUNrQixJQUFJLEdBQUcsQ0FBUixDQUFYLENBQXNCSixLQUF0QixDQUE0QkMsU0FBNUIsR0FBd0MsRUFBeEM7QUFDRCxPQVBELE1BT08sSUFBSUcsSUFBSSxLQUFLLENBQWIsRUFBZ0I7QUFDckJ2QixpQkFBUyxDQUFDQSxTQUFTLENBQUNnQixNQUFWLEdBQW1CLENBQXBCLENBQVQsQ0FBZ0NHLEtBQWhDLENBQXNDQyxTQUF0QyxHQUFrRCxFQUFsRDtBQUNBbkIsa0JBQVUsQ0FBQ0QsU0FBUyxDQUFDZ0IsTUFBVixHQUFtQixDQUFwQixDQUFWLENBQWlDRyxLQUFqQyxDQUF1Q0MsU0FBdkMsR0FBbUQsRUFBbkQ7QUFDQWxCLGdCQUFRLENBQUNGLFNBQVMsQ0FBQ2dCLE1BQVYsR0FBbUIsQ0FBcEIsQ0FBUixDQUErQkcsS0FBL0IsQ0FBcUNDLFNBQXJDLEdBQWlELEVBQWpEO0FBQ0FqQixpQkFBUyxDQUFDSCxTQUFTLENBQUNnQixNQUFWLEdBQW1CLENBQXBCLENBQVQsQ0FBZ0NHLEtBQWhDLENBQXNDQyxTQUF0QyxHQUFrRCxFQUFsRDtBQUNBaEIsaUJBQVMsQ0FBQ0osU0FBUyxDQUFDZ0IsTUFBVixHQUFtQixDQUFwQixDQUFULENBQWdDRyxLQUFoQyxDQUFzQ0MsU0FBdEMsR0FBa0QsRUFBbEQ7QUFDQWYsbUJBQVcsQ0FBQ0wsU0FBUyxDQUFDZ0IsTUFBVixHQUFtQixDQUFwQixDQUFYLENBQWtDRyxLQUFsQyxDQUF3Q0MsU0FBeEMsR0FBb0QsRUFBcEQ7QUFDRDs7QUFFRCxVQUFJVSxVQUFVLENBQUNiLE9BQWYsRUFBd0I7QUFDdEJsQyxZQUFJLENBQUM0QixLQUFMO0FBQ0Q7O0FBQ0QsVUFBSW9CLFdBQVcsQ0FBQ2QsT0FBaEIsRUFBeUI7QUFDdkIvQixhQUFLLENBQUN5QixLQUFOO0FBQ0Q7O0FBQ0QsVUFBSXFCLFNBQVMsQ0FBQ2YsT0FBZCxFQUF1QjtBQUNyQjlCLFdBQUcsQ0FBQ3dCLEtBQUo7QUFDRDs7QUFJRCxVQUFJc0IsVUFBVSxDQUFDaEIsT0FBZixFQUF3QjtBQUN0QjdCLFlBQUksQ0FBQ3VCLEtBQUw7QUFDRDs7QUFDRCxVQUFJdUIsVUFBVSxDQUFDakIsT0FBZixFQUF3QjtBQUN0QjVCLFlBQUksQ0FBQ3NCLEtBQUw7QUFDRDs7QUFDRCxVQUFJd0IsWUFBWSxDQUFDbEIsT0FBakIsRUFBMEI7QUFDeEIzQixjQUFNLENBQUNxQixLQUFQO0FBQ0Q7QUFDRjs7QUFDREosU0FBSztBQUNOO0FBQ0Y7O0FBR0Q2QixNQUFNLENBQUMxQixnQkFBUCxDQUF3QixrQkFBeEIsRUFBNEMsWUFBTTtBQUNsRDVCLFdBQVM7QUFDUixDQUZELEU7Ozs7Ozs7Ozs7O0FDbktBLHVDIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9kaXN0L1wiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3NyYy9pbmRleC5qc1wiKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cbnZhciBydW50aW1lID0gZnVuY3Rpb24gKGV4cG9ydHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIE9wID0gT2JqZWN0LnByb3RvdHlwZTtcbiAgdmFyIGhhc093biA9IE9wLmhhc093blByb3BlcnR5O1xuICB2YXIgdW5kZWZpbmVkOyAvLyBNb3JlIGNvbXByZXNzaWJsZSB0aGFuIHZvaWQgMC5cblxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIGZ1bmN0aW9uIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBJZiBvdXRlckZuIHByb3ZpZGVkIGFuZCBvdXRlckZuLnByb3RvdHlwZSBpcyBhIEdlbmVyYXRvciwgdGhlbiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvci5cbiAgICB2YXIgcHJvdG9HZW5lcmF0b3IgPSBvdXRlckZuICYmIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yID8gb3V0ZXJGbiA6IEdlbmVyYXRvcjtcbiAgICB2YXIgZ2VuZXJhdG9yID0gT2JqZWN0LmNyZWF0ZShwcm90b0dlbmVyYXRvci5wcm90b3R5cGUpO1xuICAgIHZhciBjb250ZXh0ID0gbmV3IENvbnRleHQodHJ5TG9jc0xpc3QgfHwgW10pOyAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuXG4gICAgZ2VuZXJhdG9yLl9pbnZva2UgPSBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cblxuICBleHBvcnRzLndyYXAgPSB3cmFwOyAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG5cbiAgZnVuY3Rpb24gdHJ5Q2F0Y2goZm4sIG9iaiwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwibm9ybWFsXCIsXG4gICAgICAgIGFyZzogZm4uY2FsbChvYmosIGFyZylcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcInRocm93XCIsXG4gICAgICAgIGFyZzogZXJyXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0ID0gXCJzdXNwZW5kZWRTdGFydFwiO1xuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRZaWVsZCA9IFwic3VzcGVuZGVkWWllbGRcIjtcbiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gXCJleGVjdXRpbmdcIjtcbiAgdmFyIEdlblN0YXRlQ29tcGxldGVkID0gXCJjb21wbGV0ZWRcIjsgLy8gUmV0dXJuaW5nIHRoaXMgb2JqZWN0IGZyb20gdGhlIGlubmVyRm4gaGFzIHRoZSBzYW1lIGVmZmVjdCBhc1xuICAvLyBicmVha2luZyBvdXQgb2YgdGhlIGRpc3BhdGNoIHN3aXRjaCBzdGF0ZW1lbnQuXG5cbiAgdmFyIENvbnRpbnVlU2VudGluZWwgPSB7fTsgLy8gRHVtbXkgY29uc3RydWN0b3IgZnVuY3Rpb25zIHRoYXQgd2UgdXNlIGFzIHRoZSAuY29uc3RydWN0b3IgYW5kXG4gIC8vIC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgcHJvcGVydGllcyBmb3IgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIEdlbmVyYXRvclxuICAvLyBvYmplY3RzLiBGb3IgZnVsbCBzcGVjIGNvbXBsaWFuY2UsIHlvdSBtYXkgd2lzaCB0byBjb25maWd1cmUgeW91clxuICAvLyBtaW5pZmllciBub3QgdG8gbWFuZ2xlIHRoZSBuYW1lcyBvZiB0aGVzZSB0d28gZnVuY3Rpb25zLlxuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9XG5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuXG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge30gLy8gVGhpcyBpcyBhIHBvbHlmaWxsIGZvciAlSXRlcmF0b3JQcm90b3R5cGUlIGZvciBlbnZpcm9ubWVudHMgdGhhdFxuICAvLyBkb24ndCBuYXRpdmVseSBzdXBwb3J0IGl0LlxuXG5cbiAgdmFyIEl0ZXJhdG9yUHJvdG90eXBlID0ge307XG5cbiAgSXRlcmF0b3JQcm90b3R5cGVbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbiAgdmFyIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG8gJiYgZ2V0UHJvdG8oZ2V0UHJvdG8odmFsdWVzKFtdKSkpO1xuXG4gIGlmIChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAmJiBOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAhPT0gT3AgJiYgaGFzT3duLmNhbGwoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sKSkge1xuICAgIC8vIFRoaXMgZW52aXJvbm1lbnQgaGFzIGEgbmF0aXZlICVJdGVyYXRvclByb3RvdHlwZSU7IHVzZSBpdCBpbnN0ZWFkXG4gICAgLy8gb2YgdGhlIHBvbHlmaWxsLlxuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gTmF0aXZlSXRlcmF0b3JQcm90b3R5cGU7XG4gIH1cblxuICB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPSBHZW5lcmF0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJdGVyYXRvclByb3RvdHlwZSk7XG4gIEdlbmVyYXRvckZ1bmN0aW9uLnByb3RvdHlwZSA9IEdwLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLmNvbnN0cnVjdG9yID0gR2VuZXJhdG9yRnVuY3Rpb247XG4gIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlW3RvU3RyaW5nVGFnU3ltYm9sXSA9IEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiOyAvLyBIZWxwZXIgZm9yIGRlZmluaW5nIHRoZSAubmV4dCwgLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzIG9mIHRoZVxuICAvLyBJdGVyYXRvciBpbnRlcmZhY2UgaW4gdGVybXMgb2YgYSBzaW5nbGUgLl9pbnZva2UgbWV0aG9kLlxuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICBwcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZXhwb3J0cy5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvciA/IGN0b3IgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8IC8vIEZvciB0aGUgbmF0aXZlIEdlbmVyYXRvckZ1bmN0aW9uIGNvbnN0cnVjdG9yLCB0aGUgYmVzdCB3ZSBjYW5cbiAgICAvLyBkbyBpcyB0byBjaGVjayBpdHMgLm5hbWUgcHJvcGVydHkuXG4gICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiIDogZmFsc2U7XG4gIH07XG5cbiAgZXhwb3J0cy5tYXJrID0gZnVuY3Rpb24gKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuXG4gICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7XG4gICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvckZ1bmN0aW9uXCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2VuRnVuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR3ApO1xuICAgIHJldHVybiBnZW5GdW47XG4gIH07IC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKWAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuXG5cblxuICBleHBvcnRzLmF3cmFwID0gZnVuY3Rpb24gKGFyZykge1xuICAgIHJldHVybiB7XG4gICAgICBfX2F3YWl0OiBhcmdcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFzeW5jSXRlcmF0b3IoZ2VuZXJhdG9yLCBQcm9taXNlSW1wbCkge1xuICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTtcblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgcmVqZWN0KHJlY29yZC5hcmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlY29yZC5hcmc7XG4gICAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdC52YWx1ZTtcblxuICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIGhhc093bi5jYWxsKHZhbHVlLCBcIl9fYXdhaXRcIikpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZUltcGwucmVzb2x2ZSh2YWx1ZS5fX2F3YWl0KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaW52b2tlKFwibmV4dFwiLCB2YWx1ZSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJ0aHJvd1wiLCBlcnIsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZUltcGwucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbiAodW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBJZiBhIHJlamVjdGVkIFByb21pc2Ugd2FzIHlpZWxkZWQsIHRocm93IHRoZSByZWplY3Rpb24gYmFja1xuICAgICAgICAgIC8vIGludG8gdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBzbyBpdCBjYW4gYmUgaGFuZGxlZCB0aGVyZS5cbiAgICAgICAgICByZXR1cm4gaW52b2tlKFwidGhyb3dcIiwgZXJyb3IsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBwcmV2aW91c1Byb21pc2U7XG5cbiAgICBmdW5jdGlvbiBlbnF1ZXVlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlSW1wbChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9IC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgIC8vIGFsbCBwcmV2aW91cyBQcm9taXNlcyBoYXZlIGJlZW4gcmVzb2x2ZWQgYmVmb3JlIGNhbGxpbmcgaW52b2tlLFxuICAgICAgLy8gc28gdGhhdCByZXN1bHRzIGFyZSBhbHdheXMgZGVsaXZlcmVkIGluIHRoZSBjb3JyZWN0IG9yZGVyLiBJZlxuICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgIC8vIGNhbGwgaW52b2tlIGltbWVkaWF0ZWx5LCB3aXRob3V0IHdhaXRpbmcgb24gYSBjYWxsYmFjayB0byBmaXJlLFxuICAgICAgLy8gc28gdGhhdCB0aGUgYXN5bmMgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhcyB0aGUgb3Bwb3J0dW5pdHkgdG8gZG9cbiAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgIC8vIGlzIHdoeSB0aGUgUHJvbWlzZSBjb25zdHJ1Y3RvciBzeW5jaHJvbm91c2x5IGludm9rZXMgaXRzXG4gICAgICAvLyBleGVjdXRvciBjYWxsYmFjaywgYW5kIHdoeSBhc3luYyBmdW5jdGlvbnMgc3luY2hyb25vdXNseVxuICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgIC8vIGFzeW5jIGZ1bmN0aW9ucyBpbiB0ZXJtcyBvZiBhc3luYyBnZW5lcmF0b3JzLCBpdCBpcyBlc3BlY2lhbGx5XG4gICAgICAvLyBpbXBvcnRhbnQgdG8gZ2V0IHRoaXMgcmlnaHQsIGV2ZW4gdGhvdWdoIGl0IHJlcXVpcmVzIGNhcmUuXG4gICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZywgLy8gQXZvaWQgcHJvcGFnYXRpbmcgZmFpbHVyZXMgdG8gUHJvbWlzZXMgcmV0dXJuZWQgYnkgbGF0ZXJcbiAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgfSAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuXG5cbiAgICB0aGlzLl9pbnZva2UgPSBlbnF1ZXVlO1xuICB9XG5cbiAgZGVmaW5lSXRlcmF0b3JNZXRob2RzKEFzeW5jSXRlcmF0b3IucHJvdG90eXBlKTtcblxuICBBc3luY0l0ZXJhdG9yLnByb3RvdHlwZVthc3luY0l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBleHBvcnRzLkFzeW5jSXRlcmF0b3IgPSBBc3luY0l0ZXJhdG9yOyAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cblxuICBleHBvcnRzLmFzeW5jID0gZnVuY3Rpb24gKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0LCBQcm9taXNlSW1wbCkge1xuICAgIGlmIChQcm9taXNlSW1wbCA9PT0gdm9pZCAwKSBQcm9taXNlSW1wbCA9IFByb21pc2U7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcih3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSwgUHJvbWlzZUltcGwpO1xuICAgIHJldHVybiBleHBvcnRzLmlzR2VuZXJhdG9yRnVuY3Rpb24ob3V0ZXJGbikgPyBpdGVyIC8vIElmIG91dGVyRm4gaXMgYSBnZW5lcmF0b3IsIHJldHVybiB0aGUgZnVsbCBpdGVyYXRvci5cbiAgICA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgcmV0dXJuIHJlc3VsdC5kb25lID8gcmVzdWx0LnZhbHVlIDogaXRlci5uZXh0KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KSB7XG4gICAgdmFyIHN0YXRlID0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydDtcbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9IC8vIEJlIGZvcmdpdmluZywgcGVyIDI1LjMuMy4zLjMgb2YgdGhlIHNwZWM6XG4gICAgICAgIC8vIGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1nZW5lcmF0b3JyZXN1bWVcblxuXG4gICAgICAgIHJldHVybiBkb25lUmVzdWx0KCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRleHQubWV0aG9kID0gbWV0aG9kO1xuICAgICAgY29udGV4dC5hcmcgPSBhcmc7XG5cbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IGNvbnRleHQuZGVsZWdhdGU7XG5cbiAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgdmFyIGRlbGVnYXRlUmVzdWx0ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7XG4gICAgICAgICAgICByZXR1cm4gZGVsZWdhdGVSZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgIC8vIFNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgICAgIC8vIGZ1bmN0aW9uLnNlbnQgaW1wbGVtZW50YXRpb24uXG4gICAgICAgICAgY29udGV4dC5zZW50ID0gY29udGV4dC5fc2VudCA9IGNvbnRleHQuYXJnO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICAgIGNvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGNvbnRleHQuYXJnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRlID0gR2VuU3RhdGVFeGVjdXRpbmc7XG4gICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIpIHtcbiAgICAgICAgICAvLyBJZiBhbiBleGNlcHRpb24gaXMgdGhyb3duIGZyb20gaW5uZXJGbiwgd2UgbGVhdmUgc3RhdGUgPT09XG4gICAgICAgICAgLy8gR2VuU3RhdGVFeGVjdXRpbmcgYW5kIGxvb3AgYmFjayBmb3IgYW5vdGhlciBpbnZvY2F0aW9uLlxuICAgICAgICAgIHN0YXRlID0gY29udGV4dC5kb25lID8gR2VuU3RhdGVDb21wbGV0ZWQgOiBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogcmVjb3JkLmFyZyxcbiAgICAgICAgICAgIGRvbmU6IGNvbnRleHQuZG9uZVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7IC8vIERpc3BhdGNoIHRoZSBleGNlcHRpb24gYnkgbG9vcGluZyBiYWNrIGFyb3VuZCB0byB0aGVcbiAgICAgICAgICAvLyBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKSBjYWxsIGFib3ZlLlxuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfSAvLyBDYWxsIGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXShjb250ZXh0LmFyZykgYW5kIGhhbmRsZSB0aGVcbiAgLy8gcmVzdWx0LCBlaXRoZXIgYnkgcmV0dXJuaW5nIGEgeyB2YWx1ZSwgZG9uZSB9IHJlc3VsdCBmcm9tIHRoZVxuICAvLyBkZWxlZ2F0ZSBpdGVyYXRvciwgb3IgYnkgbW9kaWZ5aW5nIGNvbnRleHQubWV0aG9kIGFuZCBjb250ZXh0LmFyZyxcbiAgLy8gc2V0dGluZyBjb250ZXh0LmRlbGVnYXRlIHRvIG51bGwsIGFuZCByZXR1cm5pbmcgdGhlIENvbnRpbnVlU2VudGluZWwuXG5cblxuICBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KSB7XG4gICAgdmFyIG1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXTtcblxuICAgIGlmIChtZXRob2QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gQSAudGhyb3cgb3IgLnJldHVybiB3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gLnRocm93XG4gICAgICAvLyBtZXRob2QgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLlxuICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIC8vIE5vdGU6IFtcInJldHVyblwiXSBtdXN0IGJlIHVzZWQgZm9yIEVTMyBwYXJzaW5nIGNvbXBhdGliaWxpdHkuXG4gICAgICAgIGlmIChkZWxlZ2F0ZS5pdGVyYXRvcltcInJldHVyblwiXSkge1xuICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGFcbiAgICAgICAgICAvLyBjaGFuY2UgdG8gY2xlYW4gdXAuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInJldHVyblwiO1xuICAgICAgICAgIGNvbnRleHQuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG1heWJlSW52b2tlRGVsZWdhdGUoZGVsZWdhdGUsIGNvbnRleHQpO1xuXG4gICAgICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIC8vIElmIG1heWJlSW52b2tlRGVsZWdhdGUoY29udGV4dCkgY2hhbmdlZCBjb250ZXh0Lm1ldGhvZCBmcm9tXG4gICAgICAgICAgICAvLyBcInJldHVyblwiIHRvIFwidGhyb3dcIiwgbGV0IHRoYXQgb3ZlcnJpZGUgdGhlIFR5cGVFcnJvciBiZWxvdy5cbiAgICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IG5ldyBUeXBlRXJyb3IoXCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICd0aHJvdycgbWV0aG9kXCIpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG5cbiAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2gobWV0aG9kLCBkZWxlZ2F0ZS5pdGVyYXRvciwgY29udGV4dC5hcmcpO1xuXG4gICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG5cbiAgICB2YXIgaW5mbyA9IHJlY29yZC5hcmc7XG5cbiAgICBpZiAoIWluZm8pIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFwiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgIC8vIEFzc2lnbiB0aGUgcmVzdWx0IG9mIHRoZSBmaW5pc2hlZCBkZWxlZ2F0ZSB0byB0aGUgdGVtcG9yYXJ5XG4gICAgICAvLyB2YXJpYWJsZSBzcGVjaWZpZWQgYnkgZGVsZWdhdGUucmVzdWx0TmFtZSAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7IC8vIFJlc3VtZSBleGVjdXRpb24gYXQgdGhlIGRlc2lyZWQgbG9jYXRpb24gKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cblxuICAgICAgY29udGV4dC5uZXh0ID0gZGVsZWdhdGUubmV4dExvYzsgLy8gSWYgY29udGV4dC5tZXRob2Qgd2FzIFwidGhyb3dcIiBidXQgdGhlIGRlbGVnYXRlIGhhbmRsZWQgdGhlXG4gICAgICAvLyBleGNlcHRpb24sIGxldCB0aGUgb3V0ZXIgZ2VuZXJhdG9yIHByb2NlZWQgbm9ybWFsbHkuIElmXG4gICAgICAvLyBjb250ZXh0Lm1ldGhvZCB3YXMgXCJuZXh0XCIsIGZvcmdldCBjb250ZXh0LmFyZyBzaW5jZSBpdCBoYXMgYmVlblxuICAgICAgLy8gXCJjb25zdW1lZFwiIGJ5IHRoZSBkZWxlZ2F0ZSBpdGVyYXRvci4gSWYgY29udGV4dC5tZXRob2Qgd2FzXG4gICAgICAvLyBcInJldHVyblwiLCBhbGxvdyB0aGUgb3JpZ2luYWwgLnJldHVybiBjYWxsIHRvIGNvbnRpbnVlIGluIHRoZVxuICAgICAgLy8gb3V0ZXIgZ2VuZXJhdG9yLlxuXG4gICAgICBpZiAoY29udGV4dC5tZXRob2QgIT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFJlLXlpZWxkIHRoZSByZXN1bHQgcmV0dXJuZWQgYnkgdGhlIGRlbGVnYXRlIG1ldGhvZC5cbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH0gLy8gVGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGlzIGZpbmlzaGVkLCBzbyBmb3JnZXQgaXQgYW5kIGNvbnRpbnVlIHdpdGhcbiAgICAvLyB0aGUgb3V0ZXIgZ2VuZXJhdG9yLlxuXG5cbiAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgfSAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG5cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoR3ApO1xuICBHcFt0b1N0cmluZ1RhZ1N5bWJvbF0gPSBcIkdlbmVyYXRvclwiOyAvLyBBIEdlbmVyYXRvciBzaG91bGQgYWx3YXlzIHJldHVybiBpdHNlbGYgYXMgdGhlIGl0ZXJhdG9yIG9iamVjdCB3aGVuIHRoZVxuICAvLyBAQGl0ZXJhdG9yIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbiBpdC4gU29tZSBicm93c2VycycgaW1wbGVtZW50YXRpb25zIG9mIHRoZVxuICAvLyBpdGVyYXRvciBwcm90b3R5cGUgY2hhaW4gaW5jb3JyZWN0bHkgaW1wbGVtZW50IHRoaXMsIGNhdXNpbmcgdGhlIEdlbmVyYXRvclxuICAvLyBvYmplY3QgdG8gbm90IGJlIHJldHVybmVkIGZyb20gdGhpcyBjYWxsLiBUaGlzIGVuc3VyZXMgdGhhdCBkb2Vzbid0IGhhcHBlbi5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9pc3N1ZXMvMjc0IGZvciBtb3JlIGRldGFpbHMuXG5cbiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEdwLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0ge1xuICAgICAgdHJ5TG9jOiBsb2NzWzBdXG4gICAgfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbe1xuICAgICAgdHJ5TG9jOiBcInJvb3RcIlxuICAgIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgZXhwb3J0cy5rZXlzID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgIHZhciBrZXlzID0gW107XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG5cbiAgICBrZXlzLnJldmVyc2UoKTsgLy8gUmF0aGVyIHRoYW4gcmV0dXJuaW5nIGFuIG9iamVjdCB3aXRoIGEgbmV4dCBtZXRob2QsIHdlIGtlZXBcbiAgICAvLyB0aGluZ3Mgc2ltcGxlIGFuZCByZXR1cm4gdGhlIG5leHQgZnVuY3Rpb24gaXRzZWxmLlxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG5cbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5O1xuICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgICB9IC8vIFRvIGF2b2lkIGNyZWF0aW5nIGFuIGFkZGl0aW9uYWwgb2JqZWN0LCB3ZSBqdXN0IGhhbmcgdGhlIC52YWx1ZVxuICAgICAgLy8gYW5kIC5kb25lIHByb3BlcnRpZXMgb2ZmIHRoZSBuZXh0IGZ1bmN0aW9uIG9iamVjdCBpdHNlbGYuIFRoaXNcbiAgICAgIC8vIGFsc28gZW5zdXJlcyB0aGF0IHRoZSBtaW5pZmllciB3aWxsIG5vdCBhbm9ueW1pemUgdGhlIGZ1bmN0aW9uLlxuXG5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuXG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGl0ZXJhYmxlLm5leHQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkge1xuICAgICAgICB2YXIgaSA9IC0xLFxuICAgICAgICAgICAgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG5leHQubmV4dCA9IG5leHQ7XG4gICAgICB9XG4gICAgfSAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG5cblxuICAgIHJldHVybiB7XG4gICAgICBuZXh0OiBkb25lUmVzdWx0XG4gICAgfTtcbiAgfVxuXG4gIGV4cG9ydHMudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiB1bmRlZmluZWQsXG4gICAgICBkb25lOiB0cnVlXG4gICAgfTtcbiAgfVxuXG4gIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuICAgIHJlc2V0OiBmdW5jdGlvbiAoc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7IC8vIFJlc2V0dGluZyBjb250ZXh0Ll9zZW50IGZvciBsZWdhY3kgc3VwcG9ydCBvZiBCYWJlbCdzXG4gICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuXG4gICAgICB0aGlzLnNlbnQgPSB0aGlzLl9zZW50ID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICB0aGlzLmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpO1xuXG4gICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSB7XG4gICAgICAgICAgLy8gTm90IHN1cmUgYWJvdXQgdGhlIG9wdGltYWwgb3JkZXIgb2YgdGhlc2UgY29uZGl0aW9uczpcbiAgICAgICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09IFwidFwiICYmIGhhc093bi5jYWxsKHRoaXMsIG5hbWUpICYmICFpc05hTigrbmFtZS5zbGljZSgxKSkpIHtcbiAgICAgICAgICAgIHRoaXNbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgIGlmIChyb290UmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByb290UmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucnZhbDtcbiAgICB9LFxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbiAoZXhjZXB0aW9uKSB7XG4gICAgICBpZiAodGhpcy5kb25lKSB7XG4gICAgICAgIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuXG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcblxuICAgICAgICBpZiAoY2F1Z2h0KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAvLyB0aGVuIGxldCB0aGF0IGNhdGNoIGJsb2NrIGhhbmRsZSB0aGUgZXhjZXB0aW9uIG5vcm1hbGx5LlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gISFjYXVnaHQ7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSBcInJvb3RcIikge1xuICAgICAgICAgIC8vIEV4Y2VwdGlvbiB0aHJvd24gb3V0c2lkZSBvZiBhbnkgdHJ5IGJsb2NrIHRoYXQgY291bGQgaGFuZGxlXG4gICAgICAgICAgLy8gaXQsIHNvIHNldCB0aGUgY29tcGxldGlvbiB2YWx1ZSBvZiB0aGUgZW50aXJlIGZ1bmN0aW9uIHRvXG4gICAgICAgICAgLy8gdGhyb3cgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXR1cm4gaGFuZGxlKFwiZW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHtcbiAgICAgICAgICB2YXIgaGFzQ2F0Y2ggPSBoYXNPd24uY2FsbChlbnRyeSwgXCJjYXRjaExvY1wiKTtcbiAgICAgICAgICB2YXIgaGFzRmluYWxseSA9IGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIik7XG5cbiAgICAgICAgICBpZiAoaGFzQ2F0Y2ggJiYgaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNDYXRjaCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uICh0eXBlLCBhcmcpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2ICYmIGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIikgJiYgdGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgIHZhciBmaW5hbGx5RW50cnkgPSBlbnRyeTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZmluYWxseUVudHJ5ICYmICh0eXBlID09PSBcImJyZWFrXCIgfHwgdHlwZSA9PT0gXCJjb250aW51ZVwiKSAmJiBmaW5hbGx5RW50cnkudHJ5TG9jIDw9IGFyZyAmJiBhcmcgPD0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgLy8gSWdub3JlIHRoZSBmaW5hbGx5IGVudHJ5IGlmIGNvbnRyb2wgaXMgbm90IGp1bXBpbmcgdG8gYVxuICAgICAgICAvLyBsb2NhdGlvbiBvdXRzaWRlIHRoZSB0cnkvY2F0Y2ggYmxvY2suXG4gICAgICAgIGZpbmFsbHlFbnRyeSA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciByZWNvcmQgPSBmaW5hbGx5RW50cnkgPyBmaW5hbGx5RW50cnkuY29tcGxldGlvbiA6IHt9O1xuICAgICAgcmVjb3JkLnR5cGUgPSB0eXBlO1xuICAgICAgcmVjb3JkLmFyZyA9IGFyZztcblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSkge1xuICAgICAgICB0aGlzLm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICB0aGlzLm5leHQgPSBmaW5hbGx5RW50cnkuZmluYWxseUxvYztcbiAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRlKHJlY29yZCk7XG4gICAgfSxcbiAgICBjb21wbGV0ZTogZnVuY3Rpb24gKHJlY29yZCwgYWZ0ZXJMb2MpIHtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJicmVha1wiIHx8IHJlY29yZC50eXBlID09PSBcImNvbnRpbnVlXCIpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gcmVjb3JkLmFyZztcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgdGhpcy5ydmFsID0gdGhpcy5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB0aGlzLm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgIHRoaXMubmV4dCA9IFwiZW5kXCI7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcIm5vcm1hbFwiICYmIGFmdGVyTG9jKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IGFmdGVyTG9jO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9LFxuICAgIGZpbmlzaDogZnVuY3Rpb24gKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuXG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24gKHRyeUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdGhyb3duO1xuICAgICAgICB9XG4gICAgICB9IC8vIFRoZSBjb250ZXh0LmNhdGNoIG1ldGhvZCBtdXN0IG9ubHkgYmUgY2FsbGVkIHdpdGggYSBsb2NhdGlvblxuICAgICAgLy8gYXJndW1lbnQgdGhhdCBjb3JyZXNwb25kcyB0byBhIGtub3duIGNhdGNoIGJsb2NrLlxuXG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIChpdGVyYWJsZSwgcmVzdWx0TmFtZSwgbmV4dExvYykge1xuICAgICAgdGhpcy5kZWxlZ2F0ZSA9IHtcbiAgICAgICAgaXRlcmF0b3I6IHZhbHVlcyhpdGVyYWJsZSksXG4gICAgICAgIHJlc3VsdE5hbWU6IHJlc3VsdE5hbWUsXG4gICAgICAgIG5leHRMb2M6IG5leHRMb2NcbiAgICAgIH07XG5cbiAgICAgIGlmICh0aGlzLm1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgLy8gRGVsaWJlcmF0ZWx5IGZvcmdldCB0aGUgbGFzdCBzZW50IHZhbHVlIHNvIHRoYXQgd2UgZG9uJ3RcbiAgICAgICAgLy8gYWNjaWRlbnRhbGx5IHBhc3MgaXQgb24gdG8gdGhlIGRlbGVnYXRlLlxuICAgICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfVxuICB9OyAvLyBSZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGhpcyBzY3JpcHQgaXMgZXhlY3V0aW5nIGFzIGEgQ29tbW9uSlMgbW9kdWxlXG4gIC8vIG9yIG5vdCwgcmV0dXJuIHRoZSBydW50aW1lIG9iamVjdCBzbyB0aGF0IHdlIGNhbiBkZWNsYXJlIHRoZSB2YXJpYWJsZVxuICAvLyByZWdlbmVyYXRvclJ1bnRpbWUgaW4gdGhlIG91dGVyIHNjb3BlLCB3aGljaCBhbGxvd3MgdGhpcyBtb2R1bGUgdG8gYmVcbiAgLy8gaW5qZWN0ZWQgZWFzaWx5IGJ5IGBiaW4vcmVnZW5lcmF0b3IgLS1pbmNsdWRlLXJ1bnRpbWUgc2NyaXB0LmpzYC5cblxuICByZXR1cm4gZXhwb3J0cztcbn0oIC8vIElmIHRoaXMgc2NyaXB0IGlzIGV4ZWN1dGluZyBhcyBhIENvbW1vbkpTIG1vZHVsZSwgdXNlIG1vZHVsZS5leHBvcnRzXG4vLyBhcyB0aGUgcmVnZW5lcmF0b3JSdW50aW1lIG5hbWVzcGFjZS4gT3RoZXJ3aXNlIGNyZWF0ZSBhIG5ldyBlbXB0eVxuLy8gb2JqZWN0LiBFaXRoZXIgd2F5LCB0aGUgcmVzdWx0aW5nIG9iamVjdCB3aWxsIGJlIHVzZWQgdG8gaW5pdGlhbGl6ZVxuLy8gdGhlIHJlZ2VuZXJhdG9yUnVudGltZSB2YXJpYWJsZSBhdCB0aGUgdG9wIG9mIHRoaXMgZmlsZS5cbnR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgPyBtb2R1bGUuZXhwb3J0cyA6IHt9KTtcblxudHJ5IHtcbiAgcmVnZW5lcmF0b3JSdW50aW1lID0gcnVudGltZTtcbn0gY2F0Y2ggKGFjY2lkZW50YWxTdHJpY3RNb2RlKSB7XG4gIC8vIFRoaXMgbW9kdWxlIHNob3VsZCBub3QgYmUgcnVubmluZyBpbiBzdHJpY3QgbW9kZSwgc28gdGhlIGFib3ZlXG4gIC8vIGFzc2lnbm1lbnQgc2hvdWxkIGFsd2F5cyB3b3JrIHVubGVzcyBzb21ldGhpbmcgaXMgbWlzY29uZmlndXJlZC4gSnVzdFxuICAvLyBpbiBjYXNlIHJ1bnRpbWUuanMgYWNjaWRlbnRhbGx5IHJ1bnMgaW4gc3RyaWN0IG1vZGUsIHdlIGNhbiBlc2NhcGVcbiAgLy8gc3RyaWN0IG1vZGUgdXNpbmcgYSBnbG9iYWwgRnVuY3Rpb24gY2FsbC4gVGhpcyBjb3VsZCBjb25jZWl2YWJseSBmYWlsXG4gIC8vIGlmIGEgQ29udGVudCBTZWN1cml0eSBQb2xpY3kgZm9yYmlkcyB1c2luZyBGdW5jdGlvbiwgYnV0IGluIHRoYXQgY2FzZVxuICAvLyB0aGUgcHJvcGVyIHNvbHV0aW9uIGlzIHRvIGZpeCB0aGUgYWNjaWRlbnRhbCBzdHJpY3QgbW9kZSBwcm9ibGVtLiBJZlxuICAvLyB5b3UndmUgbWlzY29uZmlndXJlZCB5b3VyIGJ1bmRsZXIgdG8gZm9yY2Ugc3RyaWN0IG1vZGUgYW5kIGFwcGxpZWQgYVxuICAvLyBDU1AgdG8gZm9yYmlkIEZ1bmN0aW9uLCBhbmQgeW91J3JlIG5vdCB3aWxsaW5nIHRvIGZpeCBlaXRoZXIgb2YgdGhvc2VcbiAgLy8gcHJvYmxlbXMsIHBsZWFzZSBkZXRhaWwgeW91ciB1bmlxdWUgcHJlZGljYW1lbnQgaW4gYSBHaXRIdWIgaXNzdWUuXG4gIEZ1bmN0aW9uKFwiclwiLCBcInJlZ2VuZXJhdG9yUnVudGltZSA9IHJcIikocnVudGltZSk7XG59IiwiIWZ1bmN0aW9uICh0LCBlKSB7XG4gIFwib2JqZWN0XCIgPT0gdHlwZW9mIGV4cG9ydHMgJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgbW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgPSBlKCkgOiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFtdLCBlKSA6IFwib2JqZWN0XCIgPT0gdHlwZW9mIGV4cG9ydHMgPyBleHBvcnRzLlRvbmUgPSBlKCkgOiB0LlRvbmUgPSBlKCk7XG59KFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHNlbGYgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICB2YXIgZSA9IHt9O1xuXG4gICAgZnVuY3Rpb24gaShzKSB7XG4gICAgICBpZiAoZVtzXSkgcmV0dXJuIGVbc10uZXhwb3J0cztcbiAgICAgIHZhciBuID0gZVtzXSA9IHtcbiAgICAgICAgaTogcyxcbiAgICAgICAgbDogITEsXG4gICAgICAgIGV4cG9ydHM6IHt9XG4gICAgICB9O1xuICAgICAgcmV0dXJuIHRbc10uY2FsbChuLmV4cG9ydHMsIG4sIG4uZXhwb3J0cywgaSksIG4ubCA9ICEwLCBuLmV4cG9ydHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIGkubSA9IHQsIGkuYyA9IGUsIGkuZCA9IGZ1bmN0aW9uICh0LCBlLCBzKSB7XG4gICAgICBpLm8odCwgZSkgfHwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGUsIHtcbiAgICAgICAgY29uZmlndXJhYmxlOiAhMSxcbiAgICAgICAgZW51bWVyYWJsZTogITAsXG4gICAgICAgIGdldDogc1xuICAgICAgfSk7XG4gICAgfSwgaS5yID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBcIl9fZXNNb2R1bGVcIiwge1xuICAgICAgICB2YWx1ZTogITBcbiAgICAgIH0pO1xuICAgIH0sIGkubiA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHQgJiYgdC5fX2VzTW9kdWxlID8gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdC5kZWZhdWx0O1xuICAgICAgfSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIGkuZChlLCBcImFcIiwgZSksIGU7XG4gICAgfSwgaS5vID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgZSk7XG4gICAgfSwgaS5wID0gXCJcIiwgaShpLnMgPSAxNDgpO1xuICB9KFtmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpLCBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIHMgPSBpKDkzKSxcbiAgICAgICAgICBuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgbikpIHRocm93IG5ldyBFcnJvcihcImNvbnN0cnVjdG9yIG5lZWRzIHRvIGJlIGNhbGxlZCB3aXRoIHRoZSAnbmV3JyBrZXl3b3JkXCIpO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogIFRvbmUuanNcbiAgICAgICAqICBAYXV0aG9yIFlvdGFtIE1hbm5cbiAgICAgICAqICBAbGljZW5zZSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUIE1JVCBMaWNlbnNlXG4gICAgICAgKiAgQGNvcHlyaWdodCAyMDE0LTIwMTkgWW90YW0gTWFublxuICAgICAgICovXG5cblxuICAgICAgbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIHQgaW4gbikge1xuICAgICAgICAgIHZhciBlID0gdFswXS5tYXRjaCgvXltBLVpdJC8pLFxuICAgICAgICAgICAgICBpID0gblt0XSA9PT0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICAgICAgICBpZiAobi5pc0Z1bmN0aW9uKG5bdF0pICYmIGUgJiYgaSkgcmV0dXJuIHQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gXCJUb25lXCI7XG4gICAgICB9LCBuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sIG4ucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgIGlmIChuLmlzU3RyaW5nKHQpKSB7XG4gICAgICAgICAgdmFyIGkgPSB7fTtcbiAgICAgICAgICBpW3RdID0gZSwgdCA9IGk7XG4gICAgICAgIH1cblxuICAgICAgICB0OiBmb3IgKHZhciBzIGluIHQpIHtcbiAgICAgICAgICBlID0gdFtzXTtcbiAgICAgICAgICB2YXIgbyA9IHRoaXM7XG5cbiAgICAgICAgICBpZiAoLTEgIT09IHMuaW5kZXhPZihcIi5cIikpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGEgPSBzLnNwbGl0KFwiLlwiKSwgciA9IDA7IHIgPCBhLmxlbmd0aCAtIDE7IHIrKykgaWYgKChvID0gb1thW3JdXSkgaW5zdGFuY2VvZiBuKSB7XG4gICAgICAgICAgICAgIGEuc3BsaWNlKDAsIHIgKyAxKTtcbiAgICAgICAgICAgICAgdmFyIGwgPSBhLmpvaW4oXCIuXCIpO1xuICAgICAgICAgICAgICBvLnNldChsLCBlKTtcbiAgICAgICAgICAgICAgY29udGludWUgdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcyA9IGFbYS5sZW5ndGggLSAxXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgdSA9IG9bc107XG4gICAgICAgICAgbi5pc1VuZGVmKHUpIHx8IChuLlNpZ25hbCAmJiB1IGluc3RhbmNlb2Ygbi5TaWduYWwgfHwgbi5QYXJhbSAmJiB1IGluc3RhbmNlb2Ygbi5QYXJhbSA/IHUudmFsdWUgIT09IGUgJiYgKHUudmFsdWUgPSBlKSA6IHUgaW5zdGFuY2VvZiBBdWRpb1BhcmFtID8gdS52YWx1ZSAhPT0gZSAmJiAodS52YWx1ZSA9IGUpIDogbi5UaW1lQmFzZSAmJiB1IGluc3RhbmNlb2Ygbi5UaW1lQmFzZSA/IG9bc10gPSBlIDogdSBpbnN0YW5jZW9mIG4gPyB1LnNldChlKSA6IHUgIT09IGUgJiYgKG9bc10gPSBlKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH0sIG4ucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIG4uaXNVbmRlZih0KSA/IHQgPSB0aGlzLl9jb2xsZWN0RGVmYXVsdHModGhpcy5jb25zdHJ1Y3RvcikgOiBuLmlzU3RyaW5nKHQpICYmICh0ID0gW3RdKTtcblxuICAgICAgICBmb3IgKHZhciBlID0ge30sIGkgPSAwOyBpIDwgdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBzID0gdFtpXSxcbiAgICAgICAgICAgICAgbyA9IHRoaXMsXG4gICAgICAgICAgICAgIGEgPSBlO1xuXG4gICAgICAgICAgaWYgKC0xICE9PSBzLmluZGV4T2YoXCIuXCIpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciByID0gcy5zcGxpdChcIi5cIiksIGwgPSAwOyBsIDwgci5sZW5ndGggLSAxOyBsKyspIHtcbiAgICAgICAgICAgICAgdmFyIHUgPSByW2xdO1xuICAgICAgICAgICAgICBhW3VdID0gYVt1XSB8fCB7fSwgYSA9IGFbdV0sIG8gPSBvW3VdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzID0gcltyLmxlbmd0aCAtIDFdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBkID0gb1tzXTtcbiAgICAgICAgICBuLmlzT2JqZWN0KHRbc10pID8gYVtzXSA9IGQuZ2V0KCkgOiBuLlNpZ25hbCAmJiBkIGluc3RhbmNlb2Ygbi5TaWduYWwgPyBhW3NdID0gZC52YWx1ZSA6IG4uUGFyYW0gJiYgZCBpbnN0YW5jZW9mIG4uUGFyYW0gPyBhW3NdID0gZC52YWx1ZSA6IGQgaW5zdGFuY2VvZiBBdWRpb1BhcmFtID8gYVtzXSA9IGQudmFsdWUgOiBkIGluc3RhbmNlb2YgbiA/IGFbc10gPSBkLmdldCgpIDogIW4uaXNGdW5jdGlvbihkKSAmJiBuLmlzRGVmaW5lZChkKSAmJiAoYVtzXSA9IGQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9LCBuLnByb3RvdHlwZS5fY29sbGVjdERlZmF1bHRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSBbXTtcbiAgICAgICAgaWYgKG4uaXNEZWZpbmVkKHQuZGVmYXVsdHMpICYmIChlID0gT2JqZWN0LmtleXModC5kZWZhdWx0cykpLCBuLmlzRGVmaW5lZCh0Ll9zdXBlcikpIGZvciAodmFyIGkgPSB0aGlzLl9jb2xsZWN0RGVmYXVsdHModC5fc3VwZXIpLCBzID0gMDsgcyA8IGkubGVuZ3RoOyBzKyspIC0xID09PSBlLmluZGV4T2YoaVtzXSkgJiYgZS5wdXNoKGlbc10pO1xuICAgICAgICByZXR1cm4gZTtcbiAgICAgIH0sIG4uZGVmYXVsdHMgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgICB2YXIgcyA9IHt9O1xuICAgICAgICBpZiAoMSA9PT0gdC5sZW5ndGggJiYgbi5pc09iamVjdCh0WzBdKSkgcyA9IHRbMF07ZWxzZSBmb3IgKHZhciBvID0gMDsgbyA8IGUubGVuZ3RoOyBvKyspIHNbZVtvXV0gPSB0W29dO1xuICAgICAgICByZXR1cm4gbi5pc0RlZmluZWQoaS5kZWZhdWx0cykgPyBuLmRlZmF1bHRBcmcocywgaS5kZWZhdWx0cykgOiBuLmlzT2JqZWN0KGkpID8gbi5kZWZhdWx0QXJnKHMsIGkpIDogcztcbiAgICAgIH0sIG4uZGVmYXVsdEFyZyA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgIGlmIChuLmlzT2JqZWN0KHQpICYmIG4uaXNPYmplY3QoZSkpIHtcbiAgICAgICAgICB2YXIgaSA9IHt9O1xuXG4gICAgICAgICAgZm9yICh2YXIgcyBpbiB0KSBpW3NdID0gbi5kZWZhdWx0QXJnKGVbc10sIHRbc10pO1xuXG4gICAgICAgICAgZm9yICh2YXIgbyBpbiBlKSBpW29dID0gbi5kZWZhdWx0QXJnKHRbb10sIGVbb10pO1xuXG4gICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbi5pc1VuZGVmKHQpID8gZSA6IHQ7XG4gICAgICB9LCBuLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmRlYnVnIHx8IHRoaXMudG9TdHJpbmcoKSA9PT0gbi5nbG9iYWwuVE9ORV9ERUJVR19DTEFTUykge1xuICAgICAgICAgIHZhciB0ID0gQXJyYXkuZnJvbShhcmd1bWVudHMpO1xuICAgICAgICAgIHQudW5zaGlmdCh0aGlzLnRvU3RyaW5nKCkgKyBcIjpcIiksIGNvbnNvbGUubG9nLmFwcGx5KHZvaWQgMCwgdCk7XG4gICAgICAgIH1cbiAgICAgIH0sIG4ucHJvdG90eXBlLmFzc2VydCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgIGlmICghdCkgdGhyb3cgbmV3IEVycm9yKGUpO1xuICAgICAgfSwgbi5jb25uZWN0U2VyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciB0ID0gYXJndW1lbnRzWzBdLCBlID0gMTsgZSA8IGFyZ3VtZW50cy5sZW5ndGg7IGUrKykge1xuICAgICAgICAgIHZhciBpID0gYXJndW1lbnRzW2VdO1xuICAgICAgICAgIG4uY29ubmVjdCh0LCBpKSwgdCA9IGk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbjtcbiAgICAgIH0sIG4uY29ubmVjdCA9IGZ1bmN0aW9uICh0LCBlLCBpLCBzKSB7XG4gICAgICAgIGZvciAoOyBuLmlzRGVmaW5lZChlLmlucHV0KTspIG4uaXNBcnJheShlLmlucHV0KSA/IChzID0gbi5kZWZhdWx0QXJnKHMsIDApLCBlID0gZS5pbnB1dFtzXSwgcyA9IDApIDogZS5pbnB1dCAmJiAoZSA9IGUuaW5wdXQpO1xuXG4gICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgQXVkaW9QYXJhbSA/IHQuY29ubmVjdChlLCBpKSA6IGUgaW5zdGFuY2VvZiBBdWRpb05vZGUgJiYgdC5jb25uZWN0KGUsIGksIHMpLCBuO1xuICAgICAgfSwgbi5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKHQsIGUsIGksIHMpIHtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICBmb3IgKHZhciBvID0gITE7ICFvOykgbi5pc0FycmF5KGUuaW5wdXQpID8gKG4uaXNEZWZpbmVkKHMpID8gbi5kaXNjb25uZWN0KHQsIGUuaW5wdXRbc10sIGkpIDogZS5pbnB1dC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBuLmRpc2Nvbm5lY3QodCwgZSwgaSk7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7fVxuICAgICAgICAgIH0pLCBvID0gITApIDogZS5pbnB1dCA/IGUgPSBlLmlucHV0IDogbyA9ICEwO1xuXG4gICAgICAgICAgZSBpbnN0YW5jZW9mIEF1ZGlvUGFyYW0gPyB0LmRpc2Nvbm5lY3QoZSwgaSkgOiBlIGluc3RhbmNlb2YgQXVkaW9Ob2RlICYmIHQuZGlzY29ubmVjdChlLCBpLCBzKTtcbiAgICAgICAgfSBlbHNlIHQuZGlzY29ubmVjdCgpO1xuXG4gICAgICAgIHJldHVybiBuO1xuICAgICAgfSwgbi5pc1VuZGVmID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gdDtcbiAgICAgIH0sIG4uaXNEZWZpbmVkID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuICFuLmlzVW5kZWYodCk7XG4gICAgICB9LCBuLmlzRnVuY3Rpb24gPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gXCJmdW5jdGlvblwiID09IHR5cGVvZiB0O1xuICAgICAgfSwgbi5pc051bWJlciA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBcIm51bWJlclwiID09IHR5cGVvZiB0O1xuICAgICAgfSwgbi5pc09iamVjdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBcIltvYmplY3QgT2JqZWN0XVwiID09PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkgJiYgdC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0O1xuICAgICAgfSwgbi5pc0Jvb2xlYW4gPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gXCJib29sZWFuXCIgPT0gdHlwZW9mIHQ7XG4gICAgICB9LCBuLmlzQXJyYXkgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0KTtcbiAgICAgIH0sIG4uaXNTdHJpbmcgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdDtcbiAgICAgIH0sIG4uaXNOb3RlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIG4uaXNTdHJpbmcodCkgJiYgL14oW2EtZ117MX0oPzpifCN8eHxiYik/KSgtP1swLTldKykvaS50ZXN0KHQpO1xuICAgICAgfSwgbi5ub09wID0gZnVuY3Rpb24gKCkge30sIG4ucHJvdG90eXBlLl9yZWFkT25seSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHQpKSBmb3IgKHZhciBlID0gMDsgZSA8IHQubGVuZ3RoOyBlKyspIHRoaXMuX3JlYWRPbmx5KHRbZV0pO2Vsc2UgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHQsIHtcbiAgICAgICAgICB3cml0YWJsZTogITEsXG4gICAgICAgICAgZW51bWVyYWJsZTogITBcbiAgICAgICAgfSk7XG4gICAgICB9LCBuLnByb3RvdHlwZS5fd3JpdGFibGUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0KSkgZm9yICh2YXIgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgZSsrKSB0aGlzLl93cml0YWJsZSh0W2VdKTtlbHNlIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCB0LCB7XG4gICAgICAgICAgd3JpdGFibGU6ICEwXG4gICAgICAgIH0pO1xuICAgICAgfSwgbi5TdGF0ZSA9IHtcbiAgICAgICAgU3RhcnRlZDogXCJzdGFydGVkXCIsXG4gICAgICAgIFN0b3BwZWQ6IFwic3RvcHBlZFwiLFxuICAgICAgICBQYXVzZWQ6IFwicGF1c2VkXCJcbiAgICAgIH0sIG4uZ2xvYmFsID0gbi5pc1VuZGVmKHQpID8gd2luZG93IDogdCwgbi5lcXVhbFBvd2VyU2NhbGUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IC41ICogTWF0aC5QSTtcbiAgICAgICAgcmV0dXJuIE1hdGguc2luKHQgKiBlKTtcbiAgICAgIH0sIG4uZGJUb0dhaW4gPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gTWF0aC5wb3coMTAsIHQgLyAyMCk7XG4gICAgICB9LCBuLmdhaW5Ub0RiID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubG9nKHQpIC8gTWF0aC5MTjEwICogMjA7XG4gICAgICB9LCBuLmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdygyLCB0IC8gMTIpO1xuICAgICAgfSwgbi5wcm90b3R5cGUubm93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbi5jb250ZXh0Lm5vdygpO1xuICAgICAgfSwgbi5ub3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuLmNvbnRleHQubm93KCk7XG4gICAgICB9LCBuLnByb3RvdHlwZS5pbW1lZGlhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuLmNvbnRleHQuY3VycmVudFRpbWU7XG4gICAgICB9LCBuLmltbWVkaWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG4uY29udGV4dC5jdXJyZW50VGltZTtcbiAgICAgIH0sIG4uZXh0ZW5kID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgZnVuY3Rpb24gaSgpIHt9XG5cbiAgICAgICAgbi5pc1VuZGVmKGUpICYmIChlID0gbiksIGkucHJvdG90eXBlID0gZS5wcm90b3R5cGUsIHQucHJvdG90eXBlID0gbmV3IGkoKSwgdC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB0LCB0Ll9zdXBlciA9IGU7XG4gICAgICB9LCBuLl9hdWRpb0NvbnRleHQgPSBudWxsLCBuLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbi5jb250ZXh0LnJlc3VtZSgpO1xuICAgICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sIFwiY29udGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBuLl9hdWRpb0NvbnRleHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB0LmlzQ29udGV4dCA/IG4uX2F1ZGlvQ29udGV4dCA9IHQgOiBuLl9hdWRpb0NvbnRleHQgPSBuZXcgbi5Db250ZXh0KHQpLCBuLkNvbnRleHQuZW1pdChcImluaXRcIiwgbi5fYXVkaW9Db250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSwgXCJjb250ZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIG4uY29udGV4dDtcbiAgICAgICAgfVxuICAgICAgfSksIG4uc2V0Q29udGV4dCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIG4uY29udGV4dCA9IHQ7XG4gICAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsIFwiYmxvY2tUaW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIDEyOCAvIHRoaXMuY29udGV4dC5zYW1wbGVSYXRlO1xuICAgICAgICB9XG4gICAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLCBcInNhbXBsZVRpbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gMSAvIHRoaXMuY29udGV4dC5zYW1wbGVSYXRlO1xuICAgICAgICB9XG4gICAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sIFwic3VwcG9ydGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHQgPSBuLmdsb2JhbC5oYXNPd25Qcm9wZXJ0eShcIkF1ZGlvQ29udGV4dFwiKSB8fCBuLmdsb2JhbC5oYXNPd25Qcm9wZXJ0eShcIndlYmtpdEF1ZGlvQ29udGV4dFwiKSxcbiAgICAgICAgICAgICAgZSA9IG4uZ2xvYmFsLmhhc093blByb3BlcnR5KFwiUHJvbWlzZVwiKTtcbiAgICAgICAgICByZXR1cm4gdCAmJiBlO1xuICAgICAgICB9XG4gICAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KG4sIFwiaW5pdGlhbGl6ZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gQm9vbGVhbihuLmNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICB9KSwgbi5nZXRDb250ZXh0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKG4uaW5pdGlhbGl6ZWQpIHQobi5jb250ZXh0KTtlbHNlIHtcbiAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHQobi5jb250ZXh0KSwgbi5Db250ZXh0Lm9mZihcImluaXRcIiwgZSk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIG4uQ29udGV4dC5vbihcImluaXRcIiwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgICB9LCBuLnZlcnNpb24gPSBzLmEsIGUuZGVmYXVsdCA9IG47XG4gICAgfS5jYWxsKHRoaXMsIGkoMTQ3KSk7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjApO1xuXG4gICAgaWYgKHMuZGVmYXVsdC5zdXBwb3J0ZWQpIHtcbiAgICAgIHZhciBuID0gbmV3IE9mZmxpbmVBdWRpb0NvbnRleHQoMiwgMSwgNDQxMDApLFxuICAgICAgICAgIG8gPSBuLmNyZWF0ZUdhaW4oKSxcbiAgICAgICAgICBhID0gbi5jcmVhdGVHYWluKCk7XG5cbiAgICAgIGlmIChvLmNvbm5lY3QoYSkgIT09IGEpIHtcbiAgICAgICAgdmFyIHIgPSBBdWRpb05vZGUucHJvdG90eXBlLmNvbm5lY3Q7XG5cbiAgICAgICAgQXVkaW9Ob2RlLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiByLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIGFyZ3VtZW50c1swXTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyk7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImNvbnRleHRcIl0sIHtcbiAgICAgICAgY29udGV4dDogcy5kZWZhdWx0LmNvbnRleHRcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fY29udGV4dCA9IHQuY29udGV4dDtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BdWRpb05vZGUpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsIFwiY29udGV4dFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRleHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmNyZWF0ZUluc091dHMgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgMSA9PT0gdCA/IHRoaXMuaW5wdXQgPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpIDogdCA+IDEgJiYgKHRoaXMuaW5wdXQgPSBuZXcgQXJyYXkodCkpLCAxID09PSBlID8gdGhpcy5vdXRwdXQgPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpIDogZSA+IDEgJiYgKHRoaXMub3V0cHV0ID0gbmV3IEFycmF5KGUpKTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsIFwiY2hhbm5lbENvdW50XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXQuY2hhbm5lbENvdW50O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0cHV0LmNoYW5uZWxDb3VudCA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZSwgXCJjaGFubmVsQ291bnRNb2RlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXQuY2hhbm5lbENvdW50TW9kZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dC5jaGFubmVsQ291bnRNb2RlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLCBcImNoYW5uZWxJbnRlcnByZXRhdGlvblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3V0cHV0LmNoYW5uZWxJbnRlcnByZXRhdGlvbjtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dC5jaGFubmVsSW50ZXJwcmV0YXRpb24gPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsIFwibnVtYmVyT2ZJbnB1dHNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlucHV0ID8gcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5pbnB1dCkgPyB0aGlzLmlucHV0Lmxlbmd0aCA6IDEgOiAwO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsIFwibnVtYmVyT2ZPdXRwdXRzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXQgPyBzLmRlZmF1bHQuaXNBcnJheSh0aGlzLm91dHB1dCkgPyB0aGlzLm91dHB1dC5sZW5ndGggOiAxIDogMDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5vdXRwdXQpID8gKGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAwKSwgdGhpcy5vdXRwdXRbZV0uY29ubmVjdCh0LCAwLCBpKSkgOiBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLm91dHB1dCwgdCwgZSwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5vdXRwdXQpID8gKGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAwKSwgdGhpcy5vdXRwdXRbZV0uZGlzY29ubmVjdCh0LCAwLCBpKSkgOiBzLmRlZmF1bHQuZGlzY29ubmVjdCh0aGlzLm91dHB1dCwgdCwgZSwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuY2hhaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiB0LnVuc2hpZnQodGhpcyksIHMuZGVmYXVsdC5jb25uZWN0U2VyaWVzLmFwcGx5KHZvaWQgMCwgdCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZmFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCBhcmd1bWVudHMubGVuZ3RoOyB0KyspIHRoaXMuY29ubmVjdChhcmd1bWVudHNbdF0pO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5pc0RlZmluZWQodGhpcy5pbnB1dCkgJiYgKHRoaXMuaW5wdXQgaW5zdGFuY2VvZiBBdWRpb05vZGUgJiYgdGhpcy5pbnB1dC5kaXNjb25uZWN0KCksIHRoaXMuaW5wdXQgPSBudWxsKSwgcy5kZWZhdWx0LmlzRGVmaW5lZCh0aGlzLm91dHB1dCkgJiYgKHRoaXMub3V0cHV0IGluc3RhbmNlb2YgQXVkaW9Ob2RlICYmIHRoaXMub3V0cHV0LmRpc2Nvbm5lY3QoKSwgdGhpcy5vdXRwdXQgPSBudWxsKSwgdGhpcy5fY29udGV4dCA9IG51bGwsIHRoaXM7XG4gICAgfTtcbiAgICBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQXVkaW9Ob2RlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDQpLCBpKDE0KSwgaSgzMCksIGkoNDQpLCBpKDIwKSwgaSgzKTtcblxuICAgIGlmIChzLmRlZmF1bHQuc3VwcG9ydGVkICYmICFzLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlQ29uc3RhbnRTb3VyY2UpIHtcbiAgICAgIHZhciBuID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gdDtcblxuICAgICAgICBmb3IgKHZhciBlID0gdC5jcmVhdGVCdWZmZXIoMSwgMTI4LCB0LnNhbXBsZVJhdGUpLCBpID0gZS5nZXRDaGFubmVsRGF0YSgwKSwgcyA9IDA7IHMgPCBpLmxlbmd0aDsgcysrKSBpW3NdID0gMTtcblxuICAgICAgICB0aGlzLl9idWZmZXJTb3VyY2UgPSB0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpLCB0aGlzLl9idWZmZXJTb3VyY2UuY2hhbm5lbENvdW50ID0gMSwgdGhpcy5fYnVmZmVyU291cmNlLmNoYW5uZWxDb3VudE1vZGUgPSBcImV4cGxpY2l0XCIsIHRoaXMuX2J1ZmZlclNvdXJjZS5idWZmZXIgPSBlLCB0aGlzLl9idWZmZXJTb3VyY2UubG9vcCA9ICEwO1xuICAgICAgICB2YXIgbiA9IHRoaXMuX291dHB1dCA9IHQuY3JlYXRlR2FpbigpO1xuICAgICAgICB0aGlzLm9mZnNldCA9IG4uZ2FpbiwgdGhpcy5fYnVmZmVyU291cmNlLmNvbm5lY3Qobik7XG4gICAgICB9O1xuXG4gICAgICBuLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXJTb3VyY2Uuc3RhcnQodCksIHRoaXM7XG4gICAgICB9LCBuLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlclNvdXJjZS5zdG9wKHQpLCB0aGlzO1xuICAgICAgfSwgbi5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX291dHB1dC5jb25uZWN0LmFwcGx5KHRoaXMuX291dHB1dCwgYXJndW1lbnRzKSwgdGhpcztcbiAgICAgIH0sIG4ucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vdXRwdXQuZGlzY29ubmVjdC5hcHBseSh0aGlzLl9vdXRwdXQsIGFyZ3VtZW50cyksIHRoaXM7XG4gICAgICB9LCBBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZUNvbnN0YW50U291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG4odGhpcyk7XG4gICAgICB9LCBzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlQ29uc3RhbnRTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgbih0aGlzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcy5kZWZhdWx0LlNpZ25hbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1widmFsdWVcIiwgXCJ1bml0c1wiXSwgcy5kZWZhdWx0LlNpZ25hbCk7XG4gICAgICBzLmRlZmF1bHQuUGFyYW0uY2FsbCh0aGlzLCB0KSwgdGhpcy5fY29uc3RhbnRTb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlQ29uc3RhbnRTb3VyY2UoKSwgdGhpcy5fY29uc3RhbnRTb3VyY2Uuc3RhcnQoMCksIHRoaXMuX3BhcmFtID0gdGhpcy5fY29uc3RhbnRTb3VyY2Uub2Zmc2V0LCB0aGlzLnZhbHVlID0gdC52YWx1ZSwgdGhpcy5vdXRwdXQgPSB0aGlzLl9jb25zdGFudFNvdXJjZSwgdGhpcy5pbnB1dCA9IHRoaXMuX3BhcmFtID0gdGhpcy5vdXRwdXQub2Zmc2V0O1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNpZ25hbCwgcy5kZWZhdWx0LlBhcmFtKSwgcy5kZWZhdWx0LlNpZ25hbC5kZWZhdWx0cyA9IHtcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgdW5pdHM6IHMuZGVmYXVsdC5UeXBlLkRlZmF1bHQsXG4gICAgICBjb252ZXJ0OiAhMFxuICAgIH0sIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmNvbm5lY3QgPSBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuY29ubmVjdCwgcy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNjb25uZWN0LCBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5nZXRWYWx1ZUF0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fcGFyYW0uZ2V0VmFsdWVBdFRpbWUgPyB0aGlzLl9wYXJhbS5nZXRWYWx1ZUF0VGltZSh0KSA6IHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuZ2V0VmFsdWVBdFRpbWUuY2FsbCh0aGlzLCB0KTtcbiAgICB9LCBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9jb25zdGFudFNvdXJjZS5zdG9wKCksIHRoaXMuX2NvbnN0YW50U291cmNlLmRpc2Nvbm5lY3QoKSwgdGhpcy5fY29uc3RhbnRTb3VyY2UgPSBudWxsLCB0aGlzO1xuICAgIH07XG4gICAgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlNpZ25hbDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxNCksIGkoNCksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkdhaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImdhaW5cIiwgXCJ1bml0c1wiXSwgcy5kZWZhdWx0LkdhaW4pO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsIHQpLCB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSB0aGlzLl9nYWluTm9kZSA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCksIHRoaXMuZ2FpbiA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fZ2Fpbk5vZGUuZ2FpbixcbiAgICAgICAgdW5pdHM6IHQudW5pdHMsXG4gICAgICAgIHZhbHVlOiB0LmdhaW4sXG4gICAgICAgIGNvbnZlcnQ6IHQuY29udmVydFxuICAgICAgfSksIHRoaXMuX3JlYWRPbmx5KFwiZ2FpblwiKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5HYWluLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkdhaW4uZGVmYXVsdHMgPSB7XG4gICAgICBnYWluOiAxLFxuICAgICAgY29udmVydDogITBcbiAgICB9LCBzLmRlZmF1bHQuR2Fpbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZ2Fpbk5vZGUuZGlzY29ubmVjdCgpLCB0aGlzLl9nYWluTm9kZSA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFwiZ2FpblwiKSwgdGhpcy5nYWluLmRpc3Bvc2UoKSwgdGhpcy5nYWluID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuR2FpbjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2MyksIGkoNDYpLCBpKDQ1KSwgaSgyMCk7XG4gICAgcy5kZWZhdWx0LlR5cGUgPSB7XG4gICAgICBEZWZhdWx0OiBcIm51bWJlclwiLFxuICAgICAgVGltZTogXCJ0aW1lXCIsXG4gICAgICBGcmVxdWVuY3k6IFwiZnJlcXVlbmN5XCIsXG4gICAgICBUcmFuc3BvcnRUaW1lOiBcInRyYW5zcG9ydFRpbWVcIixcbiAgICAgIFRpY2tzOiBcInRpY2tzXCIsXG4gICAgICBOb3JtYWxSYW5nZTogXCJub3JtYWxSYW5nZVwiLFxuICAgICAgQXVkaW9SYW5nZTogXCJhdWRpb1JhbmdlXCIsXG4gICAgICBEZWNpYmVsczogXCJkYlwiLFxuICAgICAgSW50ZXJ2YWw6IFwiaW50ZXJ2YWxcIixcbiAgICAgIEJQTTogXCJicG1cIixcbiAgICAgIFBvc2l0aXZlOiBcInBvc2l0aXZlXCIsXG4gICAgICBHYWluOiBcImdhaW5cIixcbiAgICAgIENlbnRzOiBcImNlbnRzXCIsXG4gICAgICBEZWdyZWVzOiBcImRlZ3JlZXNcIixcbiAgICAgIE1JREk6IFwibWlkaVwiLFxuICAgICAgQmFyc0JlYXRzU2l4dGVlbnRoczogXCJiYXJzQmVhdHNTaXh0ZWVudGhzXCIsXG4gICAgICBTYW1wbGVzOiBcInNhbXBsZXNcIixcbiAgICAgIEhlcnR6OiBcImhlcnR6XCIsXG4gICAgICBOb3RlOiBcIm5vdGVcIixcbiAgICAgIE1pbGxpc2Vjb25kczogXCJtaWxsaXNlY29uZHNcIixcbiAgICAgIFNlY29uZHM6IFwic2Vjb25kc1wiLFxuICAgICAgTm90YXRpb246IFwibm90YXRpb25cIlxuICAgIH0sIHMuZGVmYXVsdC5wcm90b3R5cGUudG9TZWNvbmRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuaXNOdW1iZXIodCkgPyB0IDogcy5kZWZhdWx0LmlzVW5kZWYodCkgPyB0aGlzLm5vdygpIDogcy5kZWZhdWx0LmlzU3RyaW5nKHQpIHx8IHMuZGVmYXVsdC5pc09iamVjdCh0KSA/IG5ldyBzLmRlZmF1bHQuVGltZSh0KS50b1NlY29uZHMoKSA6IHQgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVGltZUJhc2UgPyB0LnRvU2Vjb25kcygpIDogdm9pZCAwO1xuICAgIH0sIHMuZGVmYXVsdC5wcm90b3R5cGUudG9GcmVxdWVuY3kgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5pc051bWJlcih0KSA/IHQgOiBzLmRlZmF1bHQuaXNTdHJpbmcodCkgfHwgcy5kZWZhdWx0LmlzVW5kZWYodCkgfHwgcy5kZWZhdWx0LmlzT2JqZWN0KHQpID8gbmV3IHMuZGVmYXVsdC5GcmVxdWVuY3kodCkudmFsdWVPZigpIDogdCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5UaW1lQmFzZSA/IHQudG9GcmVxdWVuY3koKSA6IHZvaWQgMDtcbiAgICB9LCBzLmRlZmF1bHQucHJvdG90eXBlLnRvVGlja3MgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5pc051bWJlcih0KSB8fCBzLmRlZmF1bHQuaXNTdHJpbmcodCkgfHwgcy5kZWZhdWx0LmlzT2JqZWN0KHQpID8gbmV3IHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKHQpLnRvVGlja3MoKSA6IHMuZGVmYXVsdC5pc1VuZGVmKHQpID8gcy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrcyA6IHQgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVGltZUJhc2UgPyB0LnRvVGlja3MoKSA6IHZvaWQgMDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMTQpLCBpKDMpLCBpKDMwKTtcbiAgICBzLmRlZmF1bHQuTXVsdGlwbHkgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcy5kZWZhdWx0LlNpZ25hbC5jYWxsKHRoaXMpLCB0aGlzLmNyZWF0ZUluc091dHMoMiwgMCksIHRoaXMuX211bHQgPSB0aGlzLmlucHV0WzBdID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5fcGFyYW0gPSB0aGlzLmlucHV0WzFdID0gdGhpcy5vdXRwdXQuZ2FpbiwgdGhpcy52YWx1ZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIDApO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk11bHRpcGx5LCBzLmRlZmF1bHQuU2lnbmFsKSwgcy5kZWZhdWx0Lk11bHRpcGx5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fbXVsdC5kaXNwb3NlKCksIHRoaXMuX211bHQgPSBudWxsLCB0aGlzLl9wYXJhbSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk11bHRpcGx5O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDE2KSwgaSgyNyksIGkoNDApLCBpKDQpLCBpKDM0KSwgaSgyKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuU291cmNlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuU291cmNlLmRlZmF1bHRzKSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl92b2x1bWUgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuVm9sdW1lKHQudm9sdW1lKSwgdGhpcy52b2x1bWUgPSB0aGlzLl92b2x1bWUudm9sdW1lLCB0aGlzLl9yZWFkT25seShcInZvbHVtZVwiKSwgdGhpcy5fc3RhdGUgPSBuZXcgcy5kZWZhdWx0LlRpbWVsaW5lU3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQpLCB0aGlzLl9zdGF0ZS5tZW1vcnkgPSAxMDAsIHRoaXMuX3N5bmNlZCA9ICExLCB0aGlzLl9zY2hlZHVsZWQgPSBbXSwgdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50ID0gMiwgdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50TW9kZSA9IFwiZXhwbGljaXRcIiwgdGhpcy5tdXRlID0gdC5tdXRlO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNvdXJjZSwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5Tb3VyY2UuZGVmYXVsdHMgPSB7XG4gICAgICB2b2x1bWU6IDAsXG4gICAgICBtdXRlOiAhMVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZSwgXCJzdGF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N5bmNlZCA/IHMuZGVmYXVsdC5UcmFuc3BvcnQuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkID8gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUocy5kZWZhdWx0LlRyYW5zcG9ydC5zZWNvbmRzKSA6IHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkIDogdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5ub3coKSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZSwgXCJtdXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdm9sdW1lLm11dGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl92b2x1bWUubXV0ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLl9zdGFydCA9IHMuZGVmYXVsdC5ub09wLCBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5yZXN0YXJ0ID0gcy5kZWZhdWx0Lm5vT3AsIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLl9zdG9wID0gcy5kZWZhdWx0Lm5vT3AsIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIGlmIChzLmRlZmF1bHQuaXNVbmRlZih0KSAmJiB0aGlzLl9zeW5jZWQgPyB0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydC5zZWNvbmRzIDogKHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdCA9IE1hdGgubWF4KHQsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSkpLCB0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQpIHRoaXMuX3N0YXRlLmNhbmNlbCh0KSwgdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQsIHQpLCB0aGlzLnJlc3RhcnQodCwgZSwgaSk7ZWxzZSBpZiAodGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQsIHQpLCB0aGlzLl9zeW5jZWQpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLl9zdGF0ZS5nZXQodCk7XG5cbiAgICAgICAgbi5vZmZzZXQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAwKSwgbi5kdXJhdGlvbiA9IGk7XG4gICAgICAgIHZhciBvID0gcy5kZWZhdWx0LlRyYW5zcG9ydC5zY2hlZHVsZShmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHRoaXMuX3N0YXJ0KHQsIGUsIGkpO1xuICAgICAgICB9LmJpbmQodGhpcyksIHQpO1xuICAgICAgICB0aGlzLl9zY2hlZHVsZWQucHVzaChvKSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5zdGF0ZSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgdGhpcy5fc3luY2VkU3RhcnQodGhpcy5ub3coKSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5zZWNvbmRzKTtcbiAgICAgIH0gZWxzZSB0aGlzLl9zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAocy5kZWZhdWx0LmlzVW5kZWYodCkgJiYgdGhpcy5fc3luY2VkID8gdCA9IHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyA6ICh0ID0gdGhpcy50b1NlY29uZHModCksIHQgPSBNYXRoLm1heCh0LCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpKSwgdGhpcy5fc3luY2VkKSB7XG4gICAgICAgIHZhciBlID0gcy5kZWZhdWx0LlRyYW5zcG9ydC5zY2hlZHVsZSh0aGlzLl9zdG9wLmJpbmQodGhpcyksIHQpO1xuXG4gICAgICAgIHRoaXMuX3NjaGVkdWxlZC5wdXNoKGUpO1xuICAgICAgfSBlbHNlIHRoaXMuX3N0b3AuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlLmNhbmNlbCh0KSwgdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsIHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLnN5bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3luY2VkID0gITAsIHRoaXMuX3N5bmNlZFN0YXJ0ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgaWYgKGUgPiAwKSB7XG4gICAgICAgICAgdmFyIGkgPSB0aGlzLl9zdGF0ZS5nZXQoZSk7XG5cbiAgICAgICAgICBpZiAoaSAmJiBpLnN0YXRlID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiBpLnRpbWUgIT09IGUpIHtcbiAgICAgICAgICAgIHZhciBuLFxuICAgICAgICAgICAgICAgIG8gPSBlIC0gdGhpcy50b1NlY29uZHMoaS50aW1lKTtcbiAgICAgICAgICAgIGkuZHVyYXRpb24gJiYgKG4gPSB0aGlzLnRvU2Vjb25kcyhpLmR1cmF0aW9uKSAtIG8pLCB0aGlzLl9zdGFydCh0LCB0aGlzLnRvU2Vjb25kcyhpLm9mZnNldCkgKyBvLCBuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5fc3luY2VkU3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gcy5kZWZhdWx0LlRyYW5zcG9ydC5nZXRTZWNvbmRzQXRUaW1lKE1hdGgubWF4KHQgLSB0aGlzLnNhbXBsZVRpbWUsIDApKTtcbiAgICAgICAgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSkgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmIHRoaXMuX3N0b3AodCk7XG4gICAgICB9LmJpbmQodGhpcyksIHMuZGVmYXVsdC5UcmFuc3BvcnQub24oXCJzdGFydCBsb29wU3RhcnRcIiwgdGhpcy5fc3luY2VkU3RhcnQpLCBzLmRlZmF1bHQuVHJhbnNwb3J0Lm9uKFwic3RvcCBwYXVzZSBsb29wRW5kXCIsIHRoaXMuX3N5bmNlZFN0b3ApLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLnVuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N5bmNlZCAmJiAocy5kZWZhdWx0LlRyYW5zcG9ydC5vZmYoXCJzdG9wIHBhdXNlIGxvb3BFbmRcIiwgdGhpcy5fc3luY2VkU3RvcCksIHMuZGVmYXVsdC5UcmFuc3BvcnQub2ZmKFwic3RhcnQgbG9vcFN0YXJ0XCIsIHRoaXMuX3N5bmNlZFN0YXJ0KSksIHRoaXMuX3N5bmNlZCA9ICExO1xuXG4gICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMuX3NjaGVkdWxlZC5sZW5ndGg7IHQrKykge1xuICAgICAgICB2YXIgZSA9IHRoaXMuX3NjaGVkdWxlZFt0XTtcbiAgICAgICAgcy5kZWZhdWx0LlRyYW5zcG9ydC5jbGVhcihlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3NjaGVkdWxlZCA9IFtdLCB0aGlzLl9zdGF0ZS5jYW5jZWwoMCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy51bnN5bmMoKSwgdGhpcy5fc2NoZWR1bGVkID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoXCJ2b2x1bWVcIiksIHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksIHRoaXMuX3ZvbHVtZSA9IG51bGwsIHRoaXMudm9sdW1lID0gbnVsbCwgdGhpcy5fc3RhdGUuZGlzcG9zZSgpLCB0aGlzLl9zdGF0ZSA9IG51bGw7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlNvdXJjZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgzMCksIGkoNDQpO1xuXG4gICAgaWYgKHMuZGVmYXVsdC5zdXBwb3J0ZWQgJiYgIXMuZGVmYXVsdC5nbG9iYWwuQXVkaW9Db250ZXh0LnByb3RvdHlwZS5fbmF0aXZlX2NyZWF0ZVdhdmVTaGFwZXIpIHtcbiAgICAgIHZhciBuID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICBpZiAobi5pbmNsdWRlcyhcInNhZmFyaVwiKSAmJiAhbi5pbmNsdWRlcyhcImNocm9tZVwiKSkge1xuICAgICAgICB2YXIgbyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgZm9yICh2YXIgZSBpbiB0aGlzLl9pbnRlcm5hbE5vZGUgPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSB0Ll9uYXRpdmVfY3JlYXRlV2F2ZVNoYXBlcigpLCB0aGlzLl9jdXJ2ZSA9IG51bGwsIHRoaXMuX2ludGVybmFsTm9kZSkgdGhpcy5fZGVmaW5lUHJvcGVydHkodGhpcy5faW50ZXJuYWxOb2RlLCBlKTtcbiAgICAgICAgfTtcblxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoby5wcm90b3R5cGUsIFwiY3VydmVcIiwge1xuICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnZlO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgdGhpcy5fY3VydmUgPSB0O1xuICAgICAgICAgICAgdmFyIGUgPSBuZXcgRmxvYXQzMkFycmF5KHQubGVuZ3RoICsgMSk7XG4gICAgICAgICAgICBlLnNldCh0LCAxKSwgZVswXSA9IHRbMF0sIHRoaXMuX2ludGVybmFsTm9kZS5jdXJ2ZSA9IGU7XG4gICAgICAgICAgfVxuICAgICAgICB9KSwgby5wcm90b3R5cGUuX2RlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgICBzLmRlZmF1bHQuaXNVbmRlZih0aGlzW2VdKSAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgZSwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHRbZV0gPyB0W2VdLmJpbmQodCkgOiB0W2VdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgICAgdFtlXSA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIHMuZGVmYXVsdC5nbG9iYWwuQXVkaW9Db250ZXh0LnByb3RvdHlwZS5fbmF0aXZlX2NyZWF0ZVdhdmVTaGFwZXIgPSBzLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlV2F2ZVNoYXBlciwgcy5kZWZhdWx0Lmdsb2JhbC5BdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZVdhdmVTaGFwZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBvKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIHMuZGVmYXVsdC5XYXZlU2hhcGVyID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksIHRoaXMuX3NoYXBlciA9IHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IHRoaXMuY29udGV4dC5jcmVhdGVXYXZlU2hhcGVyKCksIHRoaXMuX2N1cnZlID0gbnVsbCwgQXJyYXkuaXNBcnJheSh0KSA/IHRoaXMuY3VydmUgPSB0IDogaXNGaW5pdGUodCkgfHwgcy5kZWZhdWx0LmlzVW5kZWYodCkgPyB0aGlzLl9jdXJ2ZSA9IG5ldyBGbG9hdDMyQXJyYXkocy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgMTAyNCkpIDogcy5kZWZhdWx0LmlzRnVuY3Rpb24odCkgJiYgKHRoaXMuX2N1cnZlID0gbmV3IEZsb2F0MzJBcnJheShzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAxMDI0KSksIHRoaXMuc2V0TWFwKHQpKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5XYXZlU2hhcGVyLCBzLmRlZmF1bHQuU2lnbmFsQmFzZSksIHMuZGVmYXVsdC5XYXZlU2hhcGVyLnByb3RvdHlwZS5zZXRNYXAgPSBmdW5jdGlvbiAodCkge1xuICAgICAgZm9yICh2YXIgZSA9IG5ldyBBcnJheSh0aGlzLl9jdXJ2ZS5sZW5ndGgpLCBpID0gMCwgcyA9IHRoaXMuX2N1cnZlLmxlbmd0aDsgaSA8IHM7IGkrKykge1xuICAgICAgICB2YXIgbiA9IGkgLyAocyAtIDEpICogMiAtIDE7XG4gICAgICAgIGVbaV0gPSB0KG4sIGkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5jdXJ2ZSA9IGUsIHRoaXM7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5XYXZlU2hhcGVyLnByb3RvdHlwZSwgXCJjdXJ2ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NoYXBlci5jdXJ2ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2N1cnZlID0gbmV3IEZsb2F0MzJBcnJheSh0KSwgdGhpcy5fc2hhcGVyLmN1cnZlID0gdGhpcy5fY3VydmU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuV2F2ZVNoYXBlci5wcm90b3R5cGUsIFwib3ZlcnNhbXBsZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NoYXBlci5vdmVyc2FtcGxlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKCFbXCJub25lXCIsIFwiMnhcIiwgXCI0eFwiXS5pbmNsdWRlcyh0KSkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJUb25lLldhdmVTaGFwZXI6IG92ZXJzYW1wbGluZyBtdXN0IGJlIGVpdGhlciAnbm9uZScsICcyeCcsIG9yICc0eCdcIik7XG4gICAgICAgIHRoaXMuX3NoYXBlci5vdmVyc2FtcGxlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LldhdmVTaGFwZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fc2hhcGVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fc2hhcGVyID0gbnVsbCwgdGhpcy5fY3VydmUgPSBudWxsLCB0aGlzO1xuICAgIH07XG4gICAgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LldhdmVTaGFwZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjMpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5FZmZlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcIndldFwiXSwgcy5kZWZhdWx0LkVmZmVjdCk7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuY3JlYXRlSW5zT3V0cygxLCAxKSwgdGhpcy5fZHJ5V2V0ID0gbmV3IHMuZGVmYXVsdC5Dcm9zc0ZhZGUodC53ZXQpLCB0aGlzLndldCA9IHRoaXMuX2RyeVdldC5mYWRlLCB0aGlzLmVmZmVjdFNlbmQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5lZmZlY3RSZXR1cm4gPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgcy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCwgdGhpcy5fZHJ5V2V0LmEpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLmVmZmVjdFNlbmQpLCB0aGlzLmVmZmVjdFJldHVybi5jb25uZWN0KHRoaXMuX2RyeVdldC5iKSwgdGhpcy5fZHJ5V2V0LmNvbm5lY3QodGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJ3ZXRcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkVmZmVjdCwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5FZmZlY3QuZGVmYXVsdHMgPSB7XG4gICAgICB3ZXQ6IDFcbiAgICB9LCBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5jb25uZWN0RWZmZWN0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLmVmZmVjdFNlbmQuY2hhaW4odCwgdGhpcy5lZmZlY3RSZXR1cm4pLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9kcnlXZXQuZGlzcG9zZSgpLCB0aGlzLl9kcnlXZXQgPSBudWxsLCB0aGlzLmVmZmVjdFNlbmQuZGlzcG9zZSgpLCB0aGlzLmVmZmVjdFNlbmQgPSBudWxsLCB0aGlzLmVmZmVjdFJldHVybi5kaXNwb3NlKCksIHRoaXMuZWZmZWN0UmV0dXJuID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoW1wid2V0XCJdKSwgdGhpcy53ZXQgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5FZmZlY3Q7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMiksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCIsIFwidHlwZVwiLCBcInJvbGxvZmZcIl0sIHMuZGVmYXVsdC5GaWx0ZXIpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLmNyZWF0ZUluc091dHMoMSwgMSksIHRoaXMuX2ZpbHRlcnMgPSBbXSwgdGhpcy5mcmVxdWVuY3kgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZyZXF1ZW5jeSwgcy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSwgdGhpcy5kZXR1bmUgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCgwLCBzLmRlZmF1bHQuVHlwZS5DZW50cyksIHRoaXMuZ2FpbiA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHtcbiAgICAgICAgdmFsdWU6IHQuZ2FpbixcbiAgICAgICAgY29udmVydDogITAsXG4gICAgICAgIHR5cGU6IHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzXG4gICAgICB9KSwgdGhpcy5RID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5RKSwgdGhpcy5fdHlwZSA9IHQudHlwZSwgdGhpcy5fcm9sbG9mZiA9IHQucm9sbG9mZiwgdGhpcy5yb2xsb2ZmID0gdC5yb2xsb2ZmLCB0aGlzLl9yZWFkT25seShbXCJkZXR1bmVcIiwgXCJmcmVxdWVuY3lcIiwgXCJnYWluXCIsIFwiUVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRmlsdGVyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkZpbHRlci5kZWZhdWx0cyA9IHtcbiAgICAgIHR5cGU6IFwibG93cGFzc1wiLFxuICAgICAgZnJlcXVlbmN5OiAzNTAsXG4gICAgICByb2xsb2ZmOiAtMTIsXG4gICAgICBROiAxLFxuICAgICAgZ2FpbjogMFxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmlsdGVyLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmICgtMSA9PT0gW1wibG93cGFzc1wiLCBcImhpZ2hwYXNzXCIsIFwiYmFuZHBhc3NcIiwgXCJsb3dzaGVsZlwiLCBcImhpZ2hzaGVsZlwiLCBcIm5vdGNoXCIsIFwiYWxscGFzc1wiLCBcInBlYWtpbmdcIl0uaW5kZXhPZih0KSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRvbmUuRmlsdGVyOiBpbnZhbGlkIHR5cGUgXCIgKyB0KTtcbiAgICAgICAgdGhpcy5fdHlwZSA9IHQ7XG5cbiAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLl9maWx0ZXJzLmxlbmd0aDsgZSsrKSB0aGlzLl9maWx0ZXJzW2VdLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZpbHRlci5wcm90b3R5cGUsIFwicm9sbG9mZlwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JvbGxvZmY7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0ID0gcGFyc2VJbnQodCwgMTApO1xuICAgICAgICB2YXIgZSA9IFstMTIsIC0yNCwgLTQ4LCAtOTZdLmluZGV4T2YodCk7XG4gICAgICAgIGlmICgtMSA9PT0gZSkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJUb25lLkZpbHRlcjogcm9sbG9mZiBjYW4gb25seSBiZSAtMTIsIC0yNCwgLTQ4IG9yIC05NlwiKTtcbiAgICAgICAgZSArPSAxLCB0aGlzLl9yb2xsb2ZmID0gdCwgdGhpcy5pbnB1dC5kaXNjb25uZWN0KCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9maWx0ZXJzLmxlbmd0aDsgaSsrKSB0aGlzLl9maWx0ZXJzW2ldLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZmlsdGVyc1tpXSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fZmlsdGVycyA9IG5ldyBBcnJheShlKTtcblxuICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGU7IG4rKykge1xuICAgICAgICAgIHZhciBvID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgICAgICAgIG8udHlwZSA9IHRoaXMuX3R5cGUsIHRoaXMuZnJlcXVlbmN5LmNvbm5lY3Qoby5mcmVxdWVuY3kpLCB0aGlzLmRldHVuZS5jb25uZWN0KG8uZGV0dW5lKSwgdGhpcy5RLmNvbm5lY3Qoby5RKSwgdGhpcy5nYWluLmNvbm5lY3Qoby5nYWluKSwgdGhpcy5fZmlsdGVyc1tuXSA9IG87XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYSA9IFt0aGlzLmlucHV0XS5jb25jYXQodGhpcy5fZmlsdGVycykuY29uY2F0KFt0aGlzLm91dHB1dF0pO1xuICAgICAgICBzLmRlZmF1bHQuY29ubmVjdFNlcmllcy5hcHBseShzLmRlZmF1bHQsIGEpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRmlsdGVyLnByb3RvdHlwZS5nZXRGcmVxdWVuY3lSZXNwb25zZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgMTI4KTtcblxuICAgICAgZm9yICh2YXIgZSA9IG5ldyBGbG9hdDMyQXJyYXkodCkubWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9KSwgaSA9IG5ldyBGbG9hdDMyQXJyYXkodCksIG4gPSAwOyBuIDwgdDsgbisrKSB7XG4gICAgICAgIHZhciBvID0gMTk5ODAgKiBNYXRoLnBvdyhuIC8gdCwgMikgKyAyMDtcbiAgICAgICAgaVtuXSA9IG87XG4gICAgICB9XG5cbiAgICAgIHZhciBhID0gbmV3IEZsb2F0MzJBcnJheSh0KSxcbiAgICAgICAgICByID0gbmV3IEZsb2F0MzJBcnJheSh0KTtcbiAgICAgIHJldHVybiB0aGlzLl9maWx0ZXJzLmZvckVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtcbiAgICAgICAgdC50eXBlID0gdGhpcy5fdHlwZSwgdC5RLnZhbHVlID0gdGhpcy5RLnZhbHVlLCB0LmZyZXF1ZW5jeS52YWx1ZSA9IHRoaXMuZnJlcXVlbmN5LnZhbHVlLCB0LmdhaW4udmFsdWUgPSB0aGlzLmdhaW4udmFsdWUsIHQuZ2V0RnJlcXVlbmN5UmVzcG9uc2UoaSwgYSwgciksIGEuZm9yRWFjaChmdW5jdGlvbiAodCwgaSkge1xuICAgICAgICAgIGVbaV0gKj0gdDtcbiAgICAgICAgfSk7XG4gICAgICB9LmJpbmQodGhpcykpLCBlO1xuICAgIH0sIHMuZGVmYXVsdC5GaWx0ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG5cbiAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgdGhpcy5fZmlsdGVycy5sZW5ndGg7IHQrKykgdGhpcy5fZmlsdGVyc1t0XS5kaXNjb25uZWN0KCksIHRoaXMuX2ZpbHRlcnNbdF0gPSBudWxsO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZmlsdGVycyA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcImRldHVuZVwiLCBcImZyZXF1ZW5jeVwiLCBcImdhaW5cIiwgXCJRXCJdKSwgdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLCB0aGlzLlEuZGlzcG9zZSgpLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuUSA9IG51bGwsIHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSwgdGhpcy5kZXR1bmUgPSBudWxsLCB0aGlzLmdhaW4uZGlzcG9zZSgpLCB0aGlzLmdhaW4gPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5GaWx0ZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMSk7XG4gICAgcy5kZWZhdWx0Lk1lcmdlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCAyKSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLmNyZWF0ZUluc091dHModCwgMCksIHRoaXMuX21lcmdlciA9IHRoaXMub3V0cHV0ID0gdGhpcy5jb250ZXh0LmNyZWF0ZUNoYW5uZWxNZXJnZXIodCk7XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdDsgZSsrKSB0aGlzLmlucHV0W2VdID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuaW5wdXRbZV0uY29ubmVjdCh0aGlzLl9tZXJnZXIsIDAsIGUpLCB0aGlzLmlucHV0W2VdLmNoYW5uZWxDb3VudCA9IDEsIHRoaXMuaW5wdXRbZV0uY2hhbm5lbENvdW50TW9kZSA9IFwiZXhwbGljaXRcIjtcblxuICAgICAgdGhpcy5sZWZ0ID0gdGhpcy5pbnB1dFswXSwgdGhpcy5yaWdodCA9IHRoaXMuaW5wdXRbMV07XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWVyZ2UsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuTWVyZ2UucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnB1dC5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuZGlzcG9zZSgpO1xuICAgICAgfSksIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5sZWZ0ID0gbnVsbCwgdGhpcy5yaWdodCA9IG51bGwsIHRoaXMuX21lcmdlci5kaXNjb25uZWN0KCksIHRoaXMuX21lcmdlciA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk1lcmdlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDM1KSwgaSg0KTtcbiAgICBzLmRlZmF1bHQuc3VwcG9ydGVkICYmIChBdWRpb0J1ZmZlci5wcm90b3R5cGUuY29weVRvQ2hhbm5lbCB8fCAoQXVkaW9CdWZmZXIucHJvdG90eXBlLmNvcHlUb0NoYW5uZWwgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgdmFyIHMgPSB0aGlzLmdldENoYW5uZWxEYXRhKGUpO1xuICAgICAgaSA9IGkgfHwgMDtcblxuICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBzLmxlbmd0aDsgbisrKSBzW24gKyBpXSA9IHRbbl07XG4gICAgfSwgQXVkaW9CdWZmZXIucHJvdG90eXBlLmNvcHlGcm9tQ2hhbm5lbCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuZ2V0Q2hhbm5lbERhdGEoZSk7XG4gICAgICBpID0gaSB8fCAwO1xuXG4gICAgICBmb3IgKHZhciBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIHRbbl0gPSBzW24gKyBpXTtcbiAgICB9KSksIHMuZGVmYXVsdC5CdWZmZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInVybFwiLCBcIm9ubG9hZFwiLCBcIm9uZXJyb3JcIl0sIHMuZGVmYXVsdC5CdWZmZXIpO1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMuX2J1ZmZlciA9IG51bGwsIHRoaXMuX3JldmVyc2VkID0gdC5yZXZlcnNlLCB0aGlzLl94aHIgPSBudWxsLCB0aGlzLm9ubG9hZCA9IHMuZGVmYXVsdC5ub09wLCB0LnVybCBpbnN0YW5jZW9mIEF1ZGlvQnVmZmVyIHx8IHQudXJsIGluc3RhbmNlb2Ygcy5kZWZhdWx0LkJ1ZmZlciA/ICh0aGlzLnNldCh0LnVybCksIHRoaXMubG9hZGVkIHx8ICh0aGlzLm9ubG9hZCA9IHQub25sb2FkKSkgOiBzLmRlZmF1bHQuaXNTdHJpbmcodC51cmwpICYmIHRoaXMubG9hZCh0LnVybCkudGhlbih0Lm9ubG9hZCkuY2F0Y2godC5vbmVycm9yKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5CdWZmZXIpLCBzLmRlZmF1bHQuQnVmZmVyLmRlZmF1bHRzID0ge1xuICAgICAgdXJsOiB2b2lkIDAsXG4gICAgICByZXZlcnNlOiAhMSxcbiAgICAgIG9ubG9hZDogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBvbmVycm9yOiBzLmRlZmF1bHQubm9PcFxuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5CdWZmZXIgPyB0LmxvYWRlZCA/IHRoaXMuX2J1ZmZlciA9IHQuZ2V0KCkgOiB0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXQodCksIHRoaXMub25sb2FkKHRoaXMpO1xuICAgICAgfS5iaW5kKHRoaXMpIDogdGhpcy5fYnVmZmVyID0gdCwgdGhpcy5fcmV2ZXJzZWQgJiYgdGhpcy5fcmV2ZXJzZSgpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9idWZmZXI7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKG4sIG8pIHtcbiAgICAgICAgdGhpcy5feGhyID0gcy5kZWZhdWx0LkJ1ZmZlci5sb2FkKHQsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgdGhpcy5feGhyID0gbnVsbCwgdGhpcy5zZXQodCksIG4odGhpcyksIHRoaXMub25sb2FkKHRoaXMpLCBlICYmIGUodGhpcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB0aGlzLl94aHIgPSBudWxsLCBvKHQpLCBpICYmIGkodCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2J1ZmZlciA9IG51bGwsIHRoaXMuX3hociAmJiAocy5kZWZhdWx0LkJ1ZmZlci5fcmVtb3ZlRnJvbURvd25sb2FkUXVldWUodGhpcy5feGhyKSwgdGhpcy5feGhyLmFib3J0KCksIHRoaXMuX3hociA9IG51bGwpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZSwgXCJsb2FkZWRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCA+IDA7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZSwgXCJkdXJhdGlvblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlciA/IHRoaXMuX2J1ZmZlci5kdXJhdGlvbiA6IDA7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXIgPyB0aGlzLl9idWZmZXIubGVuZ3RoIDogMDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLCBcIm51bWJlck9mQ2hhbm5lbHNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXIgPyB0aGlzLl9idWZmZXIubnVtYmVyT2ZDaGFubmVscyA6IDA7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLmZyb21BcnJheSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRbMF0ubGVuZ3RoID4gMCxcbiAgICAgICAgICBpID0gZSA/IHQubGVuZ3RoIDogMSxcbiAgICAgICAgICBzID0gZSA/IHRbMF0ubGVuZ3RoIDogdC5sZW5ndGgsXG4gICAgICAgICAgbiA9IHRoaXMuY29udGV4dC5jcmVhdGVCdWZmZXIoaSwgcywgdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUpO1xuICAgICAgZSB8fCAxICE9PSBpIHx8ICh0ID0gW3RdKTtcblxuICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCBpOyBvKyspIG4uY29weVRvQ2hhbm5lbCh0W29dLCBvKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlciA9IG4sIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUudG9Nb25vID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmIChzLmRlZmF1bHQuaXNOdW1iZXIodCkpIHRoaXMuZnJvbUFycmF5KHRoaXMudG9BcnJheSh0KSk7ZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGUgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMubGVuZ3RoKSwgaSA9IHRoaXMubnVtYmVyT2ZDaGFubmVscywgbiA9IDA7IG4gPCBpOyBuKyspIGZvciAodmFyIG8gPSB0aGlzLnRvQXJyYXkobiksIGEgPSAwOyBhIDwgby5sZW5ndGg7IGErKykgZVthXSArPSBvW2FdO1xuXG4gICAgICAgIGUgPSBlLm1hcChmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0IC8gaTtcbiAgICAgICAgfSksIHRoaXMuZnJvbUFycmF5KGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAocy5kZWZhdWx0LmlzTnVtYmVyKHQpKSByZXR1cm4gdGhpcy5nZXRDaGFubmVsRGF0YSh0KTtcbiAgICAgIGlmICgxID09PSB0aGlzLm51bWJlck9mQ2hhbm5lbHMpIHJldHVybiB0aGlzLnRvQXJyYXkoMCk7XG5cbiAgICAgIGZvciAodmFyIGUgPSBbXSwgaSA9IDA7IGkgPCB0aGlzLm51bWJlck9mQ2hhbm5lbHM7IGkrKykgZVtpXSA9IHRoaXMuZ2V0Q2hhbm5lbERhdGEoaSk7XG5cbiAgICAgIHJldHVybiBlO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLmdldENoYW5uZWxEYXRhID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9idWZmZXIuZ2V0Q2hhbm5lbERhdGEodCk7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIHRoaXMuZHVyYXRpb24pO1xuXG4gICAgICBmb3IgKHZhciBpID0gTWF0aC5mbG9vcih0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZSAqIHRoaXMudG9TZWNvbmRzKHQpKSwgbiA9IE1hdGguZmxvb3IodGhpcy5jb250ZXh0LnNhbXBsZVJhdGUgKiB0aGlzLnRvU2Vjb25kcyhlKSksIG8gPSBbXSwgYSA9IDA7IGEgPCB0aGlzLm51bWJlck9mQ2hhbm5lbHM7IGErKykgb1thXSA9IHRoaXMudG9BcnJheShhKS5zbGljZShpLCBuKTtcblxuICAgICAgcmV0dXJuIG5ldyBzLmRlZmF1bHQuQnVmZmVyKCkuZnJvbUFycmF5KG8pO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLl9yZXZlcnNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMubG9hZGVkKSBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMubnVtYmVyT2ZDaGFubmVsczsgdCsrKSBBcnJheS5wcm90b3R5cGUucmV2ZXJzZS5jYWxsKHRoaXMuZ2V0Q2hhbm5lbERhdGEodCkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLCBcInJldmVyc2VcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZXZlcnNlZDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3JldmVyc2VkICE9PSB0ICYmICh0aGlzLl9yZXZlcnNlZCA9IHQsIHRoaXMuX3JldmVyc2UoKSk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5FbWl0dGVyLm1peGluKHMuZGVmYXVsdC5CdWZmZXIpLCBzLmRlZmF1bHQuQnVmZmVyLl9kb3dubG9hZFF1ZXVlID0gW10sIHMuZGVmYXVsdC5CdWZmZXIuYmFzZVVybCA9IFwiXCIsIHMuZGVmYXVsdC5CdWZmZXIuZnJvbUFycmF5ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBuZXcgcy5kZWZhdWx0LkJ1ZmZlcigpLmZyb21BcnJheSh0KTtcbiAgICB9LCBzLmRlZmF1bHQuQnVmZmVyLmZyb21VcmwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcigpO1xuICAgICAgcmV0dXJuIGUubG9hZCh0KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuQnVmZmVyLl9yZW1vdmVGcm9tRG93bmxvYWRRdWV1ZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHMuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWUuaW5kZXhPZih0KTtcblxuICAgICAgLTEgIT09IGUgJiYgcy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5zcGxpY2UoZSwgMSk7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlci5sb2FkID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCBzLmRlZmF1bHQubm9PcCk7XG4gICAgICB2YXIgbiA9IHQubWF0Y2goL1xcWyguK1xcfD8pK1xcXSQvKTtcblxuICAgICAgaWYgKG4pIHtcbiAgICAgICAgZm9yICh2YXIgbyA9IG5bMV0uc3BsaXQoXCJ8XCIpLCBhID0gb1swXSwgciA9IDA7IHIgPCBvLmxlbmd0aDsgcisrKSBpZiAocy5kZWZhdWx0LkJ1ZmZlci5zdXBwb3J0c1R5cGUob1tyXSkpIHtcbiAgICAgICAgICBhID0gb1tyXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHQgPSB0LnJlcGxhY2UoblswXSwgYSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGwodCkge1xuICAgICAgICBpZiAocy5kZWZhdWx0LkJ1ZmZlci5fcmVtb3ZlRnJvbURvd25sb2FkUXVldWUoZCksIHMuZGVmYXVsdC5CdWZmZXIuZW1pdChcImVycm9yXCIsIHQpLCAhaSkgdGhyb3cgdDtcbiAgICAgICAgaSh0KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdSgpIHtcbiAgICAgICAgZm9yICh2YXIgdCA9IDAsIGUgPSAwOyBlIDwgcy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5sZW5ndGg7IGUrKykgdCArPSBzLmRlZmF1bHQuQnVmZmVyLl9kb3dubG9hZFF1ZXVlW2VdLnByb2dyZXNzO1xuXG4gICAgICAgIHMuZGVmYXVsdC5CdWZmZXIuZW1pdChcInByb2dyZXNzXCIsIHQgLyBzLmRlZmF1bHQuQnVmZmVyLl9kb3dubG9hZFF1ZXVlLmxlbmd0aCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBkID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICByZXR1cm4gZC5vcGVuKFwiR0VUXCIsIHMuZGVmYXVsdC5CdWZmZXIuYmFzZVVybCArIHQsICEwKSwgZC5yZXNwb25zZVR5cGUgPSBcImFycmF5YnVmZmVyXCIsIGQucHJvZ3Jlc3MgPSAwLCBzLmRlZmF1bHQuQnVmZmVyLl9kb3dubG9hZFF1ZXVlLnB1c2goZCksIGQuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAyMDAgPT09IGQuc3RhdHVzID8gcy5kZWZhdWx0LmNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGQucmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICBkLnByb2dyZXNzID0gMSwgdSgpLCBlKHQpLCBzLmRlZmF1bHQuQnVmZmVyLl9yZW1vdmVGcm9tRG93bmxvYWRRdWV1ZShkKSwgMCA9PT0gcy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5sZW5ndGggJiYgcy5kZWZhdWx0LkJ1ZmZlci5lbWl0KFwibG9hZFwiKTtcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHMuZGVmYXVsdC5CdWZmZXIuX3JlbW92ZUZyb21Eb3dubG9hZFF1ZXVlKGQpLCBsKFwiVG9uZS5CdWZmZXI6IGNvdWxkIG5vdCBkZWNvZGUgYXVkaW8gZGF0YTogXCIgKyB0KTtcbiAgICAgICAgfSkgOiBsKFwiVG9uZS5CdWZmZXI6IGNvdWxkIG5vdCBsb2NhdGUgZmlsZTogXCIgKyB0KTtcbiAgICAgIH0pLCBkLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBsKSwgZC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdC5sZW5ndGhDb21wdXRhYmxlICYmIChkLnByb2dyZXNzID0gdC5sb2FkZWQgLyB0LnRvdGFsICogLjk1LCB1KCkpO1xuICAgICAgfSksIGQuc2VuZCgpLCBkO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIuY2FuY2VsRG93bmxvYWRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWUuc2xpY2UoKS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHMuZGVmYXVsdC5CdWZmZXIuX3JlbW92ZUZyb21Eb3dubG9hZFF1ZXVlKHQpLCB0LmFib3J0KCk7XG4gICAgICB9KSwgcy5kZWZhdWx0LkJ1ZmZlcjtcbiAgICB9LCBzLmRlZmF1bHQuQnVmZmVyLnN1cHBvcnRzVHlwZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHQuc3BsaXQoXCIuXCIpO1xuICAgICAgcmV0dXJuIGUgPSBlW2UubGVuZ3RoIC0gMV0sIFwiXCIgIT09IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhdWRpb1wiKS5jYW5QbGF5VHlwZShcImF1ZGlvL1wiICsgZSk7XG4gICAgfSwgcy5kZWZhdWx0LmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0LCBlO1xuXG4gICAgICBmdW5jdGlvbiBpKCkge1xuICAgICAgICBzLmRlZmF1bHQuQnVmZmVyLm9mZihcImxvYWRcIiwgdCksIHMuZGVmYXVsdC5CdWZmZXIub2ZmKFwiZXJyb3JcIiwgZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoaSwgbikge1xuICAgICAgICB0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGkoKTtcbiAgICAgICAgfSwgZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBuKCk7XG4gICAgICAgIH0sIHMuZGVmYXVsdC5CdWZmZXIub24oXCJsb2FkXCIsIHQpLCBzLmRlZmF1bHQuQnVmZmVyLm9uKFwiZXJyb3JcIiwgZSk7XG4gICAgICB9KS50aGVuKGkpLmNhdGNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRocm93IGkoKSwgbmV3IEVycm9yKHQpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQnVmZmVyO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDE3KSwgaSgyNiksIGkoMSksIGkoMiksIGkoMjIpLCBpKDQpLCBpKDI4KTtcbiAgICBzLmRlZmF1bHQuTEZPID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJmcmVxdWVuY3lcIiwgXCJtaW5cIiwgXCJtYXhcIl0sIHMuZGVmYXVsdC5MRk8pO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl9vc2NpbGxhdG9yID0gbmV3IHMuZGVmYXVsdC5Pc2NpbGxhdG9yKHtcbiAgICAgICAgZnJlcXVlbmN5OiB0LmZyZXF1ZW5jeSxcbiAgICAgICAgdHlwZTogdC50eXBlXG4gICAgICB9KSwgdGhpcy5mcmVxdWVuY3kgPSB0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSwgdGhpcy5hbXBsaXR1ZGUgPSB0aGlzLl9vc2NpbGxhdG9yLnZvbHVtZSwgdGhpcy5hbXBsaXR1ZGUudW5pdHMgPSBzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSwgdGhpcy5hbXBsaXR1ZGUudmFsdWUgPSB0LmFtcGxpdHVkZSwgdGhpcy5fc3RvcHBlZFNpZ25hbCA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKDAsIHMuZGVmYXVsdC5UeXBlLkF1ZGlvUmFuZ2UpLCB0aGlzLl96ZXJvcyA9IG5ldyBzLmRlZmF1bHQuWmVybygpLCB0aGlzLl9zdG9wcGVkVmFsdWUgPSAwLCB0aGlzLl9hMmcgPSBuZXcgcy5kZWZhdWx0LkF1ZGlvVG9HYWluKCksIHRoaXMuX3NjYWxlciA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5TY2FsZSh0Lm1pbiwgdC5tYXgpLCB0aGlzLl91bml0cyA9IHMuZGVmYXVsdC5UeXBlLkRlZmF1bHQsIHRoaXMudW5pdHMgPSB0LnVuaXRzLCB0aGlzLl9vc2NpbGxhdG9yLmNoYWluKHRoaXMuX2EyZywgdGhpcy5fc2NhbGVyKSwgdGhpcy5femVyb3MuY29ubmVjdCh0aGlzLl9hMmcpLCB0aGlzLl9zdG9wcGVkU2lnbmFsLmNvbm5lY3QodGhpcy5fYTJnKSwgdGhpcy5fcmVhZE9ubHkoW1wiYW1wbGl0dWRlXCIsIFwiZnJlcXVlbmN5XCJdKSwgdGhpcy5waGFzZSA9IHQucGhhc2U7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTEZPLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkxGTy5kZWZhdWx0cyA9IHtcbiAgICAgIHR5cGU6IFwic2luZVwiLFxuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiAxLFxuICAgICAgcGhhc2U6IDAsXG4gICAgICBmcmVxdWVuY3k6IFwiNG5cIixcbiAgICAgIGFtcGxpdHVkZTogMSxcbiAgICAgIHVuaXRzOiBzLmRlZmF1bHQuVHlwZS5EZWZhdWx0XG4gICAgfSwgcy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RvcHBlZFNpZ25hbC5zZXRWYWx1ZUF0VGltZSgwLCB0KSwgdGhpcy5fb3NjaWxsYXRvci5zdGFydCh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuTEZPLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX3N0b3BwZWRTaWduYWwuc2V0VmFsdWVBdFRpbWUodGhpcy5fc3RvcHBlZFZhbHVlLCB0KSwgdGhpcy5fb3NjaWxsYXRvci5zdG9wKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLnN5bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5zeW5jKCksIHRoaXMuX29zY2lsbGF0b3Iuc3luY0ZyZXF1ZW5jeSgpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLnVuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9yLnVuc3luYygpLCB0aGlzLl9vc2NpbGxhdG9yLnVuc3luY0ZyZXF1ZW5jeSgpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSwgXCJtaW5cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b1VuaXRzKHRoaXMuX3NjYWxlci5taW4pO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdCA9IHRoaXMuX2Zyb21Vbml0cyh0KSwgdGhpcy5fc2NhbGVyLm1pbiA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSwgXCJtYXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b1VuaXRzKHRoaXMuX3NjYWxlci5tYXgpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdCA9IHRoaXMuX2Zyb21Vbml0cyh0KSwgdGhpcy5fc2NhbGVyLm1heCA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvci50eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3NjaWxsYXRvci50eXBlID0gdCwgdGhpcy5fc3RvcHBlZFZhbHVlID0gdGhpcy5fb3NjaWxsYXRvci5fZ2V0SW5pdGlhbFZhbHVlKCksIHRoaXMuX3N0b3BwZWRTaWduYWwudmFsdWUgPSB0aGlzLl9zdG9wcGVkVmFsdWU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSwgXCJwaGFzZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGhhc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vc2NpbGxhdG9yLnBoYXNlID0gdCwgdGhpcy5fc3RvcHBlZFZhbHVlID0gdGhpcy5fb3NjaWxsYXRvci5fZ2V0SW5pdGlhbFZhbHVlKCksIHRoaXMuX3N0b3BwZWRTaWduYWwudmFsdWUgPSB0aGlzLl9zdG9wcGVkVmFsdWU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSwgXCJ1bml0c1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLm1pbixcbiAgICAgICAgICAgIGkgPSB0aGlzLm1heDtcbiAgICAgICAgdGhpcy5fdW5pdHMgPSB0LCB0aGlzLm1pbiA9IGUsIHRoaXMubWF4ID0gaTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5zdGF0ZTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdC5jb25zdHJ1Y3RvciAhPT0gcy5kZWZhdWx0LlNpZ25hbCAmJiB0LmNvbnN0cnVjdG9yICE9PSBzLmRlZmF1bHQuUGFyYW0gfHwgKHRoaXMuY29udmVydCA9IHQuY29udmVydCwgdGhpcy51bml0cyA9IHQudW5pdHMpLCBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuY29ubmVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLl9mcm9tVW5pdHMgPSBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl9mcm9tVW5pdHMsIHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLl90b1VuaXRzID0gcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fdG9Vbml0cywgcy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImFtcGxpdHVkZVwiLCBcImZyZXF1ZW5jeVwiXSksIHRoaXMuX29zY2lsbGF0b3IuZGlzcG9zZSgpLCB0aGlzLl9vc2NpbGxhdG9yID0gbnVsbCwgdGhpcy5fc3RvcHBlZFNpZ25hbC5kaXNwb3NlKCksIHRoaXMuX3N0b3BwZWRTaWduYWwgPSBudWxsLCB0aGlzLl96ZXJvcy5kaXNwb3NlKCksIHRoaXMuX3plcm9zID0gbnVsbCwgdGhpcy5fc2NhbGVyLmRpc3Bvc2UoKSwgdGhpcy5fc2NhbGVyID0gbnVsbCwgdGhpcy5fYTJnLmRpc3Bvc2UoKSwgdGhpcy5fYTJnID0gbnVsbCwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmFtcGxpdHVkZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkxGTztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyOSksIGkoOTApLCBpKDIpLCBpKDMpO1xuICAgIHMuZGVmYXVsdC5TdWJ0cmFjdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBzLmRlZmF1bHQuU2lnbmFsLmNhbGwodGhpcyksIHRoaXMuY3JlYXRlSW5zT3V0cygyLCAwKSwgdGhpcy5fc3VtID0gdGhpcy5pbnB1dFswXSA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuX25lZyA9IG5ldyBzLmRlZmF1bHQuTmVnYXRlKCksIHRoaXMuX3BhcmFtID0gdGhpcy5pbnB1dFsxXSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQpLCB0aGlzLl9wYXJhbS5jaGFpbih0aGlzLl9uZWcsIHRoaXMuX3N1bSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU3VidHJhY3QsIHMuZGVmYXVsdC5TaWduYWwpLCBzLmRlZmF1bHQuU3VidHJhY3QucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9uZWcuZGlzcG9zZSgpLCB0aGlzLl9uZWcgPSBudWxsLCB0aGlzLl9zdW0uZGlzY29ubmVjdCgpLCB0aGlzLl9zdW0gPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5TdWJ0cmFjdDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0KSwgaSgxKSwgaSgyNCk7XG4gICAgcy5kZWZhdWx0LlBhcmFtID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJwYXJhbVwiLCBcInVuaXRzXCIsIFwiY29udmVydFwiXSwgcy5kZWZhdWx0LlBhcmFtKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLCB0KSwgdGhpcy5fcGFyYW0gPSB0aGlzLmlucHV0ID0gdC5wYXJhbSwgdGhpcy51bml0cyA9IHQudW5pdHMsIHRoaXMuY29udmVydCA9IHQuY29udmVydCwgdGhpcy5vdmVycmlkZGVuID0gITEsIHRoaXMuX2V2ZW50cyA9IG5ldyBzLmRlZmF1bHQuVGltZWxpbmUoMWUzKSwgcy5kZWZhdWx0LmlzRGVmaW5lZCh0LnZhbHVlKSAmJiB0aGlzLl9wYXJhbSAmJiB0aGlzLnNldFZhbHVlQXRUaW1lKHQudmFsdWUsIDApO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBhcmFtLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlBhcmFtLmRlZmF1bHRzID0ge1xuICAgICAgdW5pdHM6IHMuZGVmYXVsdC5UeXBlLkRlZmF1bHQsXG4gICAgICBjb252ZXJ0OiAhMCxcbiAgICAgIHBhcmFtOiB2b2lkIDBcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLm5vdygpO1xuICAgICAgICByZXR1cm4gdGhpcy5fdG9Vbml0cyh0aGlzLmdldFZhbHVlQXRUaW1lKHQpKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2luaXRpYWxWYWx1ZSA9IHRoaXMuX2Zyb21Vbml0cyh0KSwgdGhpcy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGhpcy5ub3coKSksIHRoaXMuc2V0VmFsdWVBdFRpbWUodCwgdGhpcy5ub3coKSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLCBcIm1pblZhbHVlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuVGltZSB8fCB0aGlzLnVuaXRzID09PSBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kgfHwgdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UgfHwgdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUgfHwgdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuQlBNID8gMCA6IHRoaXMudW5pdHMgPT09IHMuZGVmYXVsdC5UeXBlLkF1ZGlvUmFuZ2UgPyAtMSA6IHRoaXMudW5pdHMgPT09IHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzID8gLTEgLyAwIDogdGhpcy5fcGFyYW0ubWluVmFsdWU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLCBcIm1heFZhbHVlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UgfHwgdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuQXVkaW9SYW5nZSA/IDEgOiB0aGlzLl9wYXJhbS5tYXhWYWx1ZTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fZnJvbVVuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmICghdGhpcy5jb252ZXJ0ICYmICFzLmRlZmF1bHQuaXNVbmRlZih0aGlzLmNvbnZlcnQpIHx8IHRoaXMub3ZlcnJpZGRlbikgcmV0dXJuIHQ7XG5cbiAgICAgIHN3aXRjaCAodGhpcy51bml0cykge1xuICAgICAgICBjYXNlIHMuZGVmYXVsdC5UeXBlLlRpbWU6XG4gICAgICAgICAgcmV0dXJuIHRoaXMudG9TZWNvbmRzKHQpO1xuXG4gICAgICAgIGNhc2Ugcy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5OlxuICAgICAgICAgIHJldHVybiB0aGlzLnRvRnJlcXVlbmN5KHQpO1xuXG4gICAgICAgIGNhc2Ugcy5kZWZhdWx0LlR5cGUuRGVjaWJlbHM6XG4gICAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5kYlRvR2Fpbih0KTtcblxuICAgICAgICBjYXNlIHMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlOlxuICAgICAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh0LCAwKSwgMSk7XG5cbiAgICAgICAgY2FzZSBzLmRlZmF1bHQuVHlwZS5BdWRpb1JhbmdlOlxuICAgICAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heCh0LCAtMSksIDEpO1xuXG4gICAgICAgIGNhc2Ugcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmU6XG4gICAgICAgICAgcmV0dXJuIE1hdGgubWF4KHQsIDApO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fdG9Vbml0cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAoIXRoaXMuY29udmVydCAmJiAhcy5kZWZhdWx0LmlzVW5kZWYodGhpcy5jb252ZXJ0KSkgcmV0dXJuIHQ7XG5cbiAgICAgIHN3aXRjaCAodGhpcy51bml0cykge1xuICAgICAgICBjYXNlIHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzOlxuICAgICAgICAgIHJldHVybiBzLmRlZmF1bHQuZ2FpblRvRGIodCk7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gdDtcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl9taW5PdXRwdXQgPSAxZS01LCBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUgPSB7XG4gICAgICBMaW5lYXI6IFwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWVcIixcbiAgICAgIEV4cG9uZW50aWFsOiBcImV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWVcIixcbiAgICAgIFRhcmdldDogXCJzZXRUYXJnZXRBdFRpbWVcIixcbiAgICAgIFNldFZhbHVlOiBcInNldFZhbHVlQXRUaW1lXCIsXG4gICAgICBDYW5jZWw6IFwiY2FuY2VsU2NoZWR1bGVkVmFsdWVzXCJcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLnNldFZhbHVlQXRUaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBlID0gdGhpcy50b1NlY29uZHMoZSksIHQgPSB0aGlzLl9mcm9tVW5pdHModCksIHRoaXMuX2V2ZW50cy5hZGQoe1xuICAgICAgICB0eXBlOiBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuU2V0VmFsdWUsXG4gICAgICAgIHZhbHVlOiB0LFxuICAgICAgICB0aW1lOiBlXG4gICAgICB9KSwgdGhpcy5sb2cocy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlNldFZhbHVlLCB0LCBlKSwgdGhpcy5fcGFyYW0uc2V0VmFsdWVBdFRpbWUodCwgZSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5nZXRWYWx1ZUF0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gdGhpcy50b1NlY29uZHModCk7XG5cbiAgICAgIHZhciBlID0gdGhpcy5fZXZlbnRzLmdldEFmdGVyKHQpLFxuICAgICAgICAgIGkgPSB0aGlzLl9ldmVudHMuZ2V0KHQpLFxuICAgICAgICAgIG4gPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0aGlzLl9pbml0aWFsVmFsdWUsIHRoaXMuX3BhcmFtLmRlZmF1bHRWYWx1ZSksXG4gICAgICAgICAgbyA9IG47XG5cbiAgICAgIGlmIChudWxsID09PSBpKSBvID0gbjtlbHNlIGlmIChpLnR5cGUgPT09IHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5UYXJnZXQpIHtcbiAgICAgICAgdmFyIGEsXG4gICAgICAgICAgICByID0gdGhpcy5fZXZlbnRzLmdldEJlZm9yZShpLnRpbWUpO1xuXG4gICAgICAgIGEgPSBudWxsID09PSByID8gbiA6IHIudmFsdWUsIG8gPSB0aGlzLl9leHBvbmVudGlhbEFwcHJvYWNoKGkudGltZSwgYSwgaS52YWx1ZSwgaS5jb25zdGFudCwgdCk7XG4gICAgICB9IGVsc2UgbyA9IG51bGwgPT09IGUgPyBpLnZhbHVlIDogZS50eXBlID09PSBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyID8gdGhpcy5fbGluZWFySW50ZXJwb2xhdGUoaS50aW1lLCBpLnZhbHVlLCBlLnRpbWUsIGUudmFsdWUsIHQpIDogZS50eXBlID09PSBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuRXhwb25lbnRpYWwgPyB0aGlzLl9leHBvbmVudGlhbEludGVycG9sYXRlKGkudGltZSwgaS52YWx1ZSwgZS50aW1lLCBlLnZhbHVlLCB0KSA6IGkudmFsdWU7XG4gICAgICByZXR1cm4gbztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLnNldFJhbXBQb2ludCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gdGhpcy50b1NlY29uZHModCk7XG4gICAgICB2YXIgZSA9IHRoaXMuZ2V0VmFsdWVBdFRpbWUodCk7XG4gICAgICByZXR1cm4gdGhpcy5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLCAwID09PSBlICYmIChlID0gdGhpcy5fbWluT3V0cHV0KSwgdGhpcy5zZXRWYWx1ZUF0VGltZSh0aGlzLl90b1VuaXRzKGUpLCB0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy5fZnJvbVVuaXRzKHQpLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHRoaXMuX2V2ZW50cy5hZGQoe1xuICAgICAgICB0eXBlOiBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyLFxuICAgICAgICB2YWx1ZTogdCxcbiAgICAgICAgdGltZTogZVxuICAgICAgfSksIHRoaXMubG9nKHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5MaW5lYXIsIHQsIGUpLCB0aGlzLl9wYXJhbS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLl9mcm9tVW5pdHModCksIHQgPSBNYXRoLm1heCh0aGlzLl9taW5PdXRwdXQsIHQpLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHRoaXMuX2V2ZW50cy5hZGQoe1xuICAgICAgICB0eXBlOiBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuRXhwb25lbnRpYWwsXG4gICAgICAgIHRpbWU6IGUsXG4gICAgICAgIHZhbHVlOiB0XG4gICAgICB9KSwgdGhpcy5sb2cocy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLkV4cG9uZW50aWFsLCB0LCBlKSwgdGhpcy5fcGFyYW0uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSh0LCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmV4cG9uZW50aWFsUmFtcFRvID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHJldHVybiBpID0gdGhpcy50b1NlY29uZHMoaSksIHRoaXMuc2V0UmFtcFBvaW50KGkpLCB0aGlzLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCwgaSArIHRoaXMudG9TZWNvbmRzKGUpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmxpbmVhclJhbXBUbyA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gaSA9IHRoaXMudG9TZWNvbmRzKGkpLCB0aGlzLnNldFJhbXBQb2ludChpKSwgdGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LCBpICsgdGhpcy50b1NlY29uZHMoZSkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUudGFyZ2V0UmFtcFRvID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHJldHVybiBpID0gdGhpcy50b1NlY29uZHMoaSksIHRoaXMuc2V0UmFtcFBvaW50KGkpLCB0aGlzLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZSh0LCBpLCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICB2YXIgcyA9IE1hdGgubG9nKHRoaXMudG9TZWNvbmRzKGkpICsgMSkgLyBNYXRoLmxvZygyMDApO1xuICAgICAgcmV0dXJuIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy5zZXRUYXJnZXRBdFRpbWUodCwgZSwgcyksIHRoaXMuY2FuY2VsQW5kSG9sZEF0VGltZShlICsgLjkgKiBpKSwgdGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0LCBlICsgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5zZXRUYXJnZXRBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgaWYgKHQgPSB0aGlzLl9mcm9tVW5pdHModCksIGkgPD0gMCkgdGhyb3cgbmV3IEVycm9yKFwidGltZUNvbnN0YW50IG11c3QgYmUgZ3JlYXRlciB0aGFuIDBcIik7XG4gICAgICByZXR1cm4gZSA9IHRoaXMudG9TZWNvbmRzKGUpLCB0aGlzLl9ldmVudHMuYWRkKHtcbiAgICAgICAgdHlwZTogcy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlRhcmdldCxcbiAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgIHRpbWU6IGUsXG4gICAgICAgIGNvbnN0YW50OiBpXG4gICAgICB9KSwgdGhpcy5sb2cocy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlRhcmdldCwgdCwgZSwgaSksIHRoaXMuX3BhcmFtLnNldFRhcmdldEF0VGltZSh0LCBlLCBpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLnNldFZhbHVlQ3VydmVBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSwgaSwgbikge1xuICAgICAgbiA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKG4sIDEpLCBpID0gdGhpcy50b1NlY29uZHMoaSksIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy5zZXRWYWx1ZUF0VGltZSh0WzBdICogbiwgZSk7XG5cbiAgICAgIGZvciAodmFyIG8gPSBpIC8gKHQubGVuZ3RoIC0gMSksIGEgPSAxOyBhIDwgdC5sZW5ndGg7IGErKykgdGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0W2FdICogbiwgZSArIGEgKiBvKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fZXZlbnRzLmNhbmNlbCh0KSwgdGhpcy5fcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpLCB0aGlzLmxvZyhzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuQ2FuY2VsLCB0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmNhbmNlbEFuZEhvbGRBdFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpO1xuICAgICAgdmFyIGUgPSB0aGlzLmdldFZhbHVlQXRUaW1lKHQpO1xuICAgICAgdGhpcy5sb2coXCJjYW5jZWxBbmRIb2xkQXRUaW1lXCIsIHQsIFwidmFsdWU9XCIgKyBlKSwgdGhpcy5fcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpO1xuXG4gICAgICB2YXIgaSA9IHRoaXMuX2V2ZW50cy5nZXQodCksXG4gICAgICAgICAgbiA9IHRoaXMuX2V2ZW50cy5nZXRBZnRlcih0KTtcblxuICAgICAgcmV0dXJuIGkgJiYgaS50aW1lID09PSB0ID8gbiA/IHRoaXMuX2V2ZW50cy5jYW5jZWwobi50aW1lKSA6IHRoaXMuX2V2ZW50cy5jYW5jZWwodCArIHRoaXMuc2FtcGxlVGltZSkgOiBuICYmICh0aGlzLl9ldmVudHMuY2FuY2VsKG4udGltZSksIG4udHlwZSA9PT0gcy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLkxpbmVhciA/IHRoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoZSwgdCkgOiBuLnR5cGUgPT09IHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5FeHBvbmVudGlhbCAmJiB0aGlzLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoZSwgdCkpLCB0aGlzLl9ldmVudHMuYWRkKHtcbiAgICAgICAgdHlwZTogcy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlNldFZhbHVlLFxuICAgICAgICB2YWx1ZTogZSxcbiAgICAgICAgdGltZTogdFxuICAgICAgfSksIHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKGUsIHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUucmFtcFRvID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHJldHVybiBlID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgLjEpLCB0aGlzLnVuaXRzID09PSBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kgfHwgdGhpcy51bml0cyA9PT0gcy5kZWZhdWx0LlR5cGUuQlBNIHx8IHRoaXMudW5pdHMgPT09IHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzID8gdGhpcy5leHBvbmVudGlhbFJhbXBUbyh0LCBlLCBpKSA6IHRoaXMubGluZWFyUmFtcFRvKHQsIGUsIGkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuX2V4cG9uZW50aWFsQXBwcm9hY2ggPSBmdW5jdGlvbiAodCwgZSwgaSwgcywgbikge1xuICAgICAgcmV0dXJuIGkgKyAoZSAtIGkpICogTWF0aC5leHAoLShuIC0gdCkgLyBzKTtcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl9saW5lYXJJbnRlcnBvbGF0ZSA9IGZ1bmN0aW9uICh0LCBlLCBpLCBzLCBuKSB7XG4gICAgICByZXR1cm4gZSArIChuIC0gdCkgLyAoaSAtIHQpICogKHMgLSBlKTtcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl9leHBvbmVudGlhbEludGVycG9sYXRlID0gZnVuY3Rpb24gKHQsIGUsIGksIHMsIG4pIHtcbiAgICAgIHJldHVybiBlICogTWF0aC5wb3cocyAvIGUsIChuIC0gdCkgLyAoaSAtIHQpKTtcbiAgICB9LCBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9wYXJhbSA9IG51bGwsIHRoaXMuX2V2ZW50cyA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBhcmFtO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDgpLCBpKDE5KSwgaSgxMCksIGkoMjMpO1xuICAgIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyk7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcIndldFwiXSwgcy5kZWZhdWx0LkVmZmVjdCk7XG4gICAgICB0aGlzLmNyZWF0ZUluc091dHMoMSwgMSksIHRoaXMuX2RyeVdldCA9IG5ldyBzLmRlZmF1bHQuQ3Jvc3NGYWRlKHQud2V0KSwgdGhpcy53ZXQgPSB0aGlzLl9kcnlXZXQuZmFkZSwgdGhpcy5fc3BsaXQgPSBuZXcgcy5kZWZhdWx0LlNwbGl0KCksIHRoaXMuZWZmZWN0U2VuZEwgPSB0aGlzLl9zcGxpdC5sZWZ0LCB0aGlzLmVmZmVjdFNlbmRSID0gdGhpcy5fc3BsaXQucmlnaHQsIHRoaXMuX21lcmdlID0gbmV3IHMuZGVmYXVsdC5NZXJnZSgpLCB0aGlzLmVmZmVjdFJldHVybkwgPSB0aGlzLl9tZXJnZS5sZWZ0LCB0aGlzLmVmZmVjdFJldHVyblIgPSB0aGlzLl9tZXJnZS5yaWdodCwgcy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCwgdGhpcy5fc3BsaXQpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLl9kcnlXZXQsIDAsIDApLCB0aGlzLl9tZXJnZS5jb25uZWN0KHRoaXMuX2RyeVdldCwgMCwgMSksIHRoaXMuX2RyeVdldC5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5fcmVhZE9ubHkoW1wid2V0XCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QsIHMuZGVmYXVsdC5FZmZlY3QpLCBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZHJ5V2V0LmRpc3Bvc2UoKSwgdGhpcy5fZHJ5V2V0ID0gbnVsbCwgdGhpcy5fc3BsaXQuZGlzcG9zZSgpLCB0aGlzLl9zcGxpdCA9IG51bGwsIHRoaXMuX21lcmdlLmRpc3Bvc2UoKSwgdGhpcy5fbWVyZ2UgPSBudWxsLCB0aGlzLmVmZmVjdFNlbmRMID0gbnVsbCwgdGhpcy5lZmZlY3RTZW5kUiA9IG51bGwsIHRoaXMuZWZmZWN0UmV0dXJuTCA9IG51bGwsIHRoaXMuZWZmZWN0UmV0dXJuUiA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcIndldFwiXSksIHRoaXMud2V0ID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDgzKSwgaSg0KSwgaSgyNCksIGkoMzUpLCBpKDMpLCBpKDgxKSwgaSg4MCksIGkoNTYpO1xuICAgIHMuZGVmYXVsdC5UcmFuc3BvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuRW1pdHRlci5jYWxsKHRoaXMpLCBzLmRlZmF1bHQuZ2V0Q29udGV4dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9vcCA9ICExLCB0aGlzLl9sb29wU3RhcnQgPSAwLCB0aGlzLl9sb29wRW5kID0gMCwgdGhpcy5fcHBxID0gbi5kZWZhdWx0cy5QUFEsIHRoaXMuX2Nsb2NrID0gbmV3IHMuZGVmYXVsdC5DbG9jayh7XG4gICAgICAgICAgY2FsbGJhY2s6IHRoaXMuX3Byb2Nlc3NUaWNrLmJpbmQodGhpcyksXG4gICAgICAgICAgZnJlcXVlbmN5OiAwXG4gICAgICAgIH0pLCB0aGlzLl9iaW5kQ2xvY2tFdmVudHMoKSwgdGhpcy5icG0gPSB0aGlzLl9jbG9jay5mcmVxdWVuY3ksIHRoaXMuYnBtLl90b1VuaXRzID0gdGhpcy5fdG9Vbml0cy5iaW5kKHRoaXMpLCB0aGlzLmJwbS5fZnJvbVVuaXRzID0gdGhpcy5fZnJvbVVuaXRzLmJpbmQodGhpcyksIHRoaXMuYnBtLnVuaXRzID0gcy5kZWZhdWx0LlR5cGUuQlBNLCB0aGlzLmJwbS52YWx1ZSA9IG4uZGVmYXVsdHMuYnBtLCB0aGlzLl9yZWFkT25seShcImJwbVwiKSwgdGhpcy5fdGltZVNpZ25hdHVyZSA9IG4uZGVmYXVsdHMudGltZVNpZ25hdHVyZSwgdGhpcy5fc2NoZWR1bGVkRXZlbnRzID0ge30sIHRoaXMuX3RpbWVsaW5lID0gbmV3IHMuZGVmYXVsdC5UaW1lbGluZSgpLCB0aGlzLl9yZXBlYXRlZEV2ZW50cyA9IG5ldyBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZSgpLCB0aGlzLl9zeW5jZWRTaWduYWxzID0gW10sIHRoaXMuX3N3aW5nVGlja3MgPSBuLmRlZmF1bHRzLlBQUSAvIDIsIHRoaXMuX3N3aW5nQW1vdW50ID0gMCwgdGhpcy5jb250ZXh0LnRyYW5zcG9ydCA9IHRoaXM7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRyYW5zcG9ydCwgcy5kZWZhdWx0LkVtaXR0ZXIpLCBzLmRlZmF1bHQuVHJhbnNwb3J0LmRlZmF1bHRzID0ge1xuICAgICAgYnBtOiAxMjAsXG4gICAgICBzd2luZzogMCxcbiAgICAgIHN3aW5nU3ViZGl2aXNpb246IFwiOG5cIixcbiAgICAgIHRpbWVTaWduYXR1cmU6IDQsXG4gICAgICBsb29wU3RhcnQ6IDAsXG4gICAgICBsb29wRW5kOiBcIjRtXCIsXG4gICAgICBQUFE6IDE5MlxuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmlzVHJhbnNwb3J0ID0gITAsIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9wcm9jZXNzVGljayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAodGhpcy5fc3dpbmdBbW91bnQgPiAwICYmIGUgJSB0aGlzLl9wcHEgIT0gMCAmJiBlICUgKDIgKiB0aGlzLl9zd2luZ1RpY2tzKSAhPSAwKSB7XG4gICAgICAgIHZhciBpID0gZSAlICgyICogdGhpcy5fc3dpbmdUaWNrcykgLyAoMiAqIHRoaXMuX3N3aW5nVGlja3MpLFxuICAgICAgICAgICAgbiA9IE1hdGguc2luKGkgKiBNYXRoLlBJKSAqIHRoaXMuX3N3aW5nQW1vdW50O1xuXG4gICAgICAgIHQgKz0gcy5kZWZhdWx0LlRpY2tzKDIgKiB0aGlzLl9zd2luZ1RpY2tzIC8gMykudG9TZWNvbmRzKCkgKiBuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmxvb3AgJiYgZSA+PSB0aGlzLl9sb29wRW5kICYmICh0aGlzLmVtaXQoXCJsb29wRW5kXCIsIHQpLCB0aGlzLl9jbG9jay5zZXRUaWNrc0F0VGltZSh0aGlzLl9sb29wU3RhcnQsIHQpLCBlID0gdGhpcy5fbG9vcFN0YXJ0LCB0aGlzLmVtaXQoXCJsb29wU3RhcnRcIiwgdCwgdGhpcy5fY2xvY2suZ2V0U2Vjb25kc0F0VGltZSh0KSksIHRoaXMuZW1pdChcImxvb3BcIiwgdCkpLCB0aGlzLl90aW1lbGluZS5mb3JFYWNoQXRUaW1lKGUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuaW52b2tlKHQpO1xuICAgICAgfSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdmFyIGkgPSBuZXcgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50KHRoaXMsIHtcbiAgICAgICAgdGltZTogcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoZSksXG4gICAgICAgIGNhbGxiYWNrOiB0XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLl9hZGRFdmVudChpLCB0aGlzLl90aW1lbGluZSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuc2NoZWR1bGVSZXBlYXQgPSBmdW5jdGlvbiAodCwgZSwgaSwgbikge1xuICAgICAgdmFyIG8gPSBuZXcgcy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50KHRoaXMsIHtcbiAgICAgICAgY2FsbGJhY2s6IHQsXG4gICAgICAgIGludGVydmFsOiBzLmRlZmF1bHQuVGltZShlKSxcbiAgICAgICAgdGltZTogcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoaSksXG4gICAgICAgIGR1cmF0aW9uOiBzLmRlZmF1bHQuVGltZShzLmRlZmF1bHQuZGVmYXVsdEFyZyhuLCAxIC8gMCkpXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLl9hZGRFdmVudChvLCB0aGlzLl9yZXBlYXRlZEV2ZW50cyk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuc2NoZWR1bGVPbmNlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHZhciBpID0gbmV3IHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudCh0aGlzLCB7XG4gICAgICAgIHRpbWU6IHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLFxuICAgICAgICBjYWxsYmFjazogdCxcbiAgICAgICAgb25jZTogITBcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMuX2FkZEV2ZW50KGksIHRoaXMuX3RpbWVsaW5lKTtcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAodGhpcy5fc2NoZWR1bGVkRXZlbnRzLmhhc093blByb3BlcnR5KHQpKSB7XG4gICAgICAgIHZhciBlID0gdGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QudG9TdHJpbmcoKV07XG5cbiAgICAgICAgZS50aW1lbGluZS5yZW1vdmUoZS5ldmVudCksIGUuZXZlbnQuZGlzcG9zZSgpLCBkZWxldGUgdGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QudG9TdHJpbmcoKV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9hZGRFdmVudCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QuaWQudG9TdHJpbmcoKV0gPSB7XG4gICAgICAgIGV2ZW50OiB0LFxuICAgICAgICB0aW1lbGluZTogZVxuICAgICAgfSwgZS5hZGQodCksIHQuaWQ7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgMCksIHQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuX3RpbWVsaW5lLmZvckVhY2hGcm9tKHQsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuY2xlYXIodC5pZCk7XG4gICAgICB9LmJpbmQodGhpcykpLCB0aGlzLl9yZXBlYXRlZEV2ZW50cy5mb3JFYWNoRnJvbSh0LCBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLmNsZWFyKHQuaWQpO1xuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5fYmluZENsb2NrRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fY2xvY2sub24oXCJzdGFydFwiLCBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgICBlID0gcy5kZWZhdWx0LlRpY2tzKGUpLnRvU2Vjb25kcygpLCB0aGlzLmVtaXQoXCJzdGFydFwiLCB0LCBlKTtcbiAgICAgIH0uYmluZCh0aGlzKSksIHRoaXMuX2Nsb2NrLm9uKFwic3RvcFwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLmVtaXQoXCJzdG9wXCIsIHQpO1xuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcy5fY2xvY2sub24oXCJwYXVzZVwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLmVtaXQoXCJwYXVzZVwiLCB0KTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvY2suZ2V0U3RhdGVBdFRpbWUodGhpcy5ub3coKSk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuaXNEZWZpbmVkKGUpICYmIChlID0gdGhpcy50b1RpY2tzKGUpKSwgdGhpcy5fY2xvY2suc3RhcnQodCwgZSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2xvY2suc3RvcCh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2xvY2sucGF1c2UodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX2Nsb2NrLmdldFN0YXRlQXRUaW1lKHQpICE9PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCA/IHRoaXMuc3RhcnQodCkgOiB0aGlzLnN0b3AodCksIHRoaXM7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInRpbWVTaWduYXR1cmVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aW1lU2lnbmF0dXJlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcy5kZWZhdWx0LmlzQXJyYXkodCkgJiYgKHQgPSB0WzBdIC8gdFsxXSAqIDQpLCB0aGlzLl90aW1lU2lnbmF0dXJlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcImxvb3BTdGFydFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wU3RhcnQpLnRvU2Vjb25kcygpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbG9vcFN0YXJ0ID0gdGhpcy50b1RpY2tzKHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsIFwibG9vcEVuZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wRW5kKS50b1NlY29uZHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3BFbmQgPSB0aGlzLnRvVGlja3ModCk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnNldExvb3BQb2ludHMgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHRoaXMubG9vcFN0YXJ0ID0gdCwgdGhpcy5sb29wRW5kID0gZSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsIFwic3dpbmdcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zd2luZ0Ftb3VudDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3N3aW5nQW1vdW50ID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInN3aW5nU3ViZGl2aXNpb25cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fc3dpbmdUaWNrcykudG9Ob3RhdGlvbigpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fc3dpbmdUaWNrcyA9IHRoaXMudG9UaWNrcyh0KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInBvc2l0aW9uXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXMubm93KCksXG4gICAgICAgICAgICBlID0gdGhpcy5fY2xvY2suZ2V0VGlja3NBdFRpbWUodCk7XG5cbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UaWNrcyhlKS50b0JhcnNCZWF0c1NpeHRlZW50aHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gdGhpcy50b1RpY2tzKHQpO1xuICAgICAgICB0aGlzLnRpY2tzID0gZTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInNlY29uZHNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9jay5zZWNvbmRzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLm5vdygpLFxuICAgICAgICAgICAgaSA9IHRoaXMuYnBtLnRpbWVUb1RpY2tzKHQsIGUpO1xuICAgICAgICB0aGlzLnRpY2tzID0gaTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLCBcInByb2dyZXNzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5sb29wKSB7XG4gICAgICAgICAgdmFyIHQgPSB0aGlzLm5vdygpO1xuICAgICAgICAgIHJldHVybiAodGhpcy5fY2xvY2suZ2V0VGlja3NBdFRpbWUodCkgLSB0aGlzLl9sb29wU3RhcnQpIC8gKHRoaXMuX2xvb3BFbmQgLSB0aGlzLl9sb29wU3RhcnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZSwgXCJ0aWNrc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb2NrLnRpY2tzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2Nsb2NrLnRpY2tzICE9PSB0KSB7XG4gICAgICAgICAgdmFyIGUgPSB0aGlzLm5vdygpO1xuICAgICAgICAgIHRoaXMuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkID8gKHRoaXMuZW1pdChcInN0b3BcIiwgZSksIHRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHQsIGUpLCB0aGlzLmVtaXQoXCJzdGFydFwiLCBlLCB0aGlzLnNlY29uZHMpKSA6IHRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHQsIGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmdldFRpY2tzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRoaXMuX2Nsb2NrLmdldFRpY2tzQXRUaW1lKHQpKTtcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5nZXRTZWNvbmRzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jbG9jay5nZXRTZWNvbmRzQXRUaW1lKHQpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZSwgXCJQUFFcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcHE7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHRoaXMuYnBtLnZhbHVlO1xuICAgICAgICB0aGlzLl9wcHEgPSB0LCB0aGlzLmJwbS52YWx1ZSA9IGU7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9mcm9tVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIDEgLyAoNjAgLyB0IC8gdGhpcy5QUFEpO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl90b1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0IC8gdGhpcy5QUFEgKiA2MDtcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5uZXh0U3ViZGl2aXNpb24gPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuc3RhdGUgIT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKSByZXR1cm4gMDtcbiAgICAgIHZhciBlID0gdGhpcy5ub3coKSxcbiAgICAgICAgICBpID0gdCAtIHRoaXMuZ2V0VGlja3NBdFRpbWUoZSkgJSB0O1xuICAgICAgcmV0dXJuIHRoaXMuX2Nsb2NrLm5leHRUaWNrVGltZShpLCBlKTtcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5zeW5jU2lnbmFsID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmICghZSkge1xuICAgICAgICB2YXIgaSA9IHRoaXMubm93KCk7XG4gICAgICAgIGUgPSAwICE9PSB0LmdldFZhbHVlQXRUaW1lKGkpID8gdC5nZXRWYWx1ZUF0VGltZShpKSAvIHRoaXMuYnBtLmdldFZhbHVlQXRUaW1lKGkpIDogMDtcbiAgICAgIH1cblxuICAgICAgdmFyIG4gPSBuZXcgcy5kZWZhdWx0LkdhaW4oZSk7XG4gICAgICByZXR1cm4gdGhpcy5icG0uY2hhaW4obiwgdC5fcGFyYW0pLCB0aGlzLl9zeW5jZWRTaWduYWxzLnB1c2goe1xuICAgICAgICByYXRpbzogbixcbiAgICAgICAgc2lnbmFsOiB0LFxuICAgICAgICBpbml0aWFsOiB0LnZhbHVlXG4gICAgICB9KSwgdC52YWx1ZSA9IDAsIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUudW5zeW5jU2lnbmFsID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGZvciAodmFyIGUgPSB0aGlzLl9zeW5jZWRTaWduYWxzLmxlbmd0aCAtIDE7IGUgPj0gMDsgZS0tKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5fc3luY2VkU2lnbmFsc1tlXTtcbiAgICAgICAgaS5zaWduYWwgPT09IHQgJiYgKGkucmF0aW8uZGlzcG9zZSgpLCBpLnNpZ25hbC52YWx1ZSA9IGkuaW5pdGlhbCwgdGhpcy5fc3luY2VkU2lnbmFscy5zcGxpY2UoZSwgMSkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5FbWl0dGVyLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2Nsb2NrLmRpc3Bvc2UoKSwgdGhpcy5fY2xvY2sgPSBudWxsLCB0aGlzLl93cml0YWJsZShcImJwbVwiKSwgdGhpcy5icG0gPSBudWxsLCB0aGlzLl90aW1lbGluZS5kaXNwb3NlKCksIHRoaXMuX3RpbWVsaW5lID0gbnVsbCwgdGhpcy5fcmVwZWF0ZWRFdmVudHMuZGlzcG9zZSgpLCB0aGlzLl9yZXBlYXRlZEV2ZW50cyA9IG51bGwsIHRoaXM7XG4gICAgfTtcbiAgICB2YXIgbiA9IHMuZGVmYXVsdC5UcmFuc3BvcnQ7XG4gICAgcy5kZWZhdWx0LlRyYW5zcG9ydCA9IG5ldyBuKCksIHMuZGVmYXVsdC5Db250ZXh0Lm9uKFwiaW5pdFwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgdC50cmFuc3BvcnQgJiYgdC50cmFuc3BvcnQuaXNUcmFuc3BvcnQgPyBzLmRlZmF1bHQuVHJhbnNwb3J0ID0gdC50cmFuc3BvcnQgOiBzLmRlZmF1bHQuVHJhbnNwb3J0ID0gbmV3IG4oKTtcbiAgICB9KSwgcy5kZWZhdWx0LkNvbnRleHQub24oXCJjbG9zZVwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgdC50cmFuc3BvcnQgJiYgdC50cmFuc3BvcnQuaXNUcmFuc3BvcnQgJiYgdC50cmFuc3BvcnQuZGlzcG9zZSgpO1xuICAgIH0pLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuVHJhbnNwb3J0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIpLCBpKDYpLCBpKDE2KSwgaSg2NCk7XG4gICAgcy5kZWZhdWx0Lk9zY2lsbGF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiLCBcInR5cGVcIl0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yKTtcbiAgICAgIHMuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLCB0KSwgdGhpcy5fb3NjaWxsYXRvciA9IG51bGwsIHRoaXMuZnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5mcmVxdWVuY3ksIHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksIHRoaXMuZGV0dW5lID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXR1bmUsIHMuZGVmYXVsdC5UeXBlLkNlbnRzKSwgdGhpcy5fd2F2ZSA9IG51bGwsIHRoaXMuX3BhcnRpYWxzID0gdC5wYXJ0aWFscywgdGhpcy5fcGFydGlhbENvdW50ID0gdC5wYXJ0aWFsQ291bnQsIHRoaXMuX3BoYXNlID0gdC5waGFzZSwgdGhpcy5fdHlwZSA9IHQudHlwZSwgdC5wYXJ0aWFsQ291bnQgJiYgdC50eXBlICE9PSBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbSAmJiAodGhpcy5fdHlwZSA9IHRoaXMuYmFzZVR5cGUgKyB0LnBhcnRpYWxDb3VudC50b1N0cmluZygpKSwgdGhpcy5waGFzZSA9IHRoaXMuX3BoYXNlLCB0aGlzLl9yZWFkT25seShbXCJmcmVxdWVuY3lcIiwgXCJkZXR1bmVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk9zY2lsbGF0b3IsIHMuZGVmYXVsdC5Tb3VyY2UpLCBzLmRlZmF1bHQuT3NjaWxsYXRvci5kZWZhdWx0cyA9IHtcbiAgICAgIHR5cGU6IFwic2luZVwiLFxuICAgICAgZnJlcXVlbmN5OiA0NDAsXG4gICAgICBkZXR1bmU6IDAsXG4gICAgICBwaGFzZTogMCxcbiAgICAgIHBhcnRpYWxzOiBbXSxcbiAgICAgIHBhcnRpYWxDb3VudDogMFxuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUgPSB7XG4gICAgICBTaW5lOiBcInNpbmVcIixcbiAgICAgIFRyaWFuZ2xlOiBcInRyaWFuZ2xlXCIsXG4gICAgICBTYXd0b290aDogXCJzYXd0b290aFwiLFxuICAgICAgU3F1YXJlOiBcInNxdWFyZVwiLFxuICAgICAgQ3VzdG9tOiBcImN1c3RvbVwiXG4gICAgfSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLmxvZyhcInN0YXJ0XCIsIHQpO1xuICAgICAgdmFyIGUgPSBuZXcgcy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlKCk7XG4gICAgICB0aGlzLl9vc2NpbGxhdG9yID0gZSwgdGhpcy5fd2F2ZSA/IHRoaXMuX29zY2lsbGF0b3Iuc2V0UGVyaW9kaWNXYXZlKHRoaXMuX3dhdmUpIDogdGhpcy5fb3NjaWxsYXRvci50eXBlID0gdGhpcy5fdHlwZSwgdGhpcy5fb3NjaWxsYXRvci5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSksIHRoaXMuZGV0dW5lLmNvbm5lY3QodGhpcy5fb3NjaWxsYXRvci5kZXR1bmUpLCB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX29zY2lsbGF0b3Iuc3RhcnQodCk7XG4gICAgfSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLl9zdG9wID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLmxvZyhcInN0b3BcIiwgdCksIHRoaXMuX29zY2lsbGF0b3IgJiYgKHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fb3NjaWxsYXRvci5zdG9wKHQpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUucmVzdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvciAmJiB0aGlzLl9vc2NpbGxhdG9yLmNhbmNlbFN0b3AoKSwgdGhpcy5fc3RhdGUuY2FuY2VsKHRoaXMudG9TZWNvbmRzKHQpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUuc3luY0ZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0LnN5bmNTaWduYWwodGhpcy5mcmVxdWVuY3kpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS51bnN5bmNGcmVxdWVuY3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlRyYW5zcG9ydC51bnN5bmNTaWduYWwodGhpcy5mcmVxdWVuY3kpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IFtzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLlNpbmUsIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU3F1YXJlLCBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLlRyaWFuZ2xlLCBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLlNhd3Rvb3RoXS5pbmNsdWRlcyh0KTtcbiAgICAgICAgaWYgKDAgPT09IHRoaXMuX3BoYXNlICYmIGUpIHRoaXMuX3dhdmUgPSBudWxsLCB0aGlzLl9wYXJ0aWFsQ291bnQgPSAwLCBudWxsICE9PSB0aGlzLl9vc2NpbGxhdG9yICYmICh0aGlzLl9vc2NpbGxhdG9yLnR5cGUgPSB0KTtlbHNlIHtcbiAgICAgICAgICB2YXIgaSA9IHRoaXMuX2dldFJlYWxJbWFnaW5hcnkodCwgdGhpcy5fcGhhc2UpLFxuICAgICAgICAgICAgICBuID0gdGhpcy5jb250ZXh0LmNyZWF0ZVBlcmlvZGljV2F2ZShpWzBdLCBpWzFdKTtcblxuICAgICAgICAgIHRoaXMuX3dhdmUgPSBuLCBudWxsICE9PSB0aGlzLl9vc2NpbGxhdG9yICYmIHRoaXMuX29zY2lsbGF0b3Iuc2V0UGVyaW9kaWNXYXZlKHRoaXMuX3dhdmUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3R5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLCBcImJhc2VUeXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZS5yZXBsYWNlKHRoaXMucGFydGlhbENvdW50LCBcIlwiKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMucGFydGlhbENvdW50ICYmIHRoaXMuX3R5cGUgIT09IHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tICYmIHQgIT09IHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tID8gdGhpcy50eXBlID0gdCArIHRoaXMucGFydGlhbENvdW50IDogdGhpcy50eXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwYXJ0aWFsQ291bnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXJ0aWFsQ291bnQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHRoaXMuX3R5cGUsXG4gICAgICAgICAgICBpID0gL14oc2luZXx0cmlhbmdsZXxzcXVhcmV8c2F3dG9vdGgpKFxcZCspJC8uZXhlYyh0aGlzLl90eXBlKTtcbiAgICAgICAgaSAmJiAoZSA9IGlbMV0pLCB0aGlzLl90eXBlICE9PSBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbSAmJiAodGhpcy50eXBlID0gMCA9PT0gdCA/IGUgOiBlICsgdC50b1N0cmluZygpKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LnByb3RvdHlwZS5nZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiB0LnR5cGUgIT09IHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tICYmIGRlbGV0ZSB0LnBhcnRpYWxzLCB0O1xuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5fZ2V0UmVhbEltYWdpbmFyeSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB2YXIgaSA9IDIwNDgsXG4gICAgICAgICAgbiA9IG5ldyBGbG9hdDMyQXJyYXkoaSksXG4gICAgICAgICAgbyA9IG5ldyBGbG9hdDMyQXJyYXkoaSksXG4gICAgICAgICAgYSA9IDE7XG4gICAgICBpZiAodCA9PT0gcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5DdXN0b20pIGEgPSB0aGlzLl9wYXJ0aWFscy5sZW5ndGggKyAxLCB0aGlzLl9wYXJ0aWFsQ291bnQgPSB0aGlzLl9wYXJ0aWFscy5sZW5ndGgsIGkgPSBhO2Vsc2Uge1xuICAgICAgICB2YXIgciA9IC9eKHNpbmV8dHJpYW5nbGV8c3F1YXJlfHNhd3Rvb3RoKShcXGQrKSQvLmV4ZWModCk7XG4gICAgICAgIHIgPyAoYSA9IHBhcnNlSW50KHJbMl0pICsgMSwgdGhpcy5fcGFydGlhbENvdW50ID0gcGFyc2VJbnQoclsyXSksIHQgPSByWzFdLCBpID0gYSA9IE1hdGgubWF4KGEsIDIpKSA6IHRoaXMuX3BhcnRpYWxDb3VudCA9IDAsIHRoaXMuX3BhcnRpYWxzID0gW107XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGwgPSAxOyBsIDwgaTsgKytsKSB7XG4gICAgICAgIHZhciB1LFxuICAgICAgICAgICAgZCA9IDIgLyAobCAqIE1hdGguUEkpO1xuXG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2Ugcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5TaW5lOlxuICAgICAgICAgICAgdSA9IGwgPD0gYSA/IDEgOiAwLCB0aGlzLl9wYXJ0aWFsc1tsIC0gMV0gPSB1O1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU3F1YXJlOlxuICAgICAgICAgICAgdSA9IDEgJiBsID8gMiAqIGQgOiAwLCB0aGlzLl9wYXJ0aWFsc1tsIC0gMV0gPSB1O1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU2F3dG9vdGg6XG4gICAgICAgICAgICB1ID0gZCAqICgxICYgbCA/IDEgOiAtMSksIHRoaXMuX3BhcnRpYWxzW2wgLSAxXSA9IHU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2Ugcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5UcmlhbmdsZTpcbiAgICAgICAgICAgIHUgPSAxICYgbCA/IGQgKiBkICogMiAqIChsIC0gMSA+PiAxICYgMSA/IC0xIDogMSkgOiAwLCB0aGlzLl9wYXJ0aWFsc1tsIC0gMV0gPSB1O1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tOlxuICAgICAgICAgICAgdSA9IHRoaXMuX3BhcnRpYWxzW2wgLSAxXTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJUb25lLk9zY2lsbGF0b3I6IGludmFsaWQgdHlwZTogXCIgKyB0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIDAgIT09IHUgPyAobltsXSA9IC11ICogTWF0aC5zaW4oZSAqIGwpLCBvW2xdID0gdSAqIE1hdGguY29zKGUgKiBsKSkgOiAobltsXSA9IDAsIG9bbF0gPSAwKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFtuLCBvXTtcbiAgICB9LCBzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUuX2ludmVyc2VGRlQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgZm9yICh2YXIgcyA9IDAsIG4gPSB0Lmxlbmd0aCwgbyA9IDA7IG8gPCBuOyBvKyspIHMgKz0gdFtvXSAqIE1hdGguY29zKG8gKiBpKSArIGVbb10gKiBNYXRoLnNpbihvICogaSk7XG5cbiAgICAgIHJldHVybiBzO1xuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5fZ2V0SW5pdGlhbFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgdCA9IHRoaXMuX2dldFJlYWxJbWFnaW5hcnkodGhpcy5fdHlwZSwgMCksIGUgPSB0WzBdLCBpID0gdFsxXSwgcyA9IDAsIG4gPSAyICogTWF0aC5QSSwgbyA9IDA7IG8gPCA4OyBvKyspIHMgPSBNYXRoLm1heCh0aGlzLl9pbnZlcnNlRkZUKGUsIGksIG8gLyA4ICogbiksIHMpO1xuXG4gICAgICByZXR1cm4gLXRoaXMuX2ludmVyc2VGRlQoZSwgaSwgdGhpcy5fcGhhc2UpIC8gcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBhcnRpYWxzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFydGlhbHM7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wYXJ0aWFscyA9IHQsIHRoaXMudHlwZSA9IHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBoYXNlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGhhc2UgKiAoMTgwIC8gTWF0aC5QSSk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9waGFzZSA9IHQgKiBNYXRoLlBJIC8gMTgwLCB0aGlzLnR5cGUgPSB0aGlzLl90eXBlO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIG51bGwgIT09IHRoaXMuX29zY2lsbGF0b3IgJiYgKHRoaXMuX29zY2lsbGF0b3IuZGlzcG9zZSgpLCB0aGlzLl9vc2NpbGxhdG9yID0gbnVsbCksIHRoaXMuX3dhdmUgPSBudWxsLCB0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIiwgXCJkZXR1bmVcIl0pLCB0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5kZXR1bmUuZGlzcG9zZSgpLCB0aGlzLmRldHVuZSA9IG51bGwsIHRoaXMuX3BhcnRpYWxzID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuT3NjaWxsYXRvcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxNCksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkRlbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJkZWxheVRpbWVcIiwgXCJtYXhEZWxheVwiXSwgcy5kZWZhdWx0LkRlbGF5KTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLCB0KSwgdGhpcy5fbWF4RGVsYXkgPSBNYXRoLm1heCh0aGlzLnRvU2Vjb25kcyh0Lm1heERlbGF5KSwgdGhpcy50b1NlY29uZHModC5kZWxheVRpbWUpKSwgdGhpcy5fZGVsYXlOb2RlID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gdGhpcy5jb250ZXh0LmNyZWF0ZURlbGF5KHRoaXMuX21heERlbGF5KSwgdGhpcy5kZWxheVRpbWUgPSBuZXcgcy5kZWZhdWx0LlBhcmFtKHtcbiAgICAgICAgcGFyYW06IHRoaXMuX2RlbGF5Tm9kZS5kZWxheVRpbWUsXG4gICAgICAgIHVuaXRzOiBzLmRlZmF1bHQuVHlwZS5UaW1lLFxuICAgICAgICB2YWx1ZTogdC5kZWxheVRpbWVcbiAgICAgIH0pLCB0aGlzLl9yZWFkT25seShcImRlbGF5VGltZVwiKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5EZWxheSwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5EZWxheS5kZWZhdWx0cyA9IHtcbiAgICAgIG1heERlbGF5OiAxLFxuICAgICAgZGVsYXlUaW1lOiAwXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5EZWxheS5wcm90b3R5cGUsIFwibWF4RGVsYXlcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXhEZWxheTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkRlbGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZGVsYXlOb2RlLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZGVsYXlOb2RlID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoXCJkZWxheVRpbWVcIiksIHRoaXMuZGVsYXlUaW1lID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRGVsYXk7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LlNwbGl0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCAyKSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLmNyZWF0ZUluc091dHMoMCwgdCksIHRoaXMuX3NwbGl0dGVyID0gdGhpcy5pbnB1dCA9IHRoaXMuY29udGV4dC5jcmVhdGVDaGFubmVsU3BsaXR0ZXIodCk7XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdDsgZSsrKSB0aGlzLm91dHB1dFtlXSA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9zcGxpdHRlciwgdGhpcy5vdXRwdXRbZV0sIGUsIDApLCB0aGlzLm91dHB1dFtlXS5jaGFubmVsQ291bnQgPSAxLCB0aGlzLm91dHB1dFtlXS5jaGFubmVsQ291bnRNb2RlID0gXCJleHBsaWNpdFwiO1xuXG4gICAgICB0aGlzLmxlZnQgPSB0aGlzLm91dHB1dFswXSwgdGhpcy5yaWdodCA9IHRoaXMub3V0cHV0WzFdO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNwbGl0LCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlNwbGl0LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMub3V0cHV0LmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdC5kaXNwb3NlKCk7XG4gICAgICB9KSwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9zcGxpdHRlci5kaXNjb25uZWN0KCksIHRoaXMubGVmdCA9IG51bGwsIHRoaXMucmlnaHQgPSBudWxsLCB0aGlzLl9zcGxpdHRlciA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlNwbGl0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKSxcbiAgICAgICAgbiA9IChpKDM1KSwgaSgyNCksIGkoNDQpLCBbXCJiYXNlTGF0ZW5jeVwiLCBcImRlc3RpbmF0aW9uXCIsIFwiY3VycmVudFRpbWVcIiwgXCJzYW1wbGVSYXRlXCIsIFwibGlzdGVuZXJcIiwgXCJzdGF0ZVwiXSksXG4gICAgICAgIG8gPSBbXCJzdXNwZW5kXCIsIFwiY2xvc2VcIiwgXCJyZXN1bWVcIiwgXCJnZXRPdXRwdXRUaW1lc3RhbXBcIiwgXCJjcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2VcIiwgXCJjcmVhdGVNZWRpYVN0cmVhbVNvdXJjZVwiLCBcImNyZWF0ZU1lZGlhU3RyZWFtRGVzdGluYXRpb25cIiwgXCJjcmVhdGVCdWZmZXJcIiwgXCJkZWNvZGVBdWRpb0RhdGFcIiwgXCJjcmVhdGVCdWZmZXJTb3VyY2VcIiwgXCJjcmVhdGVDb25zdGFudFNvdXJjZVwiLCBcImNyZWF0ZUdhaW5cIiwgXCJjcmVhdGVEZWxheVwiLCBcImNyZWF0ZUJpcXVhZEZpbHRlclwiLCBcImNyZWF0ZUlJUkZpbHRlclwiLCBcImNyZWF0ZVdhdmVTaGFwZXJcIiwgXCJjcmVhdGVQYW5uZXJcIiwgXCJjcmVhdGVDb252b2x2ZXJcIiwgXCJjcmVhdGVEeW5hbWljc0NvbXByZXNzb3JcIiwgXCJjcmVhdGVBbmFseXNlclwiLCBcImNyZWF0ZVNjcmlwdFByb2Nlc3NvclwiLCBcImNyZWF0ZVN0ZXJlb1Bhbm5lclwiLCBcImNyZWF0ZU9zY2lsbGF0b3JcIiwgXCJjcmVhdGVQZXJpb2RpY1dhdmVcIiwgXCJjcmVhdGVDaGFubmVsU3BsaXR0ZXJcIiwgXCJjcmVhdGVDaGFubmVsTWVyZ2VyXCIsIFwiYXVkaW9Xb3JrbGV0XCJdO1xuICAgIHMuZGVmYXVsdC5Db250ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkVtaXR0ZXIuY2FsbCh0aGlzKTtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiY29udGV4dFwiXSwgcy5kZWZhdWx0LkNvbnRleHQpO1xuICAgICAgaWYgKCF0LmNvbnRleHQgJiYgKHQuY29udGV4dCA9IG5ldyBzLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dCgpLCAhdC5jb250ZXh0KSkgdGhyb3cgbmV3IEVycm9yKFwiY291bGQgbm90IGNyZWF0ZSBBdWRpb0NvbnRleHQuIFBvc3NpYmx5IHRvbyBtYW55IEF1ZGlvQ29udGV4dHMgcnVubmluZyBhbHJlYWR5LlwiKTtcblxuICAgICAgZm9yICh0aGlzLl9jb250ZXh0ID0gdC5jb250ZXh0OyB0aGlzLl9jb250ZXh0LnJhd0NvbnRleHQ7KSB0aGlzLl9jb250ZXh0ID0gdGhpcy5fY29udGV4dC5yYXdDb250ZXh0O1xuXG4gICAgICBuLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZGVmaW5lUHJvcGVydHkodGhpcy5fY29udGV4dCwgdCk7XG4gICAgICB9LmJpbmQodGhpcykpLCBvLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZGVmaW5lTWV0aG9kKHRoaXMuX2NvbnRleHQsIHQpO1xuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcy5fbGF0ZW5jeUhpbnQgPSB0LmxhdGVuY3lIaW50LCB0aGlzLl9jb25zdGFudHMgPSB7fSwgdGhpcy5sb29rQWhlYWQgPSB0Lmxvb2tBaGVhZCwgdGhpcy5fY29tcHV0ZWRVcGRhdGVJbnRlcnZhbCA9IDAsIHRoaXMuX3RpY2tlciA9IG5ldyBhKHRoaXMuZW1pdC5iaW5kKHRoaXMsIFwidGlja1wiKSwgdC5jbG9ja1NvdXJjZSwgdC51cGRhdGVJbnRlcnZhbCksIHRoaXMuX3RpbWVvdXRzID0gbmV3IHMuZGVmYXVsdC5UaW1lbGluZSgpLCB0aGlzLl90aW1lb3V0SWRzID0gMCwgdGhpcy5vbihcInRpY2tcIiwgdGhpcy5fdGltZW91dExvb3AuYmluZCh0aGlzKSksIHRoaXMuX2NvbnRleHQub25zdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuZW1pdChcInN0YXRlY2hhbmdlXCIsIHQpO1xuICAgICAgfS5iaW5kKHRoaXMpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkNvbnRleHQsIHMuZGVmYXVsdC5FbWl0dGVyKSwgcy5kZWZhdWx0LkVtaXR0ZXIubWl4aW4ocy5kZWZhdWx0LkNvbnRleHQpLCBzLmRlZmF1bHQuQ29udGV4dC5kZWZhdWx0cyA9IHtcbiAgICAgIGNsb2NrU291cmNlOiBcIndvcmtlclwiLFxuICAgICAgbGF0ZW5jeUhpbnQ6IFwiaW50ZXJhY3RpdmVcIixcbiAgICAgIGxvb2tBaGVhZDogLjEsXG4gICAgICB1cGRhdGVJbnRlcnZhbDogLjAzXG4gICAgfSwgcy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmlzQ29udGV4dCA9ICEwLCBzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuX2RlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHMuZGVmYXVsdC5pc1VuZGVmKHRoaXNbZV0pICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBlLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB0W2VdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgdFtlXSA9IGk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sIHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5fZGVmaW5lTWV0aG9kID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHMuZGVmYXVsdC5pc1VuZGVmKHRoaXNbZV0pICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBlLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB0W2VdLmJpbmQodCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sIHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5ub3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY29udGV4dC5jdXJyZW50VGltZSArIHRoaXMubG9va0FoZWFkO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUsIFwiZGVzdGluYXRpb25cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hc3RlciA/IHRoaXMubWFzdGVyIDogdGhpcy5fY29udGV4dC5kZXN0aW5hdGlvbjtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBcInN1c3BlbmRlZFwiID09PSB0aGlzLl9jb250ZXh0LnN0YXRlICYmIHRoaXMuX2NvbnRleHQgaW5zdGFuY2VvZiBBdWRpb0NvbnRleHQgPyB0aGlzLl9jb250ZXh0LnJlc3VtZSgpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSwgcy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIHJldHVybiB0aGlzICE9PSBzLmRlZmF1bHQuZ2xvYmFsLlRPTkVfQVVESU9fQ09OVEVYVCAmJiAodCA9IHRoaXMucmF3Q29udGV4dC5jbG9zZSgpKSwgdC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcy5kZWZhdWx0LkNvbnRleHQuZW1pdChcImNsb3NlXCIsIHRoaXMpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LCBzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuZ2V0Q29uc3RhbnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHRoaXMuX2NvbnN0YW50c1t0XSkgcmV0dXJuIHRoaXMuX2NvbnN0YW50c1t0XTtcblxuICAgICAgZm9yICh2YXIgZSA9IHRoaXMuX2NvbnRleHQuY3JlYXRlQnVmZmVyKDEsIDEyOCwgdGhpcy5fY29udGV4dC5zYW1wbGVSYXRlKSwgaSA9IGUuZ2V0Q2hhbm5lbERhdGEoMCksIHMgPSAwOyBzIDwgaS5sZW5ndGg7IHMrKykgaVtzXSA9IHQ7XG5cbiAgICAgIHZhciBuID0gdGhpcy5fY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcblxuICAgICAgcmV0dXJuIG4uY2hhbm5lbENvdW50ID0gMSwgbi5jaGFubmVsQ291bnRNb2RlID0gXCJleHBsaWNpdFwiLCBuLmJ1ZmZlciA9IGUsIG4ubG9vcCA9ICEwLCBuLnN0YXJ0KDApLCB0aGlzLl9jb25zdGFudHNbdF0gPSBuLCBuO1xuICAgIH0sIHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5fdGltZW91dExvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciB0ID0gdGhpcy5ub3coKTsgdGhpcy5fdGltZW91dHMgJiYgdGhpcy5fdGltZW91dHMubGVuZ3RoICYmIHRoaXMuX3RpbWVvdXRzLnBlZWsoKS50aW1lIDw9IHQ7KSB0aGlzLl90aW1lb3V0cy5zaGlmdCgpLmNhbGxiYWNrKCk7XG4gICAgfSwgcy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLnNldFRpbWVvdXQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdGhpcy5fdGltZW91dElkcysrO1xuICAgICAgdmFyIGkgPSB0aGlzLm5vdygpO1xuICAgICAgcmV0dXJuIHRoaXMuX3RpbWVvdXRzLmFkZCh7XG4gICAgICAgIGNhbGxiYWNrOiB0LFxuICAgICAgICB0aW1lOiBpICsgZSxcbiAgICAgICAgaWQ6IHRoaXMuX3RpbWVvdXRJZHNcbiAgICAgIH0pLCB0aGlzLl90aW1lb3V0SWRzO1xuICAgIH0sIHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5jbGVhclRpbWVvdXQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RpbWVvdXRzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5pZCA9PT0gdCAmJiB0aGlzLnJlbW92ZShlKTtcbiAgICAgIH0pLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUsIFwidXBkYXRlSW50ZXJ2YWxcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aWNrZXIudXBkYXRlSW50ZXJ2YWw7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl90aWNrZXIudXBkYXRlSW50ZXJ2YWwgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLCBcInJhd0NvbnRleHRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLCBcImNsb2NrU291cmNlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGlja2VyLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl90aWNrZXIudHlwZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUsIFwibGF0ZW5jeUhpbnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXRlbmN5SGludDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gdDtcbiAgICAgICAgaWYgKHRoaXMuX2xhdGVuY3lIaW50ID0gdCwgcy5kZWZhdWx0LmlzU3RyaW5nKHQpKSBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICBjYXNlIFwiaW50ZXJhY3RpdmVcIjpcbiAgICAgICAgICAgIGUgPSAuMSwgdGhpcy5fY29udGV4dC5sYXRlbmN5SGludCA9IHQ7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJwbGF5YmFja1wiOlxuICAgICAgICAgICAgZSA9IC44LCB0aGlzLl9jb250ZXh0LmxhdGVuY3lIaW50ID0gdDtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcImJhbGFuY2VkXCI6XG4gICAgICAgICAgICBlID0gLjI1LCB0aGlzLl9jb250ZXh0LmxhdGVuY3lIaW50ID0gdDtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcImZhc3Rlc3RcIjpcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQubGF0ZW5jeUhpbnQgPSBcImludGVyYWN0aXZlXCIsIGUgPSAuMDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb29rQWhlYWQgPSBlLCB0aGlzLnVwZGF0ZUludGVydmFsID0gZSAvIDM7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgdCBpbiBzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl90aWNrZXIuZGlzcG9zZSgpLCB0aGlzLl90aWNrZXIgPSBudWxsLCB0aGlzLl90aW1lb3V0cy5kaXNwb3NlKCksIHRoaXMuX3RpbWVvdXRzID0gbnVsbCwgdGhpcy5fY29uc3RhbnRzKSB0aGlzLl9jb25zdGFudHNbdF0uZGlzY29ubmVjdCgpO1xuXG4gICAgICAgIHRoaXMuX2NvbnN0YW50cyA9IG51bGw7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH07XG5cbiAgICB2YXIgYSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICB0aGlzLl90eXBlID0gZSwgdGhpcy5fdXBkYXRlSW50ZXJ2YWwgPSBpLCB0aGlzLl9jYWxsYmFjayA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHMuZGVmYXVsdC5ub09wKSwgdGhpcy5fY3JlYXRlQ2xvY2soKTtcbiAgICB9O1xuXG4gICAgaWYgKGEuVHlwZSA9IHtcbiAgICAgIFdvcmtlcjogXCJ3b3JrZXJcIixcbiAgICAgIFRpbWVvdXQ6IFwidGltZW91dFwiLFxuICAgICAgT2ZmbGluZTogXCJvZmZsaW5lXCJcbiAgICB9LCBhLnByb3RvdHlwZS5fY3JlYXRlV29ya2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0Lmdsb2JhbC5VUkwgPSBzLmRlZmF1bHQuZ2xvYmFsLlVSTCB8fCBzLmRlZmF1bHQuZ2xvYmFsLndlYmtpdFVSTDtcbiAgICAgIHZhciB0ID0gbmV3IEJsb2IoW1widmFyIHRpbWVvdXRUaW1lID0gXCIgKyAoMWUzICogdGhpcy5fdXBkYXRlSW50ZXJ2YWwpLnRvRml4ZWQoMSkgKyBcIjtzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKG1zZyl7XFx0dGltZW91dFRpbWUgPSBwYXJzZUludChtc2cuZGF0YSk7fTtmdW5jdGlvbiB0aWNrKCl7XFx0c2V0VGltZW91dCh0aWNrLCB0aW1lb3V0VGltZSk7XFx0c2VsZi5wb3N0TWVzc2FnZSgndGljaycpO310aWNrKCk7XCJdKSxcbiAgICAgICAgICBlID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh0KSxcbiAgICAgICAgICBpID0gbmV3IFdvcmtlcihlKTtcbiAgICAgIGkub25tZXNzYWdlID0gdGhpcy5fY2FsbGJhY2suYmluZCh0aGlzKSwgdGhpcy5fd29ya2VyID0gaTtcbiAgICB9LCBhLnByb3RvdHlwZS5fY3JlYXRlVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlVGltZW91dCgpLCB0aGlzLl9jYWxsYmFjaygpO1xuICAgICAgfS5iaW5kKHRoaXMpLCAxZTMgKiB0aGlzLl91cGRhdGVJbnRlcnZhbCk7XG4gICAgfSwgYS5wcm90b3R5cGUuX2NyZWF0ZUNsb2NrID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMuX3R5cGUgPT09IGEuVHlwZS5Xb3JrZXIpIHRyeSB7XG4gICAgICAgIHRoaXMuX2NyZWF0ZVdvcmtlcigpO1xuICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICB0aGlzLl90eXBlID0gYS5UeXBlLlRpbWVvdXQsIHRoaXMuX2NyZWF0ZUNsb2NrKCk7XG4gICAgICB9IGVsc2UgdGhpcy5fdHlwZSA9PT0gYS5UeXBlLlRpbWVvdXQgJiYgdGhpcy5fY3JlYXRlVGltZW91dCgpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLnByb3RvdHlwZSwgXCJ1cGRhdGVJbnRlcnZhbFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUludGVydmFsO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlSW50ZXJ2YWwgPSBNYXRoLm1heCh0LCAxMjggLyA0NDEwMCksIHRoaXMuX3R5cGUgPT09IGEuVHlwZS5Xb3JrZXIgJiYgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKE1hdGgubWF4KDFlMyAqIHQsIDEpKTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZGlzcG9zZUNsb2NrKCksIHRoaXMuX3R5cGUgPSB0LCB0aGlzLl9jcmVhdGVDbG9jaygpO1xuICAgICAgfVxuICAgIH0pLCBhLnByb3RvdHlwZS5fZGlzcG9zZUNsb2NrID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fdGltZW91dCAmJiAoY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpLCB0aGlzLl90aW1lb3V0ID0gbnVsbCksIHRoaXMuX3dvcmtlciAmJiAodGhpcy5fd29ya2VyLnRlcm1pbmF0ZSgpLCB0aGlzLl93b3JrZXIub25tZXNzYWdlID0gbnVsbCwgdGhpcy5fd29ya2VyID0gbnVsbCk7XG4gICAgfSwgYS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2Rpc3Bvc2VDbG9jaygpLCB0aGlzLl9jYWxsYmFjayA9IG51bGw7XG4gICAgfSwgcy5kZWZhdWx0LnN1cHBvcnRlZCAmJiAhcy5kZWZhdWx0LmluaXRpYWxpemVkKSB7XG4gICAgICBpZiAocy5kZWZhdWx0Lmdsb2JhbC5UT05FX0FVRElPX0NPTlRFWFQgfHwgKHMuZGVmYXVsdC5nbG9iYWwuVE9ORV9BVURJT19DT05URVhUID0gbmV3IHMuZGVmYXVsdC5Db250ZXh0KCkpLCBzLmRlZmF1bHQuY29udGV4dCA9IHMuZGVmYXVsdC5nbG9iYWwuVE9ORV9BVURJT19DT05URVhULCAhcy5kZWZhdWx0Lmdsb2JhbC5UT05FX1NJTEVOQ0VfTE9HR0lORykge1xuICAgICAgICB2YXIgciA9IFwidlwiO1xuICAgICAgICBcImRldlwiID09PSBzLmRlZmF1bHQudmVyc2lvbiAmJiAociA9IFwiXCIpO1xuICAgICAgICB2YXIgbCA9IFwiICogVG9uZS5qcyBcIiArIHIgKyBzLmRlZmF1bHQudmVyc2lvbiArIFwiICogXCI7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiJWNcIiArIGwsIFwiYmFja2dyb3VuZDogIzAwMDsgY29sb3I6ICNmZmZcIik7XG4gICAgICB9XG4gICAgfSBlbHNlIHMuZGVmYXVsdC5zdXBwb3J0ZWQgfHwgcy5kZWZhdWx0Lmdsb2JhbC5UT05FX1NJTEVOQ0VfTE9HR0lORyB8fCBjb25zb2xlLndhcm4oXCJUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBUb25lLmpzXCIpO1xuXG4gICAgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkNvbnRleHQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNCksIGkoNDApO1xuICAgIHMuZGVmYXVsdC5JbnN0cnVtZW50ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5kZWZhdWx0cyksIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5fdm9sdW1lID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlZvbHVtZSh0LnZvbHVtZSksIHRoaXMudm9sdW1lID0gdGhpcy5fdm9sdW1lLnZvbHVtZSwgdGhpcy5fcmVhZE9ubHkoXCJ2b2x1bWVcIiksIHRoaXMuX3NjaGVkdWxlZEV2ZW50cyA9IFtdO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lkluc3RydW1lbnQsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5kZWZhdWx0cyA9IHtcbiAgICAgIHZvbHVtZTogMFxuICAgIH0sIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrID0gcy5kZWZhdWx0Lm5vT3AsIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS50cmlnZ2VyUmVsZWFzZSA9IHMuZGVmYXVsdC5ub09wLCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLCAxKSwgdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsIDApLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5fc3luY01ldGhvZCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB2YXIgaSA9IHRoaXNbXCJfb3JpZ2luYWxfXCIgKyB0XSA9IHRoaXNbdF07XG5cbiAgICAgIHRoaXNbdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSxcbiAgICAgICAgICAgIG4gPSB0W2VdLFxuICAgICAgICAgICAgbyA9IHMuZGVmYXVsdC5UcmFuc3BvcnQuc2NoZWR1bGUoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICB0W2VdID0gcywgaS5hcHBseSh0aGlzLCB0KTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBuKTtcblxuICAgICAgICB0aGlzLl9zY2hlZHVsZWRFdmVudHMucHVzaChvKTtcbiAgICAgIH0uYmluZCh0aGlzKTtcbiAgICB9LCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUudW5zeW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NjaGVkdWxlZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHMuZGVmYXVsdC5UcmFuc3BvcnQuY2xlYXIodCk7XG4gICAgICB9KSwgdGhpcy5fc2NoZWR1bGVkRXZlbnRzID0gW10sIHRoaXMuX29yaWdpbmFsX3RyaWdnZXJBdHRhY2sgJiYgKHRoaXMudHJpZ2dlckF0dGFjayA9IHRoaXMuX29yaWdpbmFsX3RyaWdnZXJBdHRhY2ssIHRoaXMudHJpZ2dlclJlbGVhc2UgPSB0aGlzLl9vcmlnaW5hbF90cmlnZ2VyUmVsZWFzZSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLnRyaWdnZXJBdHRhY2tSZWxlYXNlID0gZnVuY3Rpb24gKHQsIGUsIGksIHMpIHtcbiAgICAgIHJldHVybiBpID0gdGhpcy50b1NlY29uZHMoaSksIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy50cmlnZ2VyQXR0YWNrKHQsIGksIHMpLCB0aGlzLnRyaWdnZXJSZWxlYXNlKGkgKyBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksIHRoaXMuX3ZvbHVtZSA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcInZvbHVtZVwiXSksIHRoaXMudm9sdW1lID0gbnVsbCwgdGhpcy51bnN5bmMoKSwgdGhpcy5fc2NoZWR1bGVkRXZlbnRzID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuSW5zdHJ1bWVudDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg3KSwgaSgyKTtcbiAgICBzLmRlZmF1bHQuQXVkaW9Ub0dhaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLCB0aGlzLl9ub3JtID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiAodCArIDEpIC8gMjtcbiAgICAgIH0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkF1ZGlvVG9HYWluLCBzLmRlZmF1bHQuU2lnbmFsQmFzZSksIHMuZGVmYXVsdC5BdWRpb1RvR2Fpbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9ub3JtLmRpc3Bvc2UoKSwgdGhpcy5fbm9ybSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkF1ZGlvVG9HYWluO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIpLCBpKDEzKSwgaSg4OSksIGkoMyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkNyb3NzRmFkZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuY3JlYXRlSW5zT3V0cygyLCAxKSwgdGhpcy5hID0gdGhpcy5pbnB1dFswXSA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLmIgPSB0aGlzLmlucHV0WzFdID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuZmFkZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIC41KSwgcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLCB0aGlzLl9lcXVhbFBvd2VyQSA9IG5ldyBzLmRlZmF1bHQuRXF1YWxQb3dlckdhaW4oKSwgdGhpcy5fZXF1YWxQb3dlckIgPSBuZXcgcy5kZWZhdWx0LkVxdWFsUG93ZXJHYWluKCksIHRoaXMuX29uZSA9IHRoaXMuY29udGV4dC5nZXRDb25zdGFudCgxKSwgdGhpcy5faW52ZXJ0ID0gbmV3IHMuZGVmYXVsdC5TdWJ0cmFjdCgpLCB0aGlzLmEuY29ubmVjdCh0aGlzLm91dHB1dCksIHRoaXMuYi5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5mYWRlLmNoYWluKHRoaXMuX2VxdWFsUG93ZXJCLCB0aGlzLmIuZ2FpbiksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX29uZSwgdGhpcy5faW52ZXJ0LCAwLCAwKSwgdGhpcy5mYWRlLmNvbm5lY3QodGhpcy5faW52ZXJ0LCAwLCAxKSwgdGhpcy5faW52ZXJ0LmNoYWluKHRoaXMuX2VxdWFsUG93ZXJBLCB0aGlzLmEuZ2FpbiksIHRoaXMuX3JlYWRPbmx5KFwiZmFkZVwiKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Dcm9zc0ZhZGUsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuQ3Jvc3NGYWRlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoXCJmYWRlXCIpLCB0aGlzLl9lcXVhbFBvd2VyQS5kaXNwb3NlKCksIHRoaXMuX2VxdWFsUG93ZXJBID0gbnVsbCwgdGhpcy5fZXF1YWxQb3dlckIuZGlzcG9zZSgpLCB0aGlzLl9lcXVhbFBvd2VyQiA9IG51bGwsIHRoaXMuZmFkZS5kaXNwb3NlKCksIHRoaXMuZmFkZSA9IG51bGwsIHRoaXMuX2ludmVydC5kaXNwb3NlKCksIHRoaXMuX2ludmVydCA9IG51bGwsIHRoaXMuX29uZSA9IG51bGwsIHRoaXMuYS5kaXNwb3NlKCksIHRoaXMuYSA9IG51bGwsIHRoaXMuYi5kaXNwb3NlKCksIHRoaXMuYiA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkNyb3NzRmFkZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgcy5kZWZhdWx0LlRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJtZW1vcnlcIl0sIHMuZGVmYXVsdC5UaW1lbGluZSk7XG4gICAgICBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy5fdGltZWxpbmUgPSBbXSwgdGhpcy5tZW1vcnkgPSB0Lm1lbW9yeTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UaW1lbGluZSksIHMuZGVmYXVsdC5UaW1lbGluZS5kZWZhdWx0cyA9IHtcbiAgICAgIG1lbW9yeTogMSAvIDBcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aW1lbGluZS5sZW5ndGg7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmIChzLmRlZmF1bHQuaXNVbmRlZih0LnRpbWUpKSB0aHJvdyBuZXcgRXJyb3IoXCJUb25lLlRpbWVsaW5lOiBldmVudHMgbXVzdCBoYXZlIGEgdGltZSBhdHRyaWJ1dGVcIik7XG4gICAgICB0LnRpbWUgPSB0LnRpbWUudmFsdWVPZigpO1xuXG4gICAgICB2YXIgZSA9IHRoaXMuX3NlYXJjaCh0LnRpbWUpO1xuXG4gICAgICBpZiAodGhpcy5fdGltZWxpbmUuc3BsaWNlKGUgKyAxLCAwLCB0KSwgdGhpcy5sZW5ndGggPiB0aGlzLm1lbW9yeSkge1xuICAgICAgICB2YXIgaSA9IHRoaXMubGVuZ3RoIC0gdGhpcy5tZW1vcnk7XG5cbiAgICAgICAgdGhpcy5fdGltZWxpbmUuc3BsaWNlKDAsIGkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRoaXMuX3RpbWVsaW5lLmluZGV4T2YodCk7XG5cbiAgICAgIHJldHVybiAtMSAhPT0gZSAmJiB0aGlzLl90aW1lbGluZS5zcGxpY2UoZSwgMSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIFwidGltZVwiKTtcblxuICAgICAgdmFyIGkgPSB0aGlzLl9zZWFyY2godCwgZSk7XG5cbiAgICAgIHJldHVybiAtMSAhPT0gaSA/IHRoaXMuX3RpbWVsaW5lW2ldIDogbnVsbDtcbiAgICB9LCBzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLnBlZWsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGltZWxpbmVbMF07XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5zaGlmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl90aW1lbGluZS5zaGlmdCgpO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuZ2V0QWZ0ZXIgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIFwidGltZVwiKTtcblxuICAgICAgdmFyIGkgPSB0aGlzLl9zZWFyY2godCwgZSk7XG5cbiAgICAgIHJldHVybiBpICsgMSA8IHRoaXMuX3RpbWVsaW5lLmxlbmd0aCA/IHRoaXMuX3RpbWVsaW5lW2kgKyAxXSA6IG51bGw7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5nZXRCZWZvcmUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIFwidGltZVwiKTtcbiAgICAgIHZhciBpID0gdGhpcy5fdGltZWxpbmUubGVuZ3RoO1xuICAgICAgaWYgKGkgPiAwICYmIHRoaXMuX3RpbWVsaW5lW2kgLSAxXVtlXSA8IHQpIHJldHVybiB0aGlzLl90aW1lbGluZVtpIC0gMV07XG5cbiAgICAgIHZhciBuID0gdGhpcy5fc2VhcmNoKHQsIGUpO1xuXG4gICAgICByZXR1cm4gbiAtIDEgPj0gMCA/IHRoaXMuX3RpbWVsaW5lW24gLSAxXSA6IG51bGw7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHRoaXMuX3RpbWVsaW5lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLl9zZWFyY2godCk7XG5cbiAgICAgICAgaWYgKGUgPj0gMCkge1xuICAgICAgICAgIGlmICh0aGlzLl90aW1lbGluZVtlXS50aW1lID09PSB0KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gZTsgaSA+PSAwICYmIHRoaXMuX3RpbWVsaW5lW2ldLnRpbWUgPT09IHQ7IGktLSkgZSA9IGk7XG5cbiAgICAgICAgICAgIHRoaXMuX3RpbWVsaW5lID0gdGhpcy5fdGltZWxpbmUuc2xpY2UoMCwgZSk7XG4gICAgICAgICAgfSBlbHNlIHRoaXMuX3RpbWVsaW5lID0gdGhpcy5fdGltZWxpbmUuc2xpY2UoMCwgZSArIDEpO1xuICAgICAgICB9IGVsc2UgdGhpcy5fdGltZWxpbmUgPSBbXTtcbiAgICAgIH0gZWxzZSAxID09PSB0aGlzLl90aW1lbGluZS5sZW5ndGggJiYgdGhpcy5fdGltZWxpbmVbMF0udGltZSA+PSB0ICYmICh0aGlzLl90aW1lbGluZSA9IFtdKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5jYW5jZWxCZWZvcmUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSB0aGlzLl9zZWFyY2godCk7XG5cbiAgICAgIHJldHVybiBlID49IDAgJiYgKHRoaXMuX3RpbWVsaW5lID0gdGhpcy5fdGltZWxpbmUuc2xpY2UoZSArIDEpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLnByZXZpb3VzRXZlbnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSB0aGlzLl90aW1lbGluZS5pbmRleE9mKHQpO1xuXG4gICAgICByZXR1cm4gZSA+IDAgPyB0aGlzLl90aW1lbGluZVtlIC0gMV0gOiBudWxsO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuX3NlYXJjaCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAoMCA9PT0gdGhpcy5fdGltZWxpbmUubGVuZ3RoKSByZXR1cm4gLTE7XG4gICAgICBlID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgXCJ0aW1lXCIpO1xuICAgICAgdmFyIGkgPSAwLFxuICAgICAgICAgIG4gPSB0aGlzLl90aW1lbGluZS5sZW5ndGgsXG4gICAgICAgICAgbyA9IG47XG4gICAgICBpZiAobiA+IDAgJiYgdGhpcy5fdGltZWxpbmVbbiAtIDFdW2VdIDw9IHQpIHJldHVybiBuIC0gMTtcblxuICAgICAgZm9yICg7IGkgPCBvOykge1xuICAgICAgICB2YXIgYSA9IE1hdGguZmxvb3IoaSArIChvIC0gaSkgLyAyKSxcbiAgICAgICAgICAgIHIgPSB0aGlzLl90aW1lbGluZVthXSxcbiAgICAgICAgICAgIGwgPSB0aGlzLl90aW1lbGluZVthICsgMV07XG5cbiAgICAgICAgaWYgKHJbZV0gPT09IHQpIHtcbiAgICAgICAgICBmb3IgKHZhciB1ID0gYTsgdSA8IHRoaXMuX3RpbWVsaW5lLmxlbmd0aDsgdSsrKSB7XG4gICAgICAgICAgICB0aGlzLl90aW1lbGluZVt1XVtlXSA9PT0gdCAmJiAoYSA9IHUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJbZV0gPCB0ICYmIGxbZV0gPiB0KSByZXR1cm4gYTtcbiAgICAgICAgcltlXSA+IHQgPyBvID0gYSA6IGkgPSBhICsgMTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIC0xO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuX2l0ZXJhdGUgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIDApLCBpID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoaSwgdGhpcy5fdGltZWxpbmUubGVuZ3RoIC0gMSksIHRoaXMuX3RpbWVsaW5lLnNsaWNlKGUsIGkgKyAxKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHQuY2FsbCh0aGlzLCBlKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pdGVyYXRlKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuZm9yRWFjaEJlZm9yZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB2YXIgaSA9IHRoaXMuX3NlYXJjaCh0KTtcblxuICAgICAgcmV0dXJuIC0xICE9PSBpICYmIHRoaXMuX2l0ZXJhdGUoZSwgMCwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoQWZ0ZXIgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdmFyIGkgPSB0aGlzLl9zZWFyY2godCk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9pdGVyYXRlKGUsIGkgKyAxKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2hCZXR3ZWVuID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fc2VhcmNoKHQpLFxuICAgICAgICAgIG4gPSB0aGlzLl9zZWFyY2goZSk7XG5cbiAgICAgIHJldHVybiAtMSAhPT0gcyAmJiAtMSAhPT0gbiA/ICh0aGlzLl90aW1lbGluZVtzXS50aW1lICE9PSB0ICYmIChzICs9IDEpLCB0aGlzLl90aW1lbGluZVtuXS50aW1lID09PSBlICYmIChuIC09IDEpLCB0aGlzLl9pdGVyYXRlKGksIHMsIG4pKSA6IC0xID09PSBzICYmIHRoaXMuX2l0ZXJhdGUoaSwgMCwgbiksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoRnJvbSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5fc2VhcmNoKHQpOyBpID49IDAgJiYgdGhpcy5fdGltZWxpbmVbaV0udGltZSA+PSB0OykgaS0tO1xuXG4gICAgICByZXR1cm4gdGhpcy5faXRlcmF0ZShlLCBpICsgMSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoQXRUaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHZhciBpID0gdGhpcy5fc2VhcmNoKHQpO1xuXG4gICAgICByZXR1cm4gLTEgIT09IGkgJiYgdGhpcy5faXRlcmF0ZShmdW5jdGlvbiAoaSkge1xuICAgICAgICBpLnRpbWUgPT09IHQgJiYgZS5jYWxsKHRoaXMsIGkpO1xuICAgICAgfSwgMCwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl90aW1lbGluZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlRpbWVsaW5lO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIxKSwgaSgyKTtcbiAgICBzLmRlZmF1bHQuTW9ub3Bob25pYyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0Lk1vbm9waG9uaWMuZGVmYXVsdHMpLCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5jYWxsKHRoaXMsIHQpLCB0aGlzLnBvcnRhbWVudG8gPSB0LnBvcnRhbWVudG87XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTW9ub3Bob25pYywgcy5kZWZhdWx0Lkluc3RydW1lbnQpLCBzLmRlZmF1bHQuTW9ub3Bob25pYy5kZWZhdWx0cyA9IHtcbiAgICAgIHBvcnRhbWVudG86IDBcbiAgICB9LCBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUudHJpZ2dlckF0dGFjayA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gdGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsIHQsIGUsIGkpLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHRoaXMuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayhlLCBpKSwgdGhpcy5zZXROb3RlKHQsIGUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS50cmlnZ2VyUmVsZWFzZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5sb2coXCJ0cmlnZ2VyUmVsZWFzZVwiLCB0KSwgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlQXR0YWNrID0gZnVuY3Rpb24gKCkge30sIHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSA9IGZ1bmN0aW9uICgpIHt9LCBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuZ2V0TGV2ZWxBdFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5lbnZlbG9wZS5nZXRWYWx1ZUF0VGltZSh0KTtcbiAgICB9LCBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuc2V0Tm90ZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAoZSA9IHRoaXMudG9TZWNvbmRzKGUpLCB0aGlzLnBvcnRhbWVudG8gPiAwICYmIHRoaXMuZ2V0TGV2ZWxBdFRpbWUoZSkgPiAuMDUpIHtcbiAgICAgICAgdmFyIGkgPSB0aGlzLnRvU2Vjb25kcyh0aGlzLnBvcnRhbWVudG8pO1xuICAgICAgICB0aGlzLmZyZXF1ZW5jeS5leHBvbmVudGlhbFJhbXBUbyh0LCBpLCBlKTtcbiAgICAgIH0gZWxzZSB0aGlzLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSh0LCBlKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk1vbm9waG9uaWM7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjkpLCBpKDUpLCBpKDIpO1xuICAgIHMuZGVmYXVsdC5TY2FsZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLCB0aGlzLl9vdXRwdXRNaW4gPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCAwKSwgdGhpcy5fb3V0cHV0TWF4ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgMSksIHRoaXMuX3NjYWxlID0gdGhpcy5pbnB1dCA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoMSksIHRoaXMuX2FkZCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5BZGQoMCksIHRoaXMuX3NjYWxlLmNvbm5lY3QodGhpcy5fYWRkKSwgdGhpcy5fc2V0UmFuZ2UoKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TY2FsZSwgcy5kZWZhdWx0LlNpZ25hbEJhc2UpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlLnByb3RvdHlwZSwgXCJtaW5cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vdXRwdXRNaW47XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vdXRwdXRNaW4gPSB0LCB0aGlzLl9zZXRSYW5nZSgpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlLnByb3RvdHlwZSwgXCJtYXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vdXRwdXRNYXg7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vdXRwdXRNYXggPSB0LCB0aGlzLl9zZXRSYW5nZSgpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuU2NhbGUucHJvdG90eXBlLl9zZXRSYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2FkZC52YWx1ZSA9IHRoaXMuX291dHB1dE1pbiwgdGhpcy5fc2NhbGUudmFsdWUgPSB0aGlzLl9vdXRwdXRNYXggLSB0aGlzLl9vdXRwdXRNaW47XG4gICAgfSwgcy5kZWZhdWx0LlNjYWxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2FkZC5kaXNwb3NlKCksIHRoaXMuX2FkZCA9IG51bGwsIHRoaXMuX3NjYWxlLmRpc3Bvc2UoKSwgdGhpcy5fc2NhbGUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5TY2FsZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyKSwgaSgzKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuVm9sdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJ2b2x1bWVcIl0sIHMuZGVmYXVsdC5Wb2x1bWUpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsIHQpLCB0aGlzLm91dHB1dCA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4odC52b2x1bWUsIHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzKSwgdGhpcy5fdW5tdXRlZFZvbHVtZSA9IHQudm9sdW1lLCB0aGlzLnZvbHVtZSA9IHRoaXMub3V0cHV0LmdhaW4sIHRoaXMuX3JlYWRPbmx5KFwidm9sdW1lXCIpLCB0aGlzLm11dGUgPSB0Lm11dGU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVm9sdW1lLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlZvbHVtZS5kZWZhdWx0cyA9IHtcbiAgICAgIHZvbHVtZTogMCxcbiAgICAgIG11dGU6ICExXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Wb2x1bWUucHJvdG90eXBlLCBcIm11dGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZvbHVtZS52YWx1ZSA9PT0gLTEgLyAwO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgIXRoaXMubXV0ZSAmJiB0ID8gKHRoaXMuX3VubXV0ZWRWb2x1bWUgPSB0aGlzLnZvbHVtZS52YWx1ZSwgdGhpcy52b2x1bWUudmFsdWUgPSAtMSAvIDApIDogdGhpcy5tdXRlICYmICF0ICYmICh0aGlzLnZvbHVtZS52YWx1ZSA9IHRoaXMuX3VubXV0ZWRWb2x1bWUpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuVm9sdW1lLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5wdXQuZGlzcG9zZSgpLCBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFwidm9sdW1lXCIpLCB0aGlzLnZvbHVtZS5kaXNwb3NlKCksIHRoaXMudm9sdW1lID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuVm9sdW1lO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDMpLCBpKDMwKTtcbiAgICBzLmRlZmF1bHQuWmVybyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksIHRoaXMuX2dhaW4gPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgcy5kZWZhdWx0LmNvbm5lY3QodGhpcy5jb250ZXh0LmdldENvbnN0YW50KDApLCB0aGlzLl9nYWluKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5aZXJvLCBzLmRlZmF1bHQuU2lnbmFsQmFzZSksIHMuZGVmYXVsdC5aZXJvLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2dhaW4uZGlzcG9zZSgpLCB0aGlzLl9nYWluID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuWmVybztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyKSwgaSgzKTtcbiAgICBzLmRlZmF1bHQuQWRkID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWwuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDIsIDApLCB0aGlzLl9zdW0gPSB0aGlzLmlucHV0WzBdID0gdGhpcy5pbnB1dFsxXSA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuX3BhcmFtID0gdGhpcy5pbnB1dFsxXSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQpLCB0aGlzLl9wYXJhbS5jb25uZWN0KHRoaXMuX3N1bSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQWRkLCBzLmRlZmF1bHQuU2lnbmFsKSwgcy5kZWZhdWx0LkFkZC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3N1bS5kaXNwb3NlKCksIHRoaXMuX3N1bSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkFkZDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxKTtcbiAgICBzLmRlZmF1bHQuU2lnbmFsQmFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TaWduYWxCYXNlLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWwgJiYgcy5kZWZhdWx0LlNpZ25hbCA9PT0gdC5jb25zdHJ1Y3RvciB8fCBzLmRlZmF1bHQuUGFyYW0gJiYgcy5kZWZhdWx0LlBhcmFtID09PSB0LmNvbnN0cnVjdG9yID8gKHQuX3BhcmFtLmNhbmNlbFNjaGVkdWxlZFZhbHVlcygwKSwgdC5fcGFyYW0uc2V0VmFsdWVBdFRpbWUoMCwgMCksIHQub3ZlcnJpZGRlbiA9ICEwKSA6IHQgaW5zdGFuY2VvZiBBdWRpb1BhcmFtICYmICh0LmNhbmNlbFNjaGVkdWxlZFZhbHVlcygwKSwgdC5zZXRWYWx1ZUF0VGltZSgwLCAwKSksIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmNvbm5lY3QuY2FsbCh0aGlzLCB0LCBlLCBpKSwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU2lnbmFsQmFzZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0NyksIGkoMyk7XG4gICAgcy5kZWZhdWx0LkFtcGxpdHVkZUVudmVsb3BlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkVudmVsb3BlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLl9zaWcuY29ubmVjdCh0aGlzLm91dHB1dC5nYWluKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BbXBsaXR1ZGVFbnZlbG9wZSwgcy5kZWZhdWx0LkVudmVsb3BlKSwgcy5kZWZhdWx0LkFtcGxpdHVkZUVudmVsb3BlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5BbXBsaXR1ZGVFbnZlbG9wZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxMSksIGkoNiksIGkoMyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiYnVmZmVyXCIsIFwib25sb2FkXCJdLCBzLmRlZmF1bHQuQnVmZmVyU291cmNlKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLCB0KSwgdGhpcy5vbmVuZGVkID0gdC5vbmVuZGVkLCB0aGlzLl9zdGFydFRpbWUgPSAtMSwgdGhpcy5fc291cmNlU3RhcnRlZCA9ICExLCB0aGlzLl9zb3VyY2VTdG9wcGVkID0gITEsIHRoaXMuX3N0b3BUaW1lID0gLTEsIHRoaXMuX2dhaW5Ob2RlID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oMCksIHRoaXMuX3NvdXJjZSA9IHRoaXMuY29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKSwgcy5kZWZhdWx0LmNvbm5lY3QodGhpcy5fc291cmNlLCB0aGlzLl9nYWluTm9kZSksIHRoaXMuX3NvdXJjZS5vbmVuZGVkID0gdGhpcy5fb25lbmRlZC5iaW5kKHRoaXMpLCB0aGlzLl9idWZmZXIgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcih0LmJ1ZmZlciwgdC5vbmxvYWQpLCB0aGlzLnBsYXliYWNrUmF0ZSA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fc291cmNlLnBsYXliYWNrUmF0ZSxcbiAgICAgICAgdW5pdHM6IHMuZGVmYXVsdC5UeXBlLlBvc2l0aXZlLFxuICAgICAgICB2YWx1ZTogdC5wbGF5YmFja1JhdGVcbiAgICAgIH0pLCB0aGlzLmZhZGVJbiA9IHQuZmFkZUluLCB0aGlzLmZhZGVPdXQgPSB0LmZhZGVPdXQsIHRoaXMuY3VydmUgPSB0LmN1cnZlLCB0aGlzLl9vbmVuZGVkVGltZW91dCA9IC0xLCB0aGlzLmxvb3AgPSB0Lmxvb3AsIHRoaXMubG9vcFN0YXJ0ID0gdC5sb29wU3RhcnQsIHRoaXMubG9vcEVuZCA9IHQubG9vcEVuZDtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuQnVmZmVyU291cmNlLmRlZmF1bHRzID0ge1xuICAgICAgb25lbmRlZDogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBvbmxvYWQ6IHMuZGVmYXVsdC5ub09wLFxuICAgICAgbG9vcDogITEsXG4gICAgICBsb29wU3RhcnQ6IDAsXG4gICAgICBsb29wRW5kOiAwLFxuICAgICAgZmFkZUluOiAwLFxuICAgICAgZmFkZU91dDogMCxcbiAgICAgIGN1cnZlOiBcImxpbmVhclwiLFxuICAgICAgcGxheWJhY2tSYXRlOiAxXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0ZUF0VGltZSh0aGlzLm5vdygpKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUuZ2V0U3RhdGVBdFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgLTEgIT09IHRoaXMuX3N0YXJ0VGltZSAmJiB0aGlzLl9zdGFydFRpbWUgPD0gdCAmJiAoLTEgPT09IHRoaXMuX3N0b3BUaW1lIHx8IHQgPCB0aGlzLl9zdG9wVGltZSkgJiYgIXRoaXMuX3NvdXJjZVN0b3BwZWQgPyBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCA6IHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHQsIGUsIGksIG4pIHtcbiAgICAgIHRoaXMubG9nKFwic3RhcnRcIiwgdCwgZSwgaSwgbiksIHRoaXMuYXNzZXJ0KC0xID09PSB0aGlzLl9zdGFydFRpbWUsIFwiY2FuIG9ubHkgYmUgc3RhcnRlZCBvbmNlXCIpLCB0aGlzLmFzc2VydCh0aGlzLmJ1ZmZlci5sb2FkZWQsIFwiYnVmZmVyIGlzIGVpdGhlciBub3Qgc2V0IG9yIG5vdCBsb2FkZWRcIiksIHRoaXMuYXNzZXJ0KCF0aGlzLl9zb3VyY2VTdG9wcGVkLCBcInNvdXJjZSBpcyBhbHJlYWR5IHN0b3BwZWRcIiksIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgZSA9IHRoaXMubG9vcCA/IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIHRoaXMubG9vcFN0YXJ0KSA6IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIDApLCBlID0gdGhpcy50b1NlY29uZHMoZSksIGUgPSBNYXRoLm1heChlLCAwKSwgbiA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKG4sIDEpO1xuICAgICAgdmFyIG8gPSB0aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVJbik7XG5cbiAgICAgIGlmIChvID4gMCA/ICh0aGlzLl9nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsIHQpLCBcImxpbmVhclwiID09PSB0aGlzLmN1cnZlID8gdGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShuLCB0ICsgbykgOiB0aGlzLl9nYWluTm9kZS5nYWluLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZShuLCB0LCBvKSkgOiB0aGlzLl9nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKG4sIHQpLCB0aGlzLl9zdGFydFRpbWUgPSB0LCBzLmRlZmF1bHQuaXNEZWZpbmVkKGkpKSB7XG4gICAgICAgIHZhciBhID0gdGhpcy50b1NlY29uZHMoaSk7XG4gICAgICAgIGEgPSBNYXRoLm1heChhLCAwKSwgdGhpcy5zdG9wKHQgKyBhKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubG9vcCkge1xuICAgICAgICB2YXIgciA9IHRoaXMubG9vcEVuZCB8fCB0aGlzLmJ1ZmZlci5kdXJhdGlvbixcbiAgICAgICAgICAgIGwgPSB0aGlzLmxvb3BTdGFydDtcbiAgICAgICAgZSA+PSByICYmIChlID0gKGUgLSBsKSAlIChyIC0gbCkgKyBsKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3NvdXJjZS5idWZmZXIgPSB0aGlzLmJ1ZmZlci5nZXQoKSwgdGhpcy5fc291cmNlLmxvb3BFbmQgPSB0aGlzLmxvb3BFbmQgfHwgdGhpcy5idWZmZXIuZHVyYXRpb24sIGUgPCB0aGlzLmJ1ZmZlci5kdXJhdGlvbiAmJiAodGhpcy5fc291cmNlU3RhcnRlZCA9ICEwLCB0aGlzLl9zb3VyY2Uuc3RhcnQodCwgZSkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5sb2coXCJzdG9wXCIsIHQpLCB0aGlzLmFzc2VydCh0aGlzLmJ1ZmZlci5sb2FkZWQsIFwiYnVmZmVyIGlzIGVpdGhlciBub3Qgc2V0IG9yIG5vdCBsb2FkZWRcIiksIHRoaXMuYXNzZXJ0KCF0aGlzLl9zb3VyY2VTdG9wcGVkLCBcInNvdXJjZSBpcyBhbHJlYWR5IHN0b3BwZWRcIiksIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgLTEgIT09IHRoaXMuX3N0b3BUaW1lICYmIHRoaXMuY2FuY2VsU3RvcCgpO1xuICAgICAgdmFyIGUgPSB0aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVPdXQpO1xuICAgICAgcmV0dXJuIHRoaXMuX3N0b3BUaW1lID0gdCArIGUsIGUgPiAwID8gXCJsaW5lYXJcIiA9PT0gdGhpcy5jdXJ2ZSA/IHRoaXMuX2dhaW5Ob2RlLmdhaW4ubGluZWFyUmFtcFRvKDAsIGUsIHQpIDogdGhpcy5fZ2Fpbk5vZGUuZ2Fpbi50YXJnZXRSYW1wVG8oMCwgZSwgdCkgOiAodGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLCB0aGlzLl9nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsIHQpKSwgcy5kZWZhdWx0LmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX29uZW5kZWRUaW1lb3V0KSwgdGhpcy5fb25lbmRlZFRpbWVvdXQgPSBzLmRlZmF1bHQuY29udGV4dC5zZXRUaW1lb3V0KHRoaXMuX29uZW5kZWQuYmluZCh0aGlzKSwgdGhpcy5fc3RvcFRpbWUgLSB0aGlzLm5vdygpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZS5jYW5jZWxTdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKC0xICE9PSB0aGlzLl9zdGFydFRpbWUgJiYgIXRoaXMuX3NvdXJjZVN0b3BwZWQpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVJbik7XG4gICAgICAgIHRoaXMuX2dhaW5Ob2RlLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMuX3N0YXJ0VGltZSArIHQgKyB0aGlzLnNhbXBsZVRpbWUpLCB0aGlzLmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX29uZW5kZWRUaW1lb3V0KSwgdGhpcy5fc3RvcFRpbWUgPSAtMTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUuX29uZW5kZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXRoaXMuX3NvdXJjZVN0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5fc291cmNlU3RvcHBlZCA9ICEwO1xuICAgICAgICB2YXIgdCA9IFwiZXhwb25lbnRpYWxcIiA9PT0gdGhpcy5jdXJ2ZSA/IDIgKiB0aGlzLmZhZGVPdXQgOiAwO1xuICAgICAgICB0aGlzLl9zb3VyY2VTdGFydGVkICYmIC0xICE9PSB0aGlzLl9zdG9wVGltZSAmJiB0aGlzLl9zb3VyY2Uuc3RvcCh0aGlzLl9zdG9wVGltZSArIHQpLCB0aGlzLm9uZW5kZWQodGhpcyksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRoaXMuX3NvdXJjZSAmJiAodGhpcy5fc291cmNlLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZ2Fpbk5vZGUuZGlzY29ubmVjdCgpKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCAxZTMgKiB0ICsgMTAwKTtcbiAgICAgIH1cbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUsIFwibG9vcFN0YXJ0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlLmxvb3BTdGFydDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NvdXJjZS5sb29wU3RhcnQgPSB0aGlzLnRvU2Vjb25kcyh0KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLCBcImxvb3BFbmRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb3VyY2UubG9vcEVuZDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NvdXJjZS5sb29wRW5kID0gdGhpcy50b1NlY29uZHModCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZSwgXCJidWZmZXJcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXI7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9idWZmZXIuc2V0KHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUsIFwibG9vcFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvdXJjZS5sb29wO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fc291cmNlLmxvb3AgPSB0LCB0aGlzLmNhbmNlbFN0b3AoKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl93YXNEaXNwb3NlZCB8fCAodGhpcy5fd2FzRGlzcG9zZWQgPSAhMCwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLm9uZW5kZWQgPSBudWxsLCB0aGlzLl9zb3VyY2Uub25lbmRlZCA9IG51bGwsIHRoaXMuX3NvdXJjZS5kaXNjb25uZWN0KCksIHRoaXMuX3NvdXJjZSA9IG51bGwsIHRoaXMuX2dhaW5Ob2RlLmRpc3Bvc2UoKSwgdGhpcy5fZ2Fpbk5vZGUgPSBudWxsLCB0aGlzLl9idWZmZXIuZGlzcG9zZSgpLCB0aGlzLl9idWZmZXIgPSBudWxsLCB0aGlzLl9zdGFydFRpbWUgPSAtMSwgdGhpcy5wbGF5YmFja1JhdGUgPSBudWxsLCBzLmRlZmF1bHQuY29udGV4dC5jbGVhclRpbWVvdXQodGhpcy5fb25lbmRlZFRpbWVvdXQpKSwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQnVmZmVyU291cmNlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDgpLCBpKDIpLCBpKDUpLCBpKDMpO1xuICAgIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZmVlZGJhY2tcIl0sIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCk7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuX2ZlZWRiYWNrR2FpbiA9IG5ldyBzLmRlZmF1bHQuR2Fpbih0LmZlZWRiYWNrLCBzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksIHRoaXMuZmVlZGJhY2sgPSB0aGlzLl9mZWVkYmFja0dhaW4uZ2FpbiwgdGhpcy5lZmZlY3RSZXR1cm4uY2hhaW4odGhpcy5fZmVlZGJhY2tHYWluLCB0aGlzLmVmZmVjdFNlbmQpLCB0aGlzLl9yZWFkT25seShbXCJmZWVkYmFja1wiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3QsIHMuZGVmYXVsdC5FZmZlY3QpLCBzLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3QuZGVmYXVsdHMgPSB7XG4gICAgICBmZWVkYmFjazogLjEyNVxuICAgIH0sIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImZlZWRiYWNrXCJdKSwgdGhpcy5fZmVlZGJhY2tHYWluLmRpc3Bvc2UoKSwgdGhpcy5fZmVlZGJhY2tHYWluID0gbnVsbCwgdGhpcy5mZWVkYmFjayA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDI0KSwgaSg0KTtcbiAgICBzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBzLmRlZmF1bHQuVGltZWxpbmUuY2FsbCh0aGlzKSwgdGhpcy5faW5pdGlhbCA9IHQ7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZSwgcy5kZWZhdWx0LlRpbWVsaW5lKSwgcy5kZWZhdWx0LlRpbWVsaW5lU3RhdGUucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHZhciBlID0gdGhpcy5nZXQodCk7XG4gICAgICByZXR1cm4gbnVsbCAhPT0gZSA/IGUuc3RhdGUgOiB0aGlzLl9pbml0aWFsO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlLnByb3RvdHlwZS5zZXRTdGF0ZUF0VGltZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGQoe1xuICAgICAgICBzdGF0ZTogdCxcbiAgICAgICAgdGltZTogZVxuICAgICAgfSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVsaW5lU3RhdGUucHJvdG90eXBlLmdldExhc3RTdGF0ZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBlID0gdGhpcy50b1NlY29uZHMoZSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9zZWFyY2goZSk7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHZhciBzID0gdGhpcy5fdGltZWxpbmVbaV07XG4gICAgICAgIGlmIChzLnN0YXRlID09PSB0KSByZXR1cm4gcztcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZS5wcm90b3R5cGUuZ2V0TmV4dFN0YXRlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKTtcblxuICAgICAgdmFyIGkgPSB0aGlzLl9zZWFyY2goZSk7XG5cbiAgICAgIGlmICgtMSAhPT0gaSkgZm9yICh2YXIgcyA9IGk7IHMgPCB0aGlzLl90aW1lbGluZS5sZW5ndGg7IHMrKykge1xuICAgICAgICB2YXIgbiA9IHRoaXMuX3RpbWVsaW5lW3NdO1xuICAgICAgICBpZiAobi5zdGF0ZSA9PT0gdCkgcmV0dXJuIG47XG4gICAgICB9XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlRpbWVsaW5lU3RhdGU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIHMuZGVmYXVsdC5FbWl0dGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkVtaXR0ZXIpLCBzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgZm9yICh2YXIgaSA9IHQuc3BsaXQoL1xcVysvKSwgcyA9IDA7IHMgPCBpLmxlbmd0aDsgcysrKSB7XG4gICAgICAgIHZhciBuID0gaVtzXTtcbiAgICAgICAgdGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KG4pIHx8ICh0aGlzLl9ldmVudHNbbl0gPSBbXSksIHRoaXMuX2V2ZW50c1tuXS5wdXNoKGUpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB2YXIgaSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0aGlzLm9mZih0LCBpKTtcbiAgICAgIH0uYmluZCh0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXMub24odCwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBmb3IgKHZhciBpID0gdC5zcGxpdCgvXFxXKy8pLCBuID0gMDsgbiA8IGkubGVuZ3RoOyBuKyspIGlmICh0ID0gaVtuXSwgdGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KHQpKSBpZiAocy5kZWZhdWx0LmlzVW5kZWYoZSkpIHRoaXMuX2V2ZW50c1t0XSA9IFtdO2Vsc2UgZm9yICh2YXIgbyA9IHRoaXMuX2V2ZW50c1t0XSwgYSA9IDA7IGEgPCBvLmxlbmd0aDsgYSsrKSBvW2FdID09PSBlICYmIG8uc3BsaWNlKGEsIDEpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAodGhpcy5fZXZlbnRzKSB7XG4gICAgICAgIHZhciBlID0gQXJyYXkuYXBwbHkobnVsbCwgYXJndW1lbnRzKS5zbGljZSgxKTtcbiAgICAgICAgaWYgKHRoaXMuX2V2ZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSkgZm9yICh2YXIgaSA9IHRoaXMuX2V2ZW50c1t0XS5zbGljZSgwKSwgcyA9IDAsIG4gPSBpLmxlbmd0aDsgcyA8IG47IHMrKykgaVtzXS5hcHBseSh0aGlzLCBlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVtaXR0ZXIubWl4aW4gPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSBbXCJvblwiLCBcIm9uY2VcIiwgXCJvZmZcIiwgXCJlbWl0XCJdO1xuICAgICAgdC5fZXZlbnRzID0ge307XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbiA9IGVbaV0sXG4gICAgICAgICAgICBvID0gcy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlW25dO1xuICAgICAgICB0W25dID0gbztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5FbWl0dGVyO1xuICAgIH0sIHMuZGVmYXVsdC5FbWl0dGVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9ldmVudHMgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5FbWl0dGVyO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDEpLCBpKDQ0KTtcbiAgICBzLmRlZmF1bHQuc3VwcG9ydGVkICYmIChBbmFseXNlck5vZGUucHJvdG90eXBlLmdldEZsb2F0VGltZURvbWFpbkRhdGEgfHwgKEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKTtcbiAgICAgIHRoaXMuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKGUpO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGUubGVuZ3RoOyBpKyspIHRbaV0gPSAoZVtpXSAtIDEyOCkgLyAxMjg7XG4gICAgfSkpLCBzLmRlZmF1bHQuQW5hbHlzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInR5cGVcIiwgXCJzaXplXCJdLCBzLmRlZmF1bHQuQW5hbHlzZXIpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl9hbmFseXNlciA9IHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IHRoaXMuY29udGV4dC5jcmVhdGVBbmFseXNlcigpLCB0aGlzLl90eXBlID0gdC50eXBlLCB0aGlzLl9idWZmZXIgPSBudWxsLCB0aGlzLnNpemUgPSB0LnNpemUsIHRoaXMudHlwZSA9IHQudHlwZTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BbmFseXNlciwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5BbmFseXNlci5kZWZhdWx0cyA9IHtcbiAgICAgIHNpemU6IDEwMjQsXG4gICAgICB0eXBlOiBcImZmdFwiLFxuICAgICAgc21vb3RoaW5nOiAuOFxuICAgIH0sIHMuZGVmYXVsdC5BbmFseXNlci5UeXBlID0ge1xuICAgICAgV2F2ZWZvcm06IFwid2F2ZWZvcm1cIixcbiAgICAgIEZGVDogXCJmZnRcIlxuICAgIH0sIHMuZGVmYXVsdC5BbmFseXNlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdHlwZSA9PT0gcy5kZWZhdWx0LkFuYWx5c2VyLlR5cGUuRkZUID8gdGhpcy5fYW5hbHlzZXIuZ2V0RmxvYXRGcmVxdWVuY3lEYXRhKHRoaXMuX2J1ZmZlcikgOiB0aGlzLl90eXBlID09PSBzLmRlZmF1bHQuQW5hbHlzZXIuVHlwZS5XYXZlZm9ybSAmJiB0aGlzLl9hbmFseXNlci5nZXRGbG9hdFRpbWVEb21haW5EYXRhKHRoaXMuX2J1ZmZlciksIHRoaXMuX2J1ZmZlcjtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkFuYWx5c2VyLnByb3RvdHlwZSwgXCJzaXplXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9hbmFseXNlci5mZnRTaXplID0gMiAqIHQsIHRoaXMuX2J1ZmZlciA9IG5ldyBGbG9hdDMyQXJyYXkodCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQW5hbHlzZXIucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKHQgIT09IHMuZGVmYXVsdC5BbmFseXNlci5UeXBlLldhdmVmb3JtICYmIHQgIT09IHMuZGVmYXVsdC5BbmFseXNlci5UeXBlLkZGVCkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRvbmUuQW5hbHlzZXI6IGludmFsaWQgdHlwZTogXCIgKyB0KTtcbiAgICAgICAgdGhpcy5fdHlwZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQW5hbHlzZXIucHJvdG90eXBlLCBcInNtb290aGluZ1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2FuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5BbmFseXNlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fYW5hbHlzZXIuZGlzY29ubmVjdCgpLCB0aGlzLl9hbmFseXNlciA9IG51bGwsIHRoaXMuX2J1ZmZlciA9IG51bGw7XG4gICAgfTtcbiAgICBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQW5hbHlzZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNiksIGkoMTcpLCBpKDUwKSwgaSg2OSksIGkoNDkpLCBpKDY4KSwgaSg2Nyk7XG4gICAgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJmcmVxdWVuY3lcIiwgXCJ0eXBlXCJdLCBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IpO1xuICAgICAgcy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsIHQpLCB0aGlzLmZyZXF1ZW5jeSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZnJlcXVlbmN5LCBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLCB0aGlzLmRldHVuZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGV0dW5lLCBzLmRlZmF1bHQuVHlwZS5DZW50cyksIHRoaXMuX3NvdXJjZVR5cGUgPSB2b2lkIDAsIHRoaXMuX29zY2lsbGF0b3IgPSBudWxsLCB0aGlzLnR5cGUgPSB0LnR5cGUsIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSksIHRoaXMuc2V0KHQpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLCBzLmRlZmF1bHQuU291cmNlKSwgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiA0NDAsXG4gICAgICBkZXR1bmU6IDAsXG4gICAgICB0eXBlOiBcInNpbmVcIixcbiAgICAgIHBoYXNlOiAwXG4gICAgfTtcbiAgICB2YXIgbiA9IFwiUHVsc2VPc2NpbGxhdG9yXCIsXG4gICAgICAgIG8gPSBcIlBXTU9zY2lsbGF0b3JcIixcbiAgICAgICAgYSA9IFwiT3NjaWxsYXRvclwiLFxuICAgICAgICByID0gXCJGTU9zY2lsbGF0b3JcIixcbiAgICAgICAgbCA9IFwiQU1Pc2NpbGxhdG9yXCIsXG4gICAgICAgIHUgPSBcIkZhdE9zY2lsbGF0b3JcIjtcbiAgICBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9vc2NpbGxhdG9yLnN0YXJ0KHQpO1xuICAgIH0sIHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fb3NjaWxsYXRvci5zdG9wKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUucmVzdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9vc2NpbGxhdG9yLnJlc3RhcnQodCk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSBcIlwiO1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlVHlwZSA9PT0gciA/IHQgPSBcImZtXCIgOiB0aGlzLl9zb3VyY2VUeXBlID09PSBsID8gdCA9IFwiYW1cIiA6IHRoaXMuX3NvdXJjZVR5cGUgPT09IHUgJiYgKHQgPSBcImZhdFwiKSwgdCArIHRoaXMuX29zY2lsbGF0b3IudHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIFwiZm1cIiA9PT0gdC5zdWJzdHIoMCwgMikgPyAodGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihyKSwgdGhpcy5fb3NjaWxsYXRvci50eXBlID0gdC5zdWJzdHIoMikpIDogXCJhbVwiID09PSB0LnN1YnN0cigwLCAyKSA/ICh0aGlzLl9jcmVhdGVOZXdPc2NpbGxhdG9yKGwpLCB0aGlzLl9vc2NpbGxhdG9yLnR5cGUgPSB0LnN1YnN0cigyKSkgOiBcImZhdFwiID09PSB0LnN1YnN0cigwLCAzKSA/ICh0aGlzLl9jcmVhdGVOZXdPc2NpbGxhdG9yKHUpLCB0aGlzLl9vc2NpbGxhdG9yLnR5cGUgPSB0LnN1YnN0cigzKSkgOiBcInB3bVwiID09PSB0ID8gdGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihvKSA6IFwicHVsc2VcIiA9PT0gdCA/IHRoaXMuX2NyZWF0ZU5ld09zY2lsbGF0b3IobikgOiAodGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihhKSwgdGhpcy5fb3NjaWxsYXRvci50eXBlID0gdCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBhcnRpYWxzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5wYXJ0aWFscztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29zY2lsbGF0b3IucGFydGlhbHMgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwYXJ0aWFsQ291bnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9yLnBhcnRpYWxDb3VudDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29zY2lsbGF0b3IucGFydGlhbENvdW50ID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIFwidHlwZVwiID09PSB0ID8gdGhpcy50eXBlID0gZSA6IHMuZGVmYXVsdC5pc09iamVjdCh0KSAmJiB0Lmhhc093blByb3BlcnR5KFwidHlwZVwiKSAmJiAodGhpcy50eXBlID0gdC50eXBlKSwgcy5kZWZhdWx0LnByb3RvdHlwZS5zZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRoaXMuX29zY2lsbGF0b3IuZ2V0KHQpO1xuXG4gICAgICByZXR1cm4gZS50eXBlID0gdGhpcy50eXBlLCBlO1xuICAgIH0sIHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUuX2NyZWF0ZU5ld09zY2lsbGF0b3IgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHQgIT09IHRoaXMuX3NvdXJjZVR5cGUpIHtcbiAgICAgICAgdGhpcy5fc291cmNlVHlwZSA9IHQ7XG4gICAgICAgIHZhciBlID0gcy5kZWZhdWx0W3RdLFxuICAgICAgICAgICAgaSA9IHRoaXMubm93KCk7XG5cbiAgICAgICAgaWYgKG51bGwgIT09IHRoaXMuX29zY2lsbGF0b3IpIHtcbiAgICAgICAgICB2YXIgbiA9IHRoaXMuX29zY2lsbGF0b3I7XG4gICAgICAgICAgbi5zdG9wKGkpLCB0aGlzLmNvbnRleHQuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuLmRpc3Bvc2UoKSwgbiA9IG51bGw7XG4gICAgICAgICAgfSwgdGhpcy5ibG9ja1RpbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fb3NjaWxsYXRvciA9IG5ldyBlKCksIHRoaXMuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fb3NjaWxsYXRvci5mcmVxdWVuY3kpLCB0aGlzLmRldHVuZS5jb25uZWN0KHRoaXMuX29zY2lsbGF0b3IuZGV0dW5lKSwgdGhpcy5fb3NjaWxsYXRvci5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5zdGF0ZSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgdGhpcy5fb3NjaWxsYXRvci5zdGFydChpKTtcbiAgICAgIH1cbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwaGFzZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGhhc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vc2NpbGxhdG9yLnBoYXNlID0gdDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgZCA9IHtcbiAgICAgIFB1bHNlT3NjaWxsYXRvcjogXCJwdWxzZVwiLFxuICAgICAgUFdNT3NjaWxsYXRvcjogXCJwd21cIixcbiAgICAgIE9zY2lsbGF0b3I6IFwib3NjaWxsYXRvclwiLFxuICAgICAgRk1Pc2NpbGxhdG9yOiBcImZtXCIsXG4gICAgICBBTU9zY2lsbGF0b3I6IFwiYW1cIixcbiAgICAgIEZhdE9zY2lsbGF0b3I6IFwiZmF0XCJcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInNvdXJjZVR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBkW3RoaXMuX3NvdXJjZVR5cGVdO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSBcInNpbmVcIjtcbiAgICAgICAgXCJwd21cIiAhPT0gdGhpcy5fb3NjaWxsYXRvci50eXBlICYmIFwicHVsc2VcIiAhPT0gdGhpcy5fb3NjaWxsYXRvci50eXBlICYmIChlID0gdGhpcy5fb3NjaWxsYXRvci50eXBlKSwgdCA9PT0gZC5GTU9zY2lsbGF0b3IgPyB0aGlzLnR5cGUgPSBcImZtXCIgKyBlIDogdCA9PT0gZC5BTU9zY2lsbGF0b3IgPyB0aGlzLnR5cGUgPSBcImFtXCIgKyBlIDogdCA9PT0gZC5GYXRPc2NpbGxhdG9yID8gdGhpcy50eXBlID0gXCJmYXRcIiArIGUgOiB0ID09PSBkLk9zY2lsbGF0b3IgPyB0aGlzLnR5cGUgPSBlIDogdCA9PT0gZC5QdWxzZU9zY2lsbGF0b3IgPyB0aGlzLnR5cGUgPSBcInB1bHNlXCIgOiB0ID09PSBkLlBXTU9zY2lsbGF0b3IgJiYgKHRoaXMudHlwZSA9IFwicHdtXCIpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJiYXNlVHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29zY2lsbGF0b3IuYmFzZVR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLnNvdXJjZVR5cGUgIT09IGQuUHVsc2VPc2NpbGxhdG9yICYmIHRoaXMuc291cmNlVHlwZSAhPT0gZC5QV01Pc2NpbGxhdG9yICYmICh0aGlzLl9vc2NpbGxhdG9yLmJhc2VUeXBlID0gdCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcIndpZHRoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlVHlwZSA9PT0gbiA/IHRoaXMuX29zY2lsbGF0b3Iud2lkdGggOiB2b2lkIDA7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcImNvdW50XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlVHlwZSA9PT0gdSA/IHRoaXMuX29zY2lsbGF0b3IuY291bnQgOiB2b2lkIDA7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zb3VyY2VUeXBlID09PSB1ICYmICh0aGlzLl9vc2NpbGxhdG9yLmNvdW50ID0gdCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInNwcmVhZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvdXJjZVR5cGUgPT09IHUgPyB0aGlzLl9vc2NpbGxhdG9yLnNwcmVhZCA6IHZvaWQgMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NvdXJjZVR5cGUgPT09IHUgJiYgKHRoaXMuX29zY2lsbGF0b3Iuc3ByZWFkID0gdCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcIm1vZHVsYXRpb25UeXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlVHlwZSA9PT0gciB8fCB0aGlzLl9zb3VyY2VUeXBlID09PSBsID8gdGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uVHlwZSA6IHZvaWQgMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NvdXJjZVR5cGUgIT09IHIgJiYgdGhpcy5fc291cmNlVHlwZSAhPT0gbCB8fCAodGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uVHlwZSA9IHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJtb2R1bGF0aW9uSW5kZXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb3VyY2VUeXBlID09PSByID8gdGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uSW5kZXggOiB2b2lkIDA7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLCBcImhhcm1vbmljaXR5XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc291cmNlVHlwZSA9PT0gciB8fCB0aGlzLl9zb3VyY2VUeXBlID09PSBsID8gdGhpcy5fb3NjaWxsYXRvci5oYXJtb25pY2l0eSA6IHZvaWQgMDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsIFwibW9kdWxhdGlvbkZyZXF1ZW5jeVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvdXJjZVR5cGUgPT09IG8gPyB0aGlzLl9vc2NpbGxhdG9yLm1vZHVsYXRpb25GcmVxdWVuY3kgOiB2b2lkIDA7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSksIHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSwgdGhpcy5kZXR1bmUgPSBudWxsLCB0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5fb3NjaWxsYXRvci5kaXNwb3NlKCksIHRoaXMuX29zY2lsbGF0b3IgPSBudWxsLCB0aGlzLl9zb3VyY2VUeXBlID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3I7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMzEpLCBpKDM3KSwgaSgyNSk7XG4gICAgcy5kZWZhdWx0LlN5bnRoID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuU3ludGguZGVmYXVsdHMpLCBzLmRlZmF1bHQuTW9ub3Bob25pYy5jYWxsKHRoaXMsIHQpLCB0aGlzLm9zY2lsbGF0b3IgPSBuZXcgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yKHQub3NjaWxsYXRvciksIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeSwgdGhpcy5kZXR1bmUgPSB0aGlzLm9zY2lsbGF0b3IuZGV0dW5lLCB0aGlzLmVudmVsb3BlID0gbmV3IHMuZGVmYXVsdC5BbXBsaXR1ZGVFbnZlbG9wZSh0LmVudmVsb3BlKSwgdGhpcy5vc2NpbGxhdG9yLmNoYWluKHRoaXMuZW52ZWxvcGUsIHRoaXMub3V0cHV0KSwgdGhpcy5fcmVhZE9ubHkoW1wib3NjaWxsYXRvclwiLCBcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiLCBcImVudmVsb3BlXCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TeW50aCwgcy5kZWZhdWx0Lk1vbm9waG9uaWMpLCBzLmRlZmF1bHQuU3ludGguZGVmYXVsdHMgPSB7XG4gICAgICBvc2NpbGxhdG9yOiB7XG4gICAgICAgIHR5cGU6IFwidHJpYW5nbGVcIlxuICAgICAgfSxcbiAgICAgIGVudmVsb3BlOiB7XG4gICAgICAgIGF0dGFjazogLjAwNSxcbiAgICAgICAgZGVjYXk6IC4xLFxuICAgICAgICBzdXN0YWluOiAuMyxcbiAgICAgICAgcmVsZWFzZTogMVxuICAgICAgfVxuICAgIH0sIHMuZGVmYXVsdC5TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQsIGUpLCB0aGlzLm9zY2lsbGF0b3Iuc3RhcnQodCksIDAgPT09IHRoaXMuZW52ZWxvcGUuc3VzdGFpbiAmJiB0aGlzLm9zY2lsbGF0b3Iuc3RvcCh0ICsgdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5hdHRhY2spICsgdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5kZWNheSkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5lbnZlbG9wZS50cmlnZ2VyUmVsZWFzZSh0KSwgdGhpcy5vc2NpbGxhdG9yLnN0b3AodCArIHRoaXMudG9TZWNvbmRzKHRoaXMuZW52ZWxvcGUucmVsZWFzZSkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5TeW50aC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJvc2NpbGxhdG9yXCIsIFwiZnJlcXVlbmN5XCIsIFwiZGV0dW5lXCIsIFwiZW52ZWxvcGVcIl0pLCB0aGlzLm9zY2lsbGF0b3IuZGlzcG9zZSgpLCB0aGlzLm9zY2lsbGF0b3IgPSBudWxsLCB0aGlzLmVudmVsb3BlLmRpc3Bvc2UoKSwgdGhpcy5lbnZlbG9wZSA9IG51bGwsIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5kZXR1bmUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5TeW50aDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2KSwgaSgxMSksIGkoMzIpO1xuICAgIHMuZGVmYXVsdC5Ob2lzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1widHlwZVwiXSwgcy5kZWZhdWx0Lk5vaXNlKTtcbiAgICAgIHMuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLCB0KSwgdGhpcy5fc291cmNlID0gbnVsbCwgdGhpcy5fdHlwZSA9IHQudHlwZSwgdGhpcy5fcGxheWJhY2tSYXRlID0gdC5wbGF5YmFja1JhdGU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTm9pc2UsIHMuZGVmYXVsdC5Tb3VyY2UpLCBzLmRlZmF1bHQuTm9pc2UuZGVmYXVsdHMgPSB7XG4gICAgICB0eXBlOiBcIndoaXRlXCIsXG4gICAgICBwbGF5YmFja1JhdGU6IDFcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk5vaXNlLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmICh0aGlzLl90eXBlICE9PSB0KSB7XG4gICAgICAgICAgaWYgKCEodCBpbiBuKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRvbmUuTm9pc2U6IGludmFsaWQgdHlwZTogXCIgKyB0KTtcblxuICAgICAgICAgIGlmICh0aGlzLl90eXBlID0gdCwgdGhpcy5zdGF0ZSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5ub3coKTtcbiAgICAgICAgICAgIHRoaXMuX3N0b3AoZSksIHRoaXMuX3N0YXJ0KGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk5vaXNlLnByb3RvdHlwZSwgXCJwbGF5YmFja1JhdGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wbGF5YmFja1JhdGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wbGF5YmFja1JhdGUgPSB0LCB0aGlzLl9zb3VyY2UgJiYgKHRoaXMuX3NvdXJjZS5wbGF5YmFja1JhdGUudmFsdWUgPSB0KTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lk5vaXNlLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSBuW3RoaXMuX3R5cGVdO1xuICAgICAgdGhpcy5fc291cmNlID0gbmV3IHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UoZSkuY29ubmVjdCh0aGlzLm91dHB1dCksIHRoaXMuX3NvdXJjZS5sb29wID0gITAsIHRoaXMuX3NvdXJjZS5wbGF5YmFja1JhdGUudmFsdWUgPSB0aGlzLl9wbGF5YmFja1JhdGUsIHRoaXMuX3NvdXJjZS5zdGFydCh0aGlzLnRvU2Vjb25kcyh0KSwgTWF0aC5yYW5kb20oKSAqIChlLmR1cmF0aW9uIC0gLjAwMSkpO1xuICAgIH0sIHMuZGVmYXVsdC5Ob2lzZS5wcm90b3R5cGUuX3N0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fc291cmNlICYmICh0aGlzLl9zb3VyY2Uuc3RvcCh0aGlzLnRvU2Vjb25kcyh0KSksIHRoaXMuX3NvdXJjZSA9IG51bGwpO1xuICAgIH0sIHMuZGVmYXVsdC5Ob2lzZS5wcm90b3R5cGUucmVzdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcCh0KSwgdGhpcy5fc3RhcnQodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk5vaXNlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgbnVsbCAhPT0gdGhpcy5fc291cmNlICYmICh0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLCB0aGlzLl9zb3VyY2UgPSBudWxsKSwgdGhpcy5fYnVmZmVyID0gbnVsbCwgdGhpcztcbiAgICB9O1xuICAgIHZhciBuID0ge30sXG4gICAgICAgIG8gPSB7fTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobiwgXCJwaW5rXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW8ucGluaykge1xuICAgICAgICAgIGZvciAodmFyIHQgPSBbXSwgZSA9IDA7IGUgPCAyOyBlKyspIHtcbiAgICAgICAgICAgIHZhciBpLFxuICAgICAgICAgICAgICAgIG4sXG4gICAgICAgICAgICAgICAgYSxcbiAgICAgICAgICAgICAgICByLFxuICAgICAgICAgICAgICAgIGwsXG4gICAgICAgICAgICAgICAgdSxcbiAgICAgICAgICAgICAgICBkLFxuICAgICAgICAgICAgICAgIGYgPSBuZXcgRmxvYXQzMkFycmF5KDIyMDUwMCk7XG4gICAgICAgICAgICB0W2VdID0gZiwgaSA9IG4gPSBhID0gciA9IGwgPSB1ID0gZCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGggPSAwOyBoIDwgMjIwNTAwOyBoKyspIHtcbiAgICAgICAgICAgICAgdmFyIGMgPSAyICogTWF0aC5yYW5kb20oKSAtIDE7XG4gICAgICAgICAgICAgIGkgPSAuOTk4ODYgKiBpICsgLjA1NTUxNzkgKiBjLCBuID0gLjk5MzMyICogbiArIC4wNzUwNzU5ICogYywgYSA9IC45NjkgKiBhICsgLjE1Mzg1MiAqIGMsIHIgPSAuODY2NSAqIHIgKyAuMzEwNDg1NiAqIGMsIGwgPSAuNTUgKiBsICsgLjUzMjk1MjIgKiBjLCB1ID0gLS43NjE2ICogdSAtIC4wMTY4OTggKiBjLCBmW2hdID0gaSArIG4gKyBhICsgciArIGwgKyB1ICsgZCArIC41MzYyICogYywgZltoXSAqPSAuMTEsIGQgPSAuMTE1OTI2ICogYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBvLnBpbmsgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcigpLmZyb21BcnJheSh0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvLnBpbms7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCBcImJyb3duXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW8uYnJvd24pIHtcbiAgICAgICAgICBmb3IgKHZhciB0ID0gW10sIGUgPSAwOyBlIDwgMjsgZSsrKSB7XG4gICAgICAgICAgICB2YXIgaSA9IG5ldyBGbG9hdDMyQXJyYXkoMjIwNTAwKTtcbiAgICAgICAgICAgIHRbZV0gPSBpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMCwgYSA9IDA7IGEgPCAyMjA1MDA7IGErKykge1xuICAgICAgICAgICAgICB2YXIgciA9IDIgKiBNYXRoLnJhbmRvbSgpIC0gMTtcbiAgICAgICAgICAgICAgaVthXSA9IChuICsgLjAyICogcikgLyAxLjAyLCBuID0gaVthXSwgaVthXSAqPSAzLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgby5icm93biA9IG5ldyBzLmRlZmF1bHQuQnVmZmVyKCkuZnJvbUFycmF5KHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG8uYnJvd247XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCBcIndoaXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW8ud2hpdGUpIHtcbiAgICAgICAgICBmb3IgKHZhciB0ID0gW10sIGUgPSAwOyBlIDwgMjsgZSsrKSB7XG4gICAgICAgICAgICB2YXIgaSA9IG5ldyBGbG9hdDMyQXJyYXkoMjIwNTAwKTtcbiAgICAgICAgICAgIHRbZV0gPSBpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IDIyMDUwMDsgbisrKSBpW25dID0gMiAqIE1hdGgucmFuZG9tKCkgLSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG8ud2hpdGUgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcigpLmZyb21BcnJheSh0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvLndoaXRlO1xuICAgICAgfVxuICAgIH0pLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTm9pc2U7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjcpLCBpKDIwKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuTWFzdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCBzLmRlZmF1bHQuZ2V0Q29udGV4dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlSW5zT3V0cygxLCAwKSwgdGhpcy5fdm9sdW1lID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlZvbHVtZSgpLCB0aGlzLnZvbHVtZSA9IHRoaXMuX3ZvbHVtZS52b2x1bWUsIHRoaXMuX3JlYWRPbmx5KFwidm9sdW1lXCIpLCBzLmRlZmF1bHQuY29ubmVjdFNlcmllcyh0aGlzLmlucHV0LCB0aGlzLm91dHB1dCwgdGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKSwgdGhpcy5jb250ZXh0Lm1hc3RlciA9IHRoaXM7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1hc3Rlciwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5NYXN0ZXIuZGVmYXVsdHMgPSB7XG4gICAgICB2b2x1bWU6IDAsXG4gICAgICBtdXRlOiAhMVxuICAgIH0sIHMuZGVmYXVsdC5NYXN0ZXIucHJvdG90eXBlLmlzTWFzdGVyID0gITAsIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTWFzdGVyLnByb3RvdHlwZSwgXCJtdXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdm9sdW1lLm11dGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl92b2x1bWUubXV0ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5NYXN0ZXIucHJvdG90eXBlLmNoYWluID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5pbnB1dC5kaXNjb25uZWN0KCk7XG4gICAgICB2YXIgdCA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgIHQudW5zaGlmdCh0aGlzLmlucHV0KSwgdC5wdXNoKHRoaXMub3V0cHV0KSwgcy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkodm9pZCAwLCB0KTtcbiAgICB9LCBzLmRlZmF1bHQuTWFzdGVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShcInZvbHVtZVwiKSwgdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSwgdGhpcy5fdm9sdW1lID0gbnVsbCwgdGhpcy52b2x1bWUgPSBudWxsO1xuICAgIH0sIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLnRvTWFzdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdCh0aGlzLmNvbnRleHQubWFzdGVyKSwgdGhpcztcbiAgICB9O1xuICAgIHZhciBuID0gcy5kZWZhdWx0Lk1hc3RlcjtcbiAgICBzLmRlZmF1bHQuTWFzdGVyID0gbmV3IG4oKSwgcy5kZWZhdWx0LkNvbnRleHQub24oXCJpbml0XCIsIGZ1bmN0aW9uICh0KSB7XG4gICAgICB0Lm1hc3RlciAmJiB0Lm1hc3Rlci5pc01hc3RlciA/IHMuZGVmYXVsdC5NYXN0ZXIgPSB0Lm1hc3RlciA6IHMuZGVmYXVsdC5NYXN0ZXIgPSBuZXcgbigpO1xuICAgIH0pLCBzLmRlZmF1bHQuQ29udGV4dC5vbihcImNsb3NlXCIsIGZ1bmN0aW9uICh0KSB7XG4gICAgICB0Lm1hc3RlciAmJiB0Lm1hc3Rlci5pc01hc3RlciAmJiB0Lm1hc3Rlci5kaXNwb3NlKCk7XG4gICAgfSksIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NYXN0ZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoODYpLCBpKDQ3KTtcbiAgICBzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImF0dGFja1wiLCBcImRlY2F5XCIsIFwic3VzdGFpblwiLCBcInJlbGVhc2VcIl0sIHMuZGVmYXVsdC5FbnZlbG9wZSk7XG4gICAgICB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0LkZyZXF1ZW5jeUVudmVsb3BlLmRlZmF1bHRzKSwgcy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLmNhbGwodGhpcywgdCksIHRoaXMuX29jdGF2ZXMgPSB0Lm9jdGF2ZXMsIHRoaXMuYmFzZUZyZXF1ZW5jeSA9IHQuYmFzZUZyZXF1ZW5jeSwgdGhpcy5vY3RhdmVzID0gdC5vY3RhdmVzLCB0aGlzLmV4cG9uZW50ID0gdC5leHBvbmVudDtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZSwgcy5kZWZhdWx0LkVudmVsb3BlKSwgcy5kZWZhdWx0LkZyZXF1ZW5jeUVudmVsb3BlLmRlZmF1bHRzID0ge1xuICAgICAgYmFzZUZyZXF1ZW5jeTogMjAwLFxuICAgICAgb2N0YXZlczogNCxcbiAgICAgIGV4cG9uZW50OiAxXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZS5wcm90b3R5cGUsIFwiYmFzZUZyZXF1ZW5jeVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjYWxlLm1pbjtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NjYWxlLm1pbiA9IHRoaXMudG9GcmVxdWVuY3kodCksIHRoaXMub2N0YXZlcyA9IHRoaXMuX29jdGF2ZXM7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUucHJvdG90eXBlLCBcIm9jdGF2ZXNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vY3RhdmVzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb2N0YXZlcyA9IHQsIHRoaXMuX3NjYWxlLm1heCA9IHRoaXMuYmFzZUZyZXF1ZW5jeSAqIE1hdGgucG93KDIsIHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZyZXF1ZW5jeUVudmVsb3BlLnByb3RvdHlwZSwgXCJleHBvbmVudFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4cC52YWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V4cC52YWx1ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2NhbGVkRW52ZWxvcGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjYpLCBpKDYxKTtcbiAgICBzLmRlZmF1bHQuU2NhbGVFeHAgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSwgdGhpcy5fc2NhbGUgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuU2NhbGUodCwgZSksIHRoaXMuX2V4cCA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LlBvdyhzLmRlZmF1bHQuZGVmYXVsdEFyZyhpLCAyKSksIHRoaXMuX2V4cC5jb25uZWN0KHRoaXMuX3NjYWxlKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TY2FsZUV4cCwgcy5kZWZhdWx0LlNpZ25hbEJhc2UpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlRXhwLnByb3RvdHlwZSwgXCJleHBvbmVudFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4cC52YWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V4cC52YWx1ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGVFeHAucHJvdG90eXBlLCBcIm1pblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjYWxlLm1pbjtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NjYWxlLm1pbiA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGVFeHAucHJvdG90eXBlLCBcIm1heFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjYWxlLm1heDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NjYWxlLm1heCA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5TY2FsZUV4cC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9zY2FsZS5kaXNwb3NlKCksIHRoaXMuX3NjYWxlID0gbnVsbCwgdGhpcy5fZXhwLmRpc3Bvc2UoKSwgdGhpcy5fZXhwID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU2NhbGVFeHA7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMTQpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5Db21wcmVzc29yID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJ0aHJlc2hvbGRcIiwgXCJyYXRpb1wiXSwgcy5kZWZhdWx0LkNvbXByZXNzb3IpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl9jb21wcmVzc29yID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gdGhpcy5jb250ZXh0LmNyZWF0ZUR5bmFtaWNzQ29tcHJlc3NvcigpLCB0aGlzLnRocmVzaG9sZCA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fY29tcHJlc3Nvci50aHJlc2hvbGQsXG4gICAgICAgIHVuaXRzOiBzLmRlZmF1bHQuVHlwZS5EZWNpYmVscyxcbiAgICAgICAgY29udmVydDogITFcbiAgICAgIH0pLCB0aGlzLmF0dGFjayA9IG5ldyBzLmRlZmF1bHQuUGFyYW0odGhpcy5fY29tcHJlc3Nvci5hdHRhY2ssIHMuZGVmYXVsdC5UeXBlLlRpbWUpLCB0aGlzLnJlbGVhc2UgPSBuZXcgcy5kZWZhdWx0LlBhcmFtKHRoaXMuX2NvbXByZXNzb3IucmVsZWFzZSwgcy5kZWZhdWx0LlR5cGUuVGltZSksIHRoaXMua25lZSA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fY29tcHJlc3Nvci5rbmVlLFxuICAgICAgICB1bml0czogcy5kZWZhdWx0LlR5cGUuRGVjaWJlbHMsXG4gICAgICAgIGNvbnZlcnQ6ICExXG4gICAgICB9KSwgdGhpcy5yYXRpbyA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fY29tcHJlc3Nvci5yYXRpbyxcbiAgICAgICAgY29udmVydDogITFcbiAgICAgIH0pLCB0aGlzLl9yZWFkT25seShbXCJrbmVlXCIsIFwicmVsZWFzZVwiLCBcImF0dGFja1wiLCBcInJhdGlvXCIsIFwidGhyZXNob2xkXCJdKSwgdGhpcy5zZXQodCk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ29tcHJlc3Nvciwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5Db21wcmVzc29yLmRlZmF1bHRzID0ge1xuICAgICAgcmF0aW86IDEyLFxuICAgICAgdGhyZXNob2xkOiAtMjQsXG4gICAgICByZWxlYXNlOiAuMjUsXG4gICAgICBhdHRhY2s6IC4wMDMsXG4gICAgICBrbmVlOiAzMFxuICAgIH0sIHMuZGVmYXVsdC5Db21wcmVzc29yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wia25lZVwiLCBcInJlbGVhc2VcIiwgXCJhdHRhY2tcIiwgXCJyYXRpb1wiLCBcInRocmVzaG9sZFwiXSksIHRoaXMuX2NvbXByZXNzb3IuZGlzY29ubmVjdCgpLCB0aGlzLl9jb21wcmVzc29yID0gbnVsbCwgdGhpcy5hdHRhY2suZGlzcG9zZSgpLCB0aGlzLmF0dGFjayA9IG51bGwsIHRoaXMucmVsZWFzZS5kaXNwb3NlKCksIHRoaXMucmVsZWFzZSA9IG51bGwsIHRoaXMudGhyZXNob2xkLmRpc3Bvc2UoKSwgdGhpcy50aHJlc2hvbGQgPSBudWxsLCB0aGlzLnJhdGlvLmRpc3Bvc2UoKSwgdGhpcy5yYXRpbyA9IG51bGwsIHRoaXMua25lZS5kaXNwb3NlKCksIHRoaXMua25lZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkNvbXByZXNzb3I7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg5Mik7XG5cbiAgICBpZiAocy5kZWZhdWx0LnN1cHBvcnRlZCkge1xuICAgICAgIXMuZGVmYXVsdC5nbG9iYWwuaGFzT3duUHJvcGVydHkoXCJBdWRpb0NvbnRleHRcIikgJiYgcy5kZWZhdWx0Lmdsb2JhbC5oYXNPd25Qcm9wZXJ0eShcIndlYmtpdEF1ZGlvQ29udGV4dFwiKSAmJiAocy5kZWZhdWx0Lmdsb2JhbC5BdWRpb0NvbnRleHQgPSBzLmRlZmF1bHQuZ2xvYmFsLndlYmtpdEF1ZGlvQ29udGV4dCksIEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY2xvc2UgfHwgKEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzLmRlZmF1bHQuaXNGdW5jdGlvbih0aGlzLnN1c3BlbmQpICYmIHRoaXMuc3VzcGVuZCgpLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH0pLCBBdWRpb0NvbnRleHQucHJvdG90eXBlLnJlc3VtZSB8fCAoQXVkaW9Db250ZXh0LnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcy5jcmVhdGVCdWZmZXIoMSwgMSwgdGhpcy5zYW1wbGVSYXRlKSxcbiAgICAgICAgICAgIGUgPSB0aGlzLmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICByZXR1cm4gZS5idWZmZXIgPSB0LCBlLmNvbm5lY3QodGhpcy5kZXN0aW5hdGlvbiksIGUuc3RhcnQoMCksIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfSksICFBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZUdhaW4gJiYgQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVHYWluTm9kZSAmJiAoQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVHYWluID0gQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVHYWluTm9kZSksICFBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZURlbGF5ICYmIEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlRGVsYXlOb2RlICYmIChBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZURlbGF5ID0gQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVEZWxheU5vZGUpO1xuICAgICAgdmFyIG4gPSAhMSxcbiAgICAgICAgICBvID0gbmV3IE9mZmxpbmVBdWRpb0NvbnRleHQoMSwgMSwgNDQxMDApLFxuICAgICAgICAgIGEgPSBuZXcgVWludDMyQXJyYXkoWzExNzkwMTE0MTAsIDQ4LCAxMTYzMjgwNzI3LCA1NDQ1MDEwOTQsIDE2LCAxMzEwNzMsIDQ0MTAwLCAxNzY0MDAsIDEwNDg1ODAsIDE2MzUwMTcwNjAsIDgsIDAsIDAsIDAsIDBdKS5idWZmZXI7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciByID0gby5kZWNvZGVBdWRpb0RhdGEoYSk7XG4gICAgICAgIHIgJiYgcy5kZWZhdWx0LmlzRnVuY3Rpb24oci50aGVuKSAmJiAobiA9ICEwKTtcbiAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgbiA9ICExO1xuICAgICAgfVxuXG4gICAgICBuIHx8IChBdWRpb0NvbnRleHQucHJvdG90eXBlLl9uYXRpdmVfZGVjb2RlQXVkaW9EYXRhID0gQXVkaW9Db250ZXh0LnByb3RvdHlwZS5kZWNvZGVBdWRpb0RhdGEsIEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuZGVjb2RlQXVkaW9EYXRhID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChlLCBpKSB7XG4gICAgICAgICAgdGhpcy5fbmF0aXZlX2RlY29kZUF1ZGlvRGF0YSh0LCBlLCBpKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2Myk7XG4gICAgcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKSkgcmV0dXJuIG5ldyBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSh0LCBlKTtcbiAgICAgIHMuZGVmYXVsdC5UaW1lLmNhbGwodGhpcywgdCwgZSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSwgcy5kZWZhdWx0LlRpbWUpLCBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZS5wcm90b3R5cGUuX25vdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0LnNlY29uZHM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNjIpO1xuICAgIHMuZGVmYXVsdC5GcmVxdWVuY3kgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5GcmVxdWVuY3kpKSByZXR1cm4gbmV3IHMuZGVmYXVsdC5GcmVxdWVuY3kodCwgZSk7XG4gICAgICBzLmRlZmF1bHQuVGltZUJhc2UuY2FsbCh0aGlzLCB0LCBlKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GcmVxdWVuY3ksIHMuZGVmYXVsdC5UaW1lQmFzZSksIHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9leHByZXNzaW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zLCB7XG4gICAgICBtaWRpOiB7XG4gICAgICAgIHJlZ2V4cDogL14oXFxkKyg/OlxcLlxcZCspP21pZGkpLyxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiBcIm1pZGlcIiA9PT0gdGhpcy5fZGVmYXVsdFVuaXRzID8gdCA6IHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZih0KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG5vdGU6IHtcbiAgICAgICAgcmVnZXhwOiAvXihbYS1nXXsxfSg/OmJ8I3x4fGJiKT8pKC0/WzAtOV0rKS9pLFxuICAgICAgICBtZXRob2Q6IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgICAgdmFyIGkgPSBuW3QudG9Mb3dlckNhc2UoKV0gKyAxMiAqIChwYXJzZUludChlKSArIDEpO1xuICAgICAgICAgIHJldHVybiBcIm1pZGlcIiA9PT0gdGhpcy5fZGVmYXVsdFVuaXRzID8gaSA6IHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZihpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRyOiB7XG4gICAgICAgIHJlZ2V4cDogL14oXFxkKyg/OlxcLlxcZCspPyk6KFxcZCsoPzpcXC5cXGQrKT8pOj8oXFxkKyg/OlxcLlxcZCspPyk/LyxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgICAgIHZhciBzID0gMTtcbiAgICAgICAgICByZXR1cm4gdCAmJiBcIjBcIiAhPT0gdCAmJiAocyAqPSB0aGlzLl9iZWF0c1RvVW5pdHModGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpICogcGFyc2VGbG9hdCh0KSkpLCBlICYmIFwiMFwiICE9PSBlICYmIChzICo9IHRoaXMuX2JlYXRzVG9Vbml0cyhwYXJzZUZsb2F0KGUpKSksIGkgJiYgXCIwXCIgIT09IGkgJiYgKHMgKj0gdGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoaSkgLyA0KSksIHM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUudHJhbnNwb3NlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnZhbHVlT2YoKSAqIHMuZGVmYXVsdC5pbnRlcnZhbFRvRnJlcXVlbmN5UmF0aW8odCkpO1xuICAgIH0sIHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLmhhcm1vbml6ZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdC5tYXAoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNwb3NlKHQpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LCBzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b01pZGkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkZyZXF1ZW5jeS5mdG9tKHRoaXMudmFsdWVPZigpKTtcbiAgICB9LCBzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b05vdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHRoaXMudG9GcmVxdWVuY3koKSxcbiAgICAgICAgICBlID0gTWF0aC5sb2cyKHQgLyBzLmRlZmF1bHQuRnJlcXVlbmN5LkE0KSxcbiAgICAgICAgICBpID0gTWF0aC5yb3VuZCgxMiAqIGUpICsgNTcsXG4gICAgICAgICAgbiA9IE1hdGguZmxvb3IoaSAvIDEyKTtcbiAgICAgIHJldHVybiBuIDwgMCAmJiAoaSArPSAtMTIgKiBuKSwgb1tpICUgMTJdICsgbi50b1N0cmluZygpO1xuICAgIH0sIHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLnRvU2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAxIC8gcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS50b1NlY29uZHMuY2FsbCh0aGlzKTtcbiAgICB9LCBzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b0ZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvRnJlcXVlbmN5LmNhbGwodGhpcyk7XG4gICAgfSwgcy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUudG9UaWNrcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gdGhpcy5fYmVhdHNUb1VuaXRzKDEpLFxuICAgICAgICAgIGUgPSB0aGlzLnZhbHVlT2YoKSAvIHQ7XG5cbiAgICAgIHJldHVybiBNYXRoLmZsb29yKGUgKiBzLmRlZmF1bHQuVHJhbnNwb3J0LlBQUSk7XG4gICAgfSwgcy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX25vQXJnID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfSwgcy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX2ZyZXF1ZW5jeVRvVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfSwgcy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX3RpY2tzVG9Vbml0cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gMSAvICg2MCAqIHQgLyAocy5kZWZhdWx0LlRyYW5zcG9ydC5icG0udmFsdWUgKiBzLmRlZmF1bHQuVHJhbnNwb3J0LlBQUSkpO1xuICAgIH0sIHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9iZWF0c1RvVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIDEgLyBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9iZWF0c1RvVW5pdHMuY2FsbCh0aGlzLCB0KTtcbiAgICB9LCBzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fc2Vjb25kc1RvVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIDEgLyB0O1xuICAgIH0sIHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9kZWZhdWx0VW5pdHMgPSBcImh6XCI7XG4gICAgdmFyIG4gPSB7XG4gICAgICBjYmI6IC0yLFxuICAgICAgY2I6IC0xLFxuICAgICAgYzogMCxcbiAgICAgIFwiYyNcIjogMSxcbiAgICAgIGN4OiAyLFxuICAgICAgZGJiOiAwLFxuICAgICAgZGI6IDEsXG4gICAgICBkOiAyLFxuICAgICAgXCJkI1wiOiAzLFxuICAgICAgZHg6IDQsXG4gICAgICBlYmI6IDIsXG4gICAgICBlYjogMyxcbiAgICAgIGU6IDQsXG4gICAgICBcImUjXCI6IDUsXG4gICAgICBleDogNixcbiAgICAgIGZiYjogMyxcbiAgICAgIGZiOiA0LFxuICAgICAgZjogNSxcbiAgICAgIFwiZiNcIjogNixcbiAgICAgIGZ4OiA3LFxuICAgICAgZ2JiOiA1LFxuICAgICAgZ2I6IDYsXG4gICAgICBnOiA3LFxuICAgICAgXCJnI1wiOiA4LFxuICAgICAgZ3g6IDksXG4gICAgICBhYmI6IDcsXG4gICAgICBhYjogOCxcbiAgICAgIGE6IDksXG4gICAgICBcImEjXCI6IDEwLFxuICAgICAgYXg6IDExLFxuICAgICAgYmJiOiA5LFxuICAgICAgYmI6IDEwLFxuICAgICAgYjogMTEsXG4gICAgICBcImIjXCI6IDEyLFxuICAgICAgYng6IDEzXG4gICAgfSxcbiAgICAgICAgbyA9IFtcIkNcIiwgXCJDI1wiLCBcIkRcIiwgXCJEI1wiLCBcIkVcIiwgXCJGXCIsIFwiRiNcIiwgXCJHXCIsIFwiRyNcIiwgXCJBXCIsIFwiQSNcIiwgXCJCXCJdO1xuICAgIHMuZGVmYXVsdC5GcmVxdWVuY3kuQTQgPSA0NDAsIHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZiA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkZyZXF1ZW5jeS5BNCAqIE1hdGgucG93KDIsICh0IC0gNjkpIC8gMTIpO1xuICAgIH0sIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gNjkgKyBNYXRoLnJvdW5kKDEyICogTWF0aC5sb2cyKHQgLyBzLmRlZmF1bHQuRnJlcXVlbmN5LkE0KSk7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZyZXF1ZW5jeTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyKSwgaSg2MSksIGkoNCksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkVudmVsb3BlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJhdHRhY2tcIiwgXCJkZWNheVwiLCBcInN1c3RhaW5cIiwgXCJyZWxlYXNlXCJdLCBzLmRlZmF1bHQuRW52ZWxvcGUpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLmF0dGFjayA9IHQuYXR0YWNrLCB0aGlzLmRlY2F5ID0gdC5kZWNheSwgdGhpcy5zdXN0YWluID0gdC5zdXN0YWluLCB0aGlzLnJlbGVhc2UgPSB0LnJlbGVhc2UsIHRoaXMuX2F0dGFja0N1cnZlID0gXCJsaW5lYXJcIiwgdGhpcy5fcmVsZWFzZUN1cnZlID0gXCJleHBvbmVudGlhbFwiLCB0aGlzLl9zaWcgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKDApLCB0aGlzLmF0dGFja0N1cnZlID0gdC5hdHRhY2tDdXJ2ZSwgdGhpcy5yZWxlYXNlQ3VydmUgPSB0LnJlbGVhc2VDdXJ2ZSwgdGhpcy5kZWNheUN1cnZlID0gdC5kZWNheUN1cnZlO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkVudmVsb3BlLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkVudmVsb3BlLmRlZmF1bHRzID0ge1xuICAgICAgYXR0YWNrOiAuMDEsXG4gICAgICBkZWNheTogLjEsXG4gICAgICBzdXN0YWluOiAuNSxcbiAgICAgIHJlbGVhc2U6IDEsXG4gICAgICBhdHRhY2tDdXJ2ZTogXCJsaW5lYXJcIixcbiAgICAgIGRlY2F5Q3VydmU6IFwiZXhwb25lbnRpYWxcIixcbiAgICAgIHJlbGVhc2VDdXJ2ZTogXCJleHBvbmVudGlhbFwiXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZhbHVlQXRUaW1lKHRoaXMubm93KCkpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLl9nZXRDdXJ2ZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAocy5kZWZhdWx0LmlzU3RyaW5nKHQpKSByZXR1cm4gdDtcbiAgICAgIGlmIChzLmRlZmF1bHQuaXNBcnJheSh0KSkgZm9yICh2YXIgaSBpbiBzLmRlZmF1bHQuRW52ZWxvcGUuVHlwZSkgaWYgKHMuZGVmYXVsdC5FbnZlbG9wZS5UeXBlW2ldW2VdID09PSB0KSByZXR1cm4gaTtcbiAgICB9LCBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLl9zZXRDdXJ2ZSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBpZiAocy5kZWZhdWx0LkVudmVsb3BlLlR5cGUuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgdmFyIG4gPSBzLmRlZmF1bHQuRW52ZWxvcGUuVHlwZVtpXTtcbiAgICAgICAgcy5kZWZhdWx0LmlzT2JqZWN0KG4pID8gdGhpc1t0XSA9IG5bZV0gOiB0aGlzW3RdID0gbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghcy5kZWZhdWx0LmlzQXJyYXkoaSkpIHRocm93IG5ldyBFcnJvcihcIlRvbmUuRW52ZWxvcGU6IGludmFsaWQgY3VydmU6IFwiICsgaSk7XG4gICAgICAgIHRoaXNbdF0gPSBpO1xuICAgICAgfVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLCBcImF0dGFja0N1cnZlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q3VydmUodGhpcy5fYXR0YWNrQ3VydmUsIFwiSW5cIik7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zZXRDdXJ2ZShcIl9hdHRhY2tDdXJ2ZVwiLCBcIkluXCIsIHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZSwgXCJyZWxlYXNlQ3VydmVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRDdXJ2ZSh0aGlzLl9yZWxlYXNlQ3VydmUsIFwiT3V0XCIpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fc2V0Q3VydmUoXCJfcmVsZWFzZUN1cnZlXCIsIFwiT3V0XCIsIHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZSwgXCJkZWNheUN1cnZlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVjYXlDdXJ2ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmICghW1wibGluZWFyXCIsIFwiZXhwb25lbnRpYWxcIl0uaW5jbHVkZXModCkpIHRocm93IG5ldyBFcnJvcihcIlRvbmUuRW52ZWxvcGU6IGludmFsaWQgY3VydmU6IFwiICsgdCk7XG4gICAgICAgIHRoaXMuX2RlY2F5Q3VydmUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLnRyaWdnZXJBdHRhY2sgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsIHQsIGUpLCB0ID0gdGhpcy50b1NlY29uZHModCk7XG4gICAgICB2YXIgaSA9IHRoaXMudG9TZWNvbmRzKHRoaXMuYXR0YWNrKSxcbiAgICAgICAgICBuID0gdGhpcy50b1NlY29uZHModGhpcy5kZWNheSk7XG4gICAgICBlID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgMSk7XG4gICAgICB2YXIgbyA9IHRoaXMuZ2V0VmFsdWVBdFRpbWUodCk7XG4gICAgICBvID4gMCAmJiAoaSA9ICgxIC0gbykgLyAoMSAvIGkpKTtcbiAgICAgIGlmICgwID09PSBpKSB0aGlzLl9zaWcuc2V0VmFsdWVBdFRpbWUoZSwgdCk7ZWxzZSBpZiAoXCJsaW5lYXJcIiA9PT0gdGhpcy5fYXR0YWNrQ3VydmUpIHRoaXMuX3NpZy5saW5lYXJSYW1wVG8oZSwgaSwgdCk7ZWxzZSBpZiAoXCJleHBvbmVudGlhbFwiID09PSB0aGlzLl9hdHRhY2tDdXJ2ZSkgdGhpcy5fc2lnLnRhcmdldFJhbXBUbyhlLCBpLCB0KTtlbHNlIGlmIChpID4gMCkge1xuICAgICAgICB0aGlzLl9zaWcuY2FuY2VsQW5kSG9sZEF0VGltZSh0KTtcblxuICAgICAgICBmb3IgKHZhciBhID0gdGhpcy5fYXR0YWNrQ3VydmUsIHIgPSAxOyByIDwgYS5sZW5ndGg7IHIrKykgaWYgKGFbciAtIDFdIDw9IG8gJiYgbyA8PSBhW3JdKSB7XG4gICAgICAgICAgKGEgPSB0aGlzLl9hdHRhY2tDdXJ2ZS5zbGljZShyKSlbMF0gPSBvO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2lnLnNldFZhbHVlQ3VydmVBdFRpbWUoYSwgdCwgaSwgZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChuKSB7XG4gICAgICAgIHZhciBsID0gZSAqIHRoaXMuc3VzdGFpbixcbiAgICAgICAgICAgIHUgPSB0ICsgaTtcbiAgICAgICAgdGhpcy5sb2coXCJkZWNheVwiLCB1KSwgXCJsaW5lYXJcIiA9PT0gdGhpcy5fZGVjYXlDdXJ2ZSA/IHRoaXMuX3NpZy5saW5lYXJSYW1wVG8obCwgbiwgdSArIHRoaXMuc2FtcGxlVGltZSkgOiBcImV4cG9uZW50aWFsXCIgPT09IHRoaXMuX2RlY2F5Q3VydmUgJiYgdGhpcy5fc2lnLmV4cG9uZW50aWFsQXBwcm9hY2hWYWx1ZUF0VGltZShsLCB1LCBuKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS50cmlnZ2VyUmVsZWFzZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLmxvZyhcInRyaWdnZXJSZWxlYXNlXCIsIHQpLCB0ID0gdGhpcy50b1NlY29uZHModCk7XG4gICAgICB2YXIgZSA9IHRoaXMuZ2V0VmFsdWVBdFRpbWUodCk7XG5cbiAgICAgIGlmIChlID4gMCkge1xuICAgICAgICB2YXIgaSA9IHRoaXMudG9TZWNvbmRzKHRoaXMucmVsZWFzZSk7XG4gICAgICAgIGlmIChcImxpbmVhclwiID09PSB0aGlzLl9yZWxlYXNlQ3VydmUpIHRoaXMuX3NpZy5saW5lYXJSYW1wVG8oMCwgaSwgdCk7ZWxzZSBpZiAoXCJleHBvbmVudGlhbFwiID09PSB0aGlzLl9yZWxlYXNlQ3VydmUpIHRoaXMuX3NpZy50YXJnZXRSYW1wVG8oMCwgaSwgdCk7ZWxzZSB7XG4gICAgICAgICAgdmFyIG4gPSB0aGlzLl9yZWxlYXNlQ3VydmU7XG4gICAgICAgICAgcy5kZWZhdWx0LmlzQXJyYXkobikgJiYgKHRoaXMuX3NpZy5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLCB0aGlzLl9zaWcuc2V0VmFsdWVDdXJ2ZUF0VGltZShuLCB0LCBpLCBlKSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS5nZXRWYWx1ZUF0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2lnLmdldFZhbHVlQXRUaW1lKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUudHJpZ2dlckF0dGFja1JlbGVhc2UgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcmV0dXJuIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy50cmlnZ2VyQXR0YWNrKGUsIGkpLCB0aGlzLnRyaWdnZXJSZWxlYXNlKGUgKyB0aGlzLnRvU2Vjb25kcyh0KSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NpZy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS5jb25uZWN0ID0gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmNvbm5lY3QsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0LFxuICAgICAgICAgIGUsXG4gICAgICAgICAgaSA9IFtdO1xuXG4gICAgICBmb3IgKHQgPSAwOyB0IDwgMTI4OyB0KyspIGlbdF0gPSBNYXRoLnNpbih0IC8gMTI3ICogKE1hdGguUEkgLyAyKSk7XG5cbiAgICAgIHZhciBuID0gW107XG5cbiAgICAgIGZvciAodCA9IDA7IHQgPCAxMjc7IHQrKykge1xuICAgICAgICBlID0gdCAvIDEyNztcbiAgICAgICAgdmFyIG8gPSBNYXRoLnNpbihlICogKDIgKiBNYXRoLlBJKSAqIDYuNCAtIE1hdGguUEkgLyAyKSArIDE7XG4gICAgICAgIG5bdF0gPSBvIC8gMTAgKyAuODMgKiBlO1xuICAgICAgfVxuXG4gICAgICBuWzEyN10gPSAxO1xuICAgICAgdmFyIGEgPSBbXTtcblxuICAgICAgZm9yICh0ID0gMDsgdCA8IDEyODsgdCsrKSBhW3RdID0gTWF0aC5jZWlsKHQgLyAxMjcgKiA1KSAvIDU7XG5cbiAgICAgIHZhciByID0gW107XG5cbiAgICAgIGZvciAodCA9IDA7IHQgPCAxMjg7IHQrKykgZSA9IHQgLyAxMjcsIHJbdF0gPSAuNSAqICgxIC0gTWF0aC5jb3MoTWF0aC5QSSAqIGUpKTtcblxuICAgICAgdmFyIGwsXG4gICAgICAgICAgdSA9IFtdO1xuXG4gICAgICBmb3IgKHQgPSAwOyB0IDwgMTI4OyB0KyspIHtcbiAgICAgICAgZSA9IHQgLyAxMjc7XG4gICAgICAgIHZhciBkID0gNCAqIE1hdGgucG93KGUsIDMpICsgLjIsXG4gICAgICAgICAgICBmID0gTWF0aC5jb3MoZCAqIE1hdGguUEkgKiAyICogZSk7XG4gICAgICAgIHVbdF0gPSBNYXRoLmFicyhmICogKDEgLSBlKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGgodCkge1xuICAgICAgICBmb3IgKHZhciBlID0gbmV3IEFycmF5KHQubGVuZ3RoKSwgaSA9IDA7IGkgPCB0Lmxlbmd0aDsgaSsrKSBlW2ldID0gMSAtIHRbaV07XG5cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9XG5cbiAgICAgIHMuZGVmYXVsdC5FbnZlbG9wZS5UeXBlID0ge1xuICAgICAgICBsaW5lYXI6IFwibGluZWFyXCIsXG4gICAgICAgIGV4cG9uZW50aWFsOiBcImV4cG9uZW50aWFsXCIsXG4gICAgICAgIGJvdW5jZToge1xuICAgICAgICAgIEluOiBoKHUpLFxuICAgICAgICAgIE91dDogdVxuICAgICAgICB9LFxuICAgICAgICBjb3NpbmU6IHtcbiAgICAgICAgICBJbjogaSxcbiAgICAgICAgICBPdXQ6IChsID0gaSwgbC5zbGljZSgwKS5yZXZlcnNlKCkpXG4gICAgICAgIH0sXG4gICAgICAgIHN0ZXA6IHtcbiAgICAgICAgICBJbjogYSxcbiAgICAgICAgICBPdXQ6IGgoYSlcbiAgICAgICAgfSxcbiAgICAgICAgcmlwcGxlOiB7XG4gICAgICAgICAgSW46IG4sXG4gICAgICAgICAgT3V0OiBoKG4pXG4gICAgICAgIH0sXG4gICAgICAgIHNpbmU6IHtcbiAgICAgICAgICBJbjogcixcbiAgICAgICAgICBPdXQ6IGgocilcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KCksIHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3NpZy5kaXNwb3NlKCksIHRoaXMuX3NpZyA9IG51bGwsIHRoaXMuX2F0dGFja0N1cnZlID0gbnVsbCwgdGhpcy5fcmVsZWFzZUN1cnZlID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRW52ZWxvcGU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjMpLCBpKDEwKSwgaSgxOSksIGkoNyksIGkoMjgpLCBpKDMpLCBpKDIpLCBpKDIwKTtcblxuICAgIGlmIChzLmRlZmF1bHQuc3VwcG9ydGVkICYmICFzLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlU3RlcmVvUGFubmVyKSB7XG4gICAgICB2YXIgbiA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IHQsIHRoaXMucGFuID0gbmV3IHMuZGVmYXVsdC5TaWduYWwoMCwgcy5kZWZhdWx0LlR5cGUuQXVkaW9SYW5nZSk7XG4gICAgICAgIHZhciBlID0gbmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5lcXVhbFBvd2VyU2NhbGUoKHQgKyAxKSAvIDIpO1xuICAgICAgICB9LCA0MDk2KSxcbiAgICAgICAgICAgIGkgPSBuZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gcy5kZWZhdWx0LmVxdWFsUG93ZXJTY2FsZSgxIC0gKHQgKyAxKSAvIDIpO1xuICAgICAgICB9LCA0MDk2KSxcbiAgICAgICAgICAgIG4gPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSxcbiAgICAgICAgICAgIG8gPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSxcbiAgICAgICAgICAgIGEgPSB0aGlzLmlucHV0ID0gbmV3IHMuZGVmYXVsdC5TcGxpdCgpO1xuICAgICAgICBhLl9zcGxpdHRlci5jaGFubmVsQ291bnRNb2RlID0gXCJleHBsaWNpdFwiLCBuZXcgcy5kZWZhdWx0Llplcm8oKS5mYW4oZSwgaSk7XG4gICAgICAgIHZhciByID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0Lk1lcmdlKCk7XG4gICAgICAgIGEubGVmdC5jaGFpbihuLCByLmxlZnQpLCBhLnJpZ2h0LmNoYWluKG8sIHIucmlnaHQpLCB0aGlzLnBhbi5jaGFpbihpLCBuLmdhaW4pLCB0aGlzLnBhbi5jaGFpbihlLCBvLmdhaW4pO1xuICAgICAgfTtcblxuICAgICAgbi5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5vdXRwdXQuZGlzY29ubmVjdC5hcHBseSh0aGlzLm91dHB1dCwgYXJndW1lbnRzKTtcbiAgICAgIH0sIG4ucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMub3V0cHV0LmNvbm5lY3QuYXBwbHkodGhpcy5vdXRwdXQsIGFyZ3VtZW50cyk7XG4gICAgICB9LCBBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZVN0ZXJlb1Bhbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBuKHRoaXMpO1xuICAgICAgfSwgcy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmNyZWF0ZVN0ZXJlb1Bhbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBuKHRoaXMpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBpKDIyKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuUGFubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJwYW5cIl0sIHMuZGVmYXVsdC5QYW5uZXIpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl9wYW5uZXIgPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSB0aGlzLmNvbnRleHQuY3JlYXRlU3RlcmVvUGFubmVyKCksIHRoaXMucGFuID0gdGhpcy5fcGFubmVyLnBhbiwgdGhpcy5wYW4udmFsdWUgPSB0LnBhbiwgdGhpcy5fcmVhZE9ubHkoXCJwYW5cIik7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGFubmVyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlBhbm5lci5kZWZhdWx0cyA9IHtcbiAgICAgIHBhbjogMFxuICAgIH0sIHMuZGVmYXVsdC5QYW5uZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShcInBhblwiKSwgdGhpcy5fcGFubmVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fcGFubmVyID0gbnVsbCwgdGhpcy5wYW4gPSBudWxsLCB0aGlzO1xuICAgIH07XG4gICAgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBhbm5lcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2KSwgaSgxNyksIGkoNSksIGkoMyk7XG4gICAgcy5kZWZhdWx0LkZNT3NjaWxsYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCIsIFwidHlwZVwiLCBcIm1vZHVsYXRpb25UeXBlXCJdLCBzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yKTtcbiAgICAgIHMuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLCB0KSwgdGhpcy5fY2FycmllciA9IG5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih0LmZyZXF1ZW5jeSwgdC50eXBlKSwgdGhpcy5mcmVxdWVuY3kgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZyZXF1ZW5jeSwgcy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSwgdGhpcy5kZXR1bmUgPSB0aGlzLl9jYXJyaWVyLmRldHVuZSwgdGhpcy5kZXR1bmUudmFsdWUgPSB0LmRldHVuZSwgdGhpcy5tb2R1bGF0aW9uSW5kZXggPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KHQubW9kdWxhdGlvbkluZGV4KSwgdGhpcy5tb2R1bGF0aW9uSW5kZXgudW5pdHMgPSBzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSwgdGhpcy5fbW9kdWxhdG9yID0gbmV3IHMuZGVmYXVsdC5Pc2NpbGxhdG9yKHQuZnJlcXVlbmN5LCB0Lm1vZHVsYXRpb25UeXBlKSwgdGhpcy5oYXJtb25pY2l0eSA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkodC5oYXJtb25pY2l0eSksIHRoaXMuaGFybW9uaWNpdHkudW5pdHMgPSBzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSwgdGhpcy5fbW9kdWxhdGlvbk5vZGUgPSBuZXcgcy5kZWZhdWx0LkdhaW4oMCksIHRoaXMuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fY2Fycmllci5mcmVxdWVuY3kpLCB0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLmhhcm1vbmljaXR5LCB0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSwgdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5tb2R1bGF0aW9uSW5kZXgsIHRoaXMuX21vZHVsYXRpb25Ob2RlKSwgdGhpcy5fbW9kdWxhdG9yLmNvbm5lY3QodGhpcy5fbW9kdWxhdGlvbk5vZGUuZ2FpbiksIHRoaXMuX21vZHVsYXRpb25Ob2RlLmNvbm5lY3QodGhpcy5fY2Fycmllci5mcmVxdWVuY3kpLCB0aGlzLl9jYXJyaWVyLmNvbm5lY3QodGhpcy5vdXRwdXQpLCB0aGlzLmRldHVuZS5jb25uZWN0KHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLCB0aGlzLnBoYXNlID0gdC5waGFzZSwgdGhpcy5fcmVhZE9ubHkoW1wibW9kdWxhdGlvbkluZGV4XCIsIFwiZnJlcXVlbmN5XCIsIFwiZGV0dW5lXCIsIFwiaGFybW9uaWNpdHlcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZNT3NjaWxsYXRvciwgcy5kZWZhdWx0LlNvdXJjZSksIHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IuZGVmYXVsdHMgPSB7XG4gICAgICBmcmVxdWVuY3k6IDQ0MCxcbiAgICAgIGRldHVuZTogMCxcbiAgICAgIHBoYXNlOiAwLFxuICAgICAgdHlwZTogXCJzaW5lXCIsXG4gICAgICBtb2R1bGF0aW9uSW5kZXg6IDIsXG4gICAgICBtb2R1bGF0aW9uVHlwZTogXCJzcXVhcmVcIixcbiAgICAgIGhhcm1vbmljaXR5OiAxXG4gICAgfSwgcy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuX21vZHVsYXRvci5zdGFydCh0KSwgdGhpcy5fY2Fycmllci5zdGFydCh0KTtcbiAgICB9LCBzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9tb2R1bGF0b3Iuc3RvcCh0KSwgdGhpcy5fY2Fycmllci5zdG9wKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLnJlc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fbW9kdWxhdG9yLnJlc3RhcnQodCksIHRoaXMuX2NhcnJpZXIucmVzdGFydCh0KTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcnJpZXIudHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2NhcnJpZXIudHlwZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJiYXNlVHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcnJpZXIuYmFzZVR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9jYXJyaWVyLmJhc2VUeXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBhcnRpYWxDb3VudFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcnJpZXIucGFydGlhbENvdW50O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fY2Fycmllci5wYXJ0aWFsQ291bnQgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwibW9kdWxhdGlvblR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGF0b3IudHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX21vZHVsYXRvci50eXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBoYXNlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2Fycmllci5waGFzZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2NhcnJpZXIucGhhc2UgPSB0LCB0aGlzLl9tb2R1bGF0b3IucGhhc2UgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwicGFydGlhbHNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJyaWVyLnBhcnRpYWxzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fY2Fycmllci5wYXJ0aWFscyA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJtb2R1bGF0aW9uSW5kZXhcIiwgXCJmcmVxdWVuY3lcIiwgXCJkZXR1bmVcIiwgXCJoYXJtb25pY2l0eVwiXSksIHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmRldHVuZSA9IG51bGwsIHRoaXMuaGFybW9uaWNpdHkuZGlzcG9zZSgpLCB0aGlzLmhhcm1vbmljaXR5ID0gbnVsbCwgdGhpcy5fY2Fycmllci5kaXNwb3NlKCksIHRoaXMuX2NhcnJpZXIgPSBudWxsLCB0aGlzLl9tb2R1bGF0b3IuZGlzcG9zZSgpLCB0aGlzLl9tb2R1bGF0b3IgPSBudWxsLCB0aGlzLl9tb2R1bGF0aW9uTm9kZS5kaXNwb3NlKCksIHRoaXMuX21vZHVsYXRpb25Ob2RlID0gbnVsbCwgdGhpcy5tb2R1bGF0aW9uSW5kZXguZGlzcG9zZSgpLCB0aGlzLm1vZHVsYXRpb25JbmRleCA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZNT3NjaWxsYXRvcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2KSwgaSgxNyksIGkoMiksIGkoNyksIGkoMyk7XG4gICAgcy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCIsIFwid2lkdGhcIl0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yKTtcbiAgICAgIHMuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLCB0KSwgdGhpcy53aWR0aCA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQud2lkdGgsIHMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlKSwgdGhpcy5fd2lkdGhHYXRlID0gbmV3IHMuZGVmYXVsdC5HYWluKDApLCB0aGlzLl9zYXd0b290aCA9IG5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih7XG4gICAgICAgIGZyZXF1ZW5jeTogdC5mcmVxdWVuY3ksXG4gICAgICAgIGRldHVuZTogdC5kZXR1bmUsXG4gICAgICAgIHR5cGU6IFwic2F3dG9vdGhcIixcbiAgICAgICAgcGhhc2U6IHQucGhhc2VcbiAgICAgIH0pLCB0aGlzLmZyZXF1ZW5jeSA9IHRoaXMuX3Nhd3Rvb3RoLmZyZXF1ZW5jeSwgdGhpcy5kZXR1bmUgPSB0aGlzLl9zYXd0b290aC5kZXR1bmUsIHRoaXMuX3RocmVzaCA9IG5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gdCA8IDAgPyAtMSA6IDE7XG4gICAgICB9KSwgdGhpcy5fc2F3dG9vdGguY2hhaW4odGhpcy5fdGhyZXNoLCB0aGlzLm91dHB1dCksIHRoaXMud2lkdGguY2hhaW4odGhpcy5fd2lkdGhHYXRlLCB0aGlzLl90aHJlc2gpLCB0aGlzLl9yZWFkT25seShbXCJ3aWR0aFwiLCBcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLCBzLmRlZmF1bHQuU291cmNlKSwgcy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5kZWZhdWx0cyA9IHtcbiAgICAgIGZyZXF1ZW5jeTogNDQwLFxuICAgICAgZGV0dW5lOiAwLFxuICAgICAgcGhhc2U6IDAsXG4gICAgICB3aWR0aDogLjJcbiAgICB9LCBzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zYXd0b290aC5zdGFydCh0KSwgdGhpcy5fd2lkdGhHYXRlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMSwgdCk7XG4gICAgfSwgcy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zYXd0b290aC5zdG9wKHQpLCB0aGlzLl93aWR0aEdhdGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLCB0KTtcbiAgICB9LCBzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuX3Nhd3Rvb3RoLnJlc3RhcnQodCksIHRoaXMuX3dpZHRoR2F0ZS5nYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0KSwgdGhpcy5fd2lkdGhHYXRlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMSwgdCk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBoYXNlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2F3dG9vdGgucGhhc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zYXd0b290aC5waGFzZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJwdWxzZVwiO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUsIFwiYmFzZVR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcInB1bHNlXCI7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwYXJ0aWFsc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fc2F3dG9vdGguZGlzcG9zZSgpLCB0aGlzLl9zYXd0b290aCA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcIndpZHRoXCIsIFwiZnJlcXVlbmN5XCIsIFwiZGV0dW5lXCJdKSwgdGhpcy53aWR0aC5kaXNwb3NlKCksIHRoaXMud2lkdGggPSBudWxsLCB0aGlzLl93aWR0aEdhdGUuZGlzcG9zZSgpLCB0aGlzLl93aWR0aEdhdGUgPSBudWxsLCB0aGlzLl90aHJlc2guZGlzcG9zZSgpLCB0aGlzLl90aHJlc2ggPSBudWxsLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuZGV0dW5lID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDE2KSwgaSg0KSwgaSgzNCk7XG4gICAgcy5kZWZhdWx0LkV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJjYWxsYmFja1wiLCBcInZhbHVlXCJdLCBzLmRlZmF1bHQuRXZlbnQpO1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMuX2xvb3AgPSB0Lmxvb3AsIHRoaXMuY2FsbGJhY2sgPSB0LmNhbGxiYWNrLCB0aGlzLnZhbHVlID0gdC52YWx1ZSwgdGhpcy5fbG9vcFN0YXJ0ID0gdGhpcy50b1RpY2tzKHQubG9vcFN0YXJ0KSwgdGhpcy5fbG9vcEVuZCA9IHRoaXMudG9UaWNrcyh0Lmxvb3BFbmQpLCB0aGlzLl9zdGF0ZSA9IG5ldyBzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCksIHRoaXMuX3BsYXliYWNrUmF0ZSA9IDEsIHRoaXMuX3N0YXJ0T2Zmc2V0ID0gMCwgdGhpcy5fcHJvYmFiaWxpdHkgPSB0LnByb2JhYmlsaXR5LCB0aGlzLl9odW1hbml6ZSA9IHQuaHVtYW5pemUsIHRoaXMubXV0ZSA9IHQubXV0ZSwgdGhpcy5wbGF5YmFja1JhdGUgPSB0LnBsYXliYWNrUmF0ZTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5FdmVudCksIHMuZGVmYXVsdC5FdmVudC5kZWZhdWx0cyA9IHtcbiAgICAgIGNhbGxiYWNrOiBzLmRlZmF1bHQubm9PcCxcbiAgICAgIGxvb3A6ICExLFxuICAgICAgbG9vcEVuZDogXCIxbVwiLFxuICAgICAgbG9vcFN0YXJ0OiAwLFxuICAgICAgcGxheWJhY2tSYXRlOiAxLFxuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBwcm9iYWJpbGl0eTogMSxcbiAgICAgIG11dGU6ICExLFxuICAgICAgaHVtYW5pemU6ICExXG4gICAgfSwgcy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5fcmVzY2hlZHVsZUV2ZW50cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIC0xKSwgdGhpcy5fc3RhdGUuZm9yRWFjaEZyb20odCwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGU7XG5cbiAgICAgICAgaWYgKHQuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKSB7XG4gICAgICAgICAgcy5kZWZhdWx0LmlzRGVmaW5lZCh0LmlkKSAmJiBzLmRlZmF1bHQuVHJhbnNwb3J0LmNsZWFyKHQuaWQpO1xuICAgICAgICAgIHZhciBpID0gdC50aW1lICsgTWF0aC5yb3VuZCh0aGlzLnN0YXJ0T2Zmc2V0IC8gdGhpcy5fcGxheWJhY2tSYXRlKTtcblxuICAgICAgICAgIGlmICghMCA9PT0gdGhpcy5fbG9vcCB8fCBzLmRlZmF1bHQuaXNOdW1iZXIodGhpcy5fbG9vcCkgJiYgdGhpcy5fbG9vcCA+IDEpIHtcbiAgICAgICAgICAgIGUgPSAxIC8gMCwgcy5kZWZhdWx0LmlzTnVtYmVyKHRoaXMuX2xvb3ApICYmIChlID0gdGhpcy5fbG9vcCAqIHRoaXMuX2dldExvb3BEdXJhdGlvbigpKTtcblxuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLl9zdGF0ZS5nZXRBZnRlcihpKTtcblxuICAgICAgICAgICAgbnVsbCAhPT0gbiAmJiAoZSA9IE1hdGgubWluKGUsIG4udGltZSAtIGkpKSwgZSAhPT0gMSAvIDAgJiYgKHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLCBpICsgZSArIDEpLCBlID0gcy5kZWZhdWx0LlRpY2tzKGUpKTtcbiAgICAgICAgICAgIHZhciBvID0gcy5kZWZhdWx0LlRpY2tzKHRoaXMuX2dldExvb3BEdXJhdGlvbigpKTtcbiAgICAgICAgICAgIHQuaWQgPSBzLmRlZmF1bHQuVHJhbnNwb3J0LnNjaGVkdWxlUmVwZWF0KHRoaXMuX3RpY2suYmluZCh0aGlzKSwgbywgcy5kZWZhdWx0LlRpY2tzKGkpLCBlKTtcbiAgICAgICAgICB9IGVsc2UgdC5pZCA9IHMuZGVmYXVsdC5UcmFuc3BvcnQuc2NoZWR1bGUodGhpcy5fdGljay5iaW5kKHRoaXMpLCBzLmRlZmF1bHQuVGlja3MoaSkpO1xuICAgICAgICB9XG4gICAgICB9LmJpbmQodGhpcykpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUocy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrcyk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcInN0YXJ0T2Zmc2V0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnRPZmZzZXQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zdGFydE9mZnNldCA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcInByb2JhYmlsaXR5XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvYmFiaWxpdHk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wcm9iYWJpbGl0eSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcImh1bWFuaXplXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faHVtYW5pemU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9odW1hbml6ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHQpID09PSBzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCAmJiAodGhpcy5fc3RhdGUuYWRkKHtcbiAgICAgICAgc3RhdGU6IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkLFxuICAgICAgICB0aW1lOiB0LFxuICAgICAgICBpZDogdm9pZCAwXG4gICAgICB9KSwgdGhpcy5fcmVzY2hlZHVsZUV2ZW50cyh0KSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmICh0aGlzLmNhbmNlbCh0KSwgdCA9IHRoaXMudG9UaWNrcyh0KSwgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLCB0KTtcblxuICAgICAgICB2YXIgZSA9IHRoaXMuX3N0YXRlLmdldEJlZm9yZSh0KSxcbiAgICAgICAgICAgIGkgPSB0O1xuXG4gICAgICAgIG51bGwgIT09IGUgJiYgKGkgPSBlLnRpbWUpLCB0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKGkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIC0xIC8gMCksIHQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuX3N0YXRlLmZvckVhY2hGcm9tKHQsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHMuZGVmYXVsdC5UcmFuc3BvcnQuY2xlYXIodC5pZCk7XG4gICAgICB9KSwgdGhpcy5fc3RhdGUuY2FuY2VsKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuX3RpY2sgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSBzLmRlZmF1bHQuVHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO1xuXG4gICAgICBpZiAoIXRoaXMubXV0ZSAmJiB0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShlKSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvYmFiaWxpdHkgPCAxICYmIE1hdGgucmFuZG9tKCkgPiB0aGlzLnByb2JhYmlsaXR5KSByZXR1cm47XG5cbiAgICAgICAgaWYgKHRoaXMuaHVtYW5pemUpIHtcbiAgICAgICAgICB2YXIgaSA9IC4wMjtcbiAgICAgICAgICBzLmRlZmF1bHQuaXNCb29sZWFuKHRoaXMuaHVtYW5pemUpIHx8IChpID0gdGhpcy50b1NlY29uZHModGhpcy5odW1hbml6ZSkpLCB0ICs9ICgyICogTWF0aC5yYW5kb20oKSAtIDEpICogaTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2FsbGJhY2sodCwgdGhpcy52YWx1ZSk7XG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5fZ2V0TG9vcER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIE1hdGgucm91bmQoKHRoaXMuX2xvb3BFbmQgLSB0aGlzLl9sb29wU3RhcnQpIC8gdGhpcy5fcGxheWJhY2tSYXRlKTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZSwgXCJsb29wXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9vcDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3AgPSB0LCB0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcInBsYXliYWNrUmF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3BsYXliYWNrUmF0ZSA9IHQsIHRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoKTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsIFwibG9vcEVuZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wRW5kKS50b1NlY29uZHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3BFbmQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuX2xvb3AgJiYgdGhpcy5fcmVzY2hlZHVsZUV2ZW50cygpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZSwgXCJsb29wU3RhcnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fbG9vcFN0YXJ0KS50b1NlY29uZHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3BTdGFydCA9IHRoaXMudG9UaWNrcyh0KSwgdGhpcy5fbG9vcCAmJiB0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLCBcInByb2dyZXNzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fbG9vcCkge1xuICAgICAgICAgIHZhciB0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrcyxcbiAgICAgICAgICAgICAgZSA9IHRoaXMuX3N0YXRlLmdldCh0KTtcblxuICAgICAgICAgIGlmIChudWxsICE9PSBlICYmIGUuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKSB7XG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMuX2dldExvb3BEdXJhdGlvbigpO1xuXG4gICAgICAgICAgICByZXR1cm4gKHQgLSBlLnRpbWUpICUgaSAvIGk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYW5jZWwoKSwgdGhpcy5fc3RhdGUuZGlzcG9zZSgpLCB0aGlzLl9zdGF0ZSA9IG51bGwsIHRoaXMuY2FsbGJhY2sgPSBudWxsLCB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRXZlbnQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMiksIGkoMTMpLCBpKDI5KSwgaSgxMCksIGkoMyksIGkoMSk7XG4gICAgcy5kZWZhdWx0Lk1pZFNpZGVNZXJnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDIsIDApLCB0aGlzLm1pZCA9IHRoaXMuaW5wdXRbMF0gPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5fbGVmdCA9IG5ldyBzLmRlZmF1bHQuQWRkKCksIHRoaXMuX3RpbWVzVHdvTGVmdCA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoTWF0aC5TUVJUMV8yKSwgdGhpcy5zaWRlID0gdGhpcy5pbnB1dFsxXSA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLl9yaWdodCA9IG5ldyBzLmRlZmF1bHQuU3VidHJhY3QoKSwgdGhpcy5fdGltZXNUd29SaWdodCA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoTWF0aC5TUVJUMV8yKSwgdGhpcy5fbWVyZ2UgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuTWVyZ2UoKSwgdGhpcy5taWQuY29ubmVjdCh0aGlzLl9sZWZ0LCAwLCAwKSwgdGhpcy5zaWRlLmNvbm5lY3QodGhpcy5fbGVmdCwgMCwgMSksIHRoaXMubWlkLmNvbm5lY3QodGhpcy5fcmlnaHQsIDAsIDApLCB0aGlzLnNpZGUuY29ubmVjdCh0aGlzLl9yaWdodCwgMCwgMSksIHRoaXMuX2xlZnQuY29ubmVjdCh0aGlzLl90aW1lc1R3b0xlZnQpLCB0aGlzLl9yaWdodC5jb25uZWN0KHRoaXMuX3RpbWVzVHdvUmlnaHQpLCB0aGlzLl90aW1lc1R3b0xlZnQuY29ubmVjdCh0aGlzLl9tZXJnZSwgMCwgMCksIHRoaXMuX3RpbWVzVHdvUmlnaHQuY29ubmVjdCh0aGlzLl9tZXJnZSwgMCwgMSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWlkU2lkZU1lcmdlLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0Lk1pZFNpZGVNZXJnZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMubWlkLmRpc3Bvc2UoKSwgdGhpcy5taWQgPSBudWxsLCB0aGlzLnNpZGUuZGlzcG9zZSgpLCB0aGlzLnNpZGUgPSBudWxsLCB0aGlzLl9sZWZ0LmRpc3Bvc2UoKSwgdGhpcy5fbGVmdCA9IG51bGwsIHRoaXMuX3RpbWVzVHdvTGVmdC5kaXNwb3NlKCksIHRoaXMuX3RpbWVzVHdvTGVmdCA9IG51bGwsIHRoaXMuX3JpZ2h0LmRpc3Bvc2UoKSwgdGhpcy5fcmlnaHQgPSBudWxsLCB0aGlzLl90aW1lc1R3b1JpZ2h0LmRpc3Bvc2UoKSwgdGhpcy5fdGltZXNUd29SaWdodCA9IG51bGwsIHRoaXMuX21lcmdlLmRpc3Bvc2UoKSwgdGhpcy5fbWVyZ2UgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NaWRTaWRlTWVyZ2U7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjkpLCBpKDEzKSwgaSgyKSwgaSgxOSksIGkoMSk7XG4gICAgcy5kZWZhdWx0Lk1pZFNpZGVTcGxpdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDAsIDIpLCB0aGlzLl9zcGxpdCA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LlNwbGl0KCksIHRoaXMuX21pZEFkZCA9IG5ldyBzLmRlZmF1bHQuQWRkKCksIHRoaXMubWlkID0gdGhpcy5vdXRwdXRbMF0gPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KE1hdGguU1FSVDFfMiksIHRoaXMuX3NpZGVTdWJ0cmFjdCA9IG5ldyBzLmRlZmF1bHQuU3VidHJhY3QoKSwgdGhpcy5zaWRlID0gdGhpcy5vdXRwdXRbMV0gPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KE1hdGguU1FSVDFfMiksIHRoaXMuX3NwbGl0LmNvbm5lY3QodGhpcy5fbWlkQWRkLCAwLCAwKSwgdGhpcy5fc3BsaXQuY29ubmVjdCh0aGlzLl9taWRBZGQsIDEsIDEpLCB0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX3NpZGVTdWJ0cmFjdCwgMCwgMCksIHRoaXMuX3NwbGl0LmNvbm5lY3QodGhpcy5fc2lkZVN1YnRyYWN0LCAxLCAxKSwgdGhpcy5fbWlkQWRkLmNvbm5lY3QodGhpcy5taWQpLCB0aGlzLl9zaWRlU3VidHJhY3QuY29ubmVjdCh0aGlzLnNpZGUpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1pZFNpZGVTcGxpdCwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5NaWRTaWRlU3BsaXQucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLm1pZC5kaXNwb3NlKCksIHRoaXMubWlkID0gbnVsbCwgdGhpcy5zaWRlLmRpc3Bvc2UoKSwgdGhpcy5zaWRlID0gbnVsbCwgdGhpcy5fbWlkQWRkLmRpc3Bvc2UoKSwgdGhpcy5fbWlkQWRkID0gbnVsbCwgdGhpcy5fc2lkZVN1YnRyYWN0LmRpc3Bvc2UoKSwgdGhpcy5fc2lkZVN1YnRyYWN0ID0gbnVsbCwgdGhpcy5fc3BsaXQuZGlzcG9zZSgpLCB0aGlzLl9zcGxpdCA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk1pZFNpZGVTcGxpdDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyKSwgaSg5KSwgaSgxKSwgaSg1OSk7XG4gICAgcy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJkZWxheVRpbWVcIiwgXCJyZXNvbmFuY2VcIiwgXCJkYW1wZW5pbmdcIl0sIHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlcik7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuX2NvbWJGaWx0ZXIgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuRmVlZGJhY2tDb21iRmlsdGVyKHQuZGVsYXlUaW1lLCB0LnJlc29uYW5jZSksIHRoaXMuZGVsYXlUaW1lID0gdGhpcy5fY29tYkZpbHRlci5kZWxheVRpbWUsIHRoaXMuX2xvd3Bhc3MgPSB0aGlzLmlucHV0ID0gbmV3IHMuZGVmYXVsdC5GaWx0ZXIoe1xuICAgICAgICBmcmVxdWVuY3k6IHQuZGFtcGVuaW5nLFxuICAgICAgICB0eXBlOiBcImxvd3Bhc3NcIixcbiAgICAgICAgUTogMCxcbiAgICAgICAgcm9sbG9mZjogLTEyXG4gICAgICB9KSwgdGhpcy5kYW1wZW5pbmcgPSB0aGlzLl9sb3dwYXNzLmZyZXF1ZW5jeSwgdGhpcy5yZXNvbmFuY2UgPSB0aGlzLl9jb21iRmlsdGVyLnJlc29uYW5jZSwgdGhpcy5fbG93cGFzcy5jb25uZWN0KHRoaXMuX2NvbWJGaWx0ZXIpLCB0aGlzLl9yZWFkT25seShbXCJkYW1wZW5pbmdcIiwgXCJyZXNvbmFuY2VcIiwgXCJkZWxheVRpbWVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyLmRlZmF1bHRzID0ge1xuICAgICAgZGVsYXlUaW1lOiAuMSxcbiAgICAgIHJlc29uYW5jZTogLjUsXG4gICAgICBkYW1wZW5pbmc6IDNlM1xuICAgIH0sIHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImRhbXBlbmluZ1wiLCBcInJlc29uYW5jZVwiLCBcImRlbGF5VGltZVwiXSksIHRoaXMuX2NvbWJGaWx0ZXIuZGlzcG9zZSgpLCB0aGlzLl9jb21iRmlsdGVyID0gbnVsbCwgdGhpcy5yZXNvbmFuY2UgPSBudWxsLCB0aGlzLmRlbGF5VGltZSA9IG51bGwsIHRoaXMuX2xvd3Bhc3MuZGlzcG9zZSgpLCB0aGlzLl9sb3dwYXNzID0gbnVsbCwgdGhpcy5kYW1wZW5pbmcgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0NSk7XG4gICAgcy5kZWZhdWx0LlRpY2tzID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVGlja3MpKSByZXR1cm4gbmV3IHMuZGVmYXVsdC5UaWNrcyh0LCBlKTtcbiAgICAgIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lLmNhbGwodGhpcywgdCwgZSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGlja3MsIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKSwgcy5kZWZhdWx0LlRpY2tzLnByb3RvdHlwZS5fZGVmYXVsdFVuaXRzID0gXCJpXCIsIHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUuX25vdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0LnRpY2tzO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUuX2JlYXRzVG9Vbml0cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fZ2V0UFBRKCkgKiB0O1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUuX3NlY29uZHNUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKHQgLyAoNjAgLyB0aGlzLl9nZXRCcG0oKSkgKiB0aGlzLl9nZXRQUFEoKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tzLnByb3RvdHlwZS5fdGlja3NUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0O1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUudG9UaWNrcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKTtcbiAgICB9LCBzLmRlZmF1bHQuVGlja3MucHJvdG90eXBlLnRvU2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKSAvIHRoaXMuX2dldFBQUSgpICogKDYwIC8gdGhpcy5fZ2V0QnBtKCkpO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UaWNrcztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg1NSk7XG4gICAgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCBzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQuZGVmYXVsdHMpLCBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy5UcmFuc3BvcnQgPSB0LCB0aGlzLmlkID0gcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50Ll9ldmVudElkKyssIHRoaXMudGltZSA9IHMuZGVmYXVsdC5UaWNrcyhlLnRpbWUpLCB0aGlzLmNhbGxiYWNrID0gZS5jYWxsYmFjaywgdGhpcy5fb25jZSA9IGUub25jZTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudCksIHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudC5kZWZhdWx0cyA9IHtcbiAgICAgIG9uY2U6ICExLFxuICAgICAgY2FsbGJhY2s6IHMuZGVmYXVsdC5ub09wXG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50Ll9ldmVudElkID0gMCwgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50LnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5jYWxsYmFjayAmJiAodGhpcy5jYWxsYmFjayh0KSwgdGhpcy5fb25jZSAmJiB0aGlzLlRyYW5zcG9ydCAmJiB0aGlzLlRyYW5zcG9ydC5jbGVhcih0aGlzLmlkKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLlRyYW5zcG9ydCA9IG51bGwsIHRoaXMuY2FsbGJhY2sgPSBudWxsLCB0aGlzLnRpbWUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg4MiksIGkoMzQpLCBpKDI0KSwgaSgxNCk7XG4gICAgcy5kZWZhdWx0LlRpY2tTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiXSwgcy5kZWZhdWx0LlRpY2tTb3VyY2UpO1xuICAgICAgdGhpcy5mcmVxdWVuY3kgPSBuZXcgcy5kZWZhdWx0LlRpY2tTaWduYWwodC5mcmVxdWVuY3kpLCB0aGlzLl9yZWFkT25seShcImZyZXF1ZW5jeVwiKSwgdGhpcy5fc3RhdGUgPSBuZXcgcy5kZWZhdWx0LlRpbWVsaW5lU3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQpLCB0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwgMCksIHRoaXMuX3RpY2tPZmZzZXQgPSBuZXcgcy5kZWZhdWx0LlRpbWVsaW5lKCksIHRoaXMuc2V0VGlja3NBdFRpbWUoMCwgMCk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGlja1NvdXJjZSksIHMuZGVmYXVsdC5UaWNrU291cmNlLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiAxXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZSwgXCJzdGF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHRoaXMubm93KCkpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkgIT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmICh0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCwgdCksIHMuZGVmYXVsdC5pc0RlZmluZWQoZSkgJiYgdGhpcy5zZXRUaWNrc0F0VGltZShlLCB0KSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSB7XG4gICAgICAgIHZhciBlID0gdGhpcy5fc3RhdGUuZ2V0KHQpO1xuXG4gICAgICAgIGUudGltZSA+IDAgJiYgKHRoaXMuX3RpY2tPZmZzZXQuY2FuY2VsKGUudGltZSksIHRoaXMuX3N0YXRlLmNhbmNlbChlLnRpbWUpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlLmNhbmNlbCh0KSwgdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsIHQpLCB0aGlzLnNldFRpY2tzQXRUaW1lKDAsIHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlBhdXNlZCwgdCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zdGF0ZS5jYW5jZWwodCksIHRoaXMuX3RpY2tPZmZzZXQuY2FuY2VsKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5nZXRUaWNrc0F0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gdGhpcy50b1NlY29uZHModCk7XG5cbiAgICAgIHZhciBlID0gdGhpcy5fc3RhdGUuZ2V0TGFzdFN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLCB0KSxcbiAgICAgICAgICBpID0ge1xuICAgICAgICBzdGF0ZTogcy5kZWZhdWx0LlN0YXRlLlBhdXNlZCxcbiAgICAgICAgdGltZTogdFxuICAgICAgfTtcblxuICAgICAgdGhpcy5fc3RhdGUuYWRkKGkpO1xuXG4gICAgICB2YXIgbiA9IGUsXG4gICAgICAgICAgbyA9IDA7XG4gICAgICByZXR1cm4gdGhpcy5fc3RhdGUuZm9yRWFjaEJldHdlZW4oZS50aW1lLCB0ICsgdGhpcy5zYW1wbGVUaW1lLCBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IG4udGltZSxcbiAgICAgICAgICAgIGkgPSB0aGlzLl90aWNrT2Zmc2V0LmdldCh0LnRpbWUpO1xuXG4gICAgICAgIGkudGltZSA+PSBuLnRpbWUgJiYgKG8gPSBpLnRpY2tzLCBlID0gaS50aW1lKSwgbi5zdGF0ZSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgdC5zdGF0ZSAhPT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgKG8gKz0gdGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUodC50aW1lKSAtIHRoaXMuZnJlcXVlbmN5LmdldFRpY2tzQXRUaW1lKGUpKSwgbiA9IHQ7XG4gICAgICB9LmJpbmQodGhpcykpLCB0aGlzLl9zdGF0ZS5yZW1vdmUoaSksIG87XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZSwgXCJ0aWNrc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGlja3NBdFRpbWUodGhpcy5ub3coKSk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLnNldFRpY2tzQXRUaW1lKHQsIHRoaXMubm93KCkpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLCBcInNlY29uZHNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNlY29uZHNBdFRpbWUodGhpcy5ub3coKSk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHRoaXMubm93KCksXG4gICAgICAgICAgICBpID0gdGhpcy5mcmVxdWVuY3kudGltZVRvVGlja3ModCwgZSk7XG4gICAgICAgIHRoaXMuc2V0VGlja3NBdFRpbWUoaSwgZSk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5nZXRTZWNvbmRzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSB0aGlzLnRvU2Vjb25kcyh0KTtcblxuICAgICAgdmFyIGUgPSB0aGlzLl9zdGF0ZS5nZXRMYXN0U3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsIHQpLFxuICAgICAgICAgIGkgPSB7XG4gICAgICAgIHN0YXRlOiBzLmRlZmF1bHQuU3RhdGUuUGF1c2VkLFxuICAgICAgICB0aW1lOiB0XG4gICAgICB9O1xuXG4gICAgICB0aGlzLl9zdGF0ZS5hZGQoaSk7XG5cbiAgICAgIHZhciBuID0gZSxcbiAgICAgICAgICBvID0gMDtcbiAgICAgIHJldHVybiB0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2VlbihlLnRpbWUsIHQgKyB0aGlzLnNhbXBsZVRpbWUsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gbi50aW1lLFxuICAgICAgICAgICAgaSA9IHRoaXMuX3RpY2tPZmZzZXQuZ2V0KHQudGltZSk7XG5cbiAgICAgICAgaS50aW1lID49IG4udGltZSAmJiAobyA9IGkuc2Vjb25kcywgZSA9IGkudGltZSksIG4uc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmIHQuc3RhdGUgIT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmIChvICs9IHQudGltZSAtIGUpLCBuID0gdDtcbiAgICAgIH0uYmluZCh0aGlzKSksIHRoaXMuX3N0YXRlLnJlbW92ZShpKSwgbztcbiAgICB9LCBzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuc2V0VGlja3NBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy5fdGlja09mZnNldC5jYW5jZWwoZSksIHRoaXMuX3RpY2tPZmZzZXQuYWRkKHtcbiAgICAgICAgdGltZTogZSxcbiAgICAgICAgdGlja3M6IHQsXG4gICAgICAgIHNlY29uZHM6IHRoaXMuZnJlcXVlbmN5LmdldER1cmF0aW9uT2ZUaWNrcyh0LCBlKVxuICAgICAgfSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLmdldFN0YXRlQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5nZXRUaW1lT2ZUaWNrID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCB0aGlzLm5vdygpKTtcblxuICAgICAgdmFyIGkgPSB0aGlzLl90aWNrT2Zmc2V0LmdldChlKSxcbiAgICAgICAgICBuID0gdGhpcy5fc3RhdGUuZ2V0KGUpLFxuICAgICAgICAgIG8gPSBNYXRoLm1heChpLnRpbWUsIG4udGltZSksXG4gICAgICAgICAgYSA9IHRoaXMuZnJlcXVlbmN5LmdldFRpY2tzQXRUaW1lKG8pICsgdCAtIGkudGlja3M7XG5cbiAgICAgIHJldHVybiB0aGlzLmZyZXF1ZW5jeS5nZXRUaW1lT2ZUaWNrKGEpO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5mb3JFYWNoVGlja0JldHdlZW4gPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgdmFyIG4gPSB0aGlzLl9zdGF0ZS5nZXQodCk7XG5cbiAgICAgIGlmICh0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2Vlbih0LCBlLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBuLnN0YXRlID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiBlLnN0YXRlICE9PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiB0aGlzLmZvckVhY2hUaWNrQmV0d2VlbihNYXRoLm1heChuLnRpbWUsIHQpLCBlLnRpbWUgLSB0aGlzLnNhbXBsZVRpbWUsIGkpLCBuID0gZTtcbiAgICAgIH0uYmluZCh0aGlzKSksIHQgPSBNYXRoLm1heChuLnRpbWUsIHQpLCBuLnN0YXRlID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiB0aGlzLl9zdGF0ZSkge1xuICAgICAgICB2YXIgbyA9IHRoaXMuZnJlcXVlbmN5LmdldFRpY2tzQXRUaW1lKHQpLFxuICAgICAgICAgICAgYSA9IChvIC0gdGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUobi50aW1lKSkgJSAxO1xuICAgICAgICAwICE9PSBhICYmIChhID0gMSAtIGEpO1xuXG4gICAgICAgIGZvciAodmFyIHIgPSB0aGlzLmZyZXF1ZW5jeS5nZXRUaW1lT2ZUaWNrKG8gKyBhKSwgbCA9IG51bGw7IHIgPCBlICYmIHRoaXMuX3N0YXRlOykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpKHIsIE1hdGgucm91bmQodGhpcy5nZXRUaWNrc0F0VGltZShyKSkpO1xuICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGwgPSB0O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5fc3RhdGUgJiYgKHIgKz0gdGhpcy5mcmVxdWVuY3kuZ2V0RHVyYXRpb25PZlRpY2tzKDEsIHIpKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobCkgdGhyb3cgbDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9zdGF0ZS5kaXNwb3NlKCksIHRoaXMuX3N0YXRlID0gbnVsbCwgdGhpcy5fdGlja09mZnNldC5kaXNwb3NlKCksIHRoaXMuX3RpY2tPZmZzZXQgPSBudWxsLCB0aGlzLl93cml0YWJsZShcImZyZXF1ZW5jeVwiKSwgdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlRpY2tTb3VyY2U7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoODcpLCBpKDEzKSwgaSgyKSwgaSg0KSwgaSgxOCksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkZvbGxvd2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJzbW9vdGhpbmdcIl0sIHMuZGVmYXVsdC5Gb2xsb3dlcik7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuY3JlYXRlSW5zT3V0cygxLCAxKSwgdGhpcy5fYWJzID0gbmV3IHMuZGVmYXVsdC5BYnMoKSwgdGhpcy5fZmlsdGVyID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpLCB0aGlzLl9maWx0ZXIudHlwZSA9IFwibG93cGFzc1wiLCB0aGlzLl9maWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gMCwgdGhpcy5fZmlsdGVyLlEudmFsdWUgPSAwLCB0aGlzLl9zdWIgPSBuZXcgcy5kZWZhdWx0LlN1YnRyYWN0KCksIHRoaXMuX2RlbGF5ID0gbmV3IHMuZGVmYXVsdC5EZWxheSh0aGlzLmJsb2NrVGltZSksIHRoaXMuX3Ntb290aGluZyA9IHQuc21vb3RoaW5nLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLl9kZWxheSksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuaW5wdXQsIHRoaXMuX3N1YiwgMCwgMSksIHRoaXMuX3N1Yi5jaGFpbih0aGlzLl9hYnMsIHRoaXMuX2ZpbHRlciwgdGhpcy5vdXRwdXQpLCB0aGlzLnNtb290aGluZyA9IHQuc21vb3RoaW5nO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZvbGxvd2VyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkZvbGxvd2VyLmRlZmF1bHRzID0ge1xuICAgICAgc21vb3RoaW5nOiAuMDVcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZvbGxvd2VyLnByb3RvdHlwZSwgXCJzbW9vdGhpbmdcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zbW9vdGhpbmc7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zbW9vdGhpbmcgPSB0LCB0aGlzLl9maWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gLjUgKiBzLmRlZmF1bHQuVGltZSh0KS50b0ZyZXF1ZW5jeSgpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRm9sbG93ZXIucHJvdG90eXBlLmNvbm5lY3QgPSBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuY29ubmVjdCwgcy5kZWZhdWx0LkZvbGxvd2VyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZmlsdGVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZmlsdGVyID0gbnVsbCwgdGhpcy5fZGVsYXkuZGlzcG9zZSgpLCB0aGlzLl9kZWxheSA9IG51bGwsIHRoaXMuX3N1Yi5kaXNjb25uZWN0KCksIHRoaXMuX3N1YiA9IG51bGwsIHRoaXMuX2Ficy5kaXNwb3NlKCksIHRoaXMuX2FicyA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZvbGxvd2VyO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDQyKSwgaSgyKSwgaSgxNCksIGkoMTgpLCBpKDMpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImRlbGF5VGltZVwiLCBcInJlc29uYW5jZVwiXSwgcy5kZWZhdWx0LkZlZWRiYWNrQ29tYkZpbHRlcik7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuX2RlbGF5ID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5EZWxheSh0LmRlbGF5VGltZSksIHRoaXMuZGVsYXlUaW1lID0gdGhpcy5fZGVsYXkuZGVsYXlUaW1lLCB0aGlzLl9mZWVkYmFjayA9IG5ldyBzLmRlZmF1bHQuR2Fpbih0LnJlc29uYW5jZSwgcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLCB0aGlzLnJlc29uYW5jZSA9IHRoaXMuX2ZlZWRiYWNrLmdhaW4sIHRoaXMuX2RlbGF5LmNoYWluKHRoaXMuX2ZlZWRiYWNrLCB0aGlzLl9kZWxheSksIHRoaXMuX3JlYWRPbmx5KFtcInJlc29uYW5jZVwiLCBcImRlbGF5VGltZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRmVlZGJhY2tDb21iRmlsdGVyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkZlZWRiYWNrQ29tYkZpbHRlci5kZWZhdWx0cyA9IHtcbiAgICAgIGRlbGF5VGltZTogLjEsXG4gICAgICByZXNvbmFuY2U6IC41XG4gICAgfSwgcy5kZWZhdWx0LkZlZWRiYWNrQ29tYkZpbHRlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcInJlc29uYW5jZVwiLCBcImRlbGF5VGltZVwiXSksIHRoaXMuX2RlbGF5LmRpc3Bvc2UoKSwgdGhpcy5fZGVsYXkgPSBudWxsLCB0aGlzLmRlbGF5VGltZSA9IG51bGwsIHRoaXMuX2ZlZWRiYWNrLmRpc3Bvc2UoKSwgdGhpcy5fZmVlZGJhY2sgPSBudWxsLCB0aGlzLnJlc29uYW5jZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZlZWRiYWNrQ29tYkZpbHRlcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg5KSwgaSgyKSwgaSgzKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuTXVsdGliYW5kU3BsaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImxvd0ZyZXF1ZW5jeVwiLCBcImhpZ2hGcmVxdWVuY3lcIl0sIHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdCk7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5vdXRwdXQgPSBuZXcgQXJyYXkoMyksIHRoaXMubG93ID0gdGhpcy5vdXRwdXRbMF0gPSBuZXcgcy5kZWZhdWx0LkZpbHRlcigwLCBcImxvd3Bhc3NcIiksIHRoaXMuX2xvd01pZEZpbHRlciA9IG5ldyBzLmRlZmF1bHQuRmlsdGVyKDAsIFwiaGlnaHBhc3NcIiksIHRoaXMubWlkID0gdGhpcy5vdXRwdXRbMV0gPSBuZXcgcy5kZWZhdWx0LkZpbHRlcigwLCBcImxvd3Bhc3NcIiksIHRoaXMuaGlnaCA9IHRoaXMub3V0cHV0WzJdID0gbmV3IHMuZGVmYXVsdC5GaWx0ZXIoMCwgXCJoaWdocGFzc1wiKSwgdGhpcy5sb3dGcmVxdWVuY3kgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0Lmxvd0ZyZXF1ZW5jeSwgcy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSwgdGhpcy5oaWdoRnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5oaWdoRnJlcXVlbmN5LCBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLCB0aGlzLlEgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LlEpLCB0aGlzLmlucHV0LmZhbih0aGlzLmxvdywgdGhpcy5oaWdoKSwgdGhpcy5pbnB1dC5jaGFpbih0aGlzLl9sb3dNaWRGaWx0ZXIsIHRoaXMubWlkKSwgdGhpcy5sb3dGcmVxdWVuY3kuY29ubmVjdCh0aGlzLmxvdy5mcmVxdWVuY3kpLCB0aGlzLmxvd0ZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2xvd01pZEZpbHRlci5mcmVxdWVuY3kpLCB0aGlzLmhpZ2hGcmVxdWVuY3kuY29ubmVjdCh0aGlzLm1pZC5mcmVxdWVuY3kpLCB0aGlzLmhpZ2hGcmVxdWVuY3kuY29ubmVjdCh0aGlzLmhpZ2guZnJlcXVlbmN5KSwgdGhpcy5RLmNvbm5lY3QodGhpcy5sb3cuUSksIHRoaXMuUS5jb25uZWN0KHRoaXMuX2xvd01pZEZpbHRlci5RKSwgdGhpcy5RLmNvbm5lY3QodGhpcy5taWQuUSksIHRoaXMuUS5jb25uZWN0KHRoaXMuaGlnaC5RKSwgdGhpcy5fcmVhZE9ubHkoW1wiaGlnaFwiLCBcIm1pZFwiLCBcImxvd1wiLCBcImhpZ2hGcmVxdWVuY3lcIiwgXCJsb3dGcmVxdWVuY3lcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk11bHRpYmFuZFNwbGl0LCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0Lk11bHRpYmFuZFNwbGl0LmRlZmF1bHRzID0ge1xuICAgICAgbG93RnJlcXVlbmN5OiA0MDAsXG4gICAgICBoaWdoRnJlcXVlbmN5OiAyNTAwLFxuICAgICAgUTogMVxuICAgIH0sIHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImhpZ2hcIiwgXCJtaWRcIiwgXCJsb3dcIiwgXCJoaWdoRnJlcXVlbmN5XCIsIFwibG93RnJlcXVlbmN5XCJdKSwgdGhpcy5sb3cuZGlzcG9zZSgpLCB0aGlzLmxvdyA9IG51bGwsIHRoaXMuX2xvd01pZEZpbHRlci5kaXNwb3NlKCksIHRoaXMuX2xvd01pZEZpbHRlciA9IG51bGwsIHRoaXMubWlkLmRpc3Bvc2UoKSwgdGhpcy5taWQgPSBudWxsLCB0aGlzLmhpZ2guZGlzcG9zZSgpLCB0aGlzLmhpZ2ggPSBudWxsLCB0aGlzLmxvd0ZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMubG93RnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5oaWdoRnJlcXVlbmN5LmRpc3Bvc2UoKSwgdGhpcy5oaWdoRnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5RLmRpc3Bvc2UoKSwgdGhpcy5RID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTXVsdGliYW5kU3BsaXQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNyk7XG4gICAgcy5kZWZhdWx0LlBvdyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLCB0aGlzLl9leHAgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCAxKSwgdGhpcy5fZXhwU2NhbGVyID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKHRoaXMuX2V4cEZ1bmModGhpcy5fZXhwKSwgODE5Mik7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUG93LCBzLmRlZmF1bHQuU2lnbmFsQmFzZSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUG93LnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4cDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V4cCA9IHQsIHRoaXMuX2V4cFNjYWxlci5zZXRNYXAodGhpcy5fZXhwRnVuYyh0aGlzLl9leHApKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlBvdy5wcm90b3R5cGUuX2V4cEZ1bmMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdyhNYXRoLmFicyhlKSwgdCk7XG4gICAgICB9O1xuICAgIH0sIHMuZGVmYXVsdC5Qb3cucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZXhwU2NhbGVyLmRpc3Bvc2UoKSwgdGhpcy5fZXhwU2NhbGVyID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUG93O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBzLmRlZmF1bHQuVGltZUJhc2UgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5UaW1lQmFzZSkpIHJldHVybiBuZXcgcy5kZWZhdWx0LlRpbWVCYXNlKHQsIGUpO1xuICAgICAgaWYgKHRoaXMuX3ZhbCA9IHQsIHRoaXMuX3VuaXRzID0gZSwgcy5kZWZhdWx0LmlzVW5kZWYodGhpcy5fdW5pdHMpICYmIHMuZGVmYXVsdC5pc1N0cmluZyh0aGlzLl92YWwpICYmIHBhcnNlRmxvYXQodGhpcy5fdmFsKSA9PSB0aGlzLl92YWwgJiYgXCIrXCIgIT09IHRoaXMuX3ZhbC5jaGFyQXQoMCkpIHRoaXMuX3ZhbCA9IHBhcnNlRmxvYXQodGhpcy5fdmFsKSwgdGhpcy5fdW5pdHMgPSB0aGlzLl9kZWZhdWx0VW5pdHM7ZWxzZSBpZiAodCAmJiB0LmNvbnN0cnVjdG9yID09PSB0aGlzLmNvbnN0cnVjdG9yKSB0aGlzLl92YWwgPSB0Ll92YWwsIHRoaXMuX3VuaXRzID0gdC5fdW5pdHM7ZWxzZSBpZiAodCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5UaW1lQmFzZSkgc3dpdGNoICh0aGlzLl9kZWZhdWx0VW5pdHMpIHtcbiAgICAgICAgY2FzZSBcInNcIjpcbiAgICAgICAgICB0aGlzLl92YWwgPSB0LnRvU2Vjb25kcygpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJpXCI6XG4gICAgICAgICAgdGhpcy5fdmFsID0gdC50b1RpY2tzKCk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBcImh6XCI6XG4gICAgICAgICAgdGhpcy5fdmFsID0gdC50b0ZyZXF1ZW5jeSgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgXCJtaWRpXCI6XG4gICAgICAgICAgdGhpcy5fdmFsID0gdC50b01pZGkoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVucmVjb2duaXplZCBkZWZhdWx0IHVuaXRzIFwiICsgdGhpcy5fZGVmYXVsdFVuaXRzKTtcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UaW1lQmFzZSksIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zID0ge1xuICAgICAgbjoge1xuICAgICAgICByZWdleHA6IC9eKFxcZCspbihcXC4/KSQvaSxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgICAgIHQgPSBwYXJzZUludCh0KTtcbiAgICAgICAgICB2YXIgaSA9IFwiLlwiID09PSBlID8gMS41IDogMTtcbiAgICAgICAgICByZXR1cm4gMSA9PT0gdCA/IHRoaXMuX2JlYXRzVG9Vbml0cyh0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkpICogaSA6IHRoaXMuX2JlYXRzVG9Vbml0cyg0IC8gdCkgKiBpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdDoge1xuICAgICAgICByZWdleHA6IC9eKFxcZCspdCQvaSxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0ID0gcGFyc2VJbnQodCksIHRoaXMuX2JlYXRzVG9Vbml0cyg4IC8gKDMgKiBwYXJzZUludCh0KSkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbToge1xuICAgICAgICByZWdleHA6IC9eKFxcZCspbSQvaSxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VJbnQodCkgKiB0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaToge1xuICAgICAgICByZWdleHA6IC9eKFxcZCspaSQvaSxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl90aWNrc1RvVW5pdHMocGFyc2VJbnQodCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaHo6IHtcbiAgICAgICAgcmVnZXhwOiAvXihcXGQrKD86XFwuXFxkKyk/KWh6JC9pLFxuICAgICAgICBtZXRob2Q6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2ZyZXF1ZW5jeVRvVW5pdHMocGFyc2VGbG9hdCh0KSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0cjoge1xuICAgICAgICByZWdleHA6IC9eKFxcZCsoPzpcXC5cXGQrKT8pOihcXGQrKD86XFwuXFxkKyk/KTo/KFxcZCsoPzpcXC5cXGQrKT8pPyQvLFxuICAgICAgICBtZXRob2Q6IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICAgICAgdmFyIHMgPSAwO1xuICAgICAgICAgIHJldHVybiB0ICYmIFwiMFwiICE9PSB0ICYmIChzICs9IHRoaXMuX2JlYXRzVG9Vbml0cyh0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkgKiBwYXJzZUZsb2F0KHQpKSksIGUgJiYgXCIwXCIgIT09IGUgJiYgKHMgKz0gdGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoZSkpKSwgaSAmJiBcIjBcIiAhPT0gaSAmJiAocyArPSB0aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VGbG9hdChpKSAvIDQpKSwgcztcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHM6IHtcbiAgICAgICAgcmVnZXhwOiAvXihcXGQrKD86XFwuXFxkKyk/KXMkLyxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zZWNvbmRzVG9Vbml0cyhwYXJzZUZsb2F0KHQpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNhbXBsZXM6IHtcbiAgICAgICAgcmVnZXhwOiAvXihcXGQrKXNhbXBsZXMkLyxcbiAgICAgICAgbWV0aG9kOiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiBwYXJzZUludCh0KSAvIHRoaXMuY29udGV4dC5zYW1wbGVSYXRlO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICByZWdleHA6IC9eKFxcZCsoPzpcXC5cXGQrKT8pJC8sXG4gICAgICAgIG1ldGhvZDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZXhwcmVzc2lvbnNbdGhpcy5fZGVmYXVsdFVuaXRzXS5tZXRob2QuY2FsbCh0aGlzLCB0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2RlZmF1bHRVbml0cyA9IFwic1wiLCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9nZXRCcG0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlRyYW5zcG9ydCA/IHMuZGVmYXVsdC5UcmFuc3BvcnQuYnBtLnZhbHVlIDogMTIwO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2dldFRpbWVTaWduYXR1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlRyYW5zcG9ydCA/IHMuZGVmYXVsdC5UcmFuc3BvcnQudGltZVNpZ25hdHVyZSA6IDQ7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fZ2V0UFBRID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UcmFuc3BvcnQgPyBzLmRlZmF1bHQuVHJhbnNwb3J0LlBQUSA6IDE5MjtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9ub3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5ub3coKTtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9mcmVxdWVuY3lUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiAxIC8gdDtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9iZWF0c1RvVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIDYwIC8gdGhpcy5fZ2V0QnBtKCkgKiB0O1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX3NlY29uZHNUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0O1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX3RpY2tzVG9Vbml0cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCAqICh0aGlzLl9iZWF0c1RvVW5pdHMoMSkgLyB0aGlzLl9nZXRQUFEoKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fbm9BcmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbm93KCk7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS52YWx1ZU9mID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHMuZGVmYXVsdC5pc1VuZGVmKHRoaXMuX3ZhbCkpIHJldHVybiB0aGlzLl9ub0FyZygpO1xuXG4gICAgICBpZiAocy5kZWZhdWx0LmlzU3RyaW5nKHRoaXMuX3ZhbCkgJiYgcy5kZWZhdWx0LmlzVW5kZWYodGhpcy5fdW5pdHMpKSB7XG4gICAgICAgIGZvciAodmFyIHQgaW4gdGhpcy5fZXhwcmVzc2lvbnMpIGlmICh0aGlzLl9leHByZXNzaW9uc1t0XS5yZWdleHAudGVzdCh0aGlzLl92YWwudHJpbSgpKSkge1xuICAgICAgICAgIHRoaXMuX3VuaXRzID0gdDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzLmRlZmF1bHQuaXNPYmplY3QodGhpcy5fdmFsKSkge1xuICAgICAgICB2YXIgZSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl92YWwpIHtcbiAgICAgICAgICB2YXIgbiA9IHRoaXMuX3ZhbFtpXTtcbiAgICAgICAgICBlICs9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKGkpLnZhbHVlT2YoKSAqIG47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHMuZGVmYXVsdC5pc0RlZmluZWQodGhpcy5fdW5pdHMpKSB7XG4gICAgICAgIHZhciBvID0gdGhpcy5fZXhwcmVzc2lvbnNbdGhpcy5fdW5pdHNdLFxuICAgICAgICAgICAgYSA9IHRoaXMuX3ZhbC50b1N0cmluZygpLnRyaW0oKS5tYXRjaChvLnJlZ2V4cCk7XG5cbiAgICAgICAgcmV0dXJuIGEgPyBvLm1ldGhvZC5hcHBseSh0aGlzLCBhLnNsaWNlKDEpKSA6IG8ubWV0aG9kLmNhbGwodGhpcywgcGFyc2VGbG9hdCh0aGlzLl92YWwpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3ZhbDtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvU2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKTtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvRnJlcXVlbmN5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIDEgLyB0aGlzLnRvU2Vjb25kcygpO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUudG9TYW1wbGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudG9TZWNvbmRzKCkgKiB0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZTtcbiAgICB9LCBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvTWlsbGlzZWNvbmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIDFlMyAqIHRoaXMudG9TZWNvbmRzKCk7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fdmFsID0gbnVsbCwgdGhpcy5fdW5pdHMgPSBudWxsO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UaW1lQmFzZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2MiksIGkoNDYpO1xuICAgIHMuZGVmYXVsdC5UaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVGltZSkpIHJldHVybiBuZXcgcy5kZWZhdWx0LlRpbWUodCwgZSk7XG4gICAgICBzLmRlZmF1bHQuVGltZUJhc2UuY2FsbCh0aGlzLCB0LCBlKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UaW1lLCBzLmRlZmF1bHQuVGltZUJhc2UpLCBzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zID0gT2JqZWN0LmFzc2lnbih7fSwgcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fZXhwcmVzc2lvbnMsIHtcbiAgICAgIHF1YW50aXplOiB7XG4gICAgICAgIHJlZ2V4cDogL15AKC4rKS8sXG4gICAgICAgIG1ldGhvZDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICBpZiAocy5kZWZhdWx0LlRyYW5zcG9ydCkge1xuICAgICAgICAgICAgdmFyIGUgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWNvbmRzVG9Vbml0cyhzLmRlZmF1bHQuVHJhbnNwb3J0Lm5leHRTdWJkaXZpc2lvbihlKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBub3c6IHtcbiAgICAgICAgcmVnZXhwOiAvXlxcKyguKykvLFxuICAgICAgICBtZXRob2Q6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX25vdygpICsgbmV3IHRoaXMuY29uc3RydWN0b3IodCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlRpbWUucHJvdG90eXBlLnF1YW50aXplID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAxKTtcbiAgICAgIHZhciBpID0gbmV3IHRoaXMuY29uc3RydWN0b3IodCksXG4gICAgICAgICAgbiA9IHRoaXMudmFsdWVPZigpO1xuICAgICAgcmV0dXJuIG4gKyAoTWF0aC5yb3VuZChuIC8gaSkgKiBpIC0gbikgKiBlO1xuICAgIH0sIHMuZGVmYXVsdC5UaW1lLnByb3RvdHlwZS50b05vdGF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgdCA9IHRoaXMudG9TZWNvbmRzKCksIGUgPSBbXCIxbVwiXSwgaSA9IDE7IGkgPCA4OyBpKyspIHtcbiAgICAgICAgdmFyIG4gPSBNYXRoLnBvdygyLCBpKTtcbiAgICAgICAgZS5wdXNoKG4gKyBcIm4uXCIpLCBlLnB1c2gobiArIFwiblwiKSwgZS5wdXNoKG4gKyBcInRcIik7XG4gICAgICB9XG5cbiAgICAgIGUucHVzaChcIjBcIik7XG4gICAgICB2YXIgbyA9IGVbMF0sXG4gICAgICAgICAgYSA9IHMuZGVmYXVsdC5UaW1lKGVbMF0pLnRvU2Vjb25kcygpO1xuICAgICAgcmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgaSA9IHMuZGVmYXVsdC5UaW1lKGUpLnRvU2Vjb25kcygpO1xuICAgICAgICBNYXRoLmFicyhpIC0gdCkgPCBNYXRoLmFicyhhIC0gdCkgJiYgKG8gPSBlLCBhID0gaSk7XG4gICAgICB9KSwgbztcbiAgICB9LCBzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9CYXJzQmVhdHNTaXh0ZWVudGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSB0aGlzLl9iZWF0c1RvVW5pdHMoMSksXG4gICAgICAgICAgZSA9IHRoaXMudmFsdWVPZigpIC8gdDtcblxuICAgICAgZSA9IHBhcnNlRmxvYXQoZS50b0ZpeGVkKDQpKTtcbiAgICAgIHZhciBpID0gTWF0aC5mbG9vcihlIC8gdGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpKSxcbiAgICAgICAgICBzID0gZSAlIDEgKiA0O1xuICAgICAgcmV0dXJuIGUgPSBNYXRoLmZsb29yKGUpICUgdGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpLCAocyA9IHMudG9TdHJpbmcoKSkubGVuZ3RoID4gMyAmJiAocyA9IHBhcnNlRmxvYXQocGFyc2VGbG9hdChzKS50b0ZpeGVkKDMpKSksIFtpLCBlLCBzXS5qb2luKFwiOlwiKTtcbiAgICB9LCBzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9UaWNrcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gdGhpcy5fYmVhdHNUb1VuaXRzKDEpLFxuICAgICAgICAgIGUgPSB0aGlzLnZhbHVlT2YoKSAvIHQ7XG5cbiAgICAgIHJldHVybiBNYXRoLnJvdW5kKGUgKiB0aGlzLl9nZXRQUFEoKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRpbWUucHJvdG90eXBlLnRvU2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKTtcbiAgICB9LCBzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9NaWRpID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbSh0aGlzLnRvRnJlcXVlbmN5KCkpO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UaW1lO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDExKSwgaSg2KSwgaSgzKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuc3VwcG9ydGVkICYmIChPc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUuc2V0UGVyaW9kaWNXYXZlIHx8IChPc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUuc2V0UGVyaW9kaWNXYXZlID0gT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLnNldFdhdmVUYWJsZSksIEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlUGVyaW9kaWNXYXZlIHx8IChBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZVBlcmlvZGljV2F2ZSA9IEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlV2F2ZVRhYmxlKSksIHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCIsIFwidHlwZVwiXSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLCB0KSwgdGhpcy5vbmVuZGVkID0gdC5vbmVuZGVkLCB0aGlzLl9zdGFydFRpbWUgPSAtMSwgdGhpcy5fc3RvcFRpbWUgPSAtMSwgdGhpcy5fZ2Fpbk5vZGUgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuR2FpbigwKSwgdGhpcy5fb3NjaWxsYXRvciA9IHRoaXMuY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX29zY2lsbGF0b3IsIHRoaXMuX2dhaW5Ob2RlKSwgdGhpcy50eXBlID0gdC50eXBlLCB0aGlzLmZyZXF1ZW5jeSA9IG5ldyBzLmRlZmF1bHQuUGFyYW0oe1xuICAgICAgICBwYXJhbTogdGhpcy5fb3NjaWxsYXRvci5mcmVxdWVuY3ksXG4gICAgICAgIHVuaXRzOiBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3ksXG4gICAgICAgIHZhbHVlOiB0LmZyZXF1ZW5jeVxuICAgICAgfSksIHRoaXMuZGV0dW5lID0gbmV3IHMuZGVmYXVsdC5QYXJhbSh7XG4gICAgICAgIHBhcmFtOiB0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSxcbiAgICAgICAgdW5pdHM6IHMuZGVmYXVsdC5UeXBlLkNlbnRzLFxuICAgICAgICB2YWx1ZTogdC5kZXR1bmVcbiAgICAgIH0pLCB0aGlzLl9nYWluID0gMTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZSwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZS5kZWZhdWx0cyA9IHtcbiAgICAgIGZyZXF1ZW5jeTogNDQwLFxuICAgICAgZGV0dW5lOiAwLFxuICAgICAgdHlwZTogXCJzaW5lXCIsXG4gICAgICBvbmVuZGVkOiBzLmRlZmF1bHQubm9PcFxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0ZUF0VGltZSh0aGlzLm5vdygpKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlLnByb3RvdHlwZS5nZXRTdGF0ZUF0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCAtMSAhPT0gdGhpcy5fc3RhcnRUaW1lICYmIHQgPj0gdGhpcy5fc3RhcnRUaW1lICYmICgtMSA9PT0gdGhpcy5fc3RvcFRpbWUgfHwgdCA8PSB0aGlzLl9zdG9wVGltZSkgPyBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCA6IHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkO1xuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKHRoaXMubG9nKFwic3RhcnRcIiwgdCksIC0xICE9PSB0aGlzLl9zdGFydFRpbWUpIHRocm93IG5ldyBFcnJvcihcImNhbm5vdCBjYWxsIE9zY2lsbGF0b3JOb2RlLnN0YXJ0IG1vcmUgdGhhbiBvbmNlXCIpO1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0VGltZSA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zdGFydFRpbWUgPSBNYXRoLm1heCh0aGlzLl9zdGFydFRpbWUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSksIHRoaXMuX29zY2lsbGF0b3Iuc3RhcnQodGhpcy5fc3RhcnRUaW1lKSwgdGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgxLCB0aGlzLl9zdGFydFRpbWUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUuc2V0UGVyaW9kaWNXYXZlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9yLnNldFBlcmlvZGljV2F2ZSh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMubG9nKFwic3RvcFwiLCB0KSwgdGhpcy5hc3NlcnQoLTEgIT09IHRoaXMuX3N0YXJ0VGltZSwgXCInc3RhcnQnIG11c3QgYmUgY2FsbGVkIGJlZm9yZSAnc3RvcCdcIiksIHRoaXMuY2FuY2VsU3RvcCgpLCB0aGlzLl9zdG9wVGltZSA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9zdG9wVGltZSA9IE1hdGgubWF4KHRoaXMuX3N0b3BUaW1lLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpLCB0aGlzLl9zdG9wVGltZSA+IHRoaXMuX3N0YXJ0VGltZSA/ICh0aGlzLl9nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsIHRoaXMuX3N0b3BUaW1lKSwgdGhpcy5jb250ZXh0LmNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KSwgdGhpcy5fdGltZW91dCA9IHRoaXMuY29udGV4dC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fb3NjaWxsYXRvci5zdG9wKHRoaXMubm93KCkpLCB0aGlzLm9uZW5kZWQoKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy5fb3NjaWxsYXRvciAmJiAodGhpcy5fb3NjaWxsYXRvci5kaXNjb25uZWN0KCksIHRoaXMuX2dhaW5Ob2RlLmRpc2Nvbm5lY3QoKSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSwgMTAwKTtcbiAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5fc3RvcFRpbWUgLSB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpKSA6IHRoaXMuX2dhaW5Ob2RlLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMuX3N0YXJ0VGltZSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlLnByb3RvdHlwZS5jYW5jZWxTdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIC0xICE9PSB0aGlzLl9zdGFydFRpbWUgJiYgKHRoaXMuX2dhaW5Ob2RlLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMuX3N0YXJ0VGltZSArIHRoaXMuc2FtcGxlVGltZSksIHRoaXMuY29udGV4dC5jbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCksIHRoaXMuX3N0b3BUaW1lID0gLTEpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9yLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vc2NpbGxhdG9yLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fd2FzRGlzcG9zZWQgfHwgKHRoaXMuX3dhc0Rpc3Bvc2VkID0gITAsIHRoaXMuY29udGV4dC5jbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCksIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5vbmVuZGVkID0gbnVsbCwgdGhpcy5fb3NjaWxsYXRvci5kaXNjb25uZWN0KCksIHRoaXMuX29zY2lsbGF0b3IgPSBudWxsLCB0aGlzLl9nYWluTm9kZS5kaXNwb3NlKCksIHRoaXMuX2dhaW5Ob2RlID0gbnVsbCwgdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSwgdGhpcy5kZXR1bmUgPSBudWxsKSwgdGhpcztcbiAgICB9O1xuICAgIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxMSksIGkoNiksIGkoNTcpLCBpKDMyKTtcbiAgICBzLmRlZmF1bHQuUGxheWVyID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHZhciBlO1xuICAgICAgdCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5CdWZmZXIgJiYgdC5sb2FkZWQgPyAodCA9IHQuZ2V0KCksIGUgPSBzLmRlZmF1bHQuUGxheWVyLmRlZmF1bHRzKSA6IGUgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJ1cmxcIiwgXCJvbmxvYWRcIl0sIHMuZGVmYXVsdC5QbGF5ZXIpLCBzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcywgZSksIHRoaXMuYXV0b3N0YXJ0ID0gZS5hdXRvc3RhcnQsIHRoaXMuX2J1ZmZlciA9IG5ldyBzLmRlZmF1bHQuQnVmZmVyKHtcbiAgICAgICAgdXJsOiBlLnVybCxcbiAgICAgICAgb25sb2FkOiB0aGlzLl9vbmxvYWQuYmluZCh0aGlzLCBlLm9ubG9hZCksXG4gICAgICAgIHJldmVyc2U6IGUucmV2ZXJzZVxuICAgICAgfSksIHQgaW5zdGFuY2VvZiBBdWRpb0J1ZmZlciAmJiB0aGlzLl9idWZmZXIuc2V0KHQpLCB0aGlzLl9sb29wID0gZS5sb29wLCB0aGlzLl9sb29wU3RhcnQgPSBlLmxvb3BTdGFydCwgdGhpcy5fbG9vcEVuZCA9IGUubG9vcEVuZCwgdGhpcy5fcGxheWJhY2tSYXRlID0gZS5wbGF5YmFja1JhdGUsIHRoaXMuX2FjdGl2ZVNvdXJjZXMgPSBbXSwgdGhpcy5mYWRlSW4gPSBlLmZhZGVJbiwgdGhpcy5mYWRlT3V0ID0gZS5mYWRlT3V0O1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBsYXllciwgcy5kZWZhdWx0LlNvdXJjZSksIHMuZGVmYXVsdC5QbGF5ZXIuZGVmYXVsdHMgPSB7XG4gICAgICBvbmxvYWQ6IHMuZGVmYXVsdC5ub09wLFxuICAgICAgcGxheWJhY2tSYXRlOiAxLFxuICAgICAgbG9vcDogITEsXG4gICAgICBhdXRvc3RhcnQ6ICExLFxuICAgICAgbG9vcFN0YXJ0OiAwLFxuICAgICAgbG9vcEVuZDogMCxcbiAgICAgIHJldmVyc2U6ICExLFxuICAgICAgZmFkZUluOiAwLFxuICAgICAgZmFkZU91dDogMFxuICAgIH0sIHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlci5sb2FkKHQsIHRoaXMuX29ubG9hZC5iaW5kKHRoaXMsIGUpKTtcbiAgICB9LCBzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fb25sb2FkID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICh0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0Lm5vT3ApKSh0aGlzKSwgdGhpcy5hdXRvc3RhcnQgJiYgdGhpcy5zdGFydCgpO1xuICAgIH0sIHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLl9vblNvdXJjZUVuZCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRoaXMuX2FjdGl2ZVNvdXJjZXMuaW5kZXhPZih0KTtcblxuICAgICAgdGhpcy5fYWN0aXZlU291cmNlcy5zcGxpY2UoZSwgMSksIDAgIT09IHRoaXMuX2FjdGl2ZVNvdXJjZXMubGVuZ3RoIHx8IHRoaXMuX3N5bmNlZCB8fCB0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwgcy5kZWZhdWx0Lm5vdygpKTtcbiAgICB9LCBzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgZSA9IHRoaXMuX2xvb3AgPyBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCB0aGlzLl9sb29wU3RhcnQpIDogcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgMCksIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy5fc3luY2VkICYmIChlICo9IHRoaXMuX3BsYXliYWNrUmF0ZSk7XG4gICAgICB2YXIgbiA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGksIE1hdGgubWF4KHRoaXMuX2J1ZmZlci5kdXJhdGlvbiAtIGUsIDApKTtcbiAgICAgIG4gPSB0aGlzLnRvU2Vjb25kcyhuKSwgbiAvPSB0aGlzLl9wbGF5YmFja1JhdGUsIHQgPSB0aGlzLnRvU2Vjb25kcyh0KTtcbiAgICAgIHZhciBvID0gbmV3IHMuZGVmYXVsdC5CdWZmZXJTb3VyY2Uoe1xuICAgICAgICBidWZmZXI6IHRoaXMuX2J1ZmZlcixcbiAgICAgICAgbG9vcDogdGhpcy5fbG9vcCxcbiAgICAgICAgbG9vcFN0YXJ0OiB0aGlzLl9sb29wU3RhcnQsXG4gICAgICAgIGxvb3BFbmQ6IHRoaXMuX2xvb3BFbmQsXG4gICAgICAgIG9uZW5kZWQ6IHRoaXMuX29uU291cmNlRW5kLmJpbmQodGhpcyksXG4gICAgICAgIHBsYXliYWNrUmF0ZTogdGhpcy5fcGxheWJhY2tSYXRlLFxuICAgICAgICBmYWRlSW46IHRoaXMuZmFkZUluLFxuICAgICAgICBmYWRlT3V0OiB0aGlzLmZhZGVPdXRcbiAgICAgIH0pLmNvbm5lY3QodGhpcy5vdXRwdXQpO1xuICAgICAgcmV0dXJuIHRoaXMuX2xvb3AgfHwgdGhpcy5fc3luY2VkIHx8IHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLCB0ICsgbiksIHRoaXMuX2FjdGl2ZVNvdXJjZXMucHVzaChvKSwgdGhpcy5fbG9vcCAmJiBzLmRlZmF1bHQuaXNVbmRlZihpKSA/IG8uc3RhcnQodCwgZSkgOiBvLnN0YXJ0KHQsIGUsIG4gLSB0aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVPdXQpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5zdG9wKHQpO1xuICAgICAgfSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUucmVzdGFydCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcCh0KSwgdGhpcy5fc3RhcnQodCwgZSwgaSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gZSA9IHRoaXMudG9TZWNvbmRzKGUpLCB0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShlKSA9PT0gcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQgJiYgKHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RvcChlKSwgdGhpcy5fc3RhcnQoZSwgdCkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLnNldExvb3BQb2ludHMgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHRoaXMubG9vcFN0YXJ0ID0gdCwgdGhpcy5sb29wRW5kID0gZSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUsIFwibG9vcFN0YXJ0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9vcFN0YXJ0O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbG9vcFN0YXJ0ID0gdCwgdGhpcy5fYWN0aXZlU291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5sb29wU3RhcnQgPSB0O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLCBcImxvb3BFbmRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb29wRW5kO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbG9vcEVuZCA9IHQsIHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUubG9vcEVuZCA9IHQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUsIFwiYnVmZmVyXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnVmZmVyO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyLnNldCh0KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLCBcImxvb3BcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb29wO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xvb3AgIT09IHQgJiYgKHRoaXMuX2xvb3AgPSB0LCB0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLmxvb3AgPSB0O1xuICAgICAgICB9KSwgdCkpIHtcbiAgICAgICAgICB2YXIgZSA9IHRoaXMuX3N0YXRlLmdldE5leHRTdGF0ZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwgdGhpcy5ub3coKSk7XG5cbiAgICAgICAgICBlICYmIHRoaXMuX3N0YXRlLmNhbmNlbChlLnRpbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZSwgXCJwbGF5YmFja1JhdGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wbGF5YmFja1JhdGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wbGF5YmFja1JhdGUgPSB0O1xuXG4gICAgICAgIHZhciBlID0gdGhpcy5ub3coKSxcbiAgICAgICAgICAgIGkgPSB0aGlzLl9zdGF0ZS5nZXROZXh0U3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsIGUpO1xuXG4gICAgICAgIGkgJiYgdGhpcy5fc3RhdGUuY2FuY2VsKGkudGltZSksIHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoaSkge1xuICAgICAgICAgIGkuY2FuY2VsU3RvcCgpLCBpLnBsYXliYWNrUmF0ZS5zZXRWYWx1ZUF0VGltZSh0LCBlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZSwgXCJyZXZlcnNlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnVmZmVyLnJldmVyc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9idWZmZXIucmV2ZXJzZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZSwgXCJsb2FkZWRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXIubG9hZGVkO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB0LmRpc3Bvc2UoKTtcbiAgICAgIH0pLCB0aGlzLl9hY3RpdmVTb3VyY2VzID0gbnVsbCwgcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9idWZmZXIuZGlzcG9zZSgpLCB0aGlzLl9idWZmZXIgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5QbGF5ZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMzEpLCBpKDQxKSwgaSgzNyksIGkoMiksIGkoOSksIGkoMjUpO1xuICAgIHMuZGVmYXVsdC5Nb25vU3ludGggPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHMuZGVmYXVsdC5Nb25vU3ludGguZGVmYXVsdHMpLCBzLmRlZmF1bHQuTW9ub3Bob25pYy5jYWxsKHRoaXMsIHQpLCB0aGlzLm9zY2lsbGF0b3IgPSBuZXcgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yKHQub3NjaWxsYXRvciksIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeSwgdGhpcy5kZXR1bmUgPSB0aGlzLm9zY2lsbGF0b3IuZGV0dW5lLCB0aGlzLmZpbHRlciA9IG5ldyBzLmRlZmF1bHQuRmlsdGVyKHQuZmlsdGVyKSwgdGhpcy5maWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gNWUzLCB0aGlzLmZpbHRlckVudmVsb3BlID0gbmV3IHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZSh0LmZpbHRlckVudmVsb3BlKSwgdGhpcy5lbnZlbG9wZSA9IG5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksIHRoaXMub3NjaWxsYXRvci5jaGFpbih0aGlzLmZpbHRlciwgdGhpcy5lbnZlbG9wZSwgdGhpcy5vdXRwdXQpLCB0aGlzLmZpbHRlckVudmVsb3BlLmNvbm5lY3QodGhpcy5maWx0ZXIuZnJlcXVlbmN5KSwgdGhpcy5fcmVhZE9ubHkoW1wib3NjaWxsYXRvclwiLCBcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiLCBcImZpbHRlclwiLCBcImZpbHRlckVudmVsb3BlXCIsIFwiZW52ZWxvcGVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1vbm9TeW50aCwgcy5kZWZhdWx0Lk1vbm9waG9uaWMpLCBzLmRlZmF1bHQuTW9ub1N5bnRoLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiBcIkM0XCIsXG4gICAgICBkZXR1bmU6IDAsXG4gICAgICBvc2NpbGxhdG9yOiB7XG4gICAgICAgIHR5cGU6IFwic3F1YXJlXCJcbiAgICAgIH0sXG4gICAgICBmaWx0ZXI6IHtcbiAgICAgICAgUTogNixcbiAgICAgICAgdHlwZTogXCJsb3dwYXNzXCIsXG4gICAgICAgIHJvbGxvZmY6IC0yNFxuICAgICAgfSxcbiAgICAgIGVudmVsb3BlOiB7XG4gICAgICAgIGF0dGFjazogLjAwNSxcbiAgICAgICAgZGVjYXk6IC4xLFxuICAgICAgICBzdXN0YWluOiAuOSxcbiAgICAgICAgcmVsZWFzZTogMVxuICAgICAgfSxcbiAgICAgIGZpbHRlckVudmVsb3BlOiB7XG4gICAgICAgIGF0dGFjazogLjA2LFxuICAgICAgICBkZWNheTogLjIsXG4gICAgICAgIHN1c3RhaW46IC41LFxuICAgICAgICByZWxlYXNlOiAyLFxuICAgICAgICBiYXNlRnJlcXVlbmN5OiAyMDAsXG4gICAgICAgIG9jdGF2ZXM6IDcsXG4gICAgICAgIGV4cG9uZW50OiAyXG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0Lk1vbm9TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCwgZSksIHRoaXMuZmlsdGVyRW52ZWxvcGUudHJpZ2dlckF0dGFjayh0KSwgdGhpcy5vc2NpbGxhdG9yLnN0YXJ0KHQpLCAwID09PSB0aGlzLmVudmVsb3BlLnN1c3RhaW4gJiYgdGhpcy5vc2NpbGxhdG9yLnN0b3AodCArIHRoaXMuZW52ZWxvcGUuYXR0YWNrICsgdGhpcy5lbnZlbG9wZS5kZWNheSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk1vbm9TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksIHRoaXMuZmlsdGVyRW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksIHRoaXMub3NjaWxsYXRvci5zdG9wKHQgKyB0aGlzLmVudmVsb3BlLnJlbGVhc2UpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Nb25vU3ludGgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wib3NjaWxsYXRvclwiLCBcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiLCBcImZpbHRlclwiLCBcImZpbHRlckVudmVsb3BlXCIsIFwiZW52ZWxvcGVcIl0pLCB0aGlzLm9zY2lsbGF0b3IuZGlzcG9zZSgpLCB0aGlzLm9zY2lsbGF0b3IgPSBudWxsLCB0aGlzLmVudmVsb3BlLmRpc3Bvc2UoKSwgdGhpcy5lbnZlbG9wZSA9IG51bGwsIHRoaXMuZmlsdGVyRW52ZWxvcGUuZGlzcG9zZSgpLCB0aGlzLmZpbHRlckVudmVsb3BlID0gbnVsbCwgdGhpcy5maWx0ZXIuZGlzcG9zZSgpLCB0aGlzLmZpbHRlciA9IG51bGwsIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5kZXR1bmUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Nb25vU3ludGg7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNiksIGkoMTcpLCBpKDUpLCBpKDMpO1xuICAgIHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJmcmVxdWVuY3lcIiwgXCJ0eXBlXCIsIFwic3ByZWFkXCJdLCBzLmRlZmF1bHQuRmF0T3NjaWxsYXRvcik7XG4gICAgICBzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcywgdCksIHRoaXMuZnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5mcmVxdWVuY3ksIHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksIHRoaXMuZGV0dW5lID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXR1bmUsIHMuZGVmYXVsdC5UeXBlLkNlbnRzKSwgdGhpcy5fb3NjaWxsYXRvcnMgPSBbXSwgdGhpcy5fc3ByZWFkID0gdC5zcHJlYWQsIHRoaXMuX3R5cGUgPSB0LnR5cGUsIHRoaXMuX3BoYXNlID0gdC5waGFzZSwgdGhpcy5fcGFydGlhbHMgPSB0LnBhcnRpYWxzLCB0aGlzLl9wYXJ0aWFsQ291bnQgPSB0LnBhcnRpYWxDb3VudCwgdGhpcy5jb3VudCA9IHQuY291bnQsIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRmF0T3NjaWxsYXRvciwgcy5kZWZhdWx0LlNvdXJjZSksIHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiA0NDAsXG4gICAgICBkZXR1bmU6IDAsXG4gICAgICBwaGFzZTogMCxcbiAgICAgIHNwcmVhZDogMjAsXG4gICAgICBjb3VudDogMyxcbiAgICAgIHR5cGU6IFwic2F3dG9vdGhcIixcbiAgICAgIHBhcnRpYWxzOiBbXSxcbiAgICAgIHBhcnRpYWxDb3VudDogMFxuICAgIH0sIHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuc3RhcnQodCk7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuc3RvcCh0KTtcbiAgICAgIH0pO1xuICAgIH0sIHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnJlc3RhcnQodCk7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUuX2ZvckVhY2ggPSBmdW5jdGlvbiAodCkge1xuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg7IGUrKykgdC5jYWxsKHRoaXMsIHRoaXMuX29zY2lsbGF0b3JzW2VdLCBlKTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fdHlwZSA9IHQsIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnR5cGUgPSB0O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJzcHJlYWRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zcHJlYWQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICBpZiAodGhpcy5fc3ByZWFkID0gdCwgdGhpcy5fb3NjaWxsYXRvcnMubGVuZ3RoID4gMSkge1xuICAgICAgICAgIHZhciBlID0gLXQgLyAyLFxuICAgICAgICAgICAgICBpID0gdCAvICh0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGggLSAxKTtcblxuICAgICAgICAgIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKHQsIHMpIHtcbiAgICAgICAgICAgIHQuZGV0dW5lLnZhbHVlID0gZSArIGkgKiBzO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUsIFwiY291bnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICBpZiAodCA9IE1hdGgubWF4KHQsIDEpLCB0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGggIT09IHQpIHtcbiAgICAgICAgICB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICB0LmRpc3Bvc2UoKTtcbiAgICAgICAgICB9KSwgdGhpcy5fb3NjaWxsYXRvcnMgPSBbXTtcblxuICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdDsgZSsrKSB7XG4gICAgICAgICAgICB2YXIgaSA9IG5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcigpO1xuICAgICAgICAgICAgdGhpcy50eXBlID09PSBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbSA/IGkucGFydGlhbHMgPSB0aGlzLl9wYXJ0aWFscyA6IGkudHlwZSA9IHRoaXMuX3R5cGUsIGkucGFydGlhbENvdW50ID0gdGhpcy5fcGFydGlhbENvdW50LCBpLnBoYXNlID0gdGhpcy5fcGhhc2UgKyBlIC8gdCAqIDM2MCwgaS52b2x1bWUudmFsdWUgPSAtNiAtIDEuMSAqIHQsIHRoaXMuZnJlcXVlbmN5LmNvbm5lY3QoaS5mcmVxdWVuY3kpLCB0aGlzLmRldHVuZS5jb25uZWN0KGkuZGV0dW5lKSwgaS5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5fb3NjaWxsYXRvcnNbZV0gPSBpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuc3ByZWFkID0gdGhpcy5fc3ByZWFkLCB0aGlzLnN0YXRlID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICB0LnN0YXJ0KCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwaGFzZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BoYXNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcGhhc2UgPSB0LCB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5waGFzZSA9IHQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLCBcImJhc2VUeXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnNbMF0uYmFzZVR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5iYXNlVHlwZSA9IHQ7XG4gICAgICAgIH0pLCB0aGlzLl90eXBlID0gdGhpcy5fb3NjaWxsYXRvcnNbMF0udHlwZTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwYXJ0aWFsc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29zY2lsbGF0b3JzWzBdLnBhcnRpYWxzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcGFydGlhbHMgPSB0LCB0aGlzLl90eXBlID0gcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5DdXN0b20sIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnBhcnRpYWxzID0gdDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUsIFwicGFydGlhbENvdW50XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnNbMF0ucGFydGlhbENvdW50O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcGFydGlhbENvdW50ID0gdCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUucGFydGlhbENvdW50ID0gdDtcbiAgICAgICAgfSksIHRoaXMuX3R5cGUgPSB0aGlzLl9vc2NpbGxhdG9yc1swXS50eXBlO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSksIHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmRldHVuZS5kaXNwb3NlKCksIHRoaXMuZGV0dW5lID0gbnVsbCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB0LmRpc3Bvc2UoKTtcbiAgICAgIH0pLCB0aGlzLl9vc2NpbGxhdG9ycyA9IG51bGwsIHRoaXMuX3BhcnRpYWxzID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRmF0T3NjaWxsYXRvcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2KSwgaSgxNyksIGkoNSksIGkoMyksIGkoMjIpO1xuICAgIHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiLCBcInR5cGVcIiwgXCJtb2R1bGF0aW9uVHlwZVwiXSwgcy5kZWZhdWx0LkFNT3NjaWxsYXRvcik7XG4gICAgICBzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcywgdCksIHRoaXMuX2NhcnJpZXIgPSBuZXcgcy5kZWZhdWx0Lk9zY2lsbGF0b3IodC5mcmVxdWVuY3ksIHQudHlwZSksIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5fY2Fycmllci5mcmVxdWVuY3ksIHRoaXMuZGV0dW5lID0gdGhpcy5fY2Fycmllci5kZXR1bmUsIHRoaXMuZGV0dW5lLnZhbHVlID0gdC5kZXR1bmUsIHRoaXMuX21vZHVsYXRvciA9IG5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih0LmZyZXF1ZW5jeSwgdC5tb2R1bGF0aW9uVHlwZSksIHRoaXMuX21vZHVsYXRpb25TY2FsZSA9IG5ldyBzLmRlZmF1bHQuQXVkaW9Ub0dhaW4oKSwgdGhpcy5oYXJtb25pY2l0eSA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkodC5oYXJtb25pY2l0eSksIHRoaXMuaGFybW9uaWNpdHkudW5pdHMgPSBzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSwgdGhpcy5fbW9kdWxhdGlvbk5vZGUgPSBuZXcgcy5kZWZhdWx0LkdhaW4oMCksIHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMuaGFybW9uaWNpdHksIHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3kpLCB0aGlzLmRldHVuZS5jb25uZWN0KHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLCB0aGlzLl9tb2R1bGF0b3IuY2hhaW4odGhpcy5fbW9kdWxhdGlvblNjYWxlLCB0aGlzLl9tb2R1bGF0aW9uTm9kZS5nYWluKSwgdGhpcy5fY2Fycmllci5jaGFpbih0aGlzLl9tb2R1bGF0aW9uTm9kZSwgdGhpcy5vdXRwdXQpLCB0aGlzLnBoYXNlID0gdC5waGFzZSwgdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsIFwiZGV0dW5lXCIsIFwiaGFybW9uaWNpdHlcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkFNT3NjaWxsYXRvciwgcy5kZWZhdWx0Lk9zY2lsbGF0b3IpLCBzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiA0NDAsXG4gICAgICBkZXR1bmU6IDAsXG4gICAgICBwaGFzZTogMCxcbiAgICAgIHR5cGU6IFwic2luZVwiLFxuICAgICAgbW9kdWxhdGlvblR5cGU6IFwic3F1YXJlXCIsXG4gICAgICBoYXJtb25pY2l0eTogMVxuICAgIH0sIHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9tb2R1bGF0b3Iuc3RhcnQodCksIHRoaXMuX2NhcnJpZXIuc3RhcnQodCk7XG4gICAgfSwgcy5kZWZhdWx0LkFNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fbW9kdWxhdG9yLnN0b3AodCksIHRoaXMuX2NhcnJpZXIuc3RvcCh0KTtcbiAgICB9LCBzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLCB0aGlzLl9jYXJyaWVyLnJlc3RhcnQodCk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJyaWVyLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9jYXJyaWVyLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkFNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwiYmFzZVR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJyaWVyLmJhc2VUeXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fY2Fycmllci5iYXNlVHlwZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwYXJ0aWFsQ291bnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJyaWVyLnBhcnRpYWxDb3VudDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2NhcnJpZXIucGFydGlhbENvdW50ID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcIm1vZHVsYXRpb25UeXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbW9kdWxhdG9yLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9tb2R1bGF0b3IudHlwZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZSwgXCJwaGFzZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcnJpZXIucGhhc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9jYXJyaWVyLnBoYXNlID0gdCwgdGhpcy5fbW9kdWxhdG9yLnBoYXNlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBhcnRpYWxzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2Fycmllci5wYXJ0aWFscztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2NhcnJpZXIucGFydGlhbHMgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsIFwiZGV0dW5lXCIsIFwiaGFybW9uaWNpdHlcIl0pLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuZGV0dW5lID0gbnVsbCwgdGhpcy5oYXJtb25pY2l0eS5kaXNwb3NlKCksIHRoaXMuaGFybW9uaWNpdHkgPSBudWxsLCB0aGlzLl9jYXJyaWVyLmRpc3Bvc2UoKSwgdGhpcy5fY2FycmllciA9IG51bGwsIHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksIHRoaXMuX21vZHVsYXRvciA9IG51bGwsIHRoaXMuX21vZHVsYXRpb25Ob2RlLmRpc3Bvc2UoKSwgdGhpcy5fbW9kdWxhdGlvbk5vZGUgPSBudWxsLCB0aGlzLl9tb2R1bGF0aW9uU2NhbGUuZGlzcG9zZSgpLCB0aGlzLl9tb2R1bGF0aW9uU2NhbGUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5BTU9zY2lsbGF0b3I7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNiksIGkoNTApLCBpKDE3KSwgaSg1KTtcbiAgICBzLmRlZmF1bHQuUFdNT3NjaWxsYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCIsIFwibW9kdWxhdGlvbkZyZXF1ZW5jeVwiXSwgcy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IpO1xuICAgICAgcy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsIHQpLCB0aGlzLl9wdWxzZSA9IG5ldyBzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yKHQubW9kdWxhdGlvbkZyZXF1ZW5jeSksIHRoaXMuX3B1bHNlLl9zYXd0b290aC50eXBlID0gXCJzaW5lXCIsIHRoaXMuX21vZHVsYXRvciA9IG5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih7XG4gICAgICAgIGZyZXF1ZW5jeTogdC5mcmVxdWVuY3ksXG4gICAgICAgIGRldHVuZTogdC5kZXR1bmUsXG4gICAgICAgIHBoYXNlOiB0LnBoYXNlXG4gICAgICB9KSwgdGhpcy5fc2NhbGUgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDIpLCB0aGlzLmZyZXF1ZW5jeSA9IHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3ksIHRoaXMuZGV0dW5lID0gdGhpcy5fbW9kdWxhdG9yLmRldHVuZSwgdGhpcy5tb2R1bGF0aW9uRnJlcXVlbmN5ID0gdGhpcy5fcHVsc2UuZnJlcXVlbmN5LCB0aGlzLl9tb2R1bGF0b3IuY2hhaW4odGhpcy5fc2NhbGUsIHRoaXMuX3B1bHNlLndpZHRoKSwgdGhpcy5fcHVsc2UuY29ubmVjdCh0aGlzLm91dHB1dCksIHRoaXMuX3JlYWRPbmx5KFtcIm1vZHVsYXRpb25GcmVxdWVuY3lcIiwgXCJmcmVxdWVuY3lcIiwgXCJkZXR1bmVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IsIHMuZGVmYXVsdC5Tb3VyY2UpLCBzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5kZWZhdWx0cyA9IHtcbiAgICAgIGZyZXF1ZW5jeTogNDQwLFxuICAgICAgZGV0dW5lOiAwLFxuICAgICAgcGhhc2U6IDAsXG4gICAgICBtb2R1bGF0aW9uRnJlcXVlbmN5OiAuNFxuICAgIH0sIHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9tb2R1bGF0b3Iuc3RhcnQodCksIHRoaXMuX3B1bHNlLnN0YXJ0KHQpO1xuICAgIH0sIHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX21vZHVsYXRvci5zdG9wKHQpLCB0aGlzLl9wdWxzZS5zdG9wKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLCB0aGlzLl9wdWxzZS5yZXN0YXJ0KHQpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwicHdtXCI7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwiYmFzZVR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcInB3bVwiO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IucHJvdG90eXBlLCBcInBhcnRpYWxzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUsIFwicGhhc2VcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGF0b3IucGhhc2U7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9tb2R1bGF0b3IucGhhc2UgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3B1bHNlLmRpc3Bvc2UoKSwgdGhpcy5fcHVsc2UgPSBudWxsLCB0aGlzLl9zY2FsZS5kaXNwb3NlKCksIHRoaXMuX3NjYWxlID0gbnVsbCwgdGhpcy5fbW9kdWxhdG9yLmRpc3Bvc2UoKSwgdGhpcy5fbW9kdWxhdG9yID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoW1wibW9kdWxhdGlvbkZyZXF1ZW5jeVwiLCBcImZyZXF1ZW5jeVwiLCBcImRldHVuZVwiXSksIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5kZXR1bmUgPSBudWxsLCB0aGlzLm1vZHVsYXRpb25GcmVxdWVuY3kgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDUxKSwgaSg0KSwgaSgxNik7XG4gICAgcy5kZWZhdWx0LlBhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImNhbGxiYWNrXCIsIFwiZXZlbnRzXCJdLCBzLmRlZmF1bHQuUGFydCk7XG4gICAgICBzLmRlZmF1bHQuRXZlbnQuY2FsbCh0aGlzLCB0KSwgdGhpcy5fZXZlbnRzID0gW107XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdC5ldmVudHMubGVuZ3RoOyBlKyspIEFycmF5LmlzQXJyYXkodC5ldmVudHNbZV0pID8gdGhpcy5hZGQodC5ldmVudHNbZV1bMF0sIHQuZXZlbnRzW2VdWzFdKSA6IHRoaXMuYWRkKHQuZXZlbnRzW2VdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QYXJ0LCBzLmRlZmF1bHQuRXZlbnQpLCBzLmRlZmF1bHQuUGFydC5kZWZhdWx0cyA9IHtcbiAgICAgIGNhbGxiYWNrOiBzLmRlZmF1bHQubm9PcCxcbiAgICAgIGxvb3A6ICExLFxuICAgICAgbG9vcEVuZDogXCIxbVwiLFxuICAgICAgbG9vcFN0YXJ0OiAwLFxuICAgICAgcGxheWJhY2tSYXRlOiAxLFxuICAgICAgcHJvYmFiaWxpdHk6IDEsXG4gICAgICBodW1hbml6ZTogITEsXG4gICAgICBtdXRlOiAhMSxcbiAgICAgIGV2ZW50czogW11cbiAgICB9LCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdmFyIGkgPSB0aGlzLnRvVGlja3ModCk7XG4gICAgICByZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoaSkgIT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmIChlID0gdGhpcy5fbG9vcCA/IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIHRoaXMuX2xvb3BTdGFydCkgOiBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAwKSwgZSA9IHRoaXMudG9UaWNrcyhlKSwgdGhpcy5fc3RhdGUuYWRkKHtcbiAgICAgICAgc3RhdGU6IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkLFxuICAgICAgICB0aW1lOiBpLFxuICAgICAgICBvZmZzZXQ6IGVcbiAgICAgIH0pLCB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0Tm90ZSh0LCBpLCBlKTtcbiAgICAgIH0pKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuX3N0YXJ0Tm90ZSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBlIC09IGksIHRoaXMuX2xvb3AgPyB0LnN0YXJ0T2Zmc2V0ID49IHRoaXMuX2xvb3BTdGFydCAmJiB0LnN0YXJ0T2Zmc2V0IDwgdGhpcy5fbG9vcEVuZCA/ICh0LnN0YXJ0T2Zmc2V0IDwgaSAmJiAoZSArPSB0aGlzLl9nZXRMb29wRHVyYXRpb24oKSksIHQuc3RhcnQocy5kZWZhdWx0LlRpY2tzKGUpKSkgOiB0LnN0YXJ0T2Zmc2V0IDwgdGhpcy5fbG9vcFN0YXJ0ICYmIHQuc3RhcnRPZmZzZXQgPj0gaSAmJiAodC5sb29wID0gITEsIHQuc3RhcnQocy5kZWZhdWx0LlRpY2tzKGUpKSkgOiB0LnN0YXJ0T2Zmc2V0ID49IGkgJiYgdC5zdGFydChzLmRlZmF1bHQuVGlja3MoZSkpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsIFwic3RhcnRPZmZzZXRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGFydE9mZnNldDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0T2Zmc2V0ID0gdCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHQuc3RhcnRPZmZzZXQgKz0gdGhpcy5fc3RhcnRPZmZzZXQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRoaXMudG9UaWNrcyh0KTtcbiAgICAgIHJldHVybiB0aGlzLl9zdGF0ZS5jYW5jZWwoZSksIHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLCBlKSwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnN0b3AodCk7XG4gICAgICB9KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuYXQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdCA9IHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKHQpO1xuXG4gICAgICBmb3IgKHZhciBpID0gcy5kZWZhdWx0LlRpY2tzKDEpLnRvU2Vjb25kcygpLCBuID0gMDsgbiA8IHRoaXMuX2V2ZW50cy5sZW5ndGg7IG4rKykge1xuICAgICAgICB2YXIgbyA9IHRoaXMuX2V2ZW50c1tuXTtcbiAgICAgICAgaWYgKE1hdGguYWJzKHQudG9UaWNrcygpIC0gby5zdGFydE9mZnNldCkgPCBpKSByZXR1cm4gcy5kZWZhdWx0LmlzRGVmaW5lZChlKSAmJiAoby52YWx1ZSA9IGUpLCBvO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcy5kZWZhdWx0LmlzRGVmaW5lZChlKSA/ICh0aGlzLmFkZCh0LCBlKSwgdGhpcy5fZXZlbnRzW3RoaXMuX2V2ZW50cy5sZW5ndGggLSAxXSkgOiBudWxsO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdmFyIGk7XG4gICAgICByZXR1cm4gdC5oYXNPd25Qcm9wZXJ0eShcInRpbWVcIikgJiYgKHQgPSAoZSA9IHQpLnRpbWUpLCB0ID0gdGhpcy50b1RpY2tzKHQpLCBlIGluc3RhbmNlb2Ygcy5kZWZhdWx0LkV2ZW50ID8gKGkgPSBlKS5jYWxsYmFjayA9IHRoaXMuX3RpY2suYmluZCh0aGlzKSA6IGkgPSBuZXcgcy5kZWZhdWx0LkV2ZW50KHtcbiAgICAgICAgY2FsbGJhY2s6IHRoaXMuX3RpY2suYmluZCh0aGlzKSxcbiAgICAgICAgdmFsdWU6IGVcbiAgICAgIH0pLCBpLnN0YXJ0T2Zmc2V0ID0gdCwgaS5zZXQoe1xuICAgICAgICBsb29wRW5kOiB0aGlzLmxvb3BFbmQsXG4gICAgICAgIGxvb3BTdGFydDogdGhpcy5sb29wU3RhcnQsXG4gICAgICAgIGxvb3A6IHRoaXMubG9vcCxcbiAgICAgICAgaHVtYW5pemU6IHRoaXMuaHVtYW5pemUsXG4gICAgICAgIHBsYXliYWNrUmF0ZTogdGhpcy5wbGF5YmFja1JhdGUsXG4gICAgICAgIHByb2JhYmlsaXR5OiB0aGlzLnByb2JhYmlsaXR5XG4gICAgICB9KSwgdGhpcy5fZXZlbnRzLnB1c2goaSksIHRoaXMuX3Jlc3RhcnRFdmVudChpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuX3Jlc3RhcnRFdmVudCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9zdGF0ZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkID8gdGhpcy5fc3RhcnROb3RlKHQsIGUudGltZSwgZS5vZmZzZXQpIDogdC5zdG9wKHMuZGVmYXVsdC5UaWNrcyhlLnRpbWUpKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSwgcy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB0Lmhhc093blByb3BlcnR5KFwidGltZVwiKSAmJiAodCA9IChlID0gdCkudGltZSksIHQgPSB0aGlzLnRvVGlja3ModCk7XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9ldmVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLl9ldmVudHNbaV07XG4gICAgICAgIG4uc3RhcnRPZmZzZXQgPT09IHQgJiYgKHMuZGVmYXVsdC5pc1VuZGVmKGUpIHx8IHMuZGVmYXVsdC5pc0RlZmluZWQoZSkgJiYgbi52YWx1ZSA9PT0gZSkgJiYgKHRoaXMuX2V2ZW50cy5zcGxpY2UoaSwgMSksIG4uZGlzcG9zZSgpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLnJlbW92ZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuZGlzcG9zZSgpO1xuICAgICAgfSksIHRoaXMuX2V2ZW50cyA9IFtdLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5jYW5jZWwodCk7XG4gICAgICB9KSwgdGhpcy5fc3RhdGUuY2FuY2VsKHRoaXMudG9UaWNrcyh0KSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLl9mb3JFYWNoID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmICh0aGlzLl9ldmVudHMpIHtcbiAgICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIHRoaXMpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9ldmVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICB2YXIgbiA9IHRoaXMuX2V2ZW50c1tpXTtcbiAgICAgICAgICBuIGluc3RhbmNlb2Ygcy5kZWZhdWx0LlBhcnQgPyBuLl9mb3JFYWNoKHQsIGUpIDogdC5jYWxsKGUsIG4pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5fc2V0QWxsID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgaVt0XSA9IGU7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuX3RpY2sgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgdGhpcy5tdXRlIHx8IHRoaXMuY2FsbGJhY2sodCwgZSk7XG4gICAgfSwgcy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLl90ZXN0TG9vcEJvdW5kcmllcyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9sb29wICYmICh0LnN0YXJ0T2Zmc2V0IDwgdGhpcy5fbG9vcFN0YXJ0IHx8IHQuc3RhcnRPZmZzZXQgPj0gdGhpcy5fbG9vcEVuZCkgPyB0LmNhbmNlbCgwKSA6IHQuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkICYmIHRoaXMuX3Jlc3RhcnRFdmVudCh0KTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLCBcInByb2JhYmlsaXR5XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvYmFiaWxpdHk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wcm9iYWJpbGl0eSA9IHQsIHRoaXMuX3NldEFsbChcInByb2JhYmlsaXR5XCIsIHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLCBcImh1bWFuaXplXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faHVtYW5pemU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9odW1hbml6ZSA9IHQsIHRoaXMuX3NldEFsbChcImh1bWFuaXplXCIsIHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLCBcImxvb3BcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb29wO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbG9vcCA9IHQsIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLl9sb29wU3RhcnQgPSB0aGlzLl9sb29wU3RhcnQsIGUuX2xvb3BFbmQgPSB0aGlzLl9sb29wRW5kLCBlLmxvb3AgPSB0LCB0aGlzLl90ZXN0TG9vcEJvdW5kcmllcyhlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsIFwibG9vcEVuZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wRW5kKS50b1NlY29uZHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3BFbmQgPSB0aGlzLnRvVGlja3ModCksIHRoaXMuX2xvb3AgJiYgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUubG9vcEVuZCA9IHQsIHRoaXMuX3Rlc3RMb29wQm91bmRyaWVzKGUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZSwgXCJsb29wU3RhcnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fbG9vcFN0YXJ0KS50b1NlY29uZHMoKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xvb3BTdGFydCA9IHRoaXMudG9UaWNrcyh0KSwgdGhpcy5fbG9vcCAmJiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgdC5sb29wU3RhcnQgPSB0aGlzLmxvb3BTdGFydCwgdGhpcy5fdGVzdExvb3BCb3VuZHJpZXModCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLCBcInBsYXliYWNrUmF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3BsYXliYWNrUmF0ZSA9IHQsIHRoaXMuX3NldEFsbChcInBsYXliYWNrUmF0ZVwiLCB0KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudHMubGVuZ3RoO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5yZW1vdmVBbGwoKSwgdGhpcy5jYWxsYmFjayA9IG51bGwsIHRoaXMuX2V2ZW50cyA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBhcnQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNTEpO1xuICAgIHMuZGVmYXVsdC5Mb29wID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJjYWxsYmFja1wiLCBcImludGVydmFsXCJdLCBzLmRlZmF1bHQuTG9vcCk7XG4gICAgICBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy5fZXZlbnQgPSBuZXcgcy5kZWZhdWx0LkV2ZW50KHtcbiAgICAgICAgY2FsbGJhY2s6IHRoaXMuX3RpY2suYmluZCh0aGlzKSxcbiAgICAgICAgbG9vcDogITAsXG4gICAgICAgIGxvb3BFbmQ6IHQuaW50ZXJ2YWwsXG4gICAgICAgIHBsYXliYWNrUmF0ZTogdC5wbGF5YmFja1JhdGUsXG4gICAgICAgIHByb2JhYmlsaXR5OiB0LnByb2JhYmlsaXR5XG4gICAgICB9KSwgdGhpcy5jYWxsYmFjayA9IHQuY2FsbGJhY2ssIHRoaXMuaXRlcmF0aW9ucyA9IHQuaXRlcmF0aW9ucztcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Mb29wKSwgcy5kZWZhdWx0Lkxvb3AuZGVmYXVsdHMgPSB7XG4gICAgICBpbnRlcnZhbDogXCI0blwiLFxuICAgICAgY2FsbGJhY2s6IHMuZGVmYXVsdC5ub09wLFxuICAgICAgcGxheWJhY2tSYXRlOiAxLFxuICAgICAgaXRlcmF0aW9uczogMSAvIDAsXG4gICAgICBwcm9iYWJpbGl0eTogITAsXG4gICAgICBtdXRlOiAhMVxuICAgIH0sIHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fZXZlbnQuc3RhcnQodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50LnN0b3AodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fZXZlbnQuY2FuY2VsKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5fdGljayA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLmNhbGxiYWNrKHQpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUsIFwic3RhdGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudC5zdGF0ZTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSwgXCJwcm9ncmVzc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50LnByb2dyZXNzO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLCBcImludGVydmFsXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnQubG9vcEVuZDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50Lmxvb3BFbmQgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLCBcInBsYXliYWNrUmF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50LnBsYXliYWNrUmF0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50LnBsYXliYWNrUmF0ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUsIFwiaHVtYW5pemVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudC5odW1hbml6ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50Lmh1bWFuaXplID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSwgXCJwcm9iYWJpbGl0eVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50LnByb2JhYmlsaXR5O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZXZlbnQucHJvYmFiaWxpdHkgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLCBcIm11dGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudC5tdXRlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZXZlbnQubXV0ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUsIFwiaXRlcmF0aW9uc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEwID09PSB0aGlzLl9ldmVudC5sb29wID8gMSAvIDAgOiB0aGlzLl9ldmVudC5sb29wO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZXZlbnQubG9vcCA9IHQgPT09IDEgLyAwIHx8IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fZXZlbnQuZGlzcG9zZSgpLCB0aGlzLl9ldmVudCA9IG51bGwsIHRoaXMuY2FsbGJhY2sgPSBudWxsO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Mb29wO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDE1KSwgaSgzMyk7XG4gICAgcy5kZWZhdWx0LlN0ZXJlb1hGZWVkYmFja0VmZmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZmVlZGJhY2tcIl0sIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCk7XG4gICAgICBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuZmVlZGJhY2sgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZlZWRiYWNrLCBzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksIHRoaXMuX2ZlZWRiYWNrTFIgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5fZmVlZGJhY2tSTCA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLmVmZmVjdFJldHVybkwuY2hhaW4odGhpcy5fZmVlZGJhY2tMUiwgdGhpcy5lZmZlY3RTZW5kUiksIHRoaXMuZWZmZWN0UmV0dXJuUi5jaGFpbih0aGlzLl9mZWVkYmFja1JMLCB0aGlzLmVmZmVjdFNlbmRMKSwgdGhpcy5mZWVkYmFjay5mYW4odGhpcy5fZmVlZGJhY2tMUi5nYWluLCB0aGlzLl9mZWVkYmFja1JMLmdhaW4pLCB0aGlzLl9yZWFkT25seShbXCJmZWVkYmFja1wiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0LCBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSwgcy5kZWZhdWx0LlN0ZXJlb1hGZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImZlZWRiYWNrXCJdKSwgdGhpcy5mZWVkYmFjay5kaXNwb3NlKCksIHRoaXMuZmVlZGJhY2sgPSBudWxsLCB0aGlzLl9mZWVkYmFja0xSLmRpc3Bvc2UoKSwgdGhpcy5fZmVlZGJhY2tMUiA9IG51bGwsIHRoaXMuX2ZlZWRiYWNrUkwuZGlzcG9zZSgpLCB0aGlzLl9mZWVkYmFja1JMID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDgpLCBpKDUzKSwgaSg1Mik7XG4gICAgcy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRoaXMuX21pZFNpZGVTcGxpdCA9IG5ldyBzLmRlZmF1bHQuTWlkU2lkZVNwbGl0KCksIHRoaXMuX21pZFNpZGVNZXJnZSA9IG5ldyBzLmRlZmF1bHQuTWlkU2lkZU1lcmdlKCksIHRoaXMubWlkU2VuZCA9IHRoaXMuX21pZFNpZGVTcGxpdC5taWQsIHRoaXMuc2lkZVNlbmQgPSB0aGlzLl9taWRTaWRlU3BsaXQuc2lkZSwgdGhpcy5taWRSZXR1cm4gPSB0aGlzLl9taWRTaWRlTWVyZ2UubWlkLCB0aGlzLnNpZGVSZXR1cm4gPSB0aGlzLl9taWRTaWRlTWVyZ2Uuc2lkZSwgdGhpcy5lZmZlY3RTZW5kLmNvbm5lY3QodGhpcy5fbWlkU2lkZVNwbGl0KSwgdGhpcy5fbWlkU2lkZU1lcmdlLmNvbm5lY3QodGhpcy5lZmZlY3RSZXR1cm4pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3QsIHMuZGVmYXVsdC5FZmZlY3QpLCBzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX21pZFNpZGVTcGxpdC5kaXNwb3NlKCksIHRoaXMuX21pZFNpZGVTcGxpdCA9IG51bGwsIHRoaXMuX21pZFNpZGVNZXJnZS5kaXNwb3NlKCksIHRoaXMuX21pZFNpZGVNZXJnZSA9IG51bGwsIHRoaXMubWlkU2VuZCA9IG51bGwsIHRoaXMuc2lkZVNlbmQgPSBudWxsLCB0aGlzLm1pZFJldHVybiA9IG51bGwsIHRoaXMuc2lkZVJldHVybiA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3Q7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMTEpLCBpKDgpO1xuICAgIHMuZGVmYXVsdC5Db252b2x2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInVybFwiLCBcIm9ubG9hZFwiXSwgcy5kZWZhdWx0LkNvbnZvbHZlcik7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuX2NvbnZvbHZlciA9IHRoaXMuY29udGV4dC5jcmVhdGVDb252b2x2ZXIoKSwgdGhpcy5fYnVmZmVyID0gbmV3IHMuZGVmYXVsdC5CdWZmZXIodC51cmwsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gZS5nZXQoKSwgdC5vbmxvYWQoKTtcbiAgICAgIH0uYmluZCh0aGlzKSksIHRoaXMuX2J1ZmZlci5sb2FkZWQgJiYgKHRoaXMuYnVmZmVyID0gdGhpcy5fYnVmZmVyKSwgdGhpcy5ub3JtYWxpemUgPSB0Lm5vcm1hbGl6ZSwgdGhpcy5jb25uZWN0RWZmZWN0KHRoaXMuX2NvbnZvbHZlcik7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ29udm9sdmVyLCBzLmRlZmF1bHQuRWZmZWN0KSwgcy5kZWZhdWx0LkNvbnZvbHZlci5kZWZhdWx0cyA9IHtcbiAgICAgIG9ubG9hZDogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBub3JtYWxpemU6ICEwXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Db252b2x2ZXIucHJvdG90eXBlLCBcImJ1ZmZlclwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlci5sZW5ndGggPyB0aGlzLl9idWZmZXIgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fYnVmZmVyLnNldCh0KSwgdGhpcy5fY29udm9sdmVyLmJ1ZmZlciAmJiAodGhpcy5lZmZlY3RTZW5kLmRpc2Nvbm5lY3QoKSwgdGhpcy5fY29udm9sdmVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fY29udm9sdmVyID0gdGhpcy5jb250ZXh0LmNyZWF0ZUNvbnZvbHZlcigpLCB0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fY29udm9sdmVyKSksIHRoaXMuX2NvbnZvbHZlci5idWZmZXIgPSB0aGlzLl9idWZmZXIuZ2V0KCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udm9sdmVyLnByb3RvdHlwZSwgXCJub3JtYWxpemVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb252b2x2ZXIubm9ybWFsaXplO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fY29udm9sdmVyLm5vcm1hbGl6ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5Db252b2x2ZXIucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlci5sb2FkKHQsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gdCwgZSAmJiBlKCk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIHMuZGVmYXVsdC5Db252b2x2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9idWZmZXIuZGlzcG9zZSgpLCB0aGlzLl9idWZmZXIgPSBudWxsLCB0aGlzLl9jb252b2x2ZXIuZGlzY29ubmVjdCgpLCB0aGlzLl9jb252b2x2ZXIgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Db252b2x2ZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNyksIGkoNSksIGkoMTMpO1xuICAgIHMuZGVmYXVsdC5Nb2R1bG8gPSBmdW5jdGlvbiAodCkge1xuICAgICAgcy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDEsIDApLCB0aGlzLl9zaGFwZXIgPSBuZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoTWF0aC5wb3coMiwgMTYpKSwgdGhpcy5fbXVsdGlwbHkgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KCksIHRoaXMuX3N1YnRyYWN0ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlN1YnRyYWN0KCksIHRoaXMuX21vZFNpZ25hbCA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLl9zaGFwZXIpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLl9zdWJ0cmFjdCksIHRoaXMuX21vZFNpZ25hbC5jb25uZWN0KHRoaXMuX211bHRpcGx5LCAwLCAwKSwgdGhpcy5fc2hhcGVyLmNvbm5lY3QodGhpcy5fbXVsdGlwbHksIDAsIDEpLCB0aGlzLl9tdWx0aXBseS5jb25uZWN0KHRoaXMuX3N1YnRyYWN0LCAwLCAxKSwgdGhpcy5fc2V0V2F2ZVNoYXBlcih0KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Nb2R1bG8sIHMuZGVmYXVsdC5TaWduYWxCYXNlKSwgcy5kZWZhdWx0Lk1vZHVsby5wcm90b3R5cGUuX3NldFdhdmVTaGFwZXIgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fc2hhcGVyLnNldE1hcChmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoZSArIDFlLTQpIC8gdCk7XG4gICAgICB9KTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk1vZHVsby5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2RTaWduYWwudmFsdWU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9tb2RTaWduYWwudmFsdWUgPSB0LCB0aGlzLl9zZXRXYXZlU2hhcGVyKHQpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuTW9kdWxvLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3NoYXBlci5kaXNwb3NlKCksIHRoaXMuX3NoYXBlciA9IG51bGwsIHRoaXMuX211bHRpcGx5LmRpc3Bvc2UoKSwgdGhpcy5fbXVsdGlwbHkgPSBudWxsLCB0aGlzLl9zdWJ0cmFjdC5kaXNwb3NlKCksIHRoaXMuX3N1YnRyYWN0ID0gbnVsbCwgdGhpcy5fbW9kU2lnbmFsLmRpc3Bvc2UoKSwgdGhpcy5fbW9kU2lnbmFsID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTW9kdWxvO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIwKSwgaSg5Mik7XG4gICAgcy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0ID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHZhciBuID0gbmV3IE9mZmxpbmVBdWRpb0NvbnRleHQodCwgZSAqIGksIGkpO1xuICAgICAgcy5kZWZhdWx0LkNvbnRleHQuY2FsbCh0aGlzLCB7XG4gICAgICAgIGNvbnRleHQ6IG4sXG4gICAgICAgIGNsb2NrU291cmNlOiBcIm9mZmxpbmVcIixcbiAgICAgICAgbG9va0FoZWFkOiAwLFxuICAgICAgICB1cGRhdGVJbnRlcnZhbDogMTI4IC8gaVxuICAgICAgfSksIHRoaXMuX2R1cmF0aW9uID0gZSwgdGhpcy5fY3VycmVudFRpbWUgPSAwO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0LCBzLmRlZmF1bHQuQ29udGV4dCksIHMuZGVmYXVsdC5PZmZsaW5lQ29udGV4dC5wcm90b3R5cGUubm93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRUaW1lO1xuICAgIH0sIHMuZGVmYXVsdC5PZmZsaW5lQ29udGV4dC5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH0sIHMuZGVmYXVsdC5PZmZsaW5lQ29udGV4dC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICg7IHRoaXMuX2R1cmF0aW9uIC0gdGhpcy5fY3VycmVudFRpbWUgPj0gMDspIHRoaXMuZW1pdChcInRpY2tcIiksIHRoaXMuX2N1cnJlbnRUaW1lICs9IC4wMDU7XG5cbiAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0LnN0YXJ0UmVuZGVyaW5nKCk7XG4gICAgfSwgcy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0ID0gbnVsbCwgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0O1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDE2KSwgaSgxMSksIGkoNzYpLCBpKDQwKTtcbiAgICBzLmRlZmF1bHQuT2ZmbGluZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB2YXIgaSA9IHMuZGVmYXVsdC5jb250ZXh0LnNhbXBsZVJhdGUsXG4gICAgICAgICAgbiA9IHMuZGVmYXVsdC5jb250ZXh0LFxuICAgICAgICAgIG8gPSBuZXcgcy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0KDIsIGUsIGkpO1xuICAgICAgcy5kZWZhdWx0LmNvbnRleHQgPSBvO1xuICAgICAgdmFyIGEgPSB0KHMuZGVmYXVsdC5UcmFuc3BvcnQpLFxuICAgICAgICAgIHIgPSBudWxsO1xuICAgICAgcmV0dXJuIHIgPSBhICYmIHMuZGVmYXVsdC5pc0Z1bmN0aW9uKGEudGhlbikgPyBhLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gby5yZW5kZXIoKTtcbiAgICAgIH0pIDogby5yZW5kZXIoKSwgcy5kZWZhdWx0LmNvbnRleHQgPSBuLCByLnRoZW4oZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBzLmRlZmF1bHQuQnVmZmVyKHQpO1xuICAgICAgfSk7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk9mZmxpbmU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMTEpO1xuICAgIHMuZGVmYXVsdC5CdWZmZXJzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHZhciBlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgIGUuc2hpZnQoKTtcbiAgICAgIHZhciBpID0gcy5kZWZhdWx0LmRlZmF1bHRzKGUsIFtcIm9ubG9hZFwiLCBcImJhc2VVcmxcIl0sIHMuZGVmYXVsdC5CdWZmZXJzKTtcblxuICAgICAgZm9yICh2YXIgbiBpbiBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy5fYnVmZmVycyA9IHt9LCB0aGlzLmJhc2VVcmwgPSBpLmJhc2VVcmwsIHRoaXMuX2xvYWRpbmdDb3VudCA9IDAsIHQpIHRoaXMuX2xvYWRpbmdDb3VudCsrLCB0aGlzLmFkZChuLCB0W25dLCB0aGlzLl9idWZmZXJMb2FkZWQuYmluZCh0aGlzLCBpLm9ubG9hZCkpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkJ1ZmZlcnMpLCBzLmRlZmF1bHQuQnVmZmVycy5kZWZhdWx0cyA9IHtcbiAgICAgIG9ubG9hZDogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBiYXNlVXJsOiBcIlwiXG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fYnVmZmVycy5oYXNPd25Qcm9wZXJ0eSh0KTtcbiAgICB9LCBzLmRlZmF1bHQuQnVmZmVycy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmICh0aGlzLmhhcyh0KSkgcmV0dXJuIHRoaXMuX2J1ZmZlcnNbdF07XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUb25lLkJ1ZmZlcnM6IG5vIGJ1ZmZlciBuYW1lZCBcIiArIHQpO1xuICAgIH0sIHMuZGVmYXVsdC5CdWZmZXJzLnByb3RvdHlwZS5fYnVmZmVyTG9hZGVkID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuX2xvYWRpbmdDb3VudC0tLCAwID09PSB0aGlzLl9sb2FkaW5nQ291bnQgJiYgdCAmJiB0KHRoaXMpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVycy5wcm90b3R5cGUsIFwibG9hZGVkXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9ICEwO1xuXG4gICAgICAgIGZvciAodmFyIGUgaW4gdGhpcy5fYnVmZmVycykge1xuICAgICAgICAgIHZhciBpID0gdGhpcy5nZXQoZSk7XG4gICAgICAgICAgdCA9IHQgJiYgaS5sb2FkZWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkJ1ZmZlcnMucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gaSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGksIHMuZGVmYXVsdC5ub09wKSwgZSBpbnN0YW5jZW9mIHMuZGVmYXVsdC5CdWZmZXIgPyAodGhpcy5fYnVmZmVyc1t0XSA9IGUsIGkodGhpcykpIDogZSBpbnN0YW5jZW9mIEF1ZGlvQnVmZmVyID8gKHRoaXMuX2J1ZmZlcnNbdF0gPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcihlKSwgaSh0aGlzKSkgOiBzLmRlZmF1bHQuaXNTdHJpbmcoZSkgJiYgKHRoaXMuX2J1ZmZlcnNbdF0gPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlcih0aGlzLmJhc2VVcmwgKyBlLCBpKSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkJ1ZmZlcnMucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciB0IGluIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9idWZmZXJzKSB0aGlzLl9idWZmZXJzW3RdLmRpc3Bvc2UoKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlcnMgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5CdWZmZXJzO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBzLmRlZmF1bHQuQ3RybFBhdHRlcm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInZhbHVlc1wiLCBcInR5cGVcIl0sIHMuZGVmYXVsdC5DdHJsUGF0dGVybik7XG4gICAgICBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy52YWx1ZXMgPSB0LnZhbHVlcywgdGhpcy5pbmRleCA9IDAsIHRoaXMuX3R5cGUgPSBudWxsLCB0aGlzLl9zaHVmZmxlZCA9IG51bGwsIHRoaXMuX2RpcmVjdGlvbiA9IG51bGwsIHRoaXMudHlwZSA9IHQudHlwZTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DdHJsUGF0dGVybiksIHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlID0ge1xuICAgICAgVXA6IFwidXBcIixcbiAgICAgIERvd246IFwiZG93blwiLFxuICAgICAgVXBEb3duOiBcInVwRG93blwiLFxuICAgICAgRG93blVwOiBcImRvd25VcFwiLFxuICAgICAgQWx0ZXJuYXRlVXA6IFwiYWx0ZXJuYXRlVXBcIixcbiAgICAgIEFsdGVybmF0ZURvd246IFwiYWx0ZXJuYXRlRG93blwiLFxuICAgICAgUmFuZG9tOiBcInJhbmRvbVwiLFxuICAgICAgUmFuZG9tV2FsazogXCJyYW5kb21XYWxrXCIsXG4gICAgICBSYW5kb21PbmNlOiBcInJhbmRvbU9uY2VcIlxuICAgIH0sIHMuZGVmYXVsdC5DdHJsUGF0dGVybi5kZWZhdWx0cyA9IHtcbiAgICAgIHR5cGU6IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwLFxuICAgICAgdmFsdWVzOiBbXVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ3RybFBhdHRlcm4ucHJvdG90eXBlLCBcInZhbHVlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoMCAhPT0gdGhpcy52YWx1ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKDEgPT09IHRoaXMudmFsdWVzLmxlbmd0aCkgcmV0dXJuIHRoaXMudmFsdWVzWzBdO1xuICAgICAgICAgIHRoaXMuaW5kZXggPSBNYXRoLm1pbih0aGlzLmluZGV4LCB0aGlzLnZhbHVlcy5sZW5ndGggLSAxKTtcbiAgICAgICAgICB2YXIgdCA9IHRoaXMudmFsdWVzW3RoaXMuaW5kZXhdO1xuICAgICAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbU9uY2UgJiYgKHRoaXMudmFsdWVzLmxlbmd0aCAhPT0gdGhpcy5fc2h1ZmZsZWQubGVuZ3RoICYmIHRoaXMuX3NodWZmbGVWYWx1ZXMoKSwgdCA9IHRoaXMudmFsdWVzW3RoaXMuX3NodWZmbGVkW3RoaXMuaW5kZXhdXSksIHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DdHJsUGF0dGVybi5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl90eXBlID0gdCwgdGhpcy5fc2h1ZmZsZWQgPSBudWxsLCB0aGlzLl90eXBlID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCB8fCB0aGlzLl90eXBlID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcERvd24gfHwgdGhpcy5fdHlwZSA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuUmFuZG9tT25jZSB8fCB0aGlzLl90eXBlID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5BbHRlcm5hdGVVcCA/IHRoaXMuaW5kZXggPSAwIDogdGhpcy5fdHlwZSAhPT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuRG93biAmJiB0aGlzLl90eXBlICE9PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duVXAgJiYgdGhpcy5fdHlwZSAhPT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlRG93biB8fCAodGhpcy5pbmRleCA9IHRoaXMudmFsdWVzLmxlbmd0aCAtIDEpLCB0aGlzLl90eXBlID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcERvd24gfHwgdGhpcy5fdHlwZSA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlVXAgPyB0aGlzLl9kaXJlY3Rpb24gPSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCA6IHRoaXMuX3R5cGUgIT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd25VcCAmJiB0aGlzLl90eXBlICE9PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5BbHRlcm5hdGVEb3duIHx8ICh0aGlzLl9kaXJlY3Rpb24gPSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duKSwgdGhpcy5fdHlwZSA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuUmFuZG9tT25jZSA/IHRoaXMuX3NodWZmbGVWYWx1ZXMoKSA6IHRoaXMuX3R5cGUgPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbSAmJiAodGhpcy5pbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMudmFsdWVzLmxlbmd0aCkpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQ3RybFBhdHRlcm4ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHRoaXMudHlwZTtcbiAgICAgIHJldHVybiB0ID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCA/ICh0aGlzLmluZGV4KyssIHRoaXMuaW5kZXggPj0gdGhpcy52YWx1ZXMubGVuZ3RoICYmICh0aGlzLmluZGV4ID0gMCkpIDogdCA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuRG93biA/ICh0aGlzLmluZGV4LS0sIHRoaXMuaW5kZXggPCAwICYmICh0aGlzLmluZGV4ID0gdGhpcy52YWx1ZXMubGVuZ3RoIC0gMSkpIDogdCA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXBEb3duIHx8IHQgPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd25VcCA/ICh0aGlzLl9kaXJlY3Rpb24gPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwID8gdGhpcy5pbmRleCsrIDogdGhpcy5pbmRleC0tLCB0aGlzLmluZGV4IDwgMCA/ICh0aGlzLmluZGV4ID0gMSwgdGhpcy5fZGlyZWN0aW9uID0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApIDogdGhpcy5pbmRleCA+PSB0aGlzLnZhbHVlcy5sZW5ndGggJiYgKHRoaXMuaW5kZXggPSB0aGlzLnZhbHVlcy5sZW5ndGggLSAyLCB0aGlzLl9kaXJlY3Rpb24gPSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duKSkgOiB0ID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5SYW5kb20gPyB0aGlzLmluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy52YWx1ZXMubGVuZ3RoKSA6IHQgPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbVdhbGsgPyBNYXRoLnJhbmRvbSgpIDwgLjUgPyAodGhpcy5pbmRleC0tLCB0aGlzLmluZGV4ID0gTWF0aC5tYXgodGhpcy5pbmRleCwgMCkpIDogKHRoaXMuaW5kZXgrKywgdGhpcy5pbmRleCA9IE1hdGgubWluKHRoaXMuaW5kZXgsIHRoaXMudmFsdWVzLmxlbmd0aCAtIDEpKSA6IHQgPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbU9uY2UgPyAodGhpcy5pbmRleCsrLCB0aGlzLmluZGV4ID49IHRoaXMudmFsdWVzLmxlbmd0aCAmJiAodGhpcy5pbmRleCA9IDAsIHRoaXMuX3NodWZmbGVWYWx1ZXMoKSkpIDogdCA9PT0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlVXAgPyAodGhpcy5fZGlyZWN0aW9uID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCA/ICh0aGlzLmluZGV4ICs9IDIsIHRoaXMuX2RpcmVjdGlvbiA9IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd24pIDogKHRoaXMuaW5kZXggLT0gMSwgdGhpcy5fZGlyZWN0aW9uID0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApLCB0aGlzLmluZGV4ID49IHRoaXMudmFsdWVzLmxlbmd0aCAmJiAodGhpcy5pbmRleCA9IDAsIHRoaXMuX2RpcmVjdGlvbiA9IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwKSkgOiB0ID09PSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5BbHRlcm5hdGVEb3duICYmICh0aGlzLl9kaXJlY3Rpb24gPT09IHMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwID8gKHRoaXMuaW5kZXggKz0gMSwgdGhpcy5fZGlyZWN0aW9uID0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuRG93bikgOiAodGhpcy5pbmRleCAtPSAyLCB0aGlzLl9kaXJlY3Rpb24gPSBzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCksIHRoaXMuaW5kZXggPCAwICYmICh0aGlzLmluZGV4ID0gdGhpcy52YWx1ZXMubGVuZ3RoIC0gMSwgdGhpcy5fZGlyZWN0aW9uID0gcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuRG93bikpLCB0aGlzLnZhbHVlO1xuICAgIH0sIHMuZGVmYXVsdC5DdHJsUGF0dGVybi5wcm90b3R5cGUuX3NodWZmbGVWYWx1ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IFtdO1xuICAgICAgdGhpcy5fc2h1ZmZsZWQgPSBbXTtcblxuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLnZhbHVlcy5sZW5ndGg7IGUrKykgdFtlXSA9IGU7XG5cbiAgICAgIGZvciAoOyB0Lmxlbmd0aCA+IDA7KSB7XG4gICAgICAgIHZhciBpID0gdC5zcGxpY2UoTWF0aC5mbG9vcih0Lmxlbmd0aCAqIE1hdGgucmFuZG9tKCkpLCAxKTtcblxuICAgICAgICB0aGlzLl9zaHVmZmxlZC5wdXNoKGlbMF0pO1xuICAgICAgfVxuICAgIH0sIHMuZGVmYXVsdC5DdHJsUGF0dGVybi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3NodWZmbGVkID0gbnVsbCwgdGhpcy52YWx1ZXMgPSBudWxsO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5DdHJsUGF0dGVybjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg1NiksIGkoNTUpO1xuICAgIHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQuY2FsbCh0aGlzLCB0LCBlKSwgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudC5kZWZhdWx0cyksIHRoaXMuZHVyYXRpb24gPSBzLmRlZmF1bHQuVGlja3MoZS5kdXJhdGlvbiksIHRoaXMuX2ludGVydmFsID0gcy5kZWZhdWx0LlRpY2tzKGUuaW50ZXJ2YWwpLCB0aGlzLl9jdXJyZW50SWQgPSAtMSwgdGhpcy5fbmV4dElkID0gLTEsIHRoaXMuX25leHRUaWNrID0gdGhpcy50aW1lLCB0aGlzLl9ib3VuZFJlc3RhcnQgPSB0aGlzLl9yZXN0YXJ0LmJpbmQodGhpcyksIHRoaXMuVHJhbnNwb3J0Lm9uKFwic3RhcnQgbG9vcFN0YXJ0XCIsIHRoaXMuX2JvdW5kUmVzdGFydCksIHRoaXMuX3Jlc3RhcnQoKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudCwgcy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50KSwgcy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LmRlZmF1bHRzID0ge1xuICAgICAgZHVyYXRpb246IDEgLyAwLFxuICAgICAgaW50ZXJ2YWw6IDFcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0UmVwZWF0RXZlbnQucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9jcmVhdGVFdmVudHModCksIHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudC5wcm90b3R5cGUuaW52b2tlLmNhbGwodGhpcywgdCk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LnByb3RvdHlwZS5fY3JlYXRlRXZlbnRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHZhciBlID0gdGhpcy5UcmFuc3BvcnQuZ2V0VGlja3NBdFRpbWUodCk7XG4gICAgICBlID49IHRoaXMudGltZSAmJiBlID49IHRoaXMuX25leHRUaWNrICYmIHRoaXMuX25leHRUaWNrICsgdGhpcy5faW50ZXJ2YWwgPCB0aGlzLnRpbWUgKyB0aGlzLmR1cmF0aW9uICYmICh0aGlzLl9uZXh0VGljayArPSB0aGlzLl9pbnRlcnZhbCwgdGhpcy5fY3VycmVudElkID0gdGhpcy5fbmV4dElkLCB0aGlzLl9uZXh0SWQgPSB0aGlzLlRyYW5zcG9ydC5zY2hlZHVsZU9uY2UodGhpcy5pbnZva2UuYmluZCh0aGlzKSwgcy5kZWZhdWx0LlRpY2tzKHRoaXMuX25leHRUaWNrKSkpO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudC5wcm90b3R5cGUuX3Jlc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5UcmFuc3BvcnQuY2xlYXIodGhpcy5fY3VycmVudElkKSwgdGhpcy5UcmFuc3BvcnQuY2xlYXIodGhpcy5fbmV4dElkKSwgdGhpcy5fbmV4dFRpY2sgPSB0aGlzLnRpbWU7XG4gICAgICB2YXIgZSA9IHRoaXMuVHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO1xuICAgICAgZSA+IHRoaXMudGltZSAmJiAodGhpcy5fbmV4dFRpY2sgPSB0aGlzLnRpbWUgKyBNYXRoLmNlaWwoKGUgLSB0aGlzLnRpbWUpIC8gdGhpcy5faW50ZXJ2YWwpICogdGhpcy5faW50ZXJ2YWwpLCB0aGlzLl9jdXJyZW50SWQgPSB0aGlzLlRyYW5zcG9ydC5zY2hlZHVsZU9uY2UodGhpcy5pbnZva2UuYmluZCh0aGlzKSwgcy5kZWZhdWx0LlRpY2tzKHRoaXMuX25leHRUaWNrKSksIHRoaXMuX25leHRUaWNrICs9IHRoaXMuX2ludGVydmFsLCB0aGlzLl9uZXh0SWQgPSB0aGlzLlRyYW5zcG9ydC5zY2hlZHVsZU9uY2UodGhpcy5pbnZva2UuYmluZCh0aGlzKSwgcy5kZWZhdWx0LlRpY2tzKHRoaXMuX25leHRUaWNrKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuVHJhbnNwb3J0LmNsZWFyKHRoaXMuX2N1cnJlbnRJZCksIHRoaXMuVHJhbnNwb3J0LmNsZWFyKHRoaXMuX25leHRJZCksIHRoaXMuVHJhbnNwb3J0Lm9mZihcInN0YXJ0IGxvb3BTdGFydFwiLCB0aGlzLl9ib3VuZFJlc3RhcnQpLCB0aGlzLl9ib3VuZENyZWF0ZUV2ZW50cyA9IG51bGwsIHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLmR1cmF0aW9uID0gbnVsbCwgdGhpcy5faW50ZXJ2YWwgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0KTtcbiAgICBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5jYWxsKHRoaXMpLCB0aGlzLl9yb290ID0gbnVsbCwgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lKSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAocy5kZWZhdWx0LmlzVW5kZWYodC50aW1lKSB8fCBzLmRlZmF1bHQuaXNVbmRlZih0LmR1cmF0aW9uKSkgdGhyb3cgbmV3IEVycm9yKFwiVG9uZS5JbnRlcnZhbFRpbWVsaW5lOiBldmVudHMgbXVzdCBoYXZlIHRpbWUgYW5kIGR1cmF0aW9uIHBhcmFtZXRlcnNcIik7XG4gICAgICB0LnRpbWUgPSB0LnRpbWUudmFsdWVPZigpO1xuICAgICAgdmFyIGUgPSBuZXcgbih0LnRpbWUsIHQudGltZSArIHQuZHVyYXRpb24sIHQpO1xuXG4gICAgICBmb3IgKG51bGwgPT09IHRoaXMuX3Jvb3QgPyB0aGlzLl9yb290ID0gZSA6IHRoaXMuX3Jvb3QuaW5zZXJ0KGUpLCB0aGlzLl9sZW5ndGgrKzsgbnVsbCAhPT0gZTspIGUudXBkYXRlSGVpZ2h0KCksIGUudXBkYXRlTWF4KCksIHRoaXMuX3JlYmFsYW5jZShlKSwgZSA9IGUucGFyZW50O1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmIChudWxsICE9PSB0aGlzLl9yb290KSB7XG4gICAgICAgIHZhciBlID0gW107XG5cbiAgICAgICAgdGhpcy5fcm9vdC5zZWFyY2godC50aW1lLCBlKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgcyA9IGVbaV07XG5cbiAgICAgICAgICBpZiAocy5ldmVudCA9PT0gdCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlTm9kZShzKSwgdGhpcy5fbGVuZ3RoLS07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaEZyb20odCwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5yZW1vdmUodCk7XG4gICAgICB9LmJpbmQodGhpcykpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5fc2V0Um9vdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9yb290ID0gdCwgbnVsbCAhPT0gdGhpcy5fcm9vdCAmJiAodGhpcy5fcm9vdC5wYXJlbnQgPSBudWxsKTtcbiAgICB9LCBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuX3JlcGxhY2VOb2RlSW5QYXJlbnQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgbnVsbCAhPT0gdC5wYXJlbnQgPyAodC5pc0xlZnRDaGlsZCgpID8gdC5wYXJlbnQubGVmdCA9IGUgOiB0LnBhcmVudC5yaWdodCA9IGUsIHRoaXMuX3JlYmFsYW5jZSh0LnBhcmVudCkpIDogdGhpcy5fc2V0Um9vdChlKTtcbiAgICB9LCBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuX3JlbW92ZU5vZGUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgaWYgKG51bGwgPT09IHQubGVmdCAmJiBudWxsID09PSB0LnJpZ2h0KSB0aGlzLl9yZXBsYWNlTm9kZUluUGFyZW50KHQsIG51bGwpO2Vsc2UgaWYgKG51bGwgPT09IHQucmlnaHQpIHRoaXMuX3JlcGxhY2VOb2RlSW5QYXJlbnQodCwgdC5sZWZ0KTtlbHNlIGlmIChudWxsID09PSB0LmxlZnQpIHRoaXMuX3JlcGxhY2VOb2RlSW5QYXJlbnQodCwgdC5yaWdodCk7ZWxzZSB7XG4gICAgICAgIHZhciBlLCBpO1xuICAgICAgICBpZiAodC5nZXRCYWxhbmNlKCkgPiAwKSB7XG4gICAgICAgICAgaWYgKG51bGwgPT09IHQubGVmdC5yaWdodCkgKGUgPSB0LmxlZnQpLnJpZ2h0ID0gdC5yaWdodCwgaSA9IGU7ZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGUgPSB0LmxlZnQucmlnaHQ7IG51bGwgIT09IGUucmlnaHQ7KSBlID0gZS5yaWdodDtcblxuICAgICAgICAgICAgZS5wYXJlbnQucmlnaHQgPSBlLmxlZnQsIGkgPSBlLnBhcmVudCwgZS5sZWZ0ID0gdC5sZWZ0LCBlLnJpZ2h0ID0gdC5yaWdodDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobnVsbCA9PT0gdC5yaWdodC5sZWZ0KSAoZSA9IHQucmlnaHQpLmxlZnQgPSB0LmxlZnQsIGkgPSBlO2Vsc2Uge1xuICAgICAgICAgIGZvciAoZSA9IHQucmlnaHQubGVmdDsgbnVsbCAhPT0gZS5sZWZ0OykgZSA9IGUubGVmdDtcblxuICAgICAgICAgIGUucGFyZW50LmxlZnQgPSBlLnJpZ2h0LCBpID0gZS5wYXJlbnQsIGUubGVmdCA9IHQubGVmdCwgZS5yaWdodCA9IHQucmlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgbnVsbCAhPT0gdC5wYXJlbnQgPyB0LmlzTGVmdENoaWxkKCkgPyB0LnBhcmVudC5sZWZ0ID0gZSA6IHQucGFyZW50LnJpZ2h0ID0gZSA6IHRoaXMuX3NldFJvb3QoZSksIHRoaXMuX3JlYmFsYW5jZShpKTtcbiAgICAgIH1cbiAgICAgIHQuZGlzcG9zZSgpO1xuICAgIH0sIHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5fcm90YXRlTGVmdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHQucGFyZW50LFxuICAgICAgICAgIGkgPSB0LmlzTGVmdENoaWxkKCksXG4gICAgICAgICAgcyA9IHQucmlnaHQ7XG4gICAgICB0LnJpZ2h0ID0gcy5sZWZ0LCBzLmxlZnQgPSB0LCBudWxsICE9PSBlID8gaSA/IGUubGVmdCA9IHMgOiBlLnJpZ2h0ID0gcyA6IHRoaXMuX3NldFJvb3Qocyk7XG4gICAgfSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLl9yb3RhdGVSaWdodCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHQucGFyZW50LFxuICAgICAgICAgIGkgPSB0LmlzTGVmdENoaWxkKCksXG4gICAgICAgICAgcyA9IHQubGVmdDtcbiAgICAgIHQubGVmdCA9IHMucmlnaHQsIHMucmlnaHQgPSB0LCBudWxsICE9PSBlID8gaSA/IGUubGVmdCA9IHMgOiBlLnJpZ2h0ID0gcyA6IHRoaXMuX3NldFJvb3Qocyk7XG4gICAgfSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLl9yZWJhbGFuY2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSB0LmdldEJhbGFuY2UoKTtcbiAgICAgIGUgPiAxID8gdC5sZWZ0LmdldEJhbGFuY2UoKSA8IDAgPyB0aGlzLl9yb3RhdGVMZWZ0KHQubGVmdCkgOiB0aGlzLl9yb3RhdGVSaWdodCh0KSA6IGUgPCAtMSAmJiAodC5yaWdodC5nZXRCYWxhbmNlKCkgPiAwID8gdGhpcy5fcm90YXRlUmlnaHQodC5yaWdodCkgOiB0aGlzLl9yb3RhdGVMZWZ0KHQpKTtcbiAgICB9LCBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGlmIChudWxsICE9PSB0aGlzLl9yb290KSB7XG4gICAgICAgIHZhciBlID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMuX3Jvb3Quc2VhcmNoKHQsIGUpLCBlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gZVswXSwgcyA9IDE7IHMgPCBlLmxlbmd0aDsgcysrKSBlW3NdLmxvdyA+IGkubG93ICYmIChpID0gZVtzXSk7XG5cbiAgICAgICAgICByZXR1cm4gaS5ldmVudDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LCBzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAobnVsbCAhPT0gdGhpcy5fcm9vdCkge1xuICAgICAgICB2YXIgZSA9IFtdO1xuXG4gICAgICAgIHRoaXMuX3Jvb3QudHJhdmVyc2UoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICBlLnB1c2godCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBzID0gZVtpXS5ldmVudDtcbiAgICAgICAgICBzICYmIHQocyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2hBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKG51bGwgIT09IHRoaXMuX3Jvb3QpIHtcbiAgICAgICAgdmFyIGkgPSBbXTtcblxuICAgICAgICB0aGlzLl9yb290LnNlYXJjaCh0LCBpKTtcblxuICAgICAgICBmb3IgKHZhciBzID0gaS5sZW5ndGggLSAxOyBzID49IDA7IHMtLSkge1xuICAgICAgICAgIHZhciBuID0gaVtzXS5ldmVudDtcbiAgICAgICAgICBuICYmIGUobik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2hGcm9tID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmIChudWxsICE9PSB0aGlzLl9yb290KSB7XG4gICAgICAgIHZhciBpID0gW107XG5cbiAgICAgICAgdGhpcy5fcm9vdC5zZWFyY2hBZnRlcih0LCBpKTtcblxuICAgICAgICBmb3IgKHZhciBzID0gaS5sZW5ndGggLSAxOyBzID49IDA7IHMtLSkge1xuICAgICAgICAgIGUoaVtzXS5ldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IFtdO1xuICAgICAgbnVsbCAhPT0gdGhpcy5fcm9vdCAmJiB0aGlzLl9yb290LnRyYXZlcnNlKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHQucHVzaChlKTtcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHQubGVuZ3RoOyBlKyspIHRbZV0uZGlzcG9zZSgpO1xuXG4gICAgICByZXR1cm4gdCA9IG51bGwsIHRoaXMuX3Jvb3QgPSBudWxsLCB0aGlzO1xuICAgIH07XG5cbiAgICB2YXIgbiA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICB0aGlzLmV2ZW50ID0gaSwgdGhpcy5sb3cgPSB0LCB0aGlzLmhpZ2ggPSBlLCB0aGlzLm1heCA9IHRoaXMuaGlnaCwgdGhpcy5fbGVmdCA9IG51bGwsIHRoaXMuX3JpZ2h0ID0gbnVsbCwgdGhpcy5wYXJlbnQgPSBudWxsLCB0aGlzLmhlaWdodCA9IDA7XG4gICAgfTtcblxuICAgIG4ucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0LmxvdyA8PSB0aGlzLmxvdyA/IG51bGwgPT09IHRoaXMubGVmdCA/IHRoaXMubGVmdCA9IHQgOiB0aGlzLmxlZnQuaW5zZXJ0KHQpIDogbnVsbCA9PT0gdGhpcy5yaWdodCA/IHRoaXMucmlnaHQgPSB0IDogdGhpcy5yaWdodC5pbnNlcnQodCk7XG4gICAgfSwgbi5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHQgPiB0aGlzLm1heCB8fCAobnVsbCAhPT0gdGhpcy5sZWZ0ICYmIHRoaXMubGVmdC5zZWFyY2godCwgZSksIHRoaXMubG93IDw9IHQgJiYgdGhpcy5oaWdoID4gdCAmJiBlLnB1c2godGhpcyksIHRoaXMubG93ID4gdCB8fCBudWxsICE9PSB0aGlzLnJpZ2h0ICYmIHRoaXMucmlnaHQuc2VhcmNoKHQsIGUpKTtcbiAgICB9LCBuLnByb3RvdHlwZS5zZWFyY2hBZnRlciA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICB0aGlzLmxvdyA+PSB0ICYmIChlLnB1c2godGhpcyksIG51bGwgIT09IHRoaXMubGVmdCAmJiB0aGlzLmxlZnQuc2VhcmNoQWZ0ZXIodCwgZSkpLCBudWxsICE9PSB0aGlzLnJpZ2h0ICYmIHRoaXMucmlnaHQuc2VhcmNoQWZ0ZXIodCwgZSk7XG4gICAgfSwgbi5wcm90b3R5cGUudHJhdmVyc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCh0aGlzKSwgbnVsbCAhPT0gdGhpcy5sZWZ0ICYmIHRoaXMubGVmdC50cmF2ZXJzZSh0KSwgbnVsbCAhPT0gdGhpcy5yaWdodCAmJiB0aGlzLnJpZ2h0LnRyYXZlcnNlKHQpO1xuICAgIH0sIG4ucHJvdG90eXBlLnVwZGF0ZUhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIG51bGwgIT09IHRoaXMubGVmdCAmJiBudWxsICE9PSB0aGlzLnJpZ2h0ID8gdGhpcy5oZWlnaHQgPSBNYXRoLm1heCh0aGlzLmxlZnQuaGVpZ2h0LCB0aGlzLnJpZ2h0LmhlaWdodCkgKyAxIDogbnVsbCAhPT0gdGhpcy5yaWdodCA/IHRoaXMuaGVpZ2h0ID0gdGhpcy5yaWdodC5oZWlnaHQgKyAxIDogbnVsbCAhPT0gdGhpcy5sZWZ0ID8gdGhpcy5oZWlnaHQgPSB0aGlzLmxlZnQuaGVpZ2h0ICsgMSA6IHRoaXMuaGVpZ2h0ID0gMDtcbiAgICB9LCBuLnByb3RvdHlwZS51cGRhdGVNYXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm1heCA9IHRoaXMuaGlnaCwgbnVsbCAhPT0gdGhpcy5sZWZ0ICYmICh0aGlzLm1heCA9IE1hdGgubWF4KHRoaXMubWF4LCB0aGlzLmxlZnQubWF4KSksIG51bGwgIT09IHRoaXMucmlnaHQgJiYgKHRoaXMubWF4ID0gTWF0aC5tYXgodGhpcy5tYXgsIHRoaXMucmlnaHQubWF4KSk7XG4gICAgfSwgbi5wcm90b3R5cGUuZ2V0QmFsYW5jZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gMDtcbiAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLmxlZnQgJiYgbnVsbCAhPT0gdGhpcy5yaWdodCA/IHQgPSB0aGlzLmxlZnQuaGVpZ2h0IC0gdGhpcy5yaWdodC5oZWlnaHQgOiBudWxsICE9PSB0aGlzLmxlZnQgPyB0ID0gdGhpcy5sZWZ0LmhlaWdodCArIDEgOiBudWxsICE9PSB0aGlzLnJpZ2h0ICYmICh0ID0gLSh0aGlzLnJpZ2h0LmhlaWdodCArIDEpKSwgdDtcbiAgICB9LCBuLnByb3RvdHlwZS5pc0xlZnRDaGlsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5sZWZ0ID09PSB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSwgXCJsZWZ0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGVmdDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xlZnQgPSB0LCBudWxsICE9PSB0ICYmICh0LnBhcmVudCA9IHRoaXMpLCB0aGlzLnVwZGF0ZUhlaWdodCgpLCB0aGlzLnVwZGF0ZU1heCgpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsIFwicmlnaHRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yaWdodDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3JpZ2h0ID0gdCwgbnVsbCAhPT0gdCAmJiAodC5wYXJlbnQgPSB0aGlzKSwgdGhpcy51cGRhdGVIZWlnaHQoKSwgdGhpcy51cGRhdGVNYXgoKTtcbiAgICAgIH1cbiAgICB9KSwgbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucGFyZW50ID0gbnVsbCwgdGhpcy5fbGVmdCA9IG51bGwsIHRoaXMuX3JpZ2h0ID0gbnVsbCwgdGhpcy5ldmVudCA9IG51bGw7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkludGVydmFsVGltZWxpbmU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMik7XG5cbiAgICBmdW5jdGlvbiBuKHQpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgaSkge1xuICAgICAgICBpID0gdGhpcy50b1NlY29uZHMoaSksIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuICAgICAgICB2YXIgcyA9IHRoaXMuX2V2ZW50cy5nZXQoaSksXG4gICAgICAgICAgICBuID0gdGhpcy5fZXZlbnRzLnByZXZpb3VzRXZlbnQocyksXG4gICAgICAgICAgICBvID0gdGhpcy5fZ2V0VGlja3NVbnRpbEV2ZW50KG4sIGkpO1xuXG4gICAgICAgIHJldHVybiBzLnRpY2tzID0gTWF0aC5tYXgobywgMCksIHRoaXM7XG4gICAgICB9O1xuICAgIH1cblxuICAgIHMuZGVmYXVsdC5UaWNrU2lnbmFsID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCAxKSwgcy5kZWZhdWx0LlNpZ25hbC5jYWxsKHRoaXMsIHtcbiAgICAgICAgdW5pdHM6IHMuZGVmYXVsdC5UeXBlLlRpY2tzLFxuICAgICAgICB2YWx1ZTogdFxuICAgICAgfSksIHRoaXMuX2V2ZW50cy5tZW1vcnkgPSAxIC8gMCwgdGhpcy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCksIHRoaXMuX2V2ZW50cy5hZGQoe1xuICAgICAgICB0eXBlOiBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuU2V0VmFsdWUsXG4gICAgICAgIHRpbWU6IDAsXG4gICAgICAgIHZhbHVlOiB0XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UaWNrU2lnbmFsLCBzLmRlZmF1bHQuU2lnbmFsKSwgcy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLnNldFZhbHVlQXRUaW1lID0gbihzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5zZXRWYWx1ZUF0VGltZSksIHMuZGVmYXVsdC5UaWNrU2lnbmFsLnByb3RvdHlwZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSA9IG4ocy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUpLCBzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuc2V0VGFyZ2V0QXRUaW1lID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdGhpcy5zZXRSYW1wUG9pbnQoZSksIHQgPSB0aGlzLl9mcm9tVW5pdHModCk7XG5cbiAgICAgIGZvciAodmFyIHMgPSB0aGlzLl9ldmVudHMuZ2V0KGUpLCBuID0gTWF0aC5yb3VuZChNYXRoLm1heCgxIC8gaSwgMSkpLCBvID0gMDsgbyA8PSBuOyBvKyspIHtcbiAgICAgICAgdmFyIGEgPSBpICogbyArIGUsXG4gICAgICAgICAgICByID0gdGhpcy5fZXhwb25lbnRpYWxBcHByb2FjaChzLnRpbWUsIHMudmFsdWUsIHQsIGksIGEpO1xuXG4gICAgICAgIHRoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodGhpcy5fdG9Vbml0cyhyKSwgYSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UaWNrU2lnbmFsLnByb3RvdHlwZS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdCA9IHRoaXMuX2Zyb21Vbml0cyh0KTtcblxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX2V2ZW50cy5nZXQoZSksIHMgPSBNYXRoLnJvdW5kKE1hdGgubWF4KDEwICogKGUgLSBpLnRpbWUpLCAxKSksIG4gPSAoZSAtIGkudGltZSkgLyBzLCBvID0gMDsgbyA8PSBzOyBvKyspIHtcbiAgICAgICAgdmFyIGEgPSBuICogbyArIGkudGltZSxcbiAgICAgICAgICAgIHIgPSB0aGlzLl9leHBvbmVudGlhbEludGVycG9sYXRlKGkudGltZSwgaS52YWx1ZSwgZSwgdCwgYSk7XG5cbiAgICAgICAgdGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0aGlzLl90b1VuaXRzKHIpLCBhKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLl9nZXRUaWNrc1VudGlsRXZlbnQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKG51bGwgPT09IHQpIHQgPSB7XG4gICAgICAgIHRpY2tzOiAwLFxuICAgICAgICB0aW1lOiAwXG4gICAgICB9O2Vsc2UgaWYgKHMuZGVmYXVsdC5pc1VuZGVmKHQudGlja3MpKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5fZXZlbnRzLnByZXZpb3VzRXZlbnQodCk7XG5cbiAgICAgICAgdC50aWNrcyA9IHRoaXMuX2dldFRpY2tzVW50aWxFdmVudChpLCB0LnRpbWUpO1xuICAgICAgfVxuICAgICAgdmFyIG4gPSB0aGlzLmdldFZhbHVlQXRUaW1lKHQudGltZSksXG4gICAgICAgICAgbyA9IHRoaXMuZ2V0VmFsdWVBdFRpbWUoZSk7XG4gICAgICByZXR1cm4gdGhpcy5fZXZlbnRzLmdldChlKS50aW1lID09PSBlICYmIHRoaXMuX2V2ZW50cy5nZXQoZSkudHlwZSA9PT0gcy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlNldFZhbHVlICYmIChvID0gdGhpcy5nZXRWYWx1ZUF0VGltZShlIC0gdGhpcy5zYW1wbGVUaW1lKSksIC41ICogKGUgLSB0LnRpbWUpICogKG4gKyBvKSArIHQudGlja3M7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLmdldFRpY2tzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSB0aGlzLnRvU2Vjb25kcyh0KTtcblxuICAgICAgdmFyIGUgPSB0aGlzLl9ldmVudHMuZ2V0KHQpO1xuXG4gICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5fZ2V0VGlja3NVbnRpbEV2ZW50KGUsIHQpLCAwKTtcbiAgICB9LCBzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuZ2V0RHVyYXRpb25PZlRpY2tzID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKTtcbiAgICAgIHZhciBpID0gdGhpcy5nZXRUaWNrc0F0VGltZShlKTtcbiAgICAgIHJldHVybiB0aGlzLmdldFRpbWVPZlRpY2soaSArIHQpIC0gZTtcbiAgICB9LCBzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuZ2V0VGltZU9mVGljayA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IHRoaXMuX2V2ZW50cy5nZXQodCwgXCJ0aWNrc1wiKSxcbiAgICAgICAgICBpID0gdGhpcy5fZXZlbnRzLmdldEFmdGVyKHQsIFwidGlja3NcIik7XG5cbiAgICAgIGlmIChlICYmIGUudGlja3MgPT09IHQpIHJldHVybiBlLnRpbWU7XG5cbiAgICAgIGlmIChlICYmIGkgJiYgaS50eXBlID09PSBzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyICYmIGUudmFsdWUgIT09IGkudmFsdWUpIHtcbiAgICAgICAgdmFyIG4gPSB0aGlzLmdldFZhbHVlQXRUaW1lKGUudGltZSksXG4gICAgICAgICAgICBvID0gKHRoaXMuZ2V0VmFsdWVBdFRpbWUoaS50aW1lKSAtIG4pIC8gKGkudGltZSAtIGUudGltZSksXG4gICAgICAgICAgICBhID0gTWF0aC5zcXJ0KE1hdGgucG93KG4sIDIpIC0gMiAqIG8gKiAoZS50aWNrcyAtIHQpKSxcbiAgICAgICAgICAgIHIgPSAoLW4gKyBhKSAvIG87XG4gICAgICAgIHJldHVybiAociA+IDAgPyByIDogKC1uIC0gYSkgLyBvKSArIGUudGltZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGUgPyAwID09PSBlLnZhbHVlID8gMSAvIDAgOiBlLnRpbWUgKyAodCAtIGUudGlja3MpIC8gZS52YWx1ZSA6IHQgLyB0aGlzLl9pbml0aWFsVmFsdWU7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLnRpY2tzVG9UaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBlID0gdGhpcy50b1NlY29uZHMoZSksIG5ldyBzLmRlZmF1bHQuVGltZSh0aGlzLmdldER1cmF0aW9uT2ZUaWNrcyh0LCBlKSk7XG4gICAgfSwgcy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLnRpbWVUb1RpY2tzID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKSwgdCA9IHRoaXMudG9TZWNvbmRzKHQpO1xuICAgICAgdmFyIGkgPSB0aGlzLmdldFRpY2tzQXRUaW1lKGUpLFxuICAgICAgICAgIG4gPSB0aGlzLmdldFRpY2tzQXRUaW1lKGUgKyB0KTtcbiAgICAgIHJldHVybiBuZXcgcy5kZWZhdWx0LlRpY2tzKG4gLSBpKTtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuVGlja1NpZ25hbDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg1NyksIGkoMzQpLCBpKDM1KSwgaSgyMCk7XG4gICAgcy5kZWZhdWx0LkNsb2NrID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJjYWxsYmFja1wiLCBcImZyZXF1ZW5jeVwiXSwgcy5kZWZhdWx0LkNsb2NrKTtcbiAgICAgIHMuZGVmYXVsdC5FbWl0dGVyLmNhbGwodGhpcyksIHRoaXMuY2FsbGJhY2sgPSB0LmNhbGxiYWNrLCB0aGlzLl9uZXh0VGljayA9IDAsIHRoaXMuX3RpY2tTb3VyY2UgPSBuZXcgcy5kZWZhdWx0LlRpY2tTb3VyY2UodC5mcmVxdWVuY3kpLCB0aGlzLl9sYXN0VXBkYXRlID0gMCwgdGhpcy5mcmVxdWVuY3kgPSB0aGlzLl90aWNrU291cmNlLmZyZXF1ZW5jeSwgdGhpcy5fcmVhZE9ubHkoXCJmcmVxdWVuY3lcIiksIHRoaXMuX3N0YXRlID0gbmV3IHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSwgdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsIDApLCB0aGlzLl9ib3VuZExvb3AgPSB0aGlzLl9sb29wLmJpbmQodGhpcyksIHRoaXMuY29udGV4dC5vbihcInRpY2tcIiwgdGhpcy5fYm91bmRMb29wKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DbG9jaywgcy5kZWZhdWx0LkVtaXR0ZXIpLCBzLmRlZmF1bHQuQ2xvY2suZGVmYXVsdHMgPSB7XG4gICAgICBjYWxsYmFjazogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBmcmVxdWVuY3k6IDFcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZSwgXCJzdGF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHRoaXMubm93KCkpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbnRleHQucmVzdW1lKCksIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkgIT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkICYmICh0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCwgdCksIHRoaXMuX3RpY2tTb3VyY2Uuc3RhcnQodCwgZSksIHQgPCB0aGlzLl9sYXN0VXBkYXRlICYmIHRoaXMuZW1pdChcInN0YXJ0XCIsIHQsIGUpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RhdGUuY2FuY2VsKHQpLCB0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwgdCksIHRoaXMuX3RpY2tTb3VyY2Uuc3RvcCh0KSwgdCA8IHRoaXMuX2xhc3RVcGRhdGUgJiYgdGhpcy5lbWl0KFwic3RvcFwiLCB0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHQpID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiAodGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlBhdXNlZCwgdCksIHRoaXMuX3RpY2tTb3VyY2UucGF1c2UodCksIHQgPCB0aGlzLl9sYXN0VXBkYXRlICYmIHRoaXMuZW1pdChcInBhdXNlXCIsIHQpKSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZSwgXCJ0aWNrc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh0aGlzLmdldFRpY2tzQXRUaW1lKHRoaXMubm93KCkpKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3RpY2tTb3VyY2UudGlja3MgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZSwgXCJzZWNvbmRzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5zZWNvbmRzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fdGlja1NvdXJjZS5zZWNvbmRzID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5nZXRTZWNvbmRzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl90aWNrU291cmNlLmdldFNlY29uZHNBdFRpbWUodCk7XG4gICAgfSwgcy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5zZXRUaWNrc0F0VGltZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5zZXRUaWNrc0F0VGltZSh0LCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLmdldFRpY2tzQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl90aWNrU291cmNlLmdldFRpY2tzQXRUaW1lKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUubmV4dFRpY2tUaW1lID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGUgPSB0aGlzLnRvU2Vjb25kcyhlKTtcbiAgICAgIHZhciBpID0gdGhpcy5nZXRUaWNrc0F0VGltZShlKTtcbiAgICAgIHJldHVybiB0aGlzLl90aWNrU291cmNlLmdldFRpbWVPZlRpY2soaSArIHQsIGUpO1xuICAgIH0sIHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUuX2xvb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHRoaXMuX2xhc3RVcGRhdGUsXG4gICAgICAgICAgZSA9IHRoaXMubm93KCk7XG4gICAgICB0aGlzLl9sYXN0VXBkYXRlID0gZSwgdCAhPT0gZSAmJiAodGhpcy5fc3RhdGUuZm9yRWFjaEJldHdlZW4odCwgZSwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgc3dpdGNoICh0LnN0YXRlKSB7XG4gICAgICAgICAgY2FzZSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZDpcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5fdGlja1NvdXJjZS5nZXRUaWNrc0F0VGltZSh0LnRpbWUpO1xuXG4gICAgICAgICAgICB0aGlzLmVtaXQoXCJzdGFydFwiLCB0LnRpbWUsIGUpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkOlxuICAgICAgICAgICAgMCAhPT0gdC50aW1lICYmIHRoaXMuZW1pdChcInN0b3BcIiwgdC50aW1lKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBzLmRlZmF1bHQuU3RhdGUuUGF1c2VkOlxuICAgICAgICAgICAgdGhpcy5lbWl0KFwicGF1c2VcIiwgdC50aW1lKTtcbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcy5fdGlja1NvdXJjZS5mb3JFYWNoVGlja0JldHdlZW4odCwgZSwgZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFjayh0LCBlKTtcbiAgICAgIH0uYmluZCh0aGlzKSkpO1xuICAgIH0sIHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUuZ2V0U3RhdGVBdFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCk7XG4gICAgfSwgcy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5jb250ZXh0Lm9mZihcInRpY2tcIiwgdGhpcy5fYm91bmRMb29wKSwgdGhpcy5fd3JpdGFibGUoXCJmcmVxdWVuY3lcIiksIHRoaXMuX3RpY2tTb3VyY2UuZGlzcG9zZSgpLCB0aGlzLl90aWNrU291cmNlID0gbnVsbCwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLl9ib3VuZExvb3AgPSBudWxsLCB0aGlzLl9uZXh0VGljayA9IDEgLyAwLCB0aGlzLmNhbGxiYWNrID0gbnVsbCwgdGhpcy5fc3RhdGUuZGlzcG9zZSgpLCB0aGlzLl9zdGF0ZSA9IG51bGw7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkNsb2NrO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIpLCBpKDUpLCBpKDcpO1xuICAgIHMuZGVmYXVsdC5HcmVhdGVyVGhhblplcm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLCB0aGlzLl90aHJlc2ggPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gdCA8PSAwID8gMCA6IDE7XG4gICAgICB9LCAxMjcpLCB0aGlzLl9zY2FsZSA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDFlNCksIHRoaXMuX3NjYWxlLmNvbm5lY3QodGhpcy5fdGhyZXNoKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5HcmVhdGVyVGhhblplcm8sIHMuZGVmYXVsdC5TaWduYWxCYXNlKSwgcy5kZWZhdWx0LkdyZWF0ZXJUaGFuWmVyby5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9zY2FsZS5kaXNwb3NlKCksIHRoaXMuX3NjYWxlID0gbnVsbCwgdGhpcy5fdGhyZXNoLmRpc3Bvc2UoKSwgdGhpcy5fdGhyZXNoID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuR3JlYXRlclRoYW5aZXJvO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDg0KSwgaSgxMyksIGkoMik7XG4gICAgcy5kZWZhdWx0LkdyZWF0ZXJUaGFuID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWwuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDIsIDApLCB0aGlzLl9wYXJhbSA9IHRoaXMuaW5wdXRbMF0gPSBuZXcgcy5kZWZhdWx0LlN1YnRyYWN0KHQpLCB0aGlzLmlucHV0WzFdID0gdGhpcy5fcGFyYW0uaW5wdXRbMV0sIHRoaXMuX2d0eiA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5HcmVhdGVyVGhhblplcm8oKSwgdGhpcy5fcGFyYW0uY29ubmVjdCh0aGlzLl9ndHopO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdyZWF0ZXJUaGFuLCBzLmRlZmF1bHQuU2lnbmFsKSwgcy5kZWZhdWx0LkdyZWF0ZXJUaGFuLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZ3R6LmRpc3Bvc2UoKSwgdGhpcy5fZ3R6ID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuR3JlYXRlclRoYW47XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNDcpLCBpKDI2KTtcbiAgICBzLmRlZmF1bHQuU2NhbGVkRW52ZWxvcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImF0dGFja1wiLCBcImRlY2F5XCIsIFwic3VzdGFpblwiLCBcInJlbGVhc2VcIl0sIHMuZGVmYXVsdC5FbnZlbG9wZSk7XG4gICAgICBzLmRlZmF1bHQuRW52ZWxvcGUuY2FsbCh0aGlzLCB0KSwgdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5kZWZhdWx0cyksIHRoaXMuX2V4cCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5Qb3codC5leHBvbmVudCksIHRoaXMuX3NjYWxlID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlNjYWxlKHQubWluLCB0Lm1heCksIHRoaXMuX3NpZy5jaGFpbih0aGlzLl9leHAsIHRoaXMuX3NjYWxlKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZSwgcy5kZWZhdWx0LkVudmVsb3BlKSwgcy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLmRlZmF1bHRzID0ge1xuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiAxLFxuICAgICAgZXhwb25lbnQ6IDFcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLnByb3RvdHlwZSwgXCJtaW5cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zY2FsZS5taW47XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zY2FsZS5taW4gPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLnByb3RvdHlwZSwgXCJtYXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zY2FsZS5tYXg7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9zY2FsZS5tYXggPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLnByb3RvdHlwZSwgXCJleHBvbmVudFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4cC52YWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2V4cC52YWx1ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fc2NhbGUuZGlzcG9zZSgpLCB0aGlzLl9zY2FsZSA9IG51bGwsIHRoaXMuX2V4cC5kaXNwb3NlKCksIHRoaXMuX2V4cCA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDcpLCBpKDMwKTtcbiAgICBzLmRlZmF1bHQuQWJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSwgdGhpcy5fYWJzID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0KSA8IC4wMDEgPyAwIDogTWF0aC5hYnModCk7XG4gICAgICB9LCAxMDI0KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BYnMsIHMuZGVmYXVsdC5TaWduYWxCYXNlKSwgcy5kZWZhdWx0LkFicy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9hYnMuZGlzcG9zZSgpLCB0aGlzLl9hYnMgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5BYnM7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LlNvbG8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInNvbG9cIl0sIHMuZGVmYXVsdC5Tb2xvKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuX3NvbG9CaW5kID0gdGhpcy5fc29sb2VkLmJpbmQodGhpcyksIHRoaXMuY29udGV4dC5vbihcInNvbG9cIiwgdGhpcy5fc29sb0JpbmQpLCB0aGlzLnNvbG8gPSB0LnNvbG87XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU29sbywgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5Tb2xvLmRlZmF1bHRzID0ge1xuICAgICAgc29sbzogITFcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLCBcInNvbG9cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1NvbG9lZCgpO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdCA/IHRoaXMuX2FkZFNvbG8oKSA6IHRoaXMuX3JlbW92ZVNvbG8oKSwgdGhpcy5jb250ZXh0LmVtaXQoXCJzb2xvXCIsIHRoaXMpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLCBcIm11dGVkXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMCA9PT0gdGhpcy5pbnB1dC5nYWluLnZhbHVlO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuU29sby5wcm90b3R5cGUuX2FkZFNvbG8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuaXNBcnJheSh0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvKSB8fCAodGhpcy5jb250ZXh0Ll9jdXJyZW50U29sbyA9IFtdKSwgdGhpcy5faXNTb2xvZWQoKSB8fCB0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvLnB1c2godGhpcyk7XG4gICAgfSwgcy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLl9yZW1vdmVTb2xvID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMuX2lzU29sb2VkKCkpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvLmluZGV4T2YodGhpcyk7XG5cbiAgICAgICAgdGhpcy5jb250ZXh0Ll9jdXJyZW50U29sby5zcGxpY2UodCwgMSk7XG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLl9pc1NvbG9lZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAhIXMuZGVmYXVsdC5pc0FycmF5KHRoaXMuY29udGV4dC5fY3VycmVudFNvbG8pICYmIDAgIT09IHRoaXMuY29udGV4dC5fY3VycmVudFNvbG8ubGVuZ3RoICYmIC0xICE9PSB0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvLmluZGV4T2YodGhpcyk7XG4gICAgfSwgcy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLl9ub1NvbG9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICFzLmRlZmF1bHQuaXNBcnJheSh0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvKSB8fCAwID09PSB0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvLmxlbmd0aDtcbiAgICB9LCBzLmRlZmF1bHQuU29sby5wcm90b3R5cGUuX3NvbG9lZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2lzU29sb2VkKCkgPyB0aGlzLmlucHV0LmdhaW4udmFsdWUgPSAxIDogdGhpcy5fbm9Tb2xvcygpID8gdGhpcy5pbnB1dC5nYWluLnZhbHVlID0gMSA6IHRoaXMuaW5wdXQuZ2Fpbi52YWx1ZSA9IDA7XG4gICAgfSwgcy5kZWZhdWx0LlNvbG8ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250ZXh0Lm9mZihcInNvbG9cIiwgdGhpcy5fc29sb0JpbmQpLCB0aGlzLl9yZW1vdmVTb2xvKCksIHRoaXMuX3NvbG9CaW5kID0gbnVsbCwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Tb2xvO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDcpO1xuICAgIHMuZGVmYXVsdC5FcXVhbFBvd2VyR2FpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksIHRoaXMuX2VxUG93ZXIgPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguYWJzKHQpIDwgLjAwMSA/IDAgOiBzLmRlZmF1bHQuZXF1YWxQb3dlclNjYWxlKHQpO1xuICAgICAgfS5iaW5kKHRoaXMpLCA0MDk2KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5FcXVhbFBvd2VyR2Fpbiwgcy5kZWZhdWx0LlNpZ25hbEJhc2UpLCBzLmRlZmF1bHQuRXF1YWxQb3dlckdhaW4ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZXFQb3dlci5kaXNwb3NlKCksIHRoaXMuX2VxUG93ZXIgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5FcXVhbFBvd2VyR2FpbjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg1KSwgaSgyKTtcbiAgICBzLmRlZmF1bHQuTmVnYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSwgdGhpcy5fbXVsdGlwbHkgPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KC0xKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5OZWdhdGUsIHMuZGVmYXVsdC5TaWduYWxCYXNlKSwgcy5kZWZhdWx0Lk5lZ2F0ZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9tdWx0aXBseS5kaXNwb3NlKCksIHRoaXMuX211bHRpcGx5ID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTmVnYXRlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDQ4KSwgaSgyNyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LlBhblZvbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wicGFuXCIsIFwidm9sdW1lXCJdLCBzLmRlZmF1bHQuUGFuVm9sKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5fcGFubmVyID0gdGhpcy5pbnB1dCA9IG5ldyBzLmRlZmF1bHQuUGFubmVyKHQucGFuKSwgdGhpcy5wYW4gPSB0aGlzLl9wYW5uZXIucGFuLCB0aGlzLl92b2x1bWUgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuVm9sdW1lKHQudm9sdW1lKSwgdGhpcy52b2x1bWUgPSB0aGlzLl92b2x1bWUudm9sdW1lLCB0aGlzLl9wYW5uZXIuY29ubmVjdCh0aGlzLl92b2x1bWUpLCB0aGlzLm11dGUgPSB0Lm11dGUsIHRoaXMuX3JlYWRPbmx5KFtcInBhblwiLCBcInZvbHVtZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGFuVm9sLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlBhblZvbC5kZWZhdWx0cyA9IHtcbiAgICAgIHBhbjogMCxcbiAgICAgIHZvbHVtZTogMCxcbiAgICAgIG11dGU6ICExXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5Wb2wucHJvdG90eXBlLCBcIm11dGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92b2x1bWUubXV0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3ZvbHVtZS5tdXRlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlBhblZvbC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcInBhblwiLCBcInZvbHVtZVwiXSksIHRoaXMuX3Bhbm5lci5kaXNwb3NlKCksIHRoaXMuX3Bhbm5lciA9IG51bGwsIHRoaXMucGFuID0gbnVsbCwgdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSwgdGhpcy5fdm9sdW1lID0gbnVsbCwgdGhpcy52b2x1bWUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5QYW5Wb2w7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgcyA9IGkoMCk7XG5cbiAgICBpZiAocy5kZWZhdWx0LnN1cHBvcnRlZCkge1xuICAgICAgIXMuZGVmYXVsdC5nbG9iYWwuaGFzT3duUHJvcGVydHkoXCJPZmZsaW5lQXVkaW9Db250ZXh0XCIpICYmIHMuZGVmYXVsdC5nbG9iYWwuaGFzT3duUHJvcGVydHkoXCJ3ZWJraXRPZmZsaW5lQXVkaW9Db250ZXh0XCIpICYmIChzLmRlZmF1bHQuZ2xvYmFsLk9mZmxpbmVBdWRpb0NvbnRleHQgPSBzLmRlZmF1bHQuZ2xvYmFsLndlYmtpdE9mZmxpbmVBdWRpb0NvbnRleHQpO1xuICAgICAgdmFyIG4gPSBuZXcgT2ZmbGluZUF1ZGlvQ29udGV4dCgxLCAxLCA0NDEwMCkuc3RhcnRSZW5kZXJpbmcoKTtcbiAgICAgIG4gJiYgcy5kZWZhdWx0LmlzRnVuY3Rpb24obi50aGVuKSB8fCAoT2ZmbGluZUF1ZGlvQ29udGV4dC5wcm90b3R5cGUuX25hdGl2ZV9zdGFydFJlbmRlcmluZyA9IE9mZmxpbmVBdWRpb0NvbnRleHQucHJvdG90eXBlLnN0YXJ0UmVuZGVyaW5nLCBPZmZsaW5lQXVkaW9Db250ZXh0LnByb3RvdHlwZS5zdGFydFJlbmRlcmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgdGhpcy5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHQoZS5yZW5kZXJlZEJ1ZmZlcik7XG4gICAgICAgICAgfSwgdGhpcy5fbmF0aXZlX3N0YXJ0UmVuZGVyaW5nKCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBlLmEgPSBcIjEzLjguMjVcIjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0Nik7XG4gICAgcy5kZWZhdWx0Lk1pZGkgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5NaWRpKSkgcmV0dXJuIG5ldyBzLmRlZmF1bHQuTWlkaSh0LCBlKTtcbiAgICAgIHMuZGVmYXVsdC5GcmVxdWVuY3kuY2FsbCh0aGlzLCB0LCBlKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NaWRpLCBzLmRlZmF1bHQuRnJlcXVlbmN5KSwgcy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLl9kZWZhdWx0VW5pdHMgPSBcIm1pZGlcIiwgcy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLl9mcmVxdWVuY3lUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRnJlcXVlbmN5LmZ0b20ocy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX2ZyZXF1ZW5jeVRvVW5pdHMuY2FsbCh0aGlzLCB0KSk7XG4gICAgfSwgcy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLl90aWNrc1RvVW5pdHMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbShzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fdGlja3NUb1VuaXRzLmNhbGwodGhpcywgdCkpO1xuICAgIH0sIHMuZGVmYXVsdC5NaWRpLnByb3RvdHlwZS5fYmVhdHNUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRnJlcXVlbmN5LmZ0b20ocy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX2JlYXRzVG9Vbml0cy5jYWxsKHRoaXMsIHQpKTtcbiAgICB9LCBzLmRlZmF1bHQuTWlkaS5wcm90b3R5cGUuX3NlY29uZHNUb1VuaXRzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRnJlcXVlbmN5LmZ0b20ocy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX3NlY29uZHNUb1VuaXRzLmNhbGwodGhpcywgdCkpO1xuICAgIH0sIHMuZGVmYXVsdC5NaWRpLnByb3RvdHlwZS50b01pZGkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCk7XG4gICAgfSwgcy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLnRvRnJlcXVlbmN5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZih0aGlzLnRvTWlkaSgpKTtcbiAgICB9LCBzLmRlZmF1bHQuTWlkaS5wcm90b3R5cGUudHJhbnNwb3NlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnRvTWlkaSgpICsgdCk7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0Lk1pZGk7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjcpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5Vc2VyTWVkaWEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInZvbHVtZVwiXSwgcy5kZWZhdWx0LlVzZXJNZWRpYSk7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuX21lZGlhU3RyZWFtID0gbnVsbCwgdGhpcy5fc3RyZWFtID0gbnVsbCwgdGhpcy5fZGV2aWNlID0gbnVsbCwgdGhpcy5fdm9sdW1lID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlZvbHVtZSh0LnZvbHVtZSksIHRoaXMudm9sdW1lID0gdGhpcy5fdm9sdW1lLnZvbHVtZSwgdGhpcy5fcmVhZE9ubHkoXCJ2b2x1bWVcIiksIHRoaXMubXV0ZSA9IHQubXV0ZTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Vc2VyTWVkaWEsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuVXNlck1lZGlhLmRlZmF1bHRzID0ge1xuICAgICAgdm9sdW1lOiAwLFxuICAgICAgbXV0ZTogITFcbiAgICB9LCBzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlID09PSBzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCAmJiB0aGlzLmNsb3NlKCksIHMuZGVmYXVsdC5Vc2VyTWVkaWEuZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGlmIChzLmRlZmF1bHQuaXNOdW1iZXIodCkpIGkgPSBlW3RdO2Vsc2UgaWYgKCEoaSA9IGUuZmluZChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHJldHVybiBlLmxhYmVsID09PSB0IHx8IGUuZGV2aWNlSWQgPT09IHQ7XG4gICAgICAgIH0pKSAmJiBlLmxlbmd0aCA+IDApIGkgPSBlWzBdO2Vsc2UgaWYgKCFpICYmIHMuZGVmYXVsdC5pc0RlZmluZWQodCkpIHRocm93IG5ldyBFcnJvcihcIlRvbmUuVXNlck1lZGlhOiBubyBtYXRjaGluZyBkZXZpY2U6IFwiICsgdCk7XG4gICAgICAgIHRoaXMuX2RldmljZSA9IGk7XG4gICAgICAgIHZhciBuID0ge1xuICAgICAgICAgIGF1ZGlvOiB7XG4gICAgICAgICAgICBlY2hvQ2FuY2VsbGF0aW9uOiAhMSxcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6IHRoaXMuY29udGV4dC5zYW1wbGVSYXRlLFxuICAgICAgICAgICAgbm9pc2VTdXBwcmVzc2lvbjogITEsXG4gICAgICAgICAgICBtb3pOb2lzZVN1cHByZXNzaW9uOiAhMVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGkgJiYgKG4uYXVkaW8uZGV2aWNlSWQgPSBpLmRldmljZUlkKSwgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEobikudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW0gfHwgKHRoaXMuX3N0cmVhbSA9IHQsIHRoaXMuX21lZGlhU3RyZWFtID0gdGhpcy5jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHQpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9tZWRpYVN0cmVhbSwgdGhpcy5vdXRwdXQpKSwgdGhpcztcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSwgcy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RyZWFtICYmICh0aGlzLl9zdHJlYW0uZ2V0QXVkaW9UcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuc3RvcCgpO1xuICAgICAgfSksIHRoaXMuX3N0cmVhbSA9IG51bGwsIHRoaXMuX21lZGlhU3RyZWFtLmRpc2Nvbm5lY3QoKSwgdGhpcy5fbWVkaWFTdHJlYW0gPSBudWxsKSwgdGhpcy5fZGV2aWNlID0gbnVsbCwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVXNlck1lZGlhLmVudW1lcmF0ZURldmljZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gXCJhdWRpb2lucHV0XCIgPT09IHQua2luZDtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUsIFwic3RhdGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHJlYW0gJiYgdGhpcy5fc3RyZWFtLmFjdGl2ZSA/IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkIDogcy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZSwgXCJkZXZpY2VJZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RldmljZSA/IHRoaXMuX2RldmljZS5kZXZpY2VJZCA6IG51bGw7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZSwgXCJncm91cElkXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGV2aWNlID8gdGhpcy5fZGV2aWNlLmdyb3VwSWQgOiBudWxsO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUsIFwibGFiZWxcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZXZpY2UgPyB0aGlzLl9kZXZpY2UubGFiZWwgOiBudWxsO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUsIFwibXV0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZvbHVtZS5tdXRlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fdm9sdW1lLm11dGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5jbG9zZSgpLCB0aGlzLl93cml0YWJsZShcInZvbHVtZVwiKSwgdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSwgdGhpcy5fdm9sdW1lID0gbnVsbCwgdGhpcy52b2x1bWUgPSBudWxsLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVXNlck1lZGlhLCBcInN1cHBvcnRlZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5pc0RlZmluZWQobmF2aWdhdG9yLm1lZGlhRGV2aWNlcykgJiYgcy5kZWZhdWx0LmlzRnVuY3Rpb24obmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpO1xuICAgICAgfVxuICAgIH0pLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuVXNlck1lZGlhO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDY1KSwgaSgyNyksIGkoMSk7XG4gICAgcy5kZWZhdWx0LlBsYXllcnMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xuICAgICAgZS5zaGlmdCgpO1xuICAgICAgdmFyIGkgPSBzLmRlZmF1bHQuZGVmYXVsdHMoZSwgW1wib25sb2FkXCJdLCBzLmRlZmF1bHQuUGxheWVycyk7XG5cbiAgICAgIGZvciAodmFyIG4gaW4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsIGkpLCB0aGlzLl92b2x1bWUgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuVm9sdW1lKGkudm9sdW1lKSwgdGhpcy52b2x1bWUgPSB0aGlzLl92b2x1bWUudm9sdW1lLCB0aGlzLl9yZWFkT25seShcInZvbHVtZVwiKSwgdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50ID0gMiwgdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50TW9kZSA9IFwiZXhwbGljaXRcIiwgdGhpcy5tdXRlID0gaS5tdXRlLCB0aGlzLl9wbGF5ZXJzID0ge30sIHRoaXMuX2xvYWRpbmdDb3VudCA9IDAsIHRoaXMuX2ZhZGVJbiA9IGkuZmFkZUluLCB0aGlzLl9mYWRlT3V0ID0gaS5mYWRlT3V0LCB0KSB0aGlzLl9sb2FkaW5nQ291bnQrKywgdGhpcy5hZGQobiwgdFtuXSwgdGhpcy5fYnVmZmVyTG9hZGVkLmJpbmQodGhpcywgaS5vbmxvYWQpKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QbGF5ZXJzLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LlBsYXllcnMuZGVmYXVsdHMgPSB7XG4gICAgICB2b2x1bWU6IDAsXG4gICAgICBtdXRlOiAhMSxcbiAgICAgIG9ubG9hZDogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICBmYWRlSW46IDAsXG4gICAgICBmYWRlT3V0OiAwXG4gICAgfSwgcy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLl9idWZmZXJMb2FkZWQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fbG9hZGluZ0NvdW50LS0sIDAgPT09IHRoaXMuX2xvYWRpbmdDb3VudCAmJiB0ICYmIHQodGhpcyk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZSwgXCJtdXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdm9sdW1lLm11dGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl92b2x1bWUubXV0ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUsIFwiZmFkZUluXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmFkZUluO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fZmFkZUluID0gdCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUuZmFkZUluID0gdDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUsIFwiZmFkZU91dFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZhZGVPdXQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9mYWRlT3V0ID0gdCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUuZmFkZU91dCA9IHQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHQgPSB0IHx8IGUuc3RhdGUgPT09IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkO1xuICAgICAgICB9KSwgdCA/IHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkIDogcy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BsYXllcnMuaGFzT3duUHJvcGVydHkodCk7XG4gICAgfSwgcy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAodGhpcy5oYXModCkpIHJldHVybiB0aGlzLl9wbGF5ZXJzW3RdO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9uZS5QbGF5ZXJzOiBubyBwbGF5ZXIgbmFtZWQgXCIgKyB0KTtcbiAgICB9LCBzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUuX2ZvckVhY2ggPSBmdW5jdGlvbiAodCkge1xuICAgICAgZm9yICh2YXIgZSBpbiB0aGlzLl9wbGF5ZXJzKSB0KHRoaXMuX3BsYXllcnNbZV0sIGUpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLCBcImxvYWRlZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSAhMDtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB0ID0gdCAmJiBlLmxvYWRlZDtcbiAgICAgICAgfSksIHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3BsYXllcnNbdF0gPSBuZXcgcy5kZWZhdWx0LlBsYXllcihlLCBpKS5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5fcGxheWVyc1t0XS5mYWRlSW4gPSB0aGlzLl9mYWRlSW4sIHRoaXMuX3BsYXllcnNbdF0uZmFkZU91dCA9IHRoaXMuX2ZhZGVPdXQsIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLnN0b3BBbGwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnN0b3AodCk7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksIHRoaXMuX3ZvbHVtZSA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFwidm9sdW1lXCIpLCB0aGlzLnZvbHVtZSA9IG51bGwsIHRoaXMub3V0cHV0ID0gbnVsbCwgdGhpcy5fZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB0LmRpc3Bvc2UoKTtcbiAgICAgIH0pLCB0aGlzLl9wbGF5ZXJzID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUGxheWVycztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg2KSwgaSgxMSksIGkoMzIpO1xuICAgIHMuZGVmYXVsdC5HcmFpblBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1widXJsXCIsIFwib25sb2FkXCJdLCBzLmRlZmF1bHQuR3JhaW5QbGF5ZXIpO1xuICAgICAgcy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsIHQpLCB0aGlzLmJ1ZmZlciA9IG5ldyBzLmRlZmF1bHQuQnVmZmVyKHQudXJsLCB0Lm9ubG9hZC5iaW5kKHZvaWQgMCwgdGhpcykpLCB0aGlzLl9jbG9jayA9IG5ldyBzLmRlZmF1bHQuQ2xvY2sodGhpcy5fdGljay5iaW5kKHRoaXMpLCB0LmdyYWluU2l6ZSksIHRoaXMuX2xvb3BTdGFydCA9IDAsIHRoaXMuX2xvb3BFbmQgPSAwLCB0aGlzLl9hY3RpdmVTb3VyY2VzID0gW10sIHRoaXMuX3BsYXliYWNrUmF0ZSA9IHQucGxheWJhY2tSYXRlLCB0aGlzLl9ncmFpblNpemUgPSB0LmdyYWluU2l6ZSwgdGhpcy5fb3ZlcmxhcCA9IHQub3ZlcmxhcCwgdGhpcy5kZXR1bmUgPSB0LmRldHVuZSwgdGhpcy5vdmVybGFwID0gdC5vdmVybGFwLCB0aGlzLmxvb3AgPSB0Lmxvb3AsIHRoaXMucGxheWJhY2tSYXRlID0gdC5wbGF5YmFja1JhdGUsIHRoaXMuZ3JhaW5TaXplID0gdC5ncmFpblNpemUsIHRoaXMubG9vcFN0YXJ0ID0gdC5sb29wU3RhcnQsIHRoaXMubG9vcEVuZCA9IHQubG9vcEVuZCwgdGhpcy5yZXZlcnNlID0gdC5yZXZlcnNlLCB0aGlzLl9jbG9jay5vbihcInN0b3BcIiwgdGhpcy5fb25zdG9wLmJpbmQodGhpcykpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdyYWluUGxheWVyLCBzLmRlZmF1bHQuU291cmNlKSwgcy5kZWZhdWx0LkdyYWluUGxheWVyLmRlZmF1bHRzID0ge1xuICAgICAgb25sb2FkOiBzLmRlZmF1bHQubm9PcCxcbiAgICAgIG92ZXJsYXA6IC4xLFxuICAgICAgZ3JhaW5TaXplOiAuMixcbiAgICAgIHBsYXliYWNrUmF0ZTogMSxcbiAgICAgIGRldHVuZTogMCxcbiAgICAgIGxvb3A6ICExLFxuICAgICAgbG9vcFN0YXJ0OiAwLFxuICAgICAgbG9vcEVuZDogMCxcbiAgICAgIHJldmVyc2U6ICExXG4gICAgfSwgcy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZS5fc3RhcnQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIDApLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fb2Zmc2V0ID0gZSwgdGhpcy5fY2xvY2suc3RhcnQodCksIGkgJiYgdGhpcy5zdG9wKHQgKyB0aGlzLnRvU2Vjb25kcyhpKSk7XG4gICAgfSwgcy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZS5fc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9jbG9jay5zdG9wKHQpO1xuICAgIH0sIHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUuX29uc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5mYWRlT3V0ID0gMCwgZS5zdG9wKHQpO1xuICAgICAgfSk7XG4gICAgfSwgcy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZS5fdGljayA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBpZiAoIXRoaXMubG9vcCAmJiB0aGlzLl9vZmZzZXQgPiB0aGlzLmJ1ZmZlci5kdXJhdGlvbikgdGhpcy5zdG9wKHQpO2Vsc2Uge1xuICAgICAgICB2YXIgZSA9IHRoaXMuX29mZnNldCA8IHRoaXMuX292ZXJsYXAgPyAwIDogdGhpcy5fb3ZlcmxhcCxcbiAgICAgICAgICAgIGkgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZSh7XG4gICAgICAgICAgYnVmZmVyOiB0aGlzLmJ1ZmZlcixcbiAgICAgICAgICBmYWRlSW46IGUsXG4gICAgICAgICAgZmFkZU91dDogdGhpcy5fb3ZlcmxhcCxcbiAgICAgICAgICBsb29wOiB0aGlzLmxvb3AsXG4gICAgICAgICAgbG9vcFN0YXJ0OiB0aGlzLl9sb29wU3RhcnQsXG4gICAgICAgICAgbG9vcEVuZDogdGhpcy5fbG9vcEVuZCxcbiAgICAgICAgICBwbGF5YmFja1JhdGU6IHMuZGVmYXVsdC5pbnRlcnZhbFRvRnJlcXVlbmN5UmF0aW8odGhpcy5kZXR1bmUgLyAxMDApXG4gICAgICAgIH0pLmNvbm5lY3QodGhpcy5vdXRwdXQpO1xuICAgICAgICBpLnN0YXJ0KHQsIHRoaXMuX29mZnNldCksIHRoaXMuX29mZnNldCArPSB0aGlzLmdyYWluU2l6ZSwgaS5zdG9wKHQgKyB0aGlzLmdyYWluU2l6ZSAvIHRoaXMucGxheWJhY2tSYXRlKSwgdGhpcy5fYWN0aXZlU291cmNlcy5wdXNoKGkpLCBpLm9uZW5kZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHQgPSB0aGlzLl9hY3RpdmVTb3VyY2VzLmluZGV4T2YoaSk7XG5cbiAgICAgICAgICAtMSAhPT0gdCAmJiB0aGlzLl9hY3RpdmVTb3VyY2VzLnNwbGljZSh0LCAxKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpO1xuICAgICAgfVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLCBcInBsYXliYWNrUmF0ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3BsYXliYWNrUmF0ZSA9IHQsIHRoaXMuZ3JhaW5TaXplID0gdGhpcy5fZ3JhaW5TaXplO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZSwgXCJsb29wU3RhcnRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb29wU3RhcnQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9sb29wU3RhcnQgPSB0aGlzLnRvU2Vjb25kcyh0KTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUsIFwibG9vcEVuZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvb3BFbmQ7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9sb29wRW5kID0gdGhpcy50b1NlY29uZHModCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLCBcInJldmVyc2VcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlci5yZXZlcnNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5idWZmZXIucmV2ZXJzZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLCBcImdyYWluU2l6ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dyYWluU2l6ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2dyYWluU2l6ZSA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9jbG9jay5mcmVxdWVuY3kudmFsdWUgPSB0aGlzLl9wbGF5YmFja1JhdGUgLyB0aGlzLl9ncmFpblNpemU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLCBcIm92ZXJsYXBcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vdmVybGFwO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3ZlcmxhcCA9IHRoaXMudG9TZWNvbmRzKHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZSwgXCJsb2FkZWRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlci5sb2FkZWQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuYnVmZmVyLmRpc3Bvc2UoKSwgdGhpcy5idWZmZXIgPSBudWxsLCB0aGlzLl9jbG9jay5kaXNwb3NlKCksIHRoaXMuX2Nsb2NrID0gbnVsbCwgdGhpcy5fYWN0aXZlU291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuZGlzcG9zZSgpO1xuICAgICAgfSksIHRoaXMuX2FjdGl2ZVNvdXJjZXMgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5HcmFpblBsYXllcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxNiksIGkoMiksIGkoNDUpO1xuICAgIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgdGhpcy5vdXRwdXQgPSB0aGlzLl9vdXRwdXRTaWcgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0aGlzLl9pbml0aWFsVmFsdWUpLCB0aGlzLl9sYXN0VmFsID0gdGhpcy52YWx1ZSwgdGhpcy5fc3luY2VkID0gcy5kZWZhdWx0LlRyYW5zcG9ydC5zY2hlZHVsZVJlcGVhdCh0aGlzLl9vblRpY2suYmluZCh0aGlzKSwgXCIxaVwiKSwgdGhpcy5fYmluZEFuY2hvclZhbHVlID0gdGhpcy5fYW5jaG9yVmFsdWUuYmluZCh0aGlzKSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5vbihcInN0YXJ0IHN0b3AgcGF1c2VcIiwgdGhpcy5fYmluZEFuY2hvclZhbHVlKSwgdGhpcy5fZXZlbnRzLm1lbW9yeSA9IDEgLyAwO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLCBzLmRlZmF1bHQuU2lnbmFsKSwgcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5fb25UaWNrID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHZhciBlID0gdGhpcy5nZXRWYWx1ZUF0VGltZShzLmRlZmF1bHQuVHJhbnNwb3J0LnNlY29uZHMpO1xuICAgICAgdGhpcy5fbGFzdFZhbCAhPT0gZSAmJiAodGhpcy5fbGFzdFZhbCA9IGUsIHRoaXMuX291dHB1dFNpZy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShlLCB0KSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5fYW5jaG9yVmFsdWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgdmFyIGUgPSB0aGlzLmdldFZhbHVlQXRUaW1lKHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyk7XG4gICAgICByZXR1cm4gdGhpcy5fbGFzdFZhbCA9IGUsIHRoaXMuX291dHB1dFNpZy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCksIHRoaXMuX291dHB1dFNpZy5zZXRWYWx1ZUF0VGltZShlLCB0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWwucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUodCksIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lLmNhbGwodGhpcywgdCk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5zZXRWYWx1ZUF0VGltZSA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gZSA9IHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLCBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5zZXRWYWx1ZUF0VGltZS5jYWxsKHRoaXMsIHQsIGUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIGUgPSBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZShlKSwgcy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUuY2FsbCh0aGlzLCB0LCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWwucHJvdG90eXBlLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIGUgPSBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZShlKSwgcy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZS5jYWxsKHRoaXMsIHQsIGUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuc2V0VGFyZ2V0QXRUaW1lID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHJldHVybiBlID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoZSksIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLnNldFRhcmdldEF0VGltZS5jYWxsKHRoaXMsIHQsIGUsIGkpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuY2FuY2VsU2NoZWR1bGVkVmFsdWVzID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUodCksIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmNhbmNlbFNjaGVkdWxlZFZhbHVlcy5jYWxsKHRoaXMsIHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuc2V0VmFsdWVDdXJ2ZUF0VGltZSA9IGZ1bmN0aW9uICh0LCBlLCBpLCBuKSB7XG4gICAgICByZXR1cm4gZSA9IHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLCBpID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoaSksIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLnNldFZhbHVlQ3VydmVBdFRpbWUuY2FsbCh0aGlzLCB0LCBlLCBpLCBuKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWwucHJvdG90eXBlLmNhbmNlbEFuZEhvbGRBdFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmNhbmNlbEFuZEhvbGRBdFRpbWUuY2FsbCh0aGlzLCBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSh0KSk7XG4gICAgfSwgcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LlRyYW5zcG9ydC5jbGVhcih0aGlzLl9zeW5jZWQpLCBzLmRlZmF1bHQuVHJhbnNwb3J0Lm9mZihcInN0YXJ0IHN0b3AgcGF1c2VcIiwgdGhpcy5fc3luY2VkQ2FsbGJhY2spLCB0aGlzLl9ldmVudHMuY2FuY2VsKDApLCBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX291dHB1dFNpZy5kaXNwb3NlKCksIHRoaXMuX291dHB1dFNpZyA9IG51bGw7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDI5KSwgaSg1KTtcbiAgICBzLmRlZmF1bHQuTm9ybWFsaXplID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksIHRoaXMuX2lucHV0TWluID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgMCksIHRoaXMuX2lucHV0TWF4ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgMSksIHRoaXMuX3N1YiA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LkFkZCgwKSwgdGhpcy5fZGl2ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDEpLCB0aGlzLl9zdWIuY29ubmVjdCh0aGlzLl9kaXYpLCB0aGlzLl9zZXRSYW5nZSgpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk5vcm1hbGl6ZSwgcy5kZWZhdWx0LlNpZ25hbEJhc2UpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk5vcm1hbGl6ZS5wcm90b3R5cGUsIFwibWluXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRNaW47XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9pbnB1dE1pbiA9IHQsIHRoaXMuX3NldFJhbmdlKCk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTm9ybWFsaXplLnByb3RvdHlwZSwgXCJtYXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dE1heDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2lucHV0TWF4ID0gdCwgdGhpcy5fc2V0UmFuZ2UoKTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lk5vcm1hbGl6ZS5wcm90b3R5cGUuX3NldFJhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fc3ViLnZhbHVlID0gLXRoaXMuX2lucHV0TWluLCB0aGlzLl9kaXYudmFsdWUgPSAxIC8gKHRoaXMuX2lucHV0TWF4IC0gdGhpcy5faW5wdXRNaW4pO1xuICAgIH0sIHMuZGVmYXVsdC5Ob3JtYWxpemUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fc3ViLmRpc3Bvc2UoKSwgdGhpcy5fc3ViID0gbnVsbCwgdGhpcy5fZGl2LmRpc3Bvc2UoKSwgdGhpcy5fZGl2ID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTm9ybWFsaXplO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDcpLCBpKDIpO1xuICAgIHMuZGVmYXVsdC5HYWluVG9BdWRpbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksIHRoaXMuX25vcm0gPSB0aGlzLmlucHV0ID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIDIgKiBNYXRoLmFicyh0KSAtIDE7XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5HYWluVG9BdWRpbywgcy5kZWZhdWx0LlNpZ25hbEJhc2UpLCBzLmRlZmF1bHQuR2FpblRvQXVkaW8ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fbm9ybS5kaXNwb3NlKCksIHRoaXMuX25vcm0gPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5HYWluVG9BdWRpbztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgyMSksIGkoNzgpLCBpKDMyKTtcbiAgICBzLmRlZmF1bHQuU2FtcGxlciA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB2YXIgZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICBlLnNoaWZ0KCk7XG4gICAgICB2YXIgaSA9IHMuZGVmYXVsdC5kZWZhdWx0cyhlLCBbXCJvbmxvYWRcIiwgXCJiYXNlVXJsXCJdLCBzLmRlZmF1bHQuU2FtcGxlcik7XG4gICAgICBzLmRlZmF1bHQuSW5zdHJ1bWVudC5jYWxsKHRoaXMsIGkpO1xuICAgICAgdmFyIG4gPSB7fTtcblxuICAgICAgZm9yICh2YXIgbyBpbiB0KSBpZiAocy5kZWZhdWx0LmlzTm90ZShvKSkge1xuICAgICAgICBuW3MuZGVmYXVsdC5GcmVxdWVuY3kobykudG9NaWRpKCldID0gdFtvXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpc05hTihwYXJzZUZsb2F0KG8pKSkgdGhyb3cgbmV3IEVycm9yKFwiVG9uZS5TYW1wbGVyOiB1cmwga2V5cyBtdXN0IGJlIHRoZSBub3RlJ3MgcGl0Y2hcIik7XG4gICAgICAgIG5bb10gPSB0W29dO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9idWZmZXJzID0gbmV3IHMuZGVmYXVsdC5CdWZmZXJzKG4sIGkub25sb2FkLCBpLmJhc2VVcmwpLCB0aGlzLl9hY3RpdmVTb3VyY2VzID0ge30sIHRoaXMuYXR0YWNrID0gaS5hdHRhY2ssIHRoaXMucmVsZWFzZSA9IGkucmVsZWFzZSwgdGhpcy5jdXJ2ZSA9IGkuY3VydmU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU2FtcGxlciwgcy5kZWZhdWx0Lkluc3RydW1lbnQpLCBzLmRlZmF1bHQuU2FtcGxlci5kZWZhdWx0cyA9IHtcbiAgICAgIGF0dGFjazogMCxcbiAgICAgIHJlbGVhc2U6IC4xLFxuICAgICAgb25sb2FkOiBzLmRlZmF1bHQubm9PcCxcbiAgICAgIGJhc2VVcmw6IFwiXCIsXG4gICAgICBjdXJ2ZTogXCJleHBvbmVudGlhbFwiXG4gICAgfSwgcy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLl9maW5kQ2xvc2VzdCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBmb3IgKHZhciBlID0gMDsgZSA8IDk2Oykge1xuICAgICAgICBpZiAodGhpcy5fYnVmZmVycy5oYXModCArIGUpKSByZXR1cm4gLWU7XG4gICAgICAgIGlmICh0aGlzLl9idWZmZXJzLmhhcyh0IC0gZSkpIHJldHVybiBlO1xuICAgICAgICBlKys7XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGF2YWlsYWJsZSBidWZmZXJzIGZvciBub3RlOiBcIiArIHQpO1xuICAgIH0sIHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHRoaXMubG9nKFwidHJpZ2dlckF0dGFja1wiLCB0LCBlLCBpKSwgQXJyYXkuaXNBcnJheSh0KSB8fCAodCA9IFt0XSk7XG5cbiAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykge1xuICAgICAgICB2YXIgbyA9IHMuZGVmYXVsdC5GcmVxdWVuY3kodFtuXSkudG9NaWRpKCksXG4gICAgICAgICAgICBhID0gdGhpcy5fZmluZENsb3Nlc3QobyksXG4gICAgICAgICAgICByID0gbyAtIGEsXG4gICAgICAgICAgICBsID0gdGhpcy5fYnVmZmVycy5nZXQociksXG4gICAgICAgICAgICB1ID0gcy5kZWZhdWx0LmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyhhKSxcbiAgICAgICAgICAgIGQgPSBuZXcgcy5kZWZhdWx0LkJ1ZmZlclNvdXJjZSh7XG4gICAgICAgICAgYnVmZmVyOiBsLFxuICAgICAgICAgIHBsYXliYWNrUmF0ZTogdSxcbiAgICAgICAgICBmYWRlSW46IHRoaXMuYXR0YWNrLFxuICAgICAgICAgIGZhZGVPdXQ6IHRoaXMucmVsZWFzZSxcbiAgICAgICAgICBjdXJ2ZTogdGhpcy5jdXJ2ZVxuICAgICAgICB9KS5jb25uZWN0KHRoaXMub3V0cHV0KTtcblxuICAgICAgICBkLnN0YXJ0KGUsIDAsIGwuZHVyYXRpb24gLyB1LCBpKSwgcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5fYWN0aXZlU291cmNlc1tvXSkgfHwgKHRoaXMuX2FjdGl2ZVNvdXJjZXNbb10gPSBbXSksIHRoaXMuX2FjdGl2ZVNvdXJjZXNbb10ucHVzaChkKSwgZC5vbmVuZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICh0aGlzLl9hY3RpdmVTb3VyY2VzICYmIHRoaXMuX2FjdGl2ZVNvdXJjZXNbb10pIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5fYWN0aXZlU291cmNlc1tvXS5pbmRleE9mKGQpO1xuXG4gICAgICAgICAgICAtMSAhPT0gdCAmJiB0aGlzLl9hY3RpdmVTb3VyY2VzW29dLnNwbGljZSh0LCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0uYmluZCh0aGlzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLnRyaWdnZXJSZWxlYXNlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHRoaXMubG9nKFwidHJpZ2dlclJlbGVhc2VcIiwgdCwgZSksIEFycmF5LmlzQXJyYXkodCkgfHwgKHQgPSBbdF0pO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG4gPSBzLmRlZmF1bHQuRnJlcXVlbmN5KHRbaV0pLnRvTWlkaSgpO1xuICAgICAgICB0aGlzLl9hY3RpdmVTb3VyY2VzW25dICYmIHRoaXMuX2FjdGl2ZVNvdXJjZXNbbl0ubGVuZ3RoICYmIChlID0gdGhpcy50b1NlY29uZHMoZSksIHRoaXMuX2FjdGl2ZVNvdXJjZXNbbl0uZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHQuc3RvcChlKTtcbiAgICAgICAgfSksIHRoaXMuX2FjdGl2ZVNvdXJjZXNbbl0gPSBbXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS5yZWxlYXNlQWxsID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGZvciAodmFyIGUgaW4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9hY3RpdmVTb3VyY2VzKSBmb3IgKHZhciBpID0gdGhpcy5fYWN0aXZlU291cmNlc1tlXTsgaS5sZW5ndGg7KSB7XG4gICAgICAgIGkuc2hpZnQoKS5zdG9wKHQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuU2FtcGxlci5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLCAxKSwgdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsIDEpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZSA9IGZ1bmN0aW9uICh0LCBlLCBpLCBuKSB7XG4gICAgICBpZiAoaSA9IHRoaXMudG9TZWNvbmRzKGkpLCB0aGlzLnRyaWdnZXJBdHRhY2sodCwgaSwgbiksIHMuZGVmYXVsdC5pc0FycmF5KGUpICYmIHMuZGVmYXVsdC5pc0FycmF5KHQpKSBmb3IgKHZhciBvID0gMDsgbyA8IHQubGVuZ3RoOyBvKyspIHtcbiAgICAgICAgdmFyIGEgPSBlW01hdGgubWluKG8sIGUubGVuZ3RoIC0gMSldO1xuICAgICAgICB0aGlzLnRyaWdnZXJSZWxlYXNlKHRbb10sIGkgKyB0aGlzLnRvU2Vjb25kcyhhKSk7XG4gICAgICB9IGVsc2UgdGhpcy50cmlnZ2VyUmVsZWFzZSh0LCBpICsgdGhpcy50b1NlY29uZHMoZSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBpZiAocy5kZWZhdWx0LmlzTm90ZSh0KSkge1xuICAgICAgICB2YXIgbiA9IHMuZGVmYXVsdC5GcmVxdWVuY3kodCkudG9NaWRpKCk7XG5cbiAgICAgICAgdGhpcy5fYnVmZmVycy5hZGQobiwgZSwgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoaXNOYU4ocGFyc2VGbG9hdCh0KSkpIHRocm93IG5ldyBFcnJvcihcIlRvbmUuU2FtcGxlcjogbm90ZSBtdXN0IGJlIHRoZSBub3RlJ3MgcGl0Y2guIEluc3RlYWQgZ290IFwiICsgdCk7XG5cbiAgICAgICAgdGhpcy5fYnVmZmVycy5hZGQodCwgZSwgaSk7XG4gICAgICB9XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZSwgXCJsb2FkZWRcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9idWZmZXJzLmxvYWRlZDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciB0IGluIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2J1ZmZlcnMuZGlzcG9zZSgpLCB0aGlzLl9idWZmZXJzID0gbnVsbCwgdGhpcy5fYWN0aXZlU291cmNlcykgdGhpcy5fYWN0aXZlU291cmNlc1t0XS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9hY3RpdmVTb3VyY2VzID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU2FtcGxlcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgzOCksIGkoNik7XG4gICAgcy5kZWZhdWx0LlBvbHlTeW50aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wicG9seXBob255XCIsIFwidm9pY2VcIl0sIHMuZGVmYXVsdC5Qb2x5U3ludGgpO1xuICAgICAgcy5kZWZhdWx0Lkluc3RydW1lbnQuY2FsbCh0aGlzLCB0KSwgKHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5kZWZhdWx0cykpLnBvbHlwaG9ueSA9IE1hdGgubWluKHMuZGVmYXVsdC5Qb2x5U3ludGguTUFYX1BPTFlQSE9OWSwgdC5wb2x5cGhvbnkpLCB0aGlzLnZvaWNlcyA9IG5ldyBBcnJheSh0LnBvbHlwaG9ueSksIHRoaXMuYXNzZXJ0KHQucG9seXBob255ID4gMCwgXCJwb2x5cGhvbnkgbXVzdCBiZSBncmVhdGVyIHRoYW4gMFwiKSwgdGhpcy5kZXR1bmUgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmRldHVuZSwgcy5kZWZhdWx0LlR5cGUuQ2VudHMpLCB0aGlzLl9yZWFkT25seShcImRldHVuZVwiKTtcblxuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0LnBvbHlwaG9ueTsgZSsrKSB7XG4gICAgICAgIHZhciBpID0gbmV3IHQudm9pY2UoYXJndW1lbnRzWzJdLCBhcmd1bWVudHNbM10pO1xuICAgICAgICBpZiAoIShpIGluc3RhbmNlb2Ygcy5kZWZhdWx0Lk1vbm9waG9uaWMpKSB0aHJvdyBuZXcgRXJyb3IoXCJTeW50aCBjb25zdHJ1Y3RvciBtdXN0IGJlIGluc3RhbmNlIG9mIFRvbmUuTW9ub3Bob25pY1wiKTtcbiAgICAgICAgdGhpcy52b2ljZXNbZV0gPSBpLCBpLmluZGV4ID0gZSwgaS5jb25uZWN0KHRoaXMub3V0cHV0KSwgaS5oYXNPd25Qcm9wZXJ0eShcImRldHVuZVwiKSAmJiB0aGlzLmRldHVuZS5jb25uZWN0KGkuZGV0dW5lKTtcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Qb2x5U3ludGgsIHMuZGVmYXVsdC5JbnN0cnVtZW50KSwgcy5kZWZhdWx0LlBvbHlTeW50aC5kZWZhdWx0cyA9IHtcbiAgICAgIHBvbHlwaG9ueTogNCxcbiAgICAgIHZvbHVtZTogMCxcbiAgICAgIGRldHVuZTogMCxcbiAgICAgIHZvaWNlOiBzLmRlZmF1bHQuU3ludGhcbiAgICB9LCBzLmRlZmF1bHQuUG9seVN5bnRoLnByb3RvdHlwZS5fZ2V0Q2xvc2VzdFZvaWNlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHZhciBpID0gdGhpcy52b2ljZXMuZmluZChmdW5jdGlvbiAoaSkge1xuICAgICAgICBpZiAoTWF0aC5hYnMoaS5mcmVxdWVuY3kuZ2V0VmFsdWVBdFRpbWUodCkgLSBzLmRlZmF1bHQuRnJlcXVlbmN5KGUpKSA8IDFlLTQgJiYgaS5nZXRMZXZlbEF0VGltZSh0KSA+IDFlLTUpIHJldHVybiBpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gaSB8fCB0aGlzLnZvaWNlcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGUsIGkpIHtcbiAgICAgICAgdmFyIHMgPSBlLmdldExldmVsQXRUaW1lKHQgKyB0aGlzLmJsb2NrVGltZSksXG4gICAgICAgICAgICBuID0gaS5nZXRMZXZlbEF0VGltZSh0ICsgdGhpcy5ibG9ja1RpbWUpO1xuICAgICAgICByZXR1cm4gcyA8IDFlLTUgJiYgKHMgPSAwKSwgbiA8IDFlLTUgJiYgKG4gPSAwKSwgcyAtIG47XG4gICAgICB9LmJpbmQodGhpcykpWzBdO1xuICAgIH0sIHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLnRyaWdnZXJBdHRhY2sgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodCkgfHwgKHQgPSBbdF0pLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHQuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgcyA9IHRoaXMuX2dldENsb3Nlc3RWb2ljZShlLCB0KTtcblxuICAgICAgICBzLnRyaWdnZXJBdHRhY2sodCwgZSwgaSksIHRoaXMubG9nKFwidHJpZ2dlckF0dGFja1wiLCBzLmluZGV4LCB0KTtcbiAgICAgIH0uYmluZCh0aGlzKSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBvbHlTeW50aC5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2UgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodCkgfHwgKHQgPSBbdF0pLCBlID0gdGhpcy50b1NlY29uZHMoZSksIHQuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgaSA9IHRoaXMuX2dldENsb3Nlc3RWb2ljZShlLCB0KTtcblxuICAgICAgICB0aGlzLmxvZyhcInRyaWdnZXJSZWxlYXNlXCIsIGkuaW5kZXgsIHQpLCBpLnRyaWdnZXJSZWxlYXNlKGUpO1xuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuUG9seVN5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZSA9IGZ1bmN0aW9uICh0LCBlLCBpLCBuKSB7XG4gICAgICBpZiAoaSA9IHRoaXMudG9TZWNvbmRzKGkpLCB0aGlzLnRyaWdnZXJBdHRhY2sodCwgaSwgbiksIHMuZGVmYXVsdC5pc0FycmF5KGUpICYmIHMuZGVmYXVsdC5pc0FycmF5KHQpKSBmb3IgKHZhciBvID0gMDsgbyA8IHQubGVuZ3RoOyBvKyspIHtcbiAgICAgICAgdmFyIGEgPSBlW01hdGgubWluKG8sIGUubGVuZ3RoIC0gMSldO1xuICAgICAgICB0aGlzLnRyaWdnZXJSZWxlYXNlKHRbb10sIGkgKyB0aGlzLnRvU2Vjb25kcyhhKSk7XG4gICAgICB9IGVsc2UgdGhpcy50cmlnZ2VyUmVsZWFzZSh0LCBpICsgdGhpcy50b1NlY29uZHMoZSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBvbHlTeW50aC5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLCAxKSwgdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsIDEpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHRoaXMudm9pY2VzLmxlbmd0aDsgcysrKSB0aGlzLnZvaWNlc1tzXS5zZXQodCwgZSwgaSk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy52b2ljZXNbMF0uZ2V0KHQpO1xuICAgIH0sIHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLnJlbGVhc2VBbGwgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy52b2ljZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnRyaWdnZXJSZWxlYXNlKHQpO1xuICAgICAgfSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBvbHlTeW50aC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLnZvaWNlcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHQuZGlzcG9zZSgpO1xuICAgICAgfSksIHRoaXMuX3dyaXRhYmxlKFwiZGV0dW5lXCIpLCB0aGlzLmRldHVuZS5kaXNwb3NlKCksIHRoaXMuZGV0dW5lID0gbnVsbCwgdGhpcy52b2ljZXMgPSBudWxsLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Qb2x5U3ludGguTUFYX1BPTFlQSE9OWSA9IDIwLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUG9seVN5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIxKSwgaSgzOSksIGkoNTQpO1xuICAgIHMuZGVmYXVsdC5QbHVja1N5bnRoID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuUGx1Y2tTeW50aC5kZWZhdWx0cyksIHMuZGVmYXVsdC5JbnN0cnVtZW50LmNhbGwodGhpcywgdCksIHRoaXMuX25vaXNlID0gbmV3IHMuZGVmYXVsdC5Ob2lzZShcInBpbmtcIiksIHRoaXMuYXR0YWNrTm9pc2UgPSB0LmF0dGFja05vaXNlLCB0aGlzLl9sZmNmID0gbmV3IHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlcih7XG4gICAgICAgIHJlc29uYW5jZTogdC5yZXNvbmFuY2UsXG4gICAgICAgIGRhbXBlbmluZzogdC5kYW1wZW5pbmdcbiAgICAgIH0pLCB0aGlzLnJlc29uYW5jZSA9IHRoaXMuX2xmY2YucmVzb25hbmNlLCB0aGlzLmRhbXBlbmluZyA9IHRoaXMuX2xmY2YuZGFtcGVuaW5nLCB0aGlzLl9ub2lzZS5jb25uZWN0KHRoaXMuX2xmY2YpLCB0aGlzLl9sZmNmLmNvbm5lY3QodGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJyZXNvbmFuY2VcIiwgXCJkYW1wZW5pbmdcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBsdWNrU3ludGgsIHMuZGVmYXVsdC5JbnN0cnVtZW50KSwgcy5kZWZhdWx0LlBsdWNrU3ludGguZGVmYXVsdHMgPSB7XG4gICAgICBhdHRhY2tOb2lzZTogMSxcbiAgICAgIGRhbXBlbmluZzogNGUzLFxuICAgICAgcmVzb25hbmNlOiAuN1xuICAgIH0sIHMuZGVmYXVsdC5QbHVja1N5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHQgPSB0aGlzLnRvRnJlcXVlbmN5KHQpLCBlID0gdGhpcy50b1NlY29uZHMoZSk7XG4gICAgICB2YXIgaSA9IDEgLyB0O1xuICAgICAgcmV0dXJuIHRoaXMuX2xmY2YuZGVsYXlUaW1lLnNldFZhbHVlQXRUaW1lKGksIGUpLCB0aGlzLl9ub2lzZS5zdGFydChlKSwgdGhpcy5fbm9pc2Uuc3RvcChlICsgaSAqIHRoaXMuYXR0YWNrTm9pc2UpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5QbHVja1N5bnRoLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX25vaXNlLmRpc3Bvc2UoKSwgdGhpcy5fbGZjZi5kaXNwb3NlKCksIHRoaXMuX25vaXNlID0gbnVsbCwgdGhpcy5fbGZjZiA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcInJlc29uYW5jZVwiLCBcImRhbXBlbmluZ1wiXSksIHRoaXMuZGFtcGVuaW5nID0gbnVsbCwgdGhpcy5yZXNvbmFuY2UgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5QbHVja1N5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDMxKSwgaSg0MSksIGkoMzkpLCBpKDIpLCBpKDkpLCBpKDIxKTtcbiAgICBzLmRlZmF1bHQuTm9pc2VTeW50aCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0Lk5vaXNlU3ludGguZGVmYXVsdHMpLCBzLmRlZmF1bHQuSW5zdHJ1bWVudC5jYWxsKHRoaXMsIHQpLCB0aGlzLm5vaXNlID0gbmV3IHMuZGVmYXVsdC5Ob2lzZSh0Lm5vaXNlKSwgdGhpcy5lbnZlbG9wZSA9IG5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksIHRoaXMubm9pc2UuY2hhaW4odGhpcy5lbnZlbG9wZSwgdGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJub2lzZVwiLCBcImVudmVsb3BlXCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Ob2lzZVN5bnRoLCBzLmRlZmF1bHQuSW5zdHJ1bWVudCksIHMuZGVmYXVsdC5Ob2lzZVN5bnRoLmRlZmF1bHRzID0ge1xuICAgICAgbm9pc2U6IHtcbiAgICAgICAgdHlwZTogXCJ3aGl0ZVwiXG4gICAgICB9LFxuICAgICAgZW52ZWxvcGU6IHtcbiAgICAgICAgYXR0YWNrOiAuMDA1LFxuICAgICAgICBkZWNheTogLjEsXG4gICAgICAgIHN1c3RhaW46IDBcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuTm9pc2VTeW50aC5wcm90b3R5cGUudHJpZ2dlckF0dGFjayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCwgZSksIHRoaXMubm9pc2Uuc3RhcnQodCksIDAgPT09IHRoaXMuZW52ZWxvcGUuc3VzdGFpbiAmJiB0aGlzLm5vaXNlLnN0b3AodCArIHRoaXMuZW52ZWxvcGUuYXR0YWNrICsgdGhpcy5lbnZlbG9wZS5kZWNheSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk5vaXNlU3ludGgucHJvdG90eXBlLnRyaWdnZXJSZWxlYXNlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksIHRoaXMubm9pc2Uuc3RvcCh0ICsgdGhpcy5lbnZlbG9wZS5yZWxlYXNlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuTm9pc2VTeW50aC5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLCAwKSwgdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsIDApLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Ob2lzZVN5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICByZXR1cm4gZSA9IHRoaXMudG9TZWNvbmRzKGUpLCB0ID0gdGhpcy50b1NlY29uZHModCksIHRoaXMudHJpZ2dlckF0dGFjayhlLCBpKSwgdGhpcy50cmlnZ2VyUmVsZWFzZShlICsgdCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk5vaXNlU3ludGgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wibm9pc2VcIiwgXCJlbnZlbG9wZVwiXSksIHRoaXMubm9pc2UuZGlzcG9zZSgpLCB0aGlzLm5vaXNlID0gbnVsbCwgdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksIHRoaXMuZW52ZWxvcGUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5Ob2lzZVN5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKSxcbiAgICAgICAgbiA9IChpKDIxKSwgaSg0OSksIGkoOSksIGkoNDEpLCBpKDMxKSwgaSgzKSwgaSgyNiksIGkoNSksIFsxLCAxLjQ4MywgMS45MzIsIDIuNTQ2LCAyLjYzLCAzLjg5N10pO1xuICAgIHMuZGVmYXVsdC5NZXRhbFN5bnRoID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuTWV0YWxTeW50aC5kZWZhdWx0cyksIHMuZGVmYXVsdC5JbnN0cnVtZW50LmNhbGwodGhpcywgdCksIHRoaXMuZnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5mcmVxdWVuY3ksIHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksIHRoaXMuX29zY2lsbGF0b3JzID0gW10sIHRoaXMuX2ZyZXFNdWx0aXBsaWVycyA9IFtdLCB0aGlzLl9hbXBsaXR1ZSA9IG5ldyBzLmRlZmF1bHQuR2FpbigwKS5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5faGlnaHBhc3MgPSBuZXcgcy5kZWZhdWx0LkZpbHRlcih7XG4gICAgICAgIHR5cGU6IFwiaGlnaHBhc3NcIixcbiAgICAgICAgUTogLTMuMDEwMjk5OTU2NjM5ODEyNVxuICAgICAgfSkuY29ubmVjdCh0aGlzLl9hbXBsaXR1ZSksIHRoaXMuX29jdGF2ZXMgPSB0Lm9jdGF2ZXMsIHRoaXMuX2ZpbHRlckZyZXFTY2FsZXIgPSBuZXcgcy5kZWZhdWx0LlNjYWxlKHQucmVzb25hbmNlLCA3ZTMpLCB0aGlzLmVudmVsb3BlID0gbmV3IHMuZGVmYXVsdC5FbnZlbG9wZSh7XG4gICAgICAgIGF0dGFjazogdC5lbnZlbG9wZS5hdHRhY2ssXG4gICAgICAgIGF0dGFja0N1cnZlOiBcImxpbmVhclwiLFxuICAgICAgICBkZWNheTogdC5lbnZlbG9wZS5kZWNheSxcbiAgICAgICAgc3VzdGFpbjogMCxcbiAgICAgICAgcmVsZWFzZTogdC5lbnZlbG9wZS5yZWxlYXNlXG4gICAgICB9KS5jaGFpbih0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLCB0aGlzLl9oaWdocGFzcy5mcmVxdWVuY3kpLCB0aGlzLmVudmVsb3BlLmNvbm5lY3QodGhpcy5fYW1wbGl0dWUuZ2Fpbik7XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgbi5sZW5ndGg7IGUrKykge1xuICAgICAgICB2YXIgaSA9IG5ldyBzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yKHtcbiAgICAgICAgICB0eXBlOiBcInNxdWFyZVwiLFxuICAgICAgICAgIG1vZHVsYXRpb25UeXBlOiBcInNxdWFyZVwiLFxuICAgICAgICAgIGhhcm1vbmljaXR5OiB0Lmhhcm1vbmljaXR5LFxuICAgICAgICAgIG1vZHVsYXRpb25JbmRleDogdC5tb2R1bGF0aW9uSW5kZXhcbiAgICAgICAgfSk7XG4gICAgICAgIGkuY29ubmVjdCh0aGlzLl9oaWdocGFzcyksIHRoaXMuX29zY2lsbGF0b3JzW2VdID0gaTtcbiAgICAgICAgdmFyIG8gPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KG5bZV0pO1xuICAgICAgICB0aGlzLl9mcmVxTXVsdGlwbGllcnNbZV0gPSBvLCB0aGlzLmZyZXF1ZW5jeS5jaGFpbihvLCBpLmZyZXF1ZW5jeSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMub2N0YXZlcyA9IHQub2N0YXZlcztcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NZXRhbFN5bnRoLCBzLmRlZmF1bHQuSW5zdHJ1bWVudCksIHMuZGVmYXVsdC5NZXRhbFN5bnRoLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiAyMDAsXG4gICAgICBlbnZlbG9wZToge1xuICAgICAgICBhdHRhY2s6IC4wMDEsXG4gICAgICAgIGRlY2F5OiAxLjQsXG4gICAgICAgIHJlbGVhc2U6IC4yXG4gICAgICB9LFxuICAgICAgaGFybW9uaWNpdHk6IDUuMSxcbiAgICAgIG1vZHVsYXRpb25JbmRleDogMzIsXG4gICAgICByZXNvbmFuY2U6IDRlMyxcbiAgICAgIG9jdGF2ZXM6IDEuNVxuICAgIH0sIHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiB0ID0gdGhpcy50b1NlY29uZHModCksIGUgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLCAxKSwgdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQsIGUpLCB0aGlzLl9vc2NpbGxhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuc3RhcnQodCk7XG4gICAgICB9KSwgMCA9PT0gdGhpcy5lbnZlbG9wZS5zdXN0YWluICYmIHRoaXMuX29zY2lsbGF0b3JzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5zdG9wKHQgKyB0aGlzLmVudmVsb3BlLmF0dGFjayArIHRoaXMuZW52ZWxvcGUuZGVjYXkpO1xuICAgICAgfS5iaW5kKHRoaXMpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuTWV0YWxTeW50aC5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5lbnZlbG9wZS50cmlnZ2VyUmVsZWFzZSh0KSwgdGhpcy5fb3NjaWxsYXRvcnMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnN0b3AodCArIHRoaXMuZW52ZWxvcGUucmVsZWFzZSk7XG4gICAgICB9LmJpbmQodGhpcykpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZS5zeW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyQXR0YWNrXCIsIDApLCB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlclJlbGVhc2VcIiwgMCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk1ldGFsU3ludGgucHJvdG90eXBlLnRyaWdnZXJBdHRhY2tSZWxlYXNlID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIHJldHVybiBlID0gdGhpcy50b1NlY29uZHMoZSksIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy50cmlnZ2VyQXR0YWNrKGUsIGkpLCB0aGlzLnRyaWdnZXJSZWxlYXNlKGUgKyB0KSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk1ldGFsU3ludGgucHJvdG90eXBlLCBcIm1vZHVsYXRpb25JbmRleFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29zY2lsbGF0b3JzWzBdLm1vZHVsYXRpb25JbmRleC52YWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5fb3NjaWxsYXRvcnMubGVuZ3RoOyBlKyspIHRoaXMuX29zY2lsbGF0b3JzW2VdLm1vZHVsYXRpb25JbmRleC52YWx1ZSA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTWV0YWxTeW50aC5wcm90b3R5cGUsIFwiaGFybW9uaWNpdHlcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vc2NpbGxhdG9yc1swXS5oYXJtb25pY2l0eS52YWx1ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5fb3NjaWxsYXRvcnMubGVuZ3RoOyBlKyspIHRoaXMuX29zY2lsbGF0b3JzW2VdLmhhcm1vbmljaXR5LnZhbHVlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZSwgXCJyZXNvbmFuY2VcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLm1pbjtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2ZpbHRlckZyZXFTY2FsZXIubWluID0gdCwgdGhpcy5vY3RhdmVzID0gdGhpcy5fb2N0YXZlcztcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZSwgXCJvY3RhdmVzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb2N0YXZlcztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29jdGF2ZXMgPSB0LCB0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLm1heCA9IHRoaXMuX2ZpbHRlckZyZXFTY2FsZXIubWluICogTWF0aC5wb3coMiwgdCk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtcblxuICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCB0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg7IHQrKykgdGhpcy5fb3NjaWxsYXRvcnNbdF0uZGlzcG9zZSgpLCB0aGlzLl9mcmVxTXVsdGlwbGllcnNbdF0uZGlzcG9zZSgpO1xuXG4gICAgICB0aGlzLl9vc2NpbGxhdG9ycyA9IG51bGwsIHRoaXMuX2ZyZXFNdWx0aXBsaWVycyA9IG51bGwsIHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLmRpc3Bvc2UoKSwgdGhpcy5fZmlsdGVyRnJlcVNjYWxlciA9IG51bGwsIHRoaXMuX2FtcGxpdHVlLmRpc3Bvc2UoKSwgdGhpcy5fYW1wbGl0dWUgPSBudWxsLCB0aGlzLmVudmVsb3BlLmRpc3Bvc2UoKSwgdGhpcy5lbnZlbG9wZSA9IG51bGwsIHRoaXMuX2hpZ2hwYXNzLmRpc3Bvc2UoKSwgdGhpcy5faGlnaHBhc3MgPSBudWxsO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NZXRhbFN5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDM3KSwgaSgyMSksIGkoMzEpO1xuICAgIHMuZGVmYXVsdC5NZW1icmFuZVN5bnRoID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHQgPSBzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LCBzLmRlZmF1bHQuTWVtYnJhbmVTeW50aC5kZWZhdWx0cyksIHMuZGVmYXVsdC5JbnN0cnVtZW50LmNhbGwodGhpcywgdCksIHRoaXMub3NjaWxsYXRvciA9IG5ldyBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IodC5vc2NpbGxhdG9yKSwgdGhpcy5lbnZlbG9wZSA9IG5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksIHRoaXMub2N0YXZlcyA9IHQub2N0YXZlcywgdGhpcy5waXRjaERlY2F5ID0gdC5waXRjaERlY2F5LCB0aGlzLm9zY2lsbGF0b3IuY2hhaW4odGhpcy5lbnZlbG9wZSwgdGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJvc2NpbGxhdG9yXCIsIFwiZW52ZWxvcGVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1lbWJyYW5lU3ludGgsIHMuZGVmYXVsdC5JbnN0cnVtZW50KSwgcy5kZWZhdWx0Lk1lbWJyYW5lU3ludGguZGVmYXVsdHMgPSB7XG4gICAgICBwaXRjaERlY2F5OiAuMDUsXG4gICAgICBvY3RhdmVzOiAxMCxcbiAgICAgIG9zY2lsbGF0b3I6IHtcbiAgICAgICAgdHlwZTogXCJzaW5lXCJcbiAgICAgIH0sXG4gICAgICBlbnZlbG9wZToge1xuICAgICAgICBhdHRhY2s6IC4wMDEsXG4gICAgICAgIGRlY2F5OiAuNCxcbiAgICAgICAgc3VzdGFpbjogLjAxLFxuICAgICAgICByZWxlYXNlOiAxLjQsXG4gICAgICAgIGF0dGFja0N1cnZlOiBcImV4cG9uZW50aWFsXCJcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuTWVtYnJhbmVTeW50aC5wcm90b3R5cGUudHJpZ2dlckF0dGFjayA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBlID0gdGhpcy50b1NlY29uZHMoZSk7XG4gICAgICB2YXIgcyA9ICh0ID0gdGhpcy50b0ZyZXF1ZW5jeSh0KSkgKiB0aGlzLm9jdGF2ZXM7XG4gICAgICByZXR1cm4gdGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZShzLCBlKSwgdGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsIGUgKyB0aGlzLnRvU2Vjb25kcyh0aGlzLnBpdGNoRGVjYXkpKSwgdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKGUsIGkpLCB0aGlzLm9zY2lsbGF0b3Iuc3RhcnQoZSksIDAgPT09IHRoaXMuZW52ZWxvcGUuc3VzdGFpbiAmJiB0aGlzLm9zY2lsbGF0b3Iuc3RvcChlICsgdGhpcy5lbnZlbG9wZS5hdHRhY2sgKyB0aGlzLmVudmVsb3BlLmRlY2F5KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuTWVtYnJhbmVTeW50aC5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5lbnZlbG9wZS50cmlnZ2VyUmVsZWFzZSh0KSwgdGhpcy5vc2NpbGxhdG9yLnN0b3AodCArIHRoaXMuZW52ZWxvcGUucmVsZWFzZSksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0Lk1lbWJyYW5lU3ludGgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wib3NjaWxsYXRvclwiLCBcImVudmVsb3BlXCJdKSwgdGhpcy5vc2NpbGxhdG9yLmRpc3Bvc2UoKSwgdGhpcy5vc2NpbGxhdG9yID0gbnVsbCwgdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksIHRoaXMuZW52ZWxvcGUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NZW1icmFuZVN5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDM4KSwgaSgyKSwgaSg1KSwgaSgyNSk7XG4gICAgcy5kZWZhdWx0LkZNU3ludGggPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHMuZGVmYXVsdC5GTVN5bnRoLmRlZmF1bHRzKSwgcy5kZWZhdWx0Lk1vbm9waG9uaWMuY2FsbCh0aGlzLCB0KSwgdGhpcy5fY2FycmllciA9IG5ldyBzLmRlZmF1bHQuU3ludGgodC5jYXJyaWVyKSwgdGhpcy5fY2Fycmllci52b2x1bWUudmFsdWUgPSAtMTAsIHRoaXMub3NjaWxsYXRvciA9IHRoaXMuX2NhcnJpZXIub3NjaWxsYXRvciwgdGhpcy5lbnZlbG9wZSA9IHRoaXMuX2NhcnJpZXIuZW52ZWxvcGUuc2V0KHQuZW52ZWxvcGUpLCB0aGlzLl9tb2R1bGF0b3IgPSBuZXcgcy5kZWZhdWx0LlN5bnRoKHQubW9kdWxhdG9yKSwgdGhpcy5fbW9kdWxhdG9yLnZvbHVtZS52YWx1ZSA9IC0xMCwgdGhpcy5tb2R1bGF0aW9uID0gdGhpcy5fbW9kdWxhdG9yLm9zY2lsbGF0b3Iuc2V0KHQubW9kdWxhdGlvbiksIHRoaXMubW9kdWxhdGlvbkVudmVsb3BlID0gdGhpcy5fbW9kdWxhdG9yLmVudmVsb3BlLnNldCh0Lm1vZHVsYXRpb25FbnZlbG9wZSksIHRoaXMuZnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwoNDQwLCBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLCB0aGlzLmRldHVuZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGV0dW5lLCBzLmRlZmF1bHQuVHlwZS5DZW50cyksIHRoaXMuaGFybW9uaWNpdHkgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KHQuaGFybW9uaWNpdHkpLCB0aGlzLmhhcm1vbmljaXR5LnVuaXRzID0gcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUsIHRoaXMubW9kdWxhdGlvbkluZGV4ID0gbmV3IHMuZGVmYXVsdC5NdWx0aXBseSh0Lm1vZHVsYXRpb25JbmRleCksIHRoaXMubW9kdWxhdGlvbkluZGV4LnVuaXRzID0gcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUsIHRoaXMuX21vZHVsYXRpb25Ob2RlID0gbmV3IHMuZGVmYXVsdC5HYWluKDApLCB0aGlzLmZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2NhcnJpZXIuZnJlcXVlbmN5KSwgdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSwgdGhpcy5fbW9kdWxhdG9yLmZyZXF1ZW5jeSksIHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMubW9kdWxhdGlvbkluZGV4LCB0aGlzLl9tb2R1bGF0aW9uTm9kZSksIHRoaXMuZGV0dW5lLmZhbih0aGlzLl9jYXJyaWVyLmRldHVuZSwgdGhpcy5fbW9kdWxhdG9yLmRldHVuZSksIHRoaXMuX21vZHVsYXRvci5jb25uZWN0KHRoaXMuX21vZHVsYXRpb25Ob2RlLmdhaW4pLCB0aGlzLl9tb2R1bGF0aW9uTm9kZS5jb25uZWN0KHRoaXMuX2NhcnJpZXIuZnJlcXVlbmN5KSwgdGhpcy5fY2Fycmllci5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsIFwiaGFybW9uaWNpdHlcIiwgXCJtb2R1bGF0aW9uSW5kZXhcIiwgXCJvc2NpbGxhdG9yXCIsIFwiZW52ZWxvcGVcIiwgXCJtb2R1bGF0aW9uXCIsIFwibW9kdWxhdGlvbkVudmVsb3BlXCIsIFwiZGV0dW5lXCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GTVN5bnRoLCBzLmRlZmF1bHQuTW9ub3Bob25pYyksIHMuZGVmYXVsdC5GTVN5bnRoLmRlZmF1bHRzID0ge1xuICAgICAgaGFybW9uaWNpdHk6IDMsXG4gICAgICBtb2R1bGF0aW9uSW5kZXg6IDEwLFxuICAgICAgZGV0dW5lOiAwLFxuICAgICAgb3NjaWxsYXRvcjoge1xuICAgICAgICB0eXBlOiBcInNpbmVcIlxuICAgICAgfSxcbiAgICAgIGVudmVsb3BlOiB7XG4gICAgICAgIGF0dGFjazogLjAxLFxuICAgICAgICBkZWNheTogLjAxLFxuICAgICAgICBzdXN0YWluOiAxLFxuICAgICAgICByZWxlYXNlOiAuNVxuICAgICAgfSxcbiAgICAgIG1vZHVsYXRpb246IHtcbiAgICAgICAgdHlwZTogXCJzcXVhcmVcIlxuICAgICAgfSxcbiAgICAgIG1vZHVsYXRpb25FbnZlbG9wZToge1xuICAgICAgICBhdHRhY2s6IC41LFxuICAgICAgICBkZWNheTogMCxcbiAgICAgICAgc3VzdGFpbjogMSxcbiAgICAgICAgcmVsZWFzZTogLjVcbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuRk1TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9jYXJyaWVyLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCwgZSksIHRoaXMuX21vZHVsYXRvci5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5GTVN5bnRoLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdCA9IHRoaXMudG9TZWNvbmRzKHQpLCB0aGlzLl9jYXJyaWVyLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpLCB0aGlzLl9tb2R1bGF0b3IuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkZNU3ludGgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsIFwiaGFybW9uaWNpdHlcIiwgXCJtb2R1bGF0aW9uSW5kZXhcIiwgXCJvc2NpbGxhdG9yXCIsIFwiZW52ZWxvcGVcIiwgXCJtb2R1bGF0aW9uXCIsIFwibW9kdWxhdGlvbkVudmVsb3BlXCIsIFwiZGV0dW5lXCJdKSwgdGhpcy5fY2Fycmllci5kaXNwb3NlKCksIHRoaXMuX2NhcnJpZXIgPSBudWxsLCB0aGlzLl9tb2R1bGF0b3IuZGlzcG9zZSgpLCB0aGlzLl9tb2R1bGF0b3IgPSBudWxsLCB0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5kZXR1bmUuZGlzcG9zZSgpLCB0aGlzLmRldHVuZSA9IG51bGwsIHRoaXMubW9kdWxhdGlvbkluZGV4LmRpc3Bvc2UoKSwgdGhpcy5tb2R1bGF0aW9uSW5kZXggPSBudWxsLCB0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSwgdGhpcy5oYXJtb25pY2l0eSA9IG51bGwsIHRoaXMuX21vZHVsYXRpb25Ob2RlLmRpc3Bvc2UoKSwgdGhpcy5fbW9kdWxhdGlvbk5vZGUgPSBudWxsLCB0aGlzLm9zY2lsbGF0b3IgPSBudWxsLCB0aGlzLmVudmVsb3BlID0gbnVsbCwgdGhpcy5tb2R1bGF0aW9uRW52ZWxvcGUgPSBudWxsLCB0aGlzLm1vZHVsYXRpb24gPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5GTVN5bnRoO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDY2KSwgaSgxMiksIGkoMiksIGkoNSksIGkoMjUpLCBpKDE0KTtcbiAgICBzLmRlZmF1bHQuRHVvU3ludGggPSBmdW5jdGlvbiAodCkge1xuICAgICAgdCA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHMuZGVmYXVsdC5EdW9TeW50aC5kZWZhdWx0cyksIHMuZGVmYXVsdC5Nb25vcGhvbmljLmNhbGwodGhpcywgdCksIHRoaXMudm9pY2UwID0gbmV3IHMuZGVmYXVsdC5Nb25vU3ludGgodC52b2ljZTApLCB0aGlzLnZvaWNlMC52b2x1bWUudmFsdWUgPSAtMTAsIHRoaXMudm9pY2UxID0gbmV3IHMuZGVmYXVsdC5Nb25vU3ludGgodC52b2ljZTEpLCB0aGlzLnZvaWNlMS52b2x1bWUudmFsdWUgPSAtMTAsIHRoaXMuX3ZpYnJhdG8gPSBuZXcgcy5kZWZhdWx0LkxGTyh0LnZpYnJhdG9SYXRlLCAtNTAsIDUwKSwgdGhpcy5fdmlicmF0by5zdGFydCgpLCB0aGlzLnZpYnJhdG9SYXRlID0gdGhpcy5fdmlicmF0by5mcmVxdWVuY3ksIHRoaXMuX3ZpYnJhdG9HYWluID0gbmV3IHMuZGVmYXVsdC5HYWluKHQudmlicmF0b0Ftb3VudCwgcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUpLCB0aGlzLnZpYnJhdG9BbW91bnQgPSB0aGlzLl92aWJyYXRvR2Fpbi5nYWluLCB0aGlzLmZyZXF1ZW5jeSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKDQ0MCwgcy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSwgdGhpcy5oYXJtb25pY2l0eSA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkodC5oYXJtb25pY2l0eSksIHRoaXMuaGFybW9uaWNpdHkudW5pdHMgPSBzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSwgdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLnZvaWNlMC5mcmVxdWVuY3kpLCB0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLmhhcm1vbmljaXR5LCB0aGlzLnZvaWNlMS5mcmVxdWVuY3kpLCB0aGlzLl92aWJyYXRvLmNvbm5lY3QodGhpcy5fdmlicmF0b0dhaW4pLCB0aGlzLl92aWJyYXRvR2Fpbi5mYW4odGhpcy52b2ljZTAuZGV0dW5lLCB0aGlzLnZvaWNlMS5kZXR1bmUpLCB0aGlzLnZvaWNlMC5jb25uZWN0KHRoaXMub3V0cHV0KSwgdGhpcy52b2ljZTEuY29ubmVjdCh0aGlzLm91dHB1dCksIHRoaXMuX3JlYWRPbmx5KFtcInZvaWNlMFwiLCBcInZvaWNlMVwiLCBcImZyZXF1ZW5jeVwiLCBcInZpYnJhdG9BbW91bnRcIiwgXCJ2aWJyYXRvUmF0ZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRHVvU3ludGgsIHMuZGVmYXVsdC5Nb25vcGhvbmljKSwgcy5kZWZhdWx0LkR1b1N5bnRoLmRlZmF1bHRzID0ge1xuICAgICAgdmlicmF0b0Ftb3VudDogLjUsXG4gICAgICB2aWJyYXRvUmF0ZTogNSxcbiAgICAgIGhhcm1vbmljaXR5OiAxLjUsXG4gICAgICB2b2ljZTA6IHtcbiAgICAgICAgdm9sdW1lOiAtMTAsXG4gICAgICAgIHBvcnRhbWVudG86IDAsXG4gICAgICAgIG9zY2lsbGF0b3I6IHtcbiAgICAgICAgICB0eXBlOiBcInNpbmVcIlxuICAgICAgICB9LFxuICAgICAgICBmaWx0ZXJFbnZlbG9wZToge1xuICAgICAgICAgIGF0dGFjazogLjAxLFxuICAgICAgICAgIGRlY2F5OiAwLFxuICAgICAgICAgIHN1c3RhaW46IDEsXG4gICAgICAgICAgcmVsZWFzZTogLjVcbiAgICAgICAgfSxcbiAgICAgICAgZW52ZWxvcGU6IHtcbiAgICAgICAgICBhdHRhY2s6IC4wMSxcbiAgICAgICAgICBkZWNheTogMCxcbiAgICAgICAgICBzdXN0YWluOiAxLFxuICAgICAgICAgIHJlbGVhc2U6IC41XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB2b2ljZTE6IHtcbiAgICAgICAgdm9sdW1lOiAtMTAsXG4gICAgICAgIHBvcnRhbWVudG86IDAsXG4gICAgICAgIG9zY2lsbGF0b3I6IHtcbiAgICAgICAgICB0eXBlOiBcInNpbmVcIlxuICAgICAgICB9LFxuICAgICAgICBmaWx0ZXJFbnZlbG9wZToge1xuICAgICAgICAgIGF0dGFjazogLjAxLFxuICAgICAgICAgIGRlY2F5OiAwLFxuICAgICAgICAgIHN1c3RhaW46IDEsXG4gICAgICAgICAgcmVsZWFzZTogLjVcbiAgICAgICAgfSxcbiAgICAgICAgZW52ZWxvcGU6IHtcbiAgICAgICAgICBhdHRhY2s6IC4wMSxcbiAgICAgICAgICBkZWNheTogMCxcbiAgICAgICAgICBzdXN0YWluOiAxLFxuICAgICAgICAgIHJlbGVhc2U6IC41XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBzLmRlZmF1bHQuRHVvU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy52b2ljZTAuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0LCBlKSwgdGhpcy52b2ljZTEuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0LCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRHVvU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLnZvaWNlMC5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSwgdGhpcy52b2ljZTEuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkR1b1N5bnRoLnByb3RvdHlwZS5nZXRMZXZlbEF0VGltZSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gKHRoaXMudm9pY2UwLmdldExldmVsQXRUaW1lKHQpICsgdGhpcy52b2ljZTEuZ2V0TGV2ZWxBdFRpbWUodCkpIC8gMjtcbiAgICB9LCBzLmRlZmF1bHQuRHVvU3ludGgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1widm9pY2UwXCIsIFwidm9pY2UxXCIsIFwiZnJlcXVlbmN5XCIsIFwidmlicmF0b0Ftb3VudFwiLCBcInZpYnJhdG9SYXRlXCJdKSwgdGhpcy52b2ljZTAuZGlzcG9zZSgpLCB0aGlzLnZvaWNlMCA9IG51bGwsIHRoaXMudm9pY2UxLmRpc3Bvc2UoKSwgdGhpcy52b2ljZTEgPSBudWxsLCB0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMuZnJlcXVlbmN5ID0gbnVsbCwgdGhpcy5fdmlicmF0b0dhaW4uZGlzcG9zZSgpLCB0aGlzLl92aWJyYXRvR2FpbiA9IG51bGwsIHRoaXMuX3ZpYnJhdG8gPSBudWxsLCB0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSwgdGhpcy5oYXJtb25pY2l0eSA9IG51bGwsIHRoaXMudmlicmF0b0Ftb3VudC5kaXNwb3NlKCksIHRoaXMudmlicmF0b0Ftb3VudCA9IG51bGwsIHRoaXMudmlicmF0b1JhdGUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5EdW9TeW50aDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgzOCksIGkoMiksIGkoNSksIGkoMjUpLCBpKDIyKSwgaSgzKTtcbiAgICBzLmRlZmF1bHQuQU1TeW50aCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0LkFNU3ludGguZGVmYXVsdHMpLCBzLmRlZmF1bHQuTW9ub3Bob25pYy5jYWxsKHRoaXMsIHQpLCB0aGlzLl9jYXJyaWVyID0gbmV3IHMuZGVmYXVsdC5TeW50aCgpLCB0aGlzLl9jYXJyaWVyLnZvbHVtZS52YWx1ZSA9IC0xMCwgdGhpcy5vc2NpbGxhdG9yID0gdGhpcy5fY2Fycmllci5vc2NpbGxhdG9yLnNldCh0Lm9zY2lsbGF0b3IpLCB0aGlzLmVudmVsb3BlID0gdGhpcy5fY2Fycmllci5lbnZlbG9wZS5zZXQodC5lbnZlbG9wZSksIHRoaXMuX21vZHVsYXRvciA9IG5ldyBzLmRlZmF1bHQuU3ludGgoKSwgdGhpcy5fbW9kdWxhdG9yLnZvbHVtZS52YWx1ZSA9IC0xMCwgdGhpcy5tb2R1bGF0aW9uID0gdGhpcy5fbW9kdWxhdG9yLm9zY2lsbGF0b3Iuc2V0KHQubW9kdWxhdGlvbiksIHRoaXMubW9kdWxhdGlvbkVudmVsb3BlID0gdGhpcy5fbW9kdWxhdG9yLmVudmVsb3BlLnNldCh0Lm1vZHVsYXRpb25FbnZlbG9wZSksIHRoaXMuZnJlcXVlbmN5ID0gbmV3IHMuZGVmYXVsdC5TaWduYWwoNDQwLCBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLCB0aGlzLmRldHVuZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGV0dW5lLCBzLmRlZmF1bHQuVHlwZS5DZW50cyksIHRoaXMuaGFybW9uaWNpdHkgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KHQuaGFybW9uaWNpdHkpLCB0aGlzLmhhcm1vbmljaXR5LnVuaXRzID0gcy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUsIHRoaXMuX21vZHVsYXRpb25TY2FsZSA9IG5ldyBzLmRlZmF1bHQuQXVkaW9Ub0dhaW4oKSwgdGhpcy5fbW9kdWxhdGlvbk5vZGUgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksIHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMuaGFybW9uaWNpdHksIHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3kpLCB0aGlzLmRldHVuZS5mYW4odGhpcy5fY2Fycmllci5kZXR1bmUsIHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLCB0aGlzLl9tb2R1bGF0b3IuY2hhaW4odGhpcy5fbW9kdWxhdGlvblNjYWxlLCB0aGlzLl9tb2R1bGF0aW9uTm9kZS5nYWluKSwgdGhpcy5fY2Fycmllci5jaGFpbih0aGlzLl9tb2R1bGF0aW9uTm9kZSwgdGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJmcmVxdWVuY3lcIiwgXCJoYXJtb25pY2l0eVwiLCBcIm9zY2lsbGF0b3JcIiwgXCJlbnZlbG9wZVwiLCBcIm1vZHVsYXRpb25cIiwgXCJtb2R1bGF0aW9uRW52ZWxvcGVcIiwgXCJkZXR1bmVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkFNU3ludGgsIHMuZGVmYXVsdC5Nb25vcGhvbmljKSwgcy5kZWZhdWx0LkFNU3ludGguZGVmYXVsdHMgPSB7XG4gICAgICBoYXJtb25pY2l0eTogMyxcbiAgICAgIGRldHVuZTogMCxcbiAgICAgIG9zY2lsbGF0b3I6IHtcbiAgICAgICAgdHlwZTogXCJzaW5lXCJcbiAgICAgIH0sXG4gICAgICBlbnZlbG9wZToge1xuICAgICAgICBhdHRhY2s6IC4wMSxcbiAgICAgICAgZGVjYXk6IC4wMSxcbiAgICAgICAgc3VzdGFpbjogMSxcbiAgICAgICAgcmVsZWFzZTogLjVcbiAgICAgIH0sXG4gICAgICBtb2R1bGF0aW9uOiB7XG4gICAgICAgIHR5cGU6IFwic3F1YXJlXCJcbiAgICAgIH0sXG4gICAgICBtb2R1bGF0aW9uRW52ZWxvcGU6IHtcbiAgICAgICAgYXR0YWNrOiAuNSxcbiAgICAgICAgZGVjYXk6IDAsXG4gICAgICAgIHN1c3RhaW46IDEsXG4gICAgICAgIHJlbGVhc2U6IC41XG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0LkFNU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHQgPSB0aGlzLnRvU2Vjb25kcyh0KSwgdGhpcy5fY2Fycmllci5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsIGUpLCB0aGlzLl9tb2R1bGF0b3IuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQU1TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NhcnJpZXIuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksIHRoaXMuX21vZHVsYXRvci5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQU1TeW50aC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIiwgXCJoYXJtb25pY2l0eVwiLCBcIm9zY2lsbGF0b3JcIiwgXCJlbnZlbG9wZVwiLCBcIm1vZHVsYXRpb25cIiwgXCJtb2R1bGF0aW9uRW52ZWxvcGVcIiwgXCJkZXR1bmVcIl0pLCB0aGlzLl9jYXJyaWVyLmRpc3Bvc2UoKSwgdGhpcy5fY2FycmllciA9IG51bGwsIHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksIHRoaXMuX21vZHVsYXRvciA9IG51bGwsIHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmRldHVuZS5kaXNwb3NlKCksIHRoaXMuZGV0dW5lID0gbnVsbCwgdGhpcy5oYXJtb25pY2l0eS5kaXNwb3NlKCksIHRoaXMuaGFybW9uaWNpdHkgPSBudWxsLCB0aGlzLl9tb2R1bGF0aW9uU2NhbGUuZGlzcG9zZSgpLCB0aGlzLl9tb2R1bGF0aW9uU2NhbGUgPSBudWxsLCB0aGlzLl9tb2R1bGF0aW9uTm9kZS5kaXNwb3NlKCksIHRoaXMuX21vZHVsYXRpb25Ob2RlID0gbnVsbCwgdGhpcy5vc2NpbGxhdG9yID0gbnVsbCwgdGhpcy5lbnZlbG9wZSA9IG51bGwsIHRoaXMubW9kdWxhdGlvbkVudmVsb3BlID0gbnVsbCwgdGhpcy5tb2R1bGF0aW9uID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQU1TeW50aDtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg3MCksIGkoMTYpO1xuICAgIHMuZGVmYXVsdC5TZXF1ZW5jZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiY2FsbGJhY2tcIiwgXCJldmVudHNcIiwgXCJzdWJkaXZpc2lvblwiXSwgcy5kZWZhdWx0LlNlcXVlbmNlKSxcbiAgICAgICAgICBlID0gdC5ldmVudHM7XG4gICAgICBpZiAoZGVsZXRlIHQuZXZlbnRzLCBzLmRlZmF1bHQuUGFydC5jYWxsKHRoaXMsIHQpLCB0aGlzLl9zdWJkaXZpc2lvbiA9IHRoaXMudG9UaWNrcyh0LnN1YmRpdmlzaW9uKSwgcy5kZWZhdWx0LmlzVW5kZWYodC5sb29wRW5kKSAmJiBzLmRlZmF1bHQuaXNEZWZpbmVkKGUpICYmICh0aGlzLl9sb29wRW5kID0gZS5sZW5ndGggKiB0aGlzLl9zdWJkaXZpc2lvbiksIHRoaXMuX2xvb3AgPSAhMCwgcy5kZWZhdWx0LmlzRGVmaW5lZChlKSkgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSsrKSB0aGlzLmFkZChpLCBlW2ldKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TZXF1ZW5jZSwgcy5kZWZhdWx0LlBhcnQpLCBzLmRlZmF1bHQuU2VxdWVuY2UuZGVmYXVsdHMgPSB7XG4gICAgICBzdWJkaXZpc2lvbjogXCI0blwiXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5TZXF1ZW5jZS5wcm90b3R5cGUsIFwic3ViZGl2aXNpb25cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fc3ViZGl2aXNpb24pLnRvU2Vjb25kcygpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuU2VxdWVuY2UucHJvdG90eXBlLmF0ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuaXNBcnJheShlKSAmJiB0aGlzLnJlbW92ZSh0KSwgcy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLmF0LmNhbGwodGhpcywgdGhpcy5faW5kZXhUaW1lKHQpLCBlKTtcbiAgICB9LCBzLmRlZmF1bHQuU2VxdWVuY2UucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBpZiAobnVsbCA9PT0gZSkgcmV0dXJuIHRoaXM7XG5cbiAgICAgIGlmIChzLmRlZmF1bHQuaXNBcnJheShlKSkge1xuICAgICAgICB2YXIgaSA9IE1hdGgucm91bmQodGhpcy5fc3ViZGl2aXNpb24gLyBlLmxlbmd0aCk7XG4gICAgICAgIGUgPSBuZXcgcy5kZWZhdWx0LlNlcXVlbmNlKHRoaXMuX3RpY2suYmluZCh0aGlzKSwgZSwgcy5kZWZhdWx0LlRpY2tzKGkpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5hZGQuY2FsbCh0aGlzLCB0aGlzLl9pbmRleFRpbWUodCksIGUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5TZXF1ZW5jZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcywgdGhpcy5faW5kZXhUaW1lKHQpLCBlKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuU2VxdWVuY2UucHJvdG90eXBlLl9pbmRleFRpbWUgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSA/IHQgOiBzLmRlZmF1bHQuVGlja3ModCAqIHRoaXMuX3N1YmRpdmlzaW9uICsgdGhpcy5zdGFydE9mZnNldCkudG9TZWNvbmRzKCk7XG4gICAgfSwgcy5kZWZhdWx0LlNlcXVlbmNlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlNlcXVlbmNlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDcxKSwgaSg3OSk7XG4gICAgcy5kZWZhdWx0LlBhdHRlcm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImNhbGxiYWNrXCIsIFwidmFsdWVzXCIsIFwicGF0dGVyblwiXSwgcy5kZWZhdWx0LlBhdHRlcm4pO1xuICAgICAgcy5kZWZhdWx0Lkxvb3AuY2FsbCh0aGlzLCB0KSwgdGhpcy5fcGF0dGVybiA9IG5ldyBzLmRlZmF1bHQuQ3RybFBhdHRlcm4oe1xuICAgICAgICB2YWx1ZXM6IHQudmFsdWVzLFxuICAgICAgICB0eXBlOiB0LnBhdHRlcm4sXG4gICAgICAgIGluZGV4OiB0LmluZGV4XG4gICAgICB9KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QYXR0ZXJuLCBzLmRlZmF1bHQuTG9vcCksIHMuZGVmYXVsdC5QYXR0ZXJuLmRlZmF1bHRzID0ge1xuICAgICAgcGF0dGVybjogcy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXAsXG4gICAgICBjYWxsYmFjazogcy5kZWZhdWx0Lm5vT3AsXG4gICAgICB2YWx1ZXM6IFtdXG4gICAgfSwgcy5kZWZhdWx0LlBhdHRlcm4ucHJvdG90eXBlLl90aWNrID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHRoaXMuY2FsbGJhY2sodCwgdGhpcy5fcGF0dGVybi52YWx1ZSksIHRoaXMuX3BhdHRlcm4ubmV4dCgpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUsIFwiaW5kZXhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXR0ZXJuLmluZGV4O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcGF0dGVybi5pbmRleCA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUsIFwidmFsdWVzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGF0dGVybi52YWx1ZXM7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wYXR0ZXJuLnZhbHVlcyA9IHQ7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXR0ZXJuLnZhbHVlO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhdHRlcm4ucHJvdG90eXBlLCBcInBhdHRlcm5cIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXR0ZXJuLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wYXR0ZXJuLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3BhdHRlcm4uZGlzcG9zZSgpLCB0aGlzLl9wYXR0ZXJuID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUGF0dGVybjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg4KSwgaSgxOCksIGkoMTIpO1xuICAgIHMuZGVmYXVsdC5WaWJyYXRvID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJmcmVxdWVuY3lcIiwgXCJkZXB0aFwiXSwgcy5kZWZhdWx0LlZpYnJhdG8pO1xuICAgICAgcy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLl9kZWxheU5vZGUgPSBuZXcgcy5kZWZhdWx0LkRlbGF5KDAsIHQubWF4RGVsYXkpLCB0aGlzLl9sZm8gPSBuZXcgcy5kZWZhdWx0LkxGTyh7XG4gICAgICAgIHR5cGU6IHQudHlwZSxcbiAgICAgICAgbWluOiAwLFxuICAgICAgICBtYXg6IHQubWF4RGVsYXksXG4gICAgICAgIGZyZXF1ZW5jeTogdC5mcmVxdWVuY3ksXG4gICAgICAgIHBoYXNlOiAtOTBcbiAgICAgIH0pLnN0YXJ0KCkuY29ubmVjdCh0aGlzLl9kZWxheU5vZGUuZGVsYXlUaW1lKSwgdGhpcy5mcmVxdWVuY3kgPSB0aGlzLl9sZm8uZnJlcXVlbmN5LCB0aGlzLmRlcHRoID0gdGhpcy5fbGZvLmFtcGxpdHVkZSwgdGhpcy5kZXB0aC52YWx1ZSA9IHQuZGVwdGgsIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLCBcImRlcHRoXCJdKSwgdGhpcy5lZmZlY3RTZW5kLmNoYWluKHRoaXMuX2RlbGF5Tm9kZSwgdGhpcy5lZmZlY3RSZXR1cm4pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlZpYnJhdG8sIHMuZGVmYXVsdC5FZmZlY3QpLCBzLmRlZmF1bHQuVmlicmF0by5kZWZhdWx0cyA9IHtcbiAgICAgIG1heERlbGF5OiAuMDA1LFxuICAgICAgZnJlcXVlbmN5OiA1LFxuICAgICAgZGVwdGg6IC4xLFxuICAgICAgdHlwZTogXCJzaW5lXCJcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlZpYnJhdG8ucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZm8udHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xmby50eXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlZpYnJhdG8ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2RlbGF5Tm9kZS5kaXNwb3NlKCksIHRoaXMuX2RlbGF5Tm9kZSA9IG51bGwsIHRoaXMuX2xmby5kaXNwb3NlKCksIHRoaXMuX2xmbyA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLCBcImRlcHRoXCJdKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmRlcHRoID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuVmlicmF0bztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxMiksIGkoMTUpO1xuICAgIHMuZGVmYXVsdC5UcmVtb2xvID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJmcmVxdWVuY3lcIiwgXCJkZXB0aFwiXSwgcy5kZWZhdWx0LlRyZW1vbG8pO1xuICAgICAgcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLl9sZm9MID0gbmV3IHMuZGVmYXVsdC5MRk8oe1xuICAgICAgICBwaGFzZTogdC5zcHJlYWQsXG4gICAgICAgIG1pbjogMSxcbiAgICAgICAgbWF4OiAwXG4gICAgICB9KSwgdGhpcy5fbGZvUiA9IG5ldyBzLmRlZmF1bHQuTEZPKHtcbiAgICAgICAgcGhhc2U6IHQuc3ByZWFkLFxuICAgICAgICBtaW46IDEsXG4gICAgICAgIG1heDogMFxuICAgICAgfSksIHRoaXMuX2FtcGxpdHVkZUwgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5fYW1wbGl0dWRlUiA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLmZyZXF1ZW5jeSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZnJlcXVlbmN5LCBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLCB0aGlzLmRlcHRoID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXB0aCwgcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLCB0aGlzLl9yZWFkT25seShbXCJmcmVxdWVuY3lcIiwgXCJkZXB0aFwiXSksIHRoaXMuZWZmZWN0U2VuZEwuY2hhaW4odGhpcy5fYW1wbGl0dWRlTCwgdGhpcy5lZmZlY3RSZXR1cm5MKSwgdGhpcy5lZmZlY3RTZW5kUi5jaGFpbih0aGlzLl9hbXBsaXR1ZGVSLCB0aGlzLmVmZmVjdFJldHVyblIpLCB0aGlzLl9sZm9MLmNvbm5lY3QodGhpcy5fYW1wbGl0dWRlTC5nYWluKSwgdGhpcy5fbGZvUi5jb25uZWN0KHRoaXMuX2FtcGxpdHVkZVIuZ2FpbiksIHRoaXMuZnJlcXVlbmN5LmZhbih0aGlzLl9sZm9MLmZyZXF1ZW5jeSwgdGhpcy5fbGZvUi5mcmVxdWVuY3kpLCB0aGlzLmRlcHRoLmZhbih0aGlzLl9sZm9SLmFtcGxpdHVkZSwgdGhpcy5fbGZvTC5hbXBsaXR1ZGUpLCB0aGlzLnR5cGUgPSB0LnR5cGUsIHRoaXMuc3ByZWFkID0gdC5zcHJlYWQ7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVHJlbW9sbywgcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdCksIHMuZGVmYXVsdC5UcmVtb2xvLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiAxMCxcbiAgICAgIHR5cGU6IFwic2luZVwiLFxuICAgICAgZGVwdGg6IC41LFxuICAgICAgc3ByZWFkOiAxODBcbiAgICB9LCBzLmRlZmF1bHQuVHJlbW9sby5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmb0wuc3RhcnQodCksIHRoaXMuX2xmb1Iuc3RhcnQodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlRyZW1vbG8ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmb0wuc3RvcCh0KSwgdGhpcy5fbGZvUi5zdG9wKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5UcmVtb2xvLnByb3RvdHlwZS5zeW5jID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9sZm9MLnN5bmModCksIHRoaXMuX2xmb1Iuc3luYyh0KSwgcy5kZWZhdWx0LlRyYW5zcG9ydC5zeW5jU2lnbmFsKHRoaXMuZnJlcXVlbmN5KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuVHJlbW9sby5wcm90b3R5cGUudW5zeW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmb0wudW5zeW5jKCksIHRoaXMuX2xmb1IudW5zeW5jKCksIHMuZGVmYXVsdC5UcmFuc3BvcnQudW5zeW5jU2lnbmFsKHRoaXMuZnJlcXVlbmN5KSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyZW1vbG8ucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZm9MLnR5cGU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9sZm9MLnR5cGUgPSB0LCB0aGlzLl9sZm9SLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyZW1vbG8ucHJvdG90eXBlLCBcInNwcmVhZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xmb1IucGhhc2UgLSB0aGlzLl9sZm9MLnBoYXNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbGZvTC5waGFzZSA9IDkwIC0gdCAvIDIsIHRoaXMuX2xmb1IucGhhc2UgPSB0IC8gMiArIDkwO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuVHJlbW9sby5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLCBcImRlcHRoXCJdKSwgdGhpcy5fbGZvTC5kaXNwb3NlKCksIHRoaXMuX2xmb0wgPSBudWxsLCB0aGlzLl9sZm9SLmRpc3Bvc2UoKSwgdGhpcy5fbGZvUiA9IG51bGwsIHRoaXMuX2FtcGxpdHVkZUwuZGlzcG9zZSgpLCB0aGlzLl9hbXBsaXR1ZGVMID0gbnVsbCwgdGhpcy5fYW1wbGl0dWRlUi5kaXNwb3NlKCksIHRoaXMuX2FtcGxpdHVkZVIgPSBudWxsLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuZGVwdGggPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5UcmVtb2xvO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDczKSwgaSgyKSwgaSg1KSwgaSgxMyk7XG4gICAgcy5kZWZhdWx0LlN0ZXJlb1dpZGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcIndpZHRoXCJdLCBzLmRlZmF1bHQuU3RlcmVvV2lkZW5lcik7XG4gICAgICBzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLndpZHRoID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC53aWR0aCwgcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLCB0aGlzLl9yZWFkT25seShbXCJ3aWR0aFwiXSksIHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDIpLCB0aGlzLl90d29UaW1lc1dpZHRoU2lkZSA9IG5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoMiksIHRoaXMuX21pZE11bHQgPSBuZXcgcy5kZWZhdWx0Lk11bHRpcGx5KCksIHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQuY29ubmVjdCh0aGlzLl9taWRNdWx0LCAwLCAxKSwgdGhpcy5taWRTZW5kLmNoYWluKHRoaXMuX21pZE11bHQsIHRoaXMubWlkUmV0dXJuKSwgdGhpcy5fb25lTWludXNXaWR0aCA9IG5ldyBzLmRlZmF1bHQuU3VidHJhY3QoKSwgdGhpcy5fb25lTWludXNXaWR0aC5jb25uZWN0KHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMSksIHRoaXMuX29uZU1pbnVzV2lkdGgsIDAsIDApLCB0aGlzLndpZHRoLmNvbm5lY3QodGhpcy5fb25lTWludXNXaWR0aCwgMCwgMSksIHRoaXMuX3NpZGVNdWx0ID0gbmV3IHMuZGVmYXVsdC5NdWx0aXBseSgpLCB0aGlzLndpZHRoLmNvbm5lY3QodGhpcy5fdHdvVGltZXNXaWR0aFNpZGUpLCB0aGlzLl90d29UaW1lc1dpZHRoU2lkZS5jb25uZWN0KHRoaXMuX3NpZGVNdWx0LCAwLCAxKSwgdGhpcy5zaWRlU2VuZC5jaGFpbih0aGlzLl9zaWRlTXVsdCwgdGhpcy5zaWRlUmV0dXJuKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TdGVyZW9XaWRlbmVyLCBzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdCksIHMuZGVmYXVsdC5TdGVyZW9XaWRlbmVyLmRlZmF1bHRzID0ge1xuICAgICAgd2lkdGg6IC41XG4gICAgfSwgcy5kZWZhdWx0LlN0ZXJlb1dpZGVuZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wid2lkdGhcIl0pLCB0aGlzLndpZHRoLmRpc3Bvc2UoKSwgdGhpcy53aWR0aCA9IG51bGwsIHRoaXMuX21pZE11bHQuZGlzcG9zZSgpLCB0aGlzLl9taWRNdWx0ID0gbnVsbCwgdGhpcy5fc2lkZU11bHQuZGlzcG9zZSgpLCB0aGlzLl9zaWRlTXVsdCA9IG51bGwsIHRoaXMuX3R3b1RpbWVzV2lkdGhNaWQuZGlzcG9zZSgpLCB0aGlzLl90d29UaW1lc1dpZHRoTWlkID0gbnVsbCwgdGhpcy5fdHdvVGltZXNXaWR0aFNpZGUuZGlzcG9zZSgpLCB0aGlzLl90d29UaW1lc1dpZHRoU2lkZSA9IG51bGwsIHRoaXMuX29uZU1pbnVzV2lkdGguZGlzcG9zZSgpLCB0aGlzLl9vbmVNaW51c1dpZHRoID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU3RlcmVvV2lkZW5lcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxNSksIGkoMzMpLCBpKDMpO1xuICAgIHMuZGVmYXVsdC5TdGVyZW9GZWVkYmFja0VmZmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZmVlZGJhY2tcIl0sIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCk7XG4gICAgICBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuZmVlZGJhY2sgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZlZWRiYWNrLCBzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksIHRoaXMuX2ZlZWRiYWNrTCA9IG5ldyBzLmRlZmF1bHQuR2FpbigpLCB0aGlzLl9mZWVkYmFja1IgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5lZmZlY3RSZXR1cm5MLmNoYWluKHRoaXMuX2ZlZWRiYWNrTCwgdGhpcy5lZmZlY3RTZW5kTCksIHRoaXMuZWZmZWN0UmV0dXJuUi5jaGFpbih0aGlzLl9mZWVkYmFja1IsIHRoaXMuZWZmZWN0U2VuZFIpLCB0aGlzLmZlZWRiYWNrLmZhbih0aGlzLl9mZWVkYmFja0wuZ2FpbiwgdGhpcy5fZmVlZGJhY2tSLmdhaW4pLCB0aGlzLl9yZWFkT25seShbXCJmZWVkYmFja1wiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU3RlcmVvRmVlZGJhY2tFZmZlY3QsIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QpLCBzLmRlZmF1bHQuU3RlcmVvRmVlZGJhY2tFZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJmZWVkYmFja1wiXSksIHRoaXMuZmVlZGJhY2suZGlzcG9zZSgpLCB0aGlzLmZlZWRiYWNrID0gbnVsbCwgdGhpcy5fZmVlZGJhY2tMLmRpc3Bvc2UoKSwgdGhpcy5fZmVlZGJhY2tMID0gbnVsbCwgdGhpcy5fZmVlZGJhY2tSLmRpc3Bvc2UoKSwgdGhpcy5fZmVlZGJhY2tSID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuU3RlcmVvRmVlZGJhY2tFZmZlY3Q7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNzcpLCBpKDkpLCBpKDEwKSwgaSgzOSksIGkoMyksIGkoNzQpO1xuICAgIHMuZGVmYXVsdC5SZXZlcmIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImRlY2F5XCJdLCBzLmRlZmF1bHQuUmV2ZXJiKTtcbiAgICAgIHMuZGVmYXVsdC5FZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5fY29udm9sdmVyID0gdGhpcy5jb250ZXh0LmNyZWF0ZUNvbnZvbHZlcigpLCB0aGlzLmRlY2F5ID0gdC5kZWNheSwgdGhpcy5wcmVEZWxheSA9IHQucHJlRGVsYXksIHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9jb252b2x2ZXIpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlJldmVyYiwgcy5kZWZhdWx0LkVmZmVjdCksIHMuZGVmYXVsdC5SZXZlcmIuZGVmYXVsdHMgPSB7XG4gICAgICBkZWNheTogMS41LFxuICAgICAgcHJlRGVsYXk6IC4wMVxuICAgIH0sIHMuZGVmYXVsdC5SZXZlcmIucHJvdG90eXBlLmdlbmVyYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5PZmZsaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSBuZXcgcy5kZWZhdWx0Lk5vaXNlKCksXG4gICAgICAgICAgICBlID0gbmV3IHMuZGVmYXVsdC5Ob2lzZSgpLFxuICAgICAgICAgICAgaSA9IG5ldyBzLmRlZmF1bHQuTWVyZ2UoKTtcbiAgICAgICAgdC5jb25uZWN0KGkubGVmdCksIGUuY29ubmVjdChpLnJpZ2h0KTtcbiAgICAgICAgdmFyIG4gPSBuZXcgcy5kZWZhdWx0LkdhaW4oKS50b01hc3RlcigpO1xuICAgICAgICBpLmNvbm5lY3QobiksIHQuc3RhcnQoMCksIGUuc3RhcnQoMCksIG4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLCAwKSwgbi5nYWluLnNldFZhbHVlQXRUaW1lKDEsIHRoaXMucHJlRGVsYXkpLCBuLmdhaW4uZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKDAsIHRoaXMucHJlRGVsYXksIHRoaXMuZGVjYXkgKyB0aGlzLnByZURlbGF5KTtcbiAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5kZWNheSArIHRoaXMucHJlRGVsYXkpLnRoZW4oZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZvbHZlci5idWZmZXIgPSB0LmdldCgpLCB0aGlzO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LCBzLmRlZmF1bHQuUmV2ZXJiLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fY29udm9sdmVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fY29udm9sdmVyID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUmV2ZXJiO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDEyKSwgaSgyMyksIGkoMiksIGkoMzMpLCBpKDE4KTtcbiAgICBzLmRlZmF1bHQuUGl0Y2hTaGlmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wicGl0Y2hcIl0sIHMuZGVmYXVsdC5QaXRjaFNoaWZ0KTtcbiAgICAgIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLl9mcmVxdWVuY3kgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCgwKSwgdGhpcy5fZGVsYXlBID0gbmV3IHMuZGVmYXVsdC5EZWxheSgwLCAxKSwgdGhpcy5fbGZvQSA9IG5ldyBzLmRlZmF1bHQuTEZPKHtcbiAgICAgICAgbWluOiAwLFxuICAgICAgICBtYXg6IC4xLFxuICAgICAgICB0eXBlOiBcInNhd3Rvb3RoXCJcbiAgICAgIH0pLmNvbm5lY3QodGhpcy5fZGVsYXlBLmRlbGF5VGltZSksIHRoaXMuX2RlbGF5QiA9IG5ldyBzLmRlZmF1bHQuRGVsYXkoMCwgMSksIHRoaXMuX2xmb0IgPSBuZXcgcy5kZWZhdWx0LkxGTyh7XG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiAuMSxcbiAgICAgICAgdHlwZTogXCJzYXd0b290aFwiLFxuICAgICAgICBwaGFzZTogMTgwXG4gICAgICB9KS5jb25uZWN0KHRoaXMuX2RlbGF5Qi5kZWxheVRpbWUpLCB0aGlzLl9jcm9zc0ZhZGUgPSBuZXcgcy5kZWZhdWx0LkNyb3NzRmFkZSgpLCB0aGlzLl9jcm9zc0ZhZGVMRk8gPSBuZXcgcy5kZWZhdWx0LkxGTyh7XG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiAxLFxuICAgICAgICB0eXBlOiBcInRyaWFuZ2xlXCIsXG4gICAgICAgIHBoYXNlOiA5MFxuICAgICAgfSkuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuZmFkZSksIHRoaXMuX2ZlZWRiYWNrRGVsYXkgPSBuZXcgcy5kZWZhdWx0LkRlbGF5KHQuZGVsYXlUaW1lKSwgdGhpcy5kZWxheVRpbWUgPSB0aGlzLl9mZWVkYmFja0RlbGF5LmRlbGF5VGltZSwgdGhpcy5fcmVhZE9ubHkoXCJkZWxheVRpbWVcIiksIHRoaXMuX3BpdGNoID0gdC5waXRjaCwgdGhpcy5fd2luZG93U2l6ZSA9IHQud2luZG93U2l6ZSwgdGhpcy5fZGVsYXlBLmNvbm5lY3QodGhpcy5fY3Jvc3NGYWRlLmEpLCB0aGlzLl9kZWxheUIuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuYiksIHRoaXMuX2ZyZXF1ZW5jeS5mYW4odGhpcy5fbGZvQS5mcmVxdWVuY3ksIHRoaXMuX2xmb0IuZnJlcXVlbmN5LCB0aGlzLl9jcm9zc0ZhZGVMRk8uZnJlcXVlbmN5KSwgdGhpcy5lZmZlY3RTZW5kLmZhbih0aGlzLl9kZWxheUEsIHRoaXMuX2RlbGF5QiksIHRoaXMuX2Nyb3NzRmFkZS5jaGFpbih0aGlzLl9mZWVkYmFja0RlbGF5LCB0aGlzLmVmZmVjdFJldHVybik7XG4gICAgICB2YXIgZSA9IHRoaXMubm93KCk7XG4gICAgICB0aGlzLl9sZm9BLnN0YXJ0KGUpLCB0aGlzLl9sZm9CLnN0YXJ0KGUpLCB0aGlzLl9jcm9zc0ZhZGVMRk8uc3RhcnQoZSksIHRoaXMud2luZG93U2l6ZSA9IHRoaXMuX3dpbmRvd1NpemU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGl0Y2hTaGlmdCwgcy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0KSwgcy5kZWZhdWx0LlBpdGNoU2hpZnQuZGVmYXVsdHMgPSB7XG4gICAgICBwaXRjaDogMCxcbiAgICAgIHdpbmRvd1NpemU6IC4xLFxuICAgICAgZGVsYXlUaW1lOiAwLFxuICAgICAgZmVlZGJhY2s6IDBcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBpdGNoU2hpZnQucHJvdG90eXBlLCBcInBpdGNoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGl0Y2g7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9waXRjaCA9IHQ7XG4gICAgICAgIHZhciBlID0gMDtcbiAgICAgICAgdCA8IDAgPyAodGhpcy5fbGZvQS5taW4gPSAwLCB0aGlzLl9sZm9BLm1heCA9IHRoaXMuX3dpbmRvd1NpemUsIHRoaXMuX2xmb0IubWluID0gMCwgdGhpcy5fbGZvQi5tYXggPSB0aGlzLl93aW5kb3dTaXplLCBlID0gcy5kZWZhdWx0LmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyh0IC0gMSkgKyAxKSA6ICh0aGlzLl9sZm9BLm1pbiA9IHRoaXMuX3dpbmRvd1NpemUsIHRoaXMuX2xmb0EubWF4ID0gMCwgdGhpcy5fbGZvQi5taW4gPSB0aGlzLl93aW5kb3dTaXplLCB0aGlzLl9sZm9CLm1heCA9IDAsIGUgPSBzLmRlZmF1bHQuaW50ZXJ2YWxUb0ZyZXF1ZW5jeVJhdGlvKHQpIC0gMSksIHRoaXMuX2ZyZXF1ZW5jeS52YWx1ZSA9IGUgKiAoMS4yIC8gdGhpcy5fd2luZG93U2l6ZSk7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGl0Y2hTaGlmdC5wcm90b3R5cGUsIFwid2luZG93U2l6ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpbmRvd1NpemU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl93aW5kb3dTaXplID0gdGhpcy50b1NlY29uZHModCksIHRoaXMucGl0Y2ggPSB0aGlzLl9waXRjaDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LlBpdGNoU2hpZnQucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2ZyZXF1ZW5jeS5kaXNwb3NlKCksIHRoaXMuX2ZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuX2RlbGF5QS5kaXNjb25uZWN0KCksIHRoaXMuX2RlbGF5QSA9IG51bGwsIHRoaXMuX2RlbGF5Qi5kaXNjb25uZWN0KCksIHRoaXMuX2RlbGF5QiA9IG51bGwsIHRoaXMuX2xmb0EuZGlzcG9zZSgpLCB0aGlzLl9sZm9BID0gbnVsbCwgdGhpcy5fbGZvQi5kaXNwb3NlKCksIHRoaXMuX2xmb0IgPSBudWxsLCB0aGlzLl9jcm9zc0ZhZGUuZGlzcG9zZSgpLCB0aGlzLl9jcm9zc0ZhZGUgPSBudWxsLCB0aGlzLl9jcm9zc0ZhZGVMRk8uZGlzcG9zZSgpLCB0aGlzLl9jcm9zc0ZhZGVMRk8gPSBudWxsLCB0aGlzLl93cml0YWJsZShcImRlbGF5VGltZVwiKSwgdGhpcy5fZmVlZGJhY2tEZWxheS5kaXNwb3NlKCksIHRoaXMuX2ZlZWRiYWNrRGVsYXkgPSBudWxsLCB0aGlzLmRlbGF5VGltZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBpdGNoU2hpZnQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNzIpLCBpKDIpLCBpKDE4KTtcbiAgICBzLmRlZmF1bHQuUGluZ1BvbmdEZWxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZGVsYXlUaW1lXCIsIFwiZmVlZGJhY2tcIl0sIHMuZGVmYXVsdC5QaW5nUG9uZ0RlbGF5KTtcbiAgICAgIHMuZGVmYXVsdC5TdGVyZW9YRmVlZGJhY2tFZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5fbGVmdERlbGF5ID0gbmV3IHMuZGVmYXVsdC5EZWxheSgwLCB0Lm1heERlbGF5VGltZSksIHRoaXMuX3JpZ2h0RGVsYXkgPSBuZXcgcy5kZWZhdWx0LkRlbGF5KDAsIHQubWF4RGVsYXlUaW1lKSwgdGhpcy5fcmlnaHRQcmVEZWxheSA9IG5ldyBzLmRlZmF1bHQuRGVsYXkoMCwgdC5tYXhEZWxheVRpbWUpLCB0aGlzLmRlbGF5VGltZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGVsYXlUaW1lLCBzLmRlZmF1bHQuVHlwZS5UaW1lKSwgdGhpcy5lZmZlY3RTZW5kTC5jaGFpbih0aGlzLl9sZWZ0RGVsYXksIHRoaXMuZWZmZWN0UmV0dXJuTCksIHRoaXMuZWZmZWN0U2VuZFIuY2hhaW4odGhpcy5fcmlnaHRQcmVEZWxheSwgdGhpcy5fcmlnaHREZWxheSwgdGhpcy5lZmZlY3RSZXR1cm5SKSwgdGhpcy5kZWxheVRpbWUuZmFuKHRoaXMuX2xlZnREZWxheS5kZWxheVRpbWUsIHRoaXMuX3JpZ2h0RGVsYXkuZGVsYXlUaW1lLCB0aGlzLl9yaWdodFByZURlbGF5LmRlbGF5VGltZSksIHRoaXMuX2ZlZWRiYWNrTFIuZGlzY29ubmVjdCgpLCB0aGlzLl9mZWVkYmFja0xSLmNvbm5lY3QodGhpcy5fcmlnaHREZWxheSksIHRoaXMuX3JlYWRPbmx5KFtcImRlbGF5VGltZVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGluZ1BvbmdEZWxheSwgcy5kZWZhdWx0LlN0ZXJlb1hGZWVkYmFja0VmZmVjdCksIHMuZGVmYXVsdC5QaW5nUG9uZ0RlbGF5LmRlZmF1bHRzID0ge1xuICAgICAgZGVsYXlUaW1lOiAuMjUsXG4gICAgICBtYXhEZWxheVRpbWU6IDFcbiAgICB9LCBzLmRlZmF1bHQuUGluZ1BvbmdEZWxheS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2xlZnREZWxheS5kaXNwb3NlKCksIHRoaXMuX2xlZnREZWxheSA9IG51bGwsIHRoaXMuX3JpZ2h0RGVsYXkuZGlzcG9zZSgpLCB0aGlzLl9yaWdodERlbGF5ID0gbnVsbCwgdGhpcy5fcmlnaHRQcmVEZWxheS5kaXNwb3NlKCksIHRoaXMuX3JpZ2h0UHJlRGVsYXkgPSBudWxsLCB0aGlzLl93cml0YWJsZShbXCJkZWxheVRpbWVcIl0pLCB0aGlzLmRlbGF5VGltZS5kaXNwb3NlKCksIHRoaXMuZGVsYXlUaW1lID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuUGluZ1BvbmdEZWxheTtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgxMiksIGkoOSksIGkoMTUpO1xuICAgIHMuZGVmYXVsdC5QaGFzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiLCBcIm9jdGF2ZXNcIiwgXCJiYXNlRnJlcXVlbmN5XCJdLCBzLmRlZmF1bHQuUGhhc2VyKTtcbiAgICAgIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5fbGZvTCA9IG5ldyBzLmRlZmF1bHQuTEZPKHQuZnJlcXVlbmN5LCAwLCAxKSwgdGhpcy5fbGZvUiA9IG5ldyBzLmRlZmF1bHQuTEZPKHQuZnJlcXVlbmN5LCAwLCAxKSwgdGhpcy5fbGZvUi5waGFzZSA9IDE4MCwgdGhpcy5fYmFzZUZyZXF1ZW5jeSA9IHQuYmFzZUZyZXF1ZW5jeSwgdGhpcy5fb2N0YXZlcyA9IHQub2N0YXZlcywgdGhpcy5RID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5RLCBzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSksIHRoaXMuX2ZpbHRlcnNMID0gdGhpcy5fbWFrZUZpbHRlcnModC5zdGFnZXMsIHRoaXMuX2xmb0wsIHRoaXMuUSksIHRoaXMuX2ZpbHRlcnNSID0gdGhpcy5fbWFrZUZpbHRlcnModC5zdGFnZXMsIHRoaXMuX2xmb1IsIHRoaXMuUSksIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5fbGZvTC5mcmVxdWVuY3ksIHRoaXMuZnJlcXVlbmN5LnZhbHVlID0gdC5mcmVxdWVuY3ksIHRoaXMuZWZmZWN0U2VuZEwuY29ubmVjdCh0aGlzLl9maWx0ZXJzTFswXSksIHRoaXMuZWZmZWN0U2VuZFIuY29ubmVjdCh0aGlzLl9maWx0ZXJzUlswXSksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX2ZpbHRlcnNMW3Quc3RhZ2VzIC0gMV0sIHRoaXMuZWZmZWN0UmV0dXJuTCksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX2ZpbHRlcnNSW3Quc3RhZ2VzIC0gMV0sIHRoaXMuZWZmZWN0UmV0dXJuUiksIHRoaXMuX2xmb0wuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fbGZvUi5mcmVxdWVuY3kpLCB0aGlzLmJhc2VGcmVxdWVuY3kgPSB0LmJhc2VGcmVxdWVuY3ksIHRoaXMub2N0YXZlcyA9IHQub2N0YXZlcywgdGhpcy5fbGZvTC5zdGFydCgpLCB0aGlzLl9sZm9SLnN0YXJ0KCksIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLCBcIlFcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBoYXNlciwgcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdCksIHMuZGVmYXVsdC5QaGFzZXIuZGVmYXVsdHMgPSB7XG4gICAgICBmcmVxdWVuY3k6IC41LFxuICAgICAgb2N0YXZlczogMyxcbiAgICAgIHN0YWdlczogMTAsXG4gICAgICBROiAxMCxcbiAgICAgIGJhc2VGcmVxdWVuY3k6IDM1MFxuICAgIH0sIHMuZGVmYXVsdC5QaGFzZXIucHJvdG90eXBlLl9tYWtlRmlsdGVycyA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBmb3IgKHZhciBuID0gbmV3IEFycmF5KHQpLCBvID0gMDsgbyA8IHQ7IG8rKykge1xuICAgICAgICB2YXIgYSA9IHRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtcbiAgICAgICAgYS50eXBlID0gXCJhbGxwYXNzXCIsIGkuY29ubmVjdChhLlEpLCBlLmNvbm5lY3QoYS5mcmVxdWVuY3kpLCBuW29dID0gYTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5jb25uZWN0U2VyaWVzLmFwcGx5KHMuZGVmYXVsdCwgbiksIG47XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QaGFzZXIucHJvdG90eXBlLCBcIm9jdGF2ZXNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vY3RhdmVzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb2N0YXZlcyA9IHQ7XG4gICAgICAgIHZhciBlID0gdGhpcy5fYmFzZUZyZXF1ZW5jeSAqIE1hdGgucG93KDIsIHQpO1xuICAgICAgICB0aGlzLl9sZm9MLm1heCA9IGUsIHRoaXMuX2xmb1IubWF4ID0gZTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QaGFzZXIucHJvdG90eXBlLCBcImJhc2VGcmVxdWVuY3lcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9iYXNlRnJlcXVlbmN5O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fYmFzZUZyZXF1ZW5jeSA9IHQsIHRoaXMuX2xmb0wubWluID0gdCwgdGhpcy5fbGZvUi5taW4gPSB0LCB0aGlzLm9jdGF2ZXMgPSB0aGlzLl9vY3RhdmVzO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuUGhhc2VyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIiwgXCJRXCJdKSwgdGhpcy5RLmRpc3Bvc2UoKSwgdGhpcy5RID0gbnVsbCwgdGhpcy5fbGZvTC5kaXNwb3NlKCksIHRoaXMuX2xmb0wgPSBudWxsLCB0aGlzLl9sZm9SLmRpc3Bvc2UoKSwgdGhpcy5fbGZvUiA9IG51bGw7XG5cbiAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgdGhpcy5fZmlsdGVyc0wubGVuZ3RoOyB0KyspIHRoaXMuX2ZpbHRlcnNMW3RdLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZmlsdGVyc0xbdF0gPSBudWxsO1xuXG4gICAgICB0aGlzLl9maWx0ZXJzTCA9IG51bGw7XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5fZmlsdGVyc1IubGVuZ3RoOyBlKyspIHRoaXMuX2ZpbHRlcnNSW2VdLmRpc2Nvbm5lY3QoKSwgdGhpcy5fZmlsdGVyc1JbZV0gPSBudWxsO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZmlsdGVyc1IgPSBudWxsLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBoYXNlcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCksXG4gICAgICAgIG4gPSAoaSg1OSksIGkoMTUpLCBpKDI2KSwgWy4wNjc0OCwgLjA2NDA0LCAuMDgyMTIsIC4wOTAwNF0pLFxuICAgICAgICBvID0gWy43NzMsIC44MDIsIC43NTMsIC43MzNdLFxuICAgICAgICBhID0gWzM0NywgMTEzLCAzN107XG4gICAgcy5kZWZhdWx0LkpDUmV2ZXJiID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJyb29tU2l6ZVwiXSwgcy5kZWZhdWx0LkpDUmV2ZXJiKTtcbiAgICAgIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5yb29tU2l6ZSA9IG5ldyBzLmRlZmF1bHQuU2lnbmFsKHQucm9vbVNpemUsIHMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlKSwgdGhpcy5fc2NhbGVSb29tU2l6ZSA9IG5ldyBzLmRlZmF1bHQuU2NhbGUoLS43MzMsIC4xOTcpLCB0aGlzLl9hbGxwYXNzRmlsdGVycyA9IFtdLCB0aGlzLl9mZWVkYmFja0NvbWJGaWx0ZXJzID0gW107XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgYS5sZW5ndGg7IGUrKykge1xuICAgICAgICB2YXIgaSA9IHRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtcbiAgICAgICAgaS50eXBlID0gXCJhbGxwYXNzXCIsIGkuZnJlcXVlbmN5LnZhbHVlID0gYVtlXSwgdGhpcy5fYWxscGFzc0ZpbHRlcnMucHVzaChpKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCBuLmxlbmd0aDsgcisrKSB7XG4gICAgICAgIHZhciBsID0gbmV3IHMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXIobltyXSwgLjEpO1xuICAgICAgICB0aGlzLl9zY2FsZVJvb21TaXplLmNvbm5lY3QobC5yZXNvbmFuY2UpLCBsLnJlc29uYW5jZS52YWx1ZSA9IG9bcl0sIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX2FsbHBhc3NGaWx0ZXJzW3RoaXMuX2FsbHBhc3NGaWx0ZXJzLmxlbmd0aCAtIDFdLCBsKSwgciA8IG4ubGVuZ3RoIC8gMiA/IGwuY29ubmVjdCh0aGlzLmVmZmVjdFJldHVybkwpIDogbC5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuUiksIHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnMucHVzaChsKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yb29tU2l6ZS5jb25uZWN0KHRoaXMuX3NjYWxlUm9vbVNpemUpLCBzLmRlZmF1bHQuY29ubmVjdFNlcmllcy5hcHBseShzLmRlZmF1bHQsIHRoaXMuX2FsbHBhc3NGaWx0ZXJzKSwgdGhpcy5lZmZlY3RTZW5kTC5jb25uZWN0KHRoaXMuX2FsbHBhc3NGaWx0ZXJzWzBdKSwgdGhpcy5lZmZlY3RTZW5kUi5jb25uZWN0KHRoaXMuX2FsbHBhc3NGaWx0ZXJzWzBdKSwgdGhpcy5fcmVhZE9ubHkoW1wicm9vbVNpemVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkpDUmV2ZXJiLCBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSwgcy5kZWZhdWx0LkpDUmV2ZXJiLmRlZmF1bHRzID0ge1xuICAgICAgcm9vbVNpemU6IC41XG4gICAgfSwgcy5kZWZhdWx0LkpDUmV2ZXJiLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpO1xuXG4gICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMuX2FsbHBhc3NGaWx0ZXJzLmxlbmd0aDsgdCsrKSB0aGlzLl9hbGxwYXNzRmlsdGVyc1t0XS5kaXNjb25uZWN0KCksIHRoaXMuX2FsbHBhc3NGaWx0ZXJzW3RdID0gbnVsbDtcblxuICAgICAgdGhpcy5fYWxscGFzc0ZpbHRlcnMgPSBudWxsO1xuXG4gICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnMubGVuZ3RoOyBlKyspIHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnNbZV0uZGlzcG9zZSgpLCB0aGlzLl9mZWVkYmFja0NvbWJGaWx0ZXJzW2VdID0gbnVsbDtcblxuICAgICAgcmV0dXJuIHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnMgPSBudWxsLCB0aGlzLl93cml0YWJsZShbXCJyb29tU2l6ZVwiXSksIHRoaXMucm9vbVNpemUuZGlzcG9zZSgpLCB0aGlzLnJvb21TaXplID0gbnVsbCwgdGhpcy5fc2NhbGVSb29tU2l6ZS5kaXNwb3NlKCksIHRoaXMuX3NjYWxlUm9vbVNpemUgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5KQ1JldmVyYjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCksXG4gICAgICAgIG4gPSAoaSg1NCksIGkoMTUpLCBpKDIpLCBpKDE5KSwgaSgxMCksIGkoNDIpLCBbMTU1NyAvIDQ0MTAwLCAxNjE3IC8gNDQxMDAsIDE0OTEgLyA0NDEwMCwgMTQyMiAvIDQ0MTAwLCAxMjc3IC8gNDQxMDAsIDEzNTYgLyA0NDEwMCwgMTE4OCAvIDQ0MTAwLCAxMTE2IC8gNDQxMDBdKSxcbiAgICAgICAgbyA9IFsyMjUsIDU1NiwgNDQxLCAzNDFdO1xuICAgIHMuZGVmYXVsdC5GcmVldmVyYiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wicm9vbVNpemVcIiwgXCJkYW1wZW5pbmdcIl0sIHMuZGVmYXVsdC5GcmVldmVyYik7XG4gICAgICBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMucm9vbVNpemUgPSBuZXcgcy5kZWZhdWx0LlNpZ25hbCh0LnJvb21TaXplLCBzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksIHRoaXMuZGFtcGVuaW5nID0gbmV3IHMuZGVmYXVsdC5TaWduYWwodC5kYW1wZW5pbmcsIHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksIHRoaXMuX2NvbWJGaWx0ZXJzID0gW10sIHRoaXMuX2FsbHBhc3NGaWx0ZXJzTCA9IFtdLCB0aGlzLl9hbGxwYXNzRmlsdGVyc1IgPSBbXTtcblxuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCBvLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgICAgICBpLnR5cGUgPSBcImFsbHBhc3NcIiwgaS5mcmVxdWVuY3kudmFsdWUgPSBvW2VdLCB0aGlzLl9hbGxwYXNzRmlsdGVyc0wucHVzaChpKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBvLmxlbmd0aDsgYSsrKSB7XG4gICAgICAgIHZhciByID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgICAgICByLnR5cGUgPSBcImFsbHBhc3NcIiwgci5mcmVxdWVuY3kudmFsdWUgPSBvW2FdLCB0aGlzLl9hbGxwYXNzRmlsdGVyc1IucHVzaChyKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBuLmxlbmd0aDsgbCsrKSB7XG4gICAgICAgIHZhciB1ID0gbmV3IHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlcihuW2xdKTtcbiAgICAgICAgbCA8IG4ubGVuZ3RoIC8gMiA/IHRoaXMuZWZmZWN0U2VuZEwuY2hhaW4odSwgdGhpcy5fYWxscGFzc0ZpbHRlcnNMWzBdKSA6IHRoaXMuZWZmZWN0U2VuZFIuY2hhaW4odSwgdGhpcy5fYWxscGFzc0ZpbHRlcnNSWzBdKSwgdGhpcy5yb29tU2l6ZS5jb25uZWN0KHUucmVzb25hbmNlKSwgdGhpcy5kYW1wZW5pbmcuY29ubmVjdCh1LmRhbXBlbmluZyksIHRoaXMuX2NvbWJGaWx0ZXJzLnB1c2godSk7XG4gICAgICB9XG5cbiAgICAgIHMuZGVmYXVsdC5jb25uZWN0U2VyaWVzLmFwcGx5KHMuZGVmYXVsdCwgdGhpcy5fYWxscGFzc0ZpbHRlcnNMKSwgcy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkocy5kZWZhdWx0LCB0aGlzLl9hbGxwYXNzRmlsdGVyc1IpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9hbGxwYXNzRmlsdGVyc0xbdGhpcy5fYWxscGFzc0ZpbHRlcnNMLmxlbmd0aCAtIDFdLCB0aGlzLmVmZmVjdFJldHVybkwpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9hbGxwYXNzRmlsdGVyc1JbdGhpcy5fYWxscGFzc0ZpbHRlcnNSLmxlbmd0aCAtIDFdLCB0aGlzLmVmZmVjdFJldHVyblIpLCB0aGlzLl9yZWFkT25seShbXCJyb29tU2l6ZVwiLCBcImRhbXBlbmluZ1wiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRnJlZXZlcmIsIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QpLCBzLmRlZmF1bHQuRnJlZXZlcmIuZGVmYXVsdHMgPSB7XG4gICAgICByb29tU2l6ZTogLjcsXG4gICAgICBkYW1wZW5pbmc6IDNlM1xuICAgIH0sIHMuZGVmYXVsdC5GcmVldmVyYi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtcblxuICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCB0aGlzLl9hbGxwYXNzRmlsdGVyc0wubGVuZ3RoOyB0KyspIHRoaXMuX2FsbHBhc3NGaWx0ZXJzTFt0XS5kaXNjb25uZWN0KCksIHRoaXMuX2FsbHBhc3NGaWx0ZXJzTFt0XSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX2FsbHBhc3NGaWx0ZXJzTCA9IG51bGw7XG5cbiAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5fYWxscGFzc0ZpbHRlcnNSLmxlbmd0aDsgZSsrKSB0aGlzLl9hbGxwYXNzRmlsdGVyc1JbZV0uZGlzY29ubmVjdCgpLCB0aGlzLl9hbGxwYXNzRmlsdGVyc1JbZV0gPSBudWxsO1xuXG4gICAgICB0aGlzLl9hbGxwYXNzRmlsdGVyc1IgPSBudWxsO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NvbWJGaWx0ZXJzLmxlbmd0aDsgaSsrKSB0aGlzLl9jb21iRmlsdGVyc1tpXS5kaXNwb3NlKCksIHRoaXMuX2NvbWJGaWx0ZXJzW2ldID0gbnVsbDtcblxuICAgICAgcmV0dXJuIHRoaXMuX2NvbWJGaWx0ZXJzID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoW1wicm9vbVNpemVcIiwgXCJkYW1wZW5pbmdcIl0pLCB0aGlzLnJvb21TaXplLmRpc3Bvc2UoKSwgdGhpcy5yb29tU2l6ZSA9IG51bGwsIHRoaXMuZGFtcGVuaW5nLmRpc3Bvc2UoKSwgdGhpcy5kYW1wZW5pbmcgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5GcmVldmVyYjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgzMyksIGkoMiksIGkoMTgpO1xuICAgIHMuZGVmYXVsdC5GZWVkYmFja0RlbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJkZWxheVRpbWVcIiwgXCJmZWVkYmFja1wiXSwgcy5kZWZhdWx0LkZlZWRiYWNrRGVsYXkpO1xuICAgICAgcy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuX2RlbGF5Tm9kZSA9IG5ldyBzLmRlZmF1bHQuRGVsYXkodC5kZWxheVRpbWUsIHQubWF4RGVsYXkpLCB0aGlzLmRlbGF5VGltZSA9IHRoaXMuX2RlbGF5Tm9kZS5kZWxheVRpbWUsIHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9kZWxheU5vZGUpLCB0aGlzLl9yZWFkT25seShbXCJkZWxheVRpbWVcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZlZWRiYWNrRGVsYXksIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCksIHMuZGVmYXVsdC5GZWVkYmFja0RlbGF5LmRlZmF1bHRzID0ge1xuICAgICAgZGVsYXlUaW1lOiAuMjUsXG4gICAgICBtYXhEZWxheTogMVxuICAgIH0sIHMuZGVmYXVsdC5GZWVkYmFja0RlbGF5LnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9kZWxheU5vZGUuZGlzcG9zZSgpLCB0aGlzLl9kZWxheU5vZGUgPSBudWxsLCB0aGlzLl93cml0YWJsZShbXCJkZWxheVRpbWVcIl0pLCB0aGlzLmRlbGF5VGltZSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkZlZWRiYWNrRGVsYXk7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoOCksIGkoNyk7XG4gICAgcy5kZWZhdWx0LkRpc3RvcnRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImRpc3RvcnRpb25cIl0sIHMuZGVmYXVsdC5EaXN0b3J0aW9uKTtcbiAgICAgIHMuZGVmYXVsdC5FZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5fc2hhcGVyID0gbmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKDQwOTYpLCB0aGlzLl9kaXN0b3J0aW9uID0gdC5kaXN0b3J0aW9uLCB0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fc2hhcGVyKSwgdGhpcy5kaXN0b3J0aW9uID0gdC5kaXN0b3J0aW9uLCB0aGlzLm92ZXJzYW1wbGUgPSB0Lm92ZXJzYW1wbGU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRGlzdG9ydGlvbiwgcy5kZWZhdWx0LkVmZmVjdCksIHMuZGVmYXVsdC5EaXN0b3J0aW9uLmRlZmF1bHRzID0ge1xuICAgICAgZGlzdG9ydGlvbjogLjQsXG4gICAgICBvdmVyc2FtcGxlOiBcIm5vbmVcIlxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRGlzdG9ydGlvbi5wcm90b3R5cGUsIFwiZGlzdG9ydGlvblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc3RvcnRpb247XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9kaXN0b3J0aW9uID0gdDtcbiAgICAgICAgdmFyIGUgPSAxMDAgKiB0LFxuICAgICAgICAgICAgaSA9IE1hdGguUEkgLyAxODA7XG5cbiAgICAgICAgdGhpcy5fc2hhcGVyLnNldE1hcChmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHJldHVybiBNYXRoLmFicyh0KSA8IC4wMDEgPyAwIDogKDMgKyBlKSAqIHQgKiAyMCAqIGkgLyAoTWF0aC5QSSArIGUgKiBNYXRoLmFicyh0KSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkRpc3RvcnRpb24ucHJvdG90eXBlLCBcIm92ZXJzYW1wbGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NoYXBlci5vdmVyc2FtcGxlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkRpc3RvcnRpb24ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9zaGFwZXIuZGlzcG9zZSgpLCB0aGlzLl9zaGFwZXIgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5EaXN0b3J0aW9uO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDEyKSwgaSgxNSksIGkoMTgpO1xuICAgIHMuZGVmYXVsdC5DaG9ydXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiLCBcImRlbGF5VGltZVwiLCBcImRlcHRoXCJdLCBzLmRlZmF1bHQuQ2hvcnVzKTtcbiAgICAgIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLCB0KSwgdGhpcy5fZGVwdGggPSB0LmRlcHRoLCB0aGlzLl9kZWxheVRpbWUgPSB0LmRlbGF5VGltZSAvIDFlMywgdGhpcy5fbGZvTCA9IG5ldyBzLmRlZmF1bHQuTEZPKHtcbiAgICAgICAgZnJlcXVlbmN5OiB0LmZyZXF1ZW5jeSxcbiAgICAgICAgbWluOiAwLFxuICAgICAgICBtYXg6IDFcbiAgICAgIH0pLCB0aGlzLl9sZm9SID0gbmV3IHMuZGVmYXVsdC5MRk8oe1xuICAgICAgICBmcmVxdWVuY3k6IHQuZnJlcXVlbmN5LFxuICAgICAgICBtaW46IDAsXG4gICAgICAgIG1heDogMSxcbiAgICAgICAgcGhhc2U6IDE4MFxuICAgICAgfSksIHRoaXMuX2RlbGF5Tm9kZUwgPSBuZXcgcy5kZWZhdWx0LkRlbGF5KCksIHRoaXMuX2RlbGF5Tm9kZVIgPSBuZXcgcy5kZWZhdWx0LkRlbGF5KCksIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5fbGZvTC5mcmVxdWVuY3ksIHRoaXMuZWZmZWN0U2VuZEwuY2hhaW4odGhpcy5fZGVsYXlOb2RlTCwgdGhpcy5lZmZlY3RSZXR1cm5MKSwgdGhpcy5lZmZlY3RTZW5kUi5jaGFpbih0aGlzLl9kZWxheU5vZGVSLCB0aGlzLmVmZmVjdFJldHVyblIpLCB0aGlzLmVmZmVjdFNlbmRMLmNvbm5lY3QodGhpcy5lZmZlY3RSZXR1cm5MKSwgdGhpcy5lZmZlY3RTZW5kUi5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuUiksIHRoaXMuX2xmb0wuY29ubmVjdCh0aGlzLl9kZWxheU5vZGVMLmRlbGF5VGltZSksIHRoaXMuX2xmb1IuY29ubmVjdCh0aGlzLl9kZWxheU5vZGVSLmRlbGF5VGltZSksIHRoaXMuX2xmb0wuc3RhcnQoKSwgdGhpcy5fbGZvUi5zdGFydCgpLCB0aGlzLl9sZm9MLmZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2xmb1IuZnJlcXVlbmN5KSwgdGhpcy5kZXB0aCA9IHRoaXMuX2RlcHRoLCB0aGlzLmZyZXF1ZW5jeS52YWx1ZSA9IHQuZnJlcXVlbmN5LCB0aGlzLnR5cGUgPSB0LnR5cGUsIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiXSksIHRoaXMuc3ByZWFkID0gdC5zcHJlYWQ7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ2hvcnVzLCBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSwgcy5kZWZhdWx0LkNob3J1cy5kZWZhdWx0cyA9IHtcbiAgICAgIGZyZXF1ZW5jeTogMS41LFxuICAgICAgZGVsYXlUaW1lOiAzLjUsXG4gICAgICBkZXB0aDogLjcsXG4gICAgICB0eXBlOiBcInNpbmVcIixcbiAgICAgIHNwcmVhZDogMTgwXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaG9ydXMucHJvdG90eXBlLCBcImRlcHRoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVwdGg7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9kZXB0aCA9IHQ7XG4gICAgICAgIHZhciBlID0gdGhpcy5fZGVsYXlUaW1lICogdDtcbiAgICAgICAgdGhpcy5fbGZvTC5taW4gPSBNYXRoLm1heCh0aGlzLl9kZWxheVRpbWUgLSBlLCAwKSwgdGhpcy5fbGZvTC5tYXggPSB0aGlzLl9kZWxheVRpbWUgKyBlLCB0aGlzLl9sZm9SLm1pbiA9IE1hdGgubWF4KHRoaXMuX2RlbGF5VGltZSAtIGUsIDApLCB0aGlzLl9sZm9SLm1heCA9IHRoaXMuX2RlbGF5VGltZSArIGU7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZSwgXCJkZWxheVRpbWVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxZTMgKiB0aGlzLl9kZWxheVRpbWU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9kZWxheVRpbWUgPSB0IC8gMWUzLCB0aGlzLmRlcHRoID0gdGhpcy5fZGVwdGg7XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGZvTC50eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbGZvTC50eXBlID0gdCwgdGhpcy5fbGZvUi50eXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaG9ydXMucHJvdG90eXBlLCBcInNwcmVhZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xmb1IucGhhc2UgLSB0aGlzLl9sZm9MLnBoYXNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbGZvTC5waGFzZSA9IDkwIC0gdCAvIDIsIHRoaXMuX2xmb1IucGhhc2UgPSB0IC8gMiArIDkwO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5TdGVyZW9FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fbGZvTC5kaXNwb3NlKCksIHRoaXMuX2xmb0wgPSBudWxsLCB0aGlzLl9sZm9SLmRpc3Bvc2UoKSwgdGhpcy5fbGZvUiA9IG51bGwsIHRoaXMuX2RlbGF5Tm9kZUwuZGlzcG9zZSgpLCB0aGlzLl9kZWxheU5vZGVMID0gbnVsbCwgdGhpcy5fZGVsYXlOb2RlUi5kaXNwb3NlKCksIHRoaXMuX2RlbGF5Tm9kZVIgPSBudWxsLCB0aGlzLl93cml0YWJsZShcImZyZXF1ZW5jeVwiKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5DaG9ydXM7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoOCksIGkoNyk7XG4gICAgcy5kZWZhdWx0LkNoZWJ5c2hldiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wib3JkZXJcIl0sIHMuZGVmYXVsdC5DaGVieXNoZXYpO1xuICAgICAgcy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLl9zaGFwZXIgPSBuZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoNDA5NiksIHRoaXMuX29yZGVyID0gdC5vcmRlciwgdGhpcy5jb25uZWN0RWZmZWN0KHRoaXMuX3NoYXBlciksIHRoaXMub3JkZXIgPSB0Lm9yZGVyLCB0aGlzLm92ZXJzYW1wbGUgPSB0Lm92ZXJzYW1wbGU7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ2hlYnlzaGV2LCBzLmRlZmF1bHQuRWZmZWN0KSwgcy5kZWZhdWx0LkNoZWJ5c2hldi5kZWZhdWx0cyA9IHtcbiAgICAgIG9yZGVyOiAxLFxuICAgICAgb3ZlcnNhbXBsZTogXCJub25lXCJcbiAgICB9LCBzLmRlZmF1bHQuQ2hlYnlzaGV2LnByb3RvdHlwZS5fZ2V0Q29lZmZpY2llbnQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgcmV0dXJuIGkuaGFzT3duUHJvcGVydHkoZSkgPyBpW2VdIDogKGlbZV0gPSAwID09PSBlID8gMCA6IDEgPT09IGUgPyB0IDogMiAqIHQgKiB0aGlzLl9nZXRDb2VmZmljaWVudCh0LCBlIC0gMSwgaSkgLSB0aGlzLl9nZXRDb2VmZmljaWVudCh0LCBlIC0gMiwgaSksIGlbZV0pO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hlYnlzaGV2LnByb3RvdHlwZSwgXCJvcmRlclwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29yZGVyO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3JkZXIgPSB0O1xuXG4gICAgICAgIGZvciAodmFyIGUgPSBuZXcgQXJyYXkoNDA5NiksIGkgPSBlLmxlbmd0aCwgcyA9IDA7IHMgPCBpOyArK3MpIHtcbiAgICAgICAgICB2YXIgbiA9IDIgKiBzIC8gaSAtIDE7XG4gICAgICAgICAgZVtzXSA9IDAgPT09IG4gPyAwIDogdGhpcy5fZ2V0Q29lZmZpY2llbnQobiwgdCwge30pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2hhcGVyLmN1cnZlID0gZTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaGVieXNoZXYucHJvdG90eXBlLCBcIm92ZXJzYW1wbGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3NoYXBlci5vdmVyc2FtcGxlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkNoZWJ5c2hldi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3NoYXBlci5kaXNwb3NlKCksIHRoaXMuX3NoYXBlciA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkNoZWJ5c2hldjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg4KSwgaSgxMyksIGkoNzUpO1xuICAgIHMuZGVmYXVsdC5CaXRDcnVzaGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJiaXRzXCJdLCBzLmRlZmF1bHQuQml0Q3J1c2hlcik7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcywgdCk7XG4gICAgICB2YXIgZSA9IDEgLyBNYXRoLnBvdygyLCB0LmJpdHMgLSAxKTtcbiAgICAgIHRoaXMuX3N1YnRyYWN0ID0gbmV3IHMuZGVmYXVsdC5TdWJ0cmFjdCgpLCB0aGlzLl9tb2R1bG8gPSBuZXcgcy5kZWZhdWx0Lk1vZHVsbyhlKSwgdGhpcy5fYml0cyA9IHQuYml0cywgdGhpcy5lZmZlY3RTZW5kLmZhbih0aGlzLl9zdWJ0cmFjdCwgdGhpcy5fbW9kdWxvKSwgdGhpcy5fbW9kdWxvLmNvbm5lY3QodGhpcy5fc3VidHJhY3QsIDAsIDEpLCB0aGlzLl9zdWJ0cmFjdC5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5CaXRDcnVzaGVyLCBzLmRlZmF1bHQuRWZmZWN0KSwgcy5kZWZhdWx0LkJpdENydXNoZXIuZGVmYXVsdHMgPSB7XG4gICAgICBiaXRzOiA0XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CaXRDcnVzaGVyLnByb3RvdHlwZSwgXCJiaXRzXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYml0cztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2JpdHMgPSB0O1xuICAgICAgICB2YXIgZSA9IDEgLyBNYXRoLnBvdygyLCB0IC0gMSk7XG4gICAgICAgIHRoaXMuX21vZHVsby52YWx1ZSA9IGU7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5CaXRDcnVzaGVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fc3VidHJhY3QuZGlzcG9zZSgpLCB0aGlzLl9zdWJ0cmFjdCA9IG51bGwsIHRoaXMuX21vZHVsby5kaXNwb3NlKCksIHRoaXMuX21vZHVsbyA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkJpdENydXNoZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNTgpLCBpKDQyKSwgaSg4KSwgaSg5KTtcbiAgICBzLmRlZmF1bHQuQXV0b1dhaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiYmFzZUZyZXF1ZW5jeVwiLCBcIm9jdGF2ZXNcIiwgXCJzZW5zaXRpdml0eVwiXSwgcy5kZWZhdWx0LkF1dG9XYWgpO1xuICAgICAgcy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsIHQpLCB0aGlzLmZvbGxvd2VyID0gbmV3IHMuZGVmYXVsdC5Gb2xsb3dlcih0LmZvbGxvd2VyKSwgdGhpcy5fc3dlZXBSYW5nZSA9IG5ldyBzLmRlZmF1bHQuU2NhbGVFeHAoMCwgMSwgLjUpLCB0aGlzLl9iYXNlRnJlcXVlbmN5ID0gdC5iYXNlRnJlcXVlbmN5LCB0aGlzLl9vY3RhdmVzID0gdC5vY3RhdmVzLCB0aGlzLl9pbnB1dEJvb3N0ID0gbmV3IHMuZGVmYXVsdC5HYWluKCksIHRoaXMuX2JhbmRwYXNzID0gbmV3IHMuZGVmYXVsdC5GaWx0ZXIoe1xuICAgICAgICByb2xsb2ZmOiAtNDgsXG4gICAgICAgIGZyZXF1ZW5jeTogMCxcbiAgICAgICAgUTogdC5RXG4gICAgICB9KSwgdGhpcy5fcGVha2luZyA9IG5ldyBzLmRlZmF1bHQuRmlsdGVyKDAsIFwicGVha2luZ1wiKSwgdGhpcy5fcGVha2luZy5nYWluLnZhbHVlID0gdC5nYWluLCB0aGlzLmdhaW4gPSB0aGlzLl9wZWFraW5nLmdhaW4sIHRoaXMuUSA9IHRoaXMuX2JhbmRwYXNzLlEsIHRoaXMuZWZmZWN0U2VuZC5jaGFpbih0aGlzLl9pbnB1dEJvb3N0LCB0aGlzLmZvbGxvd2VyLCB0aGlzLl9zd2VlcFJhbmdlKSwgdGhpcy5fc3dlZXBSYW5nZS5jb25uZWN0KHRoaXMuX2JhbmRwYXNzLmZyZXF1ZW5jeSksIHRoaXMuX3N3ZWVwUmFuZ2UuY29ubmVjdCh0aGlzLl9wZWFraW5nLmZyZXF1ZW5jeSksIHRoaXMuZWZmZWN0U2VuZC5jaGFpbih0aGlzLl9iYW5kcGFzcywgdGhpcy5fcGVha2luZywgdGhpcy5lZmZlY3RSZXR1cm4pLCB0aGlzLl9zZXRTd2VlcFJhbmdlKCksIHRoaXMuc2Vuc2l0aXZpdHkgPSB0LnNlbnNpdGl2aXR5LCB0aGlzLl9yZWFkT25seShbXCJnYWluXCIsIFwiUVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQXV0b1dhaCwgcy5kZWZhdWx0LkVmZmVjdCksIHMuZGVmYXVsdC5BdXRvV2FoLmRlZmF1bHRzID0ge1xuICAgICAgYmFzZUZyZXF1ZW5jeTogMTAwLFxuICAgICAgb2N0YXZlczogNixcbiAgICAgIHNlbnNpdGl2aXR5OiAwLFxuICAgICAgUTogMixcbiAgICAgIGdhaW46IDIsXG4gICAgICBmb2xsb3dlcjoge1xuICAgICAgICBhdHRhY2s6IC4zLFxuICAgICAgICByZWxlYXNlOiAuNVxuICAgICAgfVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXV0b1dhaC5wcm90b3R5cGUsIFwib2N0YXZlc1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29jdGF2ZXM7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vY3RhdmVzID0gdCwgdGhpcy5fc2V0U3dlZXBSYW5nZSgpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1dG9XYWgucHJvdG90eXBlLCBcImJhc2VGcmVxdWVuY3lcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9iYXNlRnJlcXVlbmN5O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fYmFzZUZyZXF1ZW5jeSA9IHQsIHRoaXMuX3NldFN3ZWVwUmFuZ2UoKTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdXRvV2FoLnByb3RvdHlwZSwgXCJzZW5zaXRpdml0eVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHMuZGVmYXVsdC5nYWluVG9EYigxIC8gdGhpcy5faW5wdXRCb29zdC5nYWluLnZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2lucHV0Qm9vc3QuZ2Fpbi52YWx1ZSA9IDEgLyBzLmRlZmF1bHQuZGJUb0dhaW4odCk7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5BdXRvV2FoLnByb3RvdHlwZS5fc2V0U3dlZXBSYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N3ZWVwUmFuZ2UubWluID0gdGhpcy5fYmFzZUZyZXF1ZW5jeSwgdGhpcy5fc3dlZXBSYW5nZS5tYXggPSBNYXRoLm1pbih0aGlzLl9iYXNlRnJlcXVlbmN5ICogTWF0aC5wb3coMiwgdGhpcy5fb2N0YXZlcyksIHRoaXMuY29udGV4dC5zYW1wbGVSYXRlIC8gMik7XG4gICAgfSwgcy5kZWZhdWx0LkF1dG9XYWgucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLmZvbGxvd2VyLmRpc3Bvc2UoKSwgdGhpcy5mb2xsb3dlciA9IG51bGwsIHRoaXMuX3N3ZWVwUmFuZ2UuZGlzcG9zZSgpLCB0aGlzLl9zd2VlcFJhbmdlID0gbnVsbCwgdGhpcy5fYmFuZHBhc3MuZGlzcG9zZSgpLCB0aGlzLl9iYW5kcGFzcyA9IG51bGwsIHRoaXMuX3BlYWtpbmcuZGlzcG9zZSgpLCB0aGlzLl9wZWFraW5nID0gbnVsbCwgdGhpcy5faW5wdXRCb29zdC5kaXNwb3NlKCksIHRoaXMuX2lucHV0Qm9vc3QgPSBudWxsLCB0aGlzLl93cml0YWJsZShbXCJnYWluXCIsIFwiUVwiXSksIHRoaXMuZ2FpbiA9IG51bGwsIHRoaXMuUSA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkF1dG9XYWg7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoOCksIGkoMTIpLCBpKDQ4KTtcbiAgICBzLmRlZmF1bHQuQXV0b1Bhbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wiZnJlcXVlbmN5XCJdLCBzLmRlZmF1bHQuQXV0b1Bhbm5lcik7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuX2xmbyA9IG5ldyBzLmRlZmF1bHQuTEZPKHtcbiAgICAgICAgZnJlcXVlbmN5OiB0LmZyZXF1ZW5jeSxcbiAgICAgICAgYW1wbGl0dWRlOiB0LmRlcHRoLFxuICAgICAgICBtaW46IC0xLFxuICAgICAgICBtYXg6IDFcbiAgICAgIH0pLCB0aGlzLmRlcHRoID0gdGhpcy5fbGZvLmFtcGxpdHVkZSwgdGhpcy5fcGFubmVyID0gbmV3IHMuZGVmYXVsdC5QYW5uZXIoKSwgdGhpcy5mcmVxdWVuY3kgPSB0aGlzLl9sZm8uZnJlcXVlbmN5LCB0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fcGFubmVyKSwgdGhpcy5fbGZvLmNvbm5lY3QodGhpcy5fcGFubmVyLnBhbiksIHRoaXMudHlwZSA9IHQudHlwZSwgdGhpcy5fcmVhZE9ubHkoW1wiZGVwdGhcIiwgXCJmcmVxdWVuY3lcIl0pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkF1dG9QYW5uZXIsIHMuZGVmYXVsdC5FZmZlY3QpLCBzLmRlZmF1bHQuQXV0b1Bhbm5lci5kZWZhdWx0cyA9IHtcbiAgICAgIGZyZXF1ZW5jeTogMSxcbiAgICAgIHR5cGU6IFwic2luZVwiLFxuICAgICAgZGVwdGg6IDFcbiAgICB9LCBzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmby5zdGFydCh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGZvLnN0b3AodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkF1dG9QYW5uZXIucHJvdG90eXBlLnN5bmMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmby5zeW5jKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5BdXRvUGFubmVyLnByb3RvdHlwZS51bnN5bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGZvLnVuc3luYygpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xmby50eXBlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fbGZvLnR5cGUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX2xmby5kaXNwb3NlKCksIHRoaXMuX2xmbyA9IG51bGwsIHRoaXMuX3Bhbm5lci5kaXNwb3NlKCksIHRoaXMuX3Bhbm5lciA9IG51bGwsIHRoaXMuX3dyaXRhYmxlKFtcImRlcHRoXCIsIFwiZnJlcXVlbmN5XCJdKSwgdGhpcy5mcmVxdWVuY3kgPSBudWxsLCB0aGlzLmRlcHRoID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQXV0b1Bhbm5lcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg4KSwgaSgxMiksIGkoOSk7XG4gICAgcy5kZWZhdWx0LkF1dG9GaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcImZyZXF1ZW5jeVwiLCBcImJhc2VGcmVxdWVuY3lcIiwgXCJvY3RhdmVzXCJdLCBzLmRlZmF1bHQuQXV0b0ZpbHRlcik7XG4gICAgICBzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcywgdCksIHRoaXMuX2xmbyA9IG5ldyBzLmRlZmF1bHQuTEZPKHtcbiAgICAgICAgZnJlcXVlbmN5OiB0LmZyZXF1ZW5jeSxcbiAgICAgICAgYW1wbGl0dWRlOiB0LmRlcHRoXG4gICAgICB9KSwgdGhpcy5kZXB0aCA9IHRoaXMuX2xmby5hbXBsaXR1ZGUsIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5fbGZvLmZyZXF1ZW5jeSwgdGhpcy5maWx0ZXIgPSBuZXcgcy5kZWZhdWx0LkZpbHRlcih0LmZpbHRlciksIHRoaXMuX29jdGF2ZXMgPSAwLCB0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5maWx0ZXIpLCB0aGlzLl9sZm8uY29ubmVjdCh0aGlzLmZpbHRlci5mcmVxdWVuY3kpLCB0aGlzLnR5cGUgPSB0LnR5cGUsIHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLCBcImRlcHRoXCJdKSwgdGhpcy5vY3RhdmVzID0gdC5vY3RhdmVzLCB0aGlzLmJhc2VGcmVxdWVuY3kgPSB0LmJhc2VGcmVxdWVuY3k7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQXV0b0ZpbHRlciwgcy5kZWZhdWx0LkVmZmVjdCksIHMuZGVmYXVsdC5BdXRvRmlsdGVyLmRlZmF1bHRzID0ge1xuICAgICAgZnJlcXVlbmN5OiAxLFxuICAgICAgdHlwZTogXCJzaW5lXCIsXG4gICAgICBkZXB0aDogMSxcbiAgICAgIGJhc2VGcmVxdWVuY3k6IDIwMCxcbiAgICAgIG9jdGF2ZXM6IDIuNixcbiAgICAgIGZpbHRlcjoge1xuICAgICAgICB0eXBlOiBcImxvd3Bhc3NcIixcbiAgICAgICAgcm9sbG9mZjogLTEyLFxuICAgICAgICBROiAxXG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9sZm8uc3RhcnQodCksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmby5zdG9wKHQpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5BdXRvRmlsdGVyLnByb3RvdHlwZS5zeW5jID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9sZm8uc3luYyh0KSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuQXV0b0ZpbHRlci5wcm90b3R5cGUudW5zeW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2xmby51bnN5bmMoKSwgdGhpcztcbiAgICB9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZm8udHlwZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xmby50eXBlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdXRvRmlsdGVyLnByb3RvdHlwZSwgXCJiYXNlRnJlcXVlbmN5XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGZvLm1pbjtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2xmby5taW4gPSB0aGlzLnRvRnJlcXVlbmN5KHQpLCB0aGlzLm9jdGF2ZXMgPSB0aGlzLl9vY3RhdmVzO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLCBcIm9jdGF2ZXNcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vY3RhdmVzO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb2N0YXZlcyA9IHQsIHRoaXMuX2xmby5tYXggPSB0aGlzLmJhc2VGcmVxdWVuY3kgKiBNYXRoLnBvdygyLCB0KTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9sZm8uZGlzcG9zZSgpLCB0aGlzLl9sZm8gPSBudWxsLCB0aGlzLmZpbHRlci5kaXNwb3NlKCksIHRoaXMuZmlsdGVyID0gbnVsbCwgdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsIFwiZGVwdGhcIl0pLCB0aGlzLmZyZXF1ZW5jeSA9IG51bGwsIHRoaXMuZGVwdGggPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5BdXRvRmlsdGVyO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDIzKSwgaSgxMCksIGkoMTkpLCBpKDIpLCBpKDIyKSwgaSgyOCk7XG4gICAgcy5kZWZhdWx0Lkxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMuX29yaWVudGF0aW9uID0gWzAsIDAsIDAsIDAsIDAsIDBdLCB0aGlzLl9wb3NpdGlvbiA9IFswLCAwLCAwXSwgcy5kZWZhdWx0LmdldENvbnRleHQoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldChuLmRlZmF1bHRzKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTGlzdGVuZXIpLCBzLmRlZmF1bHQuTGlzdGVuZXIuZGVmYXVsdHMgPSB7XG4gICAgICBwb3NpdGlvblg6IDAsXG4gICAgICBwb3NpdGlvblk6IDAsXG4gICAgICBwb3NpdGlvblo6IDAsXG4gICAgICBmb3J3YXJkWDogMCxcbiAgICAgIGZvcndhcmRZOiAwLFxuICAgICAgZm9yd2FyZFo6IDEsXG4gICAgICB1cFg6IDAsXG4gICAgICB1cFk6IDEsXG4gICAgICB1cFo6IDBcbiAgICB9LCBzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLmlzTGlzdGVuZXIgPSAhMCwgcy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZS5fcmFtcFRpbWVDb25zdGFudCA9IC4wMSwgcy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBpZiAodGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25YKSB7XG4gICAgICAgIHZhciBzID0gdGhpcy5ub3coKTtcbiAgICAgICAgdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25YLnNldFRhcmdldEF0VGltZSh0LCBzLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KSwgdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25ZLnNldFRhcmdldEF0VGltZShlLCBzLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KSwgdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25aLnNldFRhcmdldEF0VGltZShpLCBzLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KTtcbiAgICAgIH0gZWxzZSB0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5zZXRQb3NpdGlvbih0LCBlLCBpKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLnNldE9yaWVudGF0aW9uID0gZnVuY3Rpb24gKHQsIGUsIGksIHMsIG4sIG8pIHtcbiAgICAgIGlmICh0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5mb3J3YXJkWCkge1xuICAgICAgICB2YXIgYSA9IHRoaXMubm93KCk7XG4gICAgICAgIHRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLmZvcndhcmRYLnNldFRhcmdldEF0VGltZSh0LCBhLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KSwgdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIuZm9yd2FyZFkuc2V0VGFyZ2V0QXRUaW1lKGUsIGEsIHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpLCB0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5mb3J3YXJkWi5zZXRUYXJnZXRBdFRpbWUoaSwgYSwgdGhpcy5fcmFtcFRpbWVDb25zdGFudCksIHRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLnVwWC5zZXRUYXJnZXRBdFRpbWUocywgYSwgdGhpcy5fcmFtcFRpbWVDb25zdGFudCksIHRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLnVwWS5zZXRUYXJnZXRBdFRpbWUobiwgYSwgdGhpcy5fcmFtcFRpbWVDb25zdGFudCksIHRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLnVwWi5zZXRUYXJnZXRBdFRpbWUobywgYSwgdGhpcy5fcmFtcFRpbWVDb25zdGFudCk7XG4gICAgICB9IGVsc2UgdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIuc2V0T3JpZW50YXRpb24odCwgZSwgaSwgcywgbiwgbyk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbiA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksIHRoaXM7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsIFwicG9zaXRpb25YXCIsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcG9zaXRpb25bMF0gPSB0LCB0aGlzLnNldFBvc2l0aW9uLmFwcGx5KHRoaXMsIHRoaXMuX3Bvc2l0aW9uKTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uWzBdO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZSwgXCJwb3NpdGlvbllcIiwge1xuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wb3NpdGlvblsxXSA9IHQsIHRoaXMuc2V0UG9zaXRpb24uYXBwbHkodGhpcywgdGhpcy5fcG9zaXRpb24pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb25bMV07XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLCBcInBvc2l0aW9uWlwiLCB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uWzJdID0gdCwgdGhpcy5zZXRQb3NpdGlvbi5hcHBseSh0aGlzLCB0aGlzLl9wb3NpdGlvbik7XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvblsyXTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsIFwiZm9yd2FyZFhcIiwge1xuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vcmllbnRhdGlvblswXSA9IHQsIHRoaXMuc2V0T3JpZW50YXRpb24uYXBwbHkodGhpcywgdGhpcy5fb3JpZW50YXRpb24pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMF07XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLCBcImZvcndhcmRZXCIsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3JpZW50YXRpb25bMV0gPSB0LCB0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsIHRoaXMuX29yaWVudGF0aW9uKTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWzFdO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZSwgXCJmb3J3YXJkWlwiLCB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29yaWVudGF0aW9uWzJdID0gdCwgdGhpcy5zZXRPcmllbnRhdGlvbi5hcHBseSh0aGlzLCB0aGlzLl9vcmllbnRhdGlvbik7XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvblsyXTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsIFwidXBYXCIsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3JpZW50YXRpb25bM10gPSB0LCB0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsIHRoaXMuX29yaWVudGF0aW9uKTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWzNdO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZSwgXCJ1cFlcIiwge1xuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vcmllbnRhdGlvbls0XSA9IHQsIHRoaXMuc2V0T3JpZW50YXRpb24uYXBwbHkodGhpcywgdGhpcy5fb3JpZW50YXRpb24pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bNF07XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLCBcInVwWlwiLCB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29yaWVudGF0aW9uWzVdID0gdCwgdGhpcy5zZXRPcmllbnRhdGlvbi5hcHBseSh0aGlzLCB0aGlzLl9vcmllbnRhdGlvbik7XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbls1XTtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uID0gbnVsbCwgdGhpcy5fcG9zaXRpb24gPSBudWxsLCB0aGlzO1xuICAgIH07XG4gICAgdmFyIG4gPSBzLmRlZmF1bHQuTGlzdGVuZXI7XG4gICAgcy5kZWZhdWx0Lkxpc3RlbmVyID0gbmV3IG4oKSwgcy5kZWZhdWx0LkNvbnRleHQub24oXCJpbml0XCIsIGZ1bmN0aW9uICh0KSB7XG4gICAgICB0Lmxpc3RlbmVyICYmIHQubGlzdGVuZXIuaXNMaXN0ZW5lciA/IHMuZGVmYXVsdC5MaXN0ZW5lciA9IHQubGlzdGVuZXIgOiBzLmRlZmF1bHQuTGlzdGVuZXIgPSBuZXcgbigpO1xuICAgIH0pLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTGlzdGVuZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjQpO1xuICAgIHMuZGVmYXVsdC5EcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMuX2V2ZW50cyA9IG5ldyBzLmRlZmF1bHQuVGltZWxpbmUoKSwgdGhpcy5leHBpcmF0aW9uID0gLjI1LCB0aGlzLmFudGljaXBhdGlvbiA9IC4wMDgsIHRoaXMuX2JvdW5kRHJhd0xvb3AgPSB0aGlzLl9kcmF3TG9vcC5iaW5kKHRoaXMpO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkRyYXcpLCBzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50cy5hZGQoe1xuICAgICAgICBjYWxsYmFjazogdCxcbiAgICAgICAgdGltZTogdGhpcy50b1NlY29uZHMoZSlcbiAgICAgIH0pLCAxID09PSB0aGlzLl9ldmVudHMubGVuZ3RoICYmIHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9ib3VuZERyYXdMb29wKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ldmVudHMuY2FuY2VsKHRoaXMudG9TZWNvbmRzKHQpKSwgdGhpcztcbiAgICB9LCBzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuX2RyYXdMb29wID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgdCA9IHMuZGVmYXVsdC5jb250ZXh0LmN1cnJlbnRUaW1lOyB0aGlzLl9ldmVudHMubGVuZ3RoICYmIHRoaXMuX2V2ZW50cy5wZWVrKCkudGltZSAtIHRoaXMuYW50aWNpcGF0aW9uIDw9IHQ7KSB7XG4gICAgICAgIHZhciBlID0gdGhpcy5fZXZlbnRzLnNoaWZ0KCk7XG5cbiAgICAgICAgdCAtIGUudGltZSA8PSB0aGlzLmV4cGlyYXRpb24gJiYgZS5jYWxsYmFjaygpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9ldmVudHMubGVuZ3RoID4gMCAmJiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fYm91bmREcmF3TG9vcCk7XG4gICAgfSwgcy5kZWZhdWx0LkRyYXcgPSBuZXcgcy5kZWZhdWx0LkRyYXcoKSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkRyYXc7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApLFxuICAgICAgICBuID0gKGkoMyksIHt9KTtcbiAgICBzLmRlZmF1bHQucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgbi5oYXNPd25Qcm9wZXJ0eSh0KSB8fCAoblt0XSA9IHRoaXMuY29udGV4dC5jcmVhdGVHYWluKCkpLCBlID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwgMCk7XG4gICAgICB2YXIgaSA9IG5ldyBzLmRlZmF1bHQuR2FpbihlLCBzLmRlZmF1bHQuVHlwZS5EZWNpYmVscyk7XG4gICAgICByZXR1cm4gdGhpcy5jb25uZWN0KGkpLCBpLmNvbm5lY3Qoblt0XSksIGk7XG4gICAgfSwgcy5kZWZhdWx0LnByb3RvdHlwZS5yZWNlaXZlID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHJldHVybiBuLmhhc093blByb3BlcnR5KHQpIHx8IChuW3RdID0gdGhpcy5jb250ZXh0LmNyZWF0ZUdhaW4oKSksIHMuZGVmYXVsdC5jb25uZWN0KG5bdF0sIHRoaXMsIDAsIGUpLCB0aGlzO1xuICAgIH0sIHMuZGVmYXVsdC5Db250ZXh0Lm9uKFwiaW5pdFwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgdC5idXNlcyA/IG4gPSB0LmJ1c2VzIDogKG4gPSB7fSwgdC5idXNlcyA9IG4pO1xuICAgIH0pLCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQ7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNCk7XG4gICAgcy5kZWZhdWx0LkN0cmxSYW5kb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcIm1pblwiLCBcIm1heFwiXSwgcy5kZWZhdWx0LkN0cmxSYW5kb20pO1xuICAgICAgcy5kZWZhdWx0LmNhbGwodGhpcyksIHRoaXMubWluID0gdC5taW4sIHRoaXMubWF4ID0gdC5tYXgsIHRoaXMuaW50ZWdlciA9IHQuaW50ZWdlcjtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DdHJsUmFuZG9tKSwgcy5kZWZhdWx0LkN0cmxSYW5kb20uZGVmYXVsdHMgPSB7XG4gICAgICBtaW46IDAsXG4gICAgICBtYXg6IDEsXG4gICAgICBpbnRlZ2VyOiAhMVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ3RybFJhbmRvbS5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcy50b1NlY29uZHModGhpcy5taW4pLFxuICAgICAgICAgICAgZSA9IHRoaXMudG9TZWNvbmRzKHRoaXMubWF4KSxcbiAgICAgICAgICAgIGkgPSBNYXRoLnJhbmRvbSgpLFxuICAgICAgICAgICAgcyA9IGkgKiB0ICsgKDEgLSBpKSAqIGU7XG4gICAgICAgIHJldHVybiB0aGlzLmludGVnZXIgJiYgKHMgPSBNYXRoLmZsb29yKHMpKSwgcztcbiAgICAgIH1cbiAgICB9KSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LkN0cmxSYW5kb207XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIHMuZGVmYXVsdC5DdHJsTWFya292ID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIHMuZGVmYXVsdC5jYWxsKHRoaXMpLCB0aGlzLnZhbHVlcyA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsIHt9KSwgdGhpcy52YWx1ZSA9IHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsIE9iamVjdC5rZXlzKHRoaXMudmFsdWVzKVswXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ3RybE1hcmtvdiksIHMuZGVmYXVsdC5DdHJsTWFya292LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMudmFsdWVzLmhhc093blByb3BlcnR5KHRoaXMudmFsdWUpKSB7XG4gICAgICAgIHZhciB0ID0gdGhpcy52YWx1ZXNbdGhpcy52YWx1ZV07XG4gICAgICAgIGlmIChzLmRlZmF1bHQuaXNBcnJheSh0KSkgZm9yICh2YXIgZSA9IHRoaXMuX2dldFByb2JEaXN0cmlidXRpb24odCksIGkgPSBNYXRoLnJhbmRvbSgpLCBuID0gMCwgbyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSB7XG4gICAgICAgICAgdmFyIGEgPSBlW29dO1xuXG4gICAgICAgICAgaWYgKGkgPiBuICYmIGkgPCBuICsgYSkge1xuICAgICAgICAgICAgdmFyIHIgPSB0W29dO1xuICAgICAgICAgICAgcy5kZWZhdWx0LmlzT2JqZWN0KHIpID8gdGhpcy52YWx1ZSA9IHIudmFsdWUgOiB0aGlzLnZhbHVlID0gcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuICs9IGE7XG4gICAgICAgIH0gZWxzZSB0aGlzLnZhbHVlID0gdDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgfSwgcy5kZWZhdWx0LkN0cmxNYXJrb3YucHJvdG90eXBlLl9nZXRQcm9iRGlzdHJpYnV0aW9uID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGZvciAodmFyIGUgPSBbXSwgaSA9IDAsIG4gPSAhMSwgbyA9IDA7IG8gPCB0Lmxlbmd0aDsgbysrKSB7XG4gICAgICAgIHZhciBhID0gdFtvXTtcbiAgICAgICAgcy5kZWZhdWx0LmlzT2JqZWN0KGEpID8gKG4gPSAhMCwgZVtvXSA9IGEucHJvYmFiaWxpdHkpIDogZVtvXSA9IDEgLyB0Lmxlbmd0aCwgaSArPSBlW29dO1xuICAgICAgfVxuXG4gICAgICBpZiAobikgZm9yICh2YXIgciA9IDA7IHIgPCBlLmxlbmd0aDsgcisrKSBlW3JdID0gZVtyXSAvIGk7XG4gICAgICByZXR1cm4gZTtcbiAgICB9LCBzLmRlZmF1bHQuQ3RybE1hcmtvdi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudmFsdWVzID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuQ3RybE1hcmtvdjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg0KTtcbiAgICBzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJ2YWx1ZXNcIiwgXCJpbmRleFwiXSwgcy5kZWZhdWx0LkN0cmxJbnRlcnBvbGF0ZSk7XG4gICAgICBzLmRlZmF1bHQuY2FsbCh0aGlzKSwgdGhpcy52YWx1ZXMgPSB0LnZhbHVlcywgdGhpcy5pbmRleCA9IHQuaW5kZXg7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlKSwgcy5kZWZhdWx0LkN0cmxJbnRlcnBvbGF0ZS5kZWZhdWx0cyA9IHtcbiAgICAgIGluZGV4OiAwLFxuICAgICAgdmFsdWVzOiBbXVxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLmluZGV4O1xuICAgICAgICB0ID0gTWF0aC5taW4odCwgdGhpcy52YWx1ZXMubGVuZ3RoIC0gMSk7XG4gICAgICAgIHZhciBlID0gTWF0aC5mbG9vcih0KSxcbiAgICAgICAgICAgIGkgPSB0aGlzLnZhbHVlc1tlXSxcbiAgICAgICAgICAgIHMgPSB0aGlzLnZhbHVlc1tNYXRoLmNlaWwodCldO1xuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJwb2xhdGUodCAtIGUsIGksIHMpO1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5faW50ZXJwb2xhdGUgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgICAgaWYgKHMuZGVmYXVsdC5pc0FycmF5KGUpKSB7XG4gICAgICAgIGZvciAodmFyIG4gPSBbXSwgbyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSBuW29dID0gdGhpcy5faW50ZXJwb2xhdGUodCwgZVtvXSwgaVtvXSk7XG5cbiAgICAgICAgcmV0dXJuIG47XG4gICAgICB9XG5cbiAgICAgIGlmIChzLmRlZmF1bHQuaXNPYmplY3QoZSkpIHtcbiAgICAgICAgdmFyIGEgPSB7fTtcblxuICAgICAgICBmb3IgKHZhciByIGluIGUpIGFbcl0gPSB0aGlzLl9pbnRlcnBvbGF0ZSh0LCBlW3JdLCBpW3JdKTtcblxuICAgICAgICByZXR1cm4gYTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICgxIC0gdCkgKiAoZSA9IHRoaXMuX3RvTnVtYmVyKGUpKSArIHQgKiAoaSA9IHRoaXMuX3RvTnVtYmVyKGkpKTtcbiAgICB9LCBzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5fdG9OdW1iZXIgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5pc051bWJlcih0KSA/IHQgOiB0aGlzLnRvU2Vjb25kcyh0KTtcbiAgICB9LCBzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy52YWx1ZXMgPSBudWxsO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5DdHJsSW50ZXJwb2xhdGU7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMzYpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5XYXZlZm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1wic2l6ZVwiXSwgcy5kZWZhdWx0LldhdmVmb3JtKTtcbiAgICAgIHQudHlwZSA9IHMuZGVmYXVsdC5BbmFseXNlci5UeXBlLldhdmVmb3JtLCBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuX2FuYWx5c2VyID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5BbmFseXNlcih0KTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5XYXZlZm9ybSwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5XYXZlZm9ybS5kZWZhdWx0cyA9IHtcbiAgICAgIHNpemU6IDEwMjRcbiAgICB9LCBzLmRlZmF1bHQuV2F2ZWZvcm0ucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKCk7XG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5XYXZlZm9ybS5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FuYWx5c2VyLnNpemU7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9hbmFseXNlci5zaXplID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LldhdmVmb3JtLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9hbmFseXNlci5kaXNwb3NlKCksIHRoaXMuX2FuYWx5c2VyID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuV2F2ZWZvcm07XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoMjMpLCBpKDEwKSwgaSgxOSksIGkoMiksIGkoMjIpLCBpKDI4KSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuUGFubmVyM0QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInBvc2l0aW9uWFwiLCBcInBvc2l0aW9uWVwiLCBcInBvc2l0aW9uWlwiXSwgcy5kZWZhdWx0LlBhbm5lcjNEKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5fcGFubmVyID0gdGhpcy5pbnB1dCA9IHRoaXMub3V0cHV0ID0gdGhpcy5jb250ZXh0LmNyZWF0ZVBhbm5lcigpLCB0aGlzLl9wYW5uZXIucGFubmluZ01vZGVsID0gdC5wYW5uaW5nTW9kZWwsIHRoaXMuX3Bhbm5lci5tYXhEaXN0YW5jZSA9IHQubWF4RGlzdGFuY2UsIHRoaXMuX3Bhbm5lci5kaXN0YW5jZU1vZGVsID0gdC5kaXN0YW5jZU1vZGVsLCB0aGlzLl9wYW5uZXIuY29uZU91dGVyR2FpbiA9IHQuY29uZU91dGVyR2FpbiwgdGhpcy5fcGFubmVyLmNvbmVPdXRlckFuZ2xlID0gdC5jb25lT3V0ZXJBbmdsZSwgdGhpcy5fcGFubmVyLmNvbmVJbm5lckFuZ2xlID0gdC5jb25lSW5uZXJBbmdsZSwgdGhpcy5fcGFubmVyLnJlZkRpc3RhbmNlID0gdC5yZWZEaXN0YW5jZSwgdGhpcy5fcGFubmVyLnJvbGxvZmZGYWN0b3IgPSB0LnJvbGxvZmZGYWN0b3IsIHRoaXMuX29yaWVudGF0aW9uID0gW3Qub3JpZW50YXRpb25YLCB0Lm9yaWVudGF0aW9uWSwgdC5vcmllbnRhdGlvblpdLCB0aGlzLl9wb3NpdGlvbiA9IFt0LnBvc2l0aW9uWCwgdC5wb3NpdGlvblksIHQucG9zaXRpb25aXSwgdGhpcy5vcmllbnRhdGlvblggPSB0Lm9yaWVudGF0aW9uWCwgdGhpcy5vcmllbnRhdGlvblkgPSB0Lm9yaWVudGF0aW9uWSwgdGhpcy5vcmllbnRhdGlvblogPSB0Lm9yaWVudGF0aW9uWiwgdGhpcy5wb3NpdGlvblggPSB0LnBvc2l0aW9uWCwgdGhpcy5wb3NpdGlvblkgPSB0LnBvc2l0aW9uWSwgdGhpcy5wb3NpdGlvblogPSB0LnBvc2l0aW9uWjtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QYW5uZXIzRCwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5QYW5uZXIzRC5kZWZhdWx0cyA9IHtcbiAgICAgIHBvc2l0aW9uWDogMCxcbiAgICAgIHBvc2l0aW9uWTogMCxcbiAgICAgIHBvc2l0aW9uWjogMCxcbiAgICAgIG9yaWVudGF0aW9uWDogMCxcbiAgICAgIG9yaWVudGF0aW9uWTogMCxcbiAgICAgIG9yaWVudGF0aW9uWjogMCxcbiAgICAgIHBhbm5pbmdNb2RlbDogXCJlcXVhbHBvd2VyXCIsXG4gICAgICBtYXhEaXN0YW5jZTogMWU0LFxuICAgICAgZGlzdGFuY2VNb2RlbDogXCJpbnZlcnNlXCIsXG4gICAgICBjb25lT3V0ZXJHYWluOiAwLFxuICAgICAgY29uZU91dGVyQW5nbGU6IDM2MCxcbiAgICAgIGNvbmVJbm5lckFuZ2xlOiAzNjAsXG4gICAgICByZWZEaXN0YW5jZTogMSxcbiAgICAgIHJvbGxvZmZGYWN0b3I6IDFcbiAgICB9LCBzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLl9yYW1wVGltZUNvbnN0YW50ID0gLjAxLCBzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICAgIGlmICh0aGlzLl9wYW5uZXIucG9zaXRpb25YKSB7XG4gICAgICAgIHZhciBzID0gdGhpcy5ub3coKTtcbiAgICAgICAgdGhpcy5fcGFubmVyLnBvc2l0aW9uWC5zZXRUYXJnZXRBdFRpbWUodCwgcywgdGhpcy5fcmFtcFRpbWVDb25zdGFudCksIHRoaXMuX3Bhbm5lci5wb3NpdGlvblkuc2V0VGFyZ2V0QXRUaW1lKGUsIHMsIHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpLCB0aGlzLl9wYW5uZXIucG9zaXRpb25aLnNldFRhcmdldEF0VGltZShpLCBzLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KTtcbiAgICAgIH0gZWxzZSB0aGlzLl9wYW5uZXIuc2V0UG9zaXRpb24odCwgZSwgaSk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbiA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksIHRoaXM7XG4gICAgfSwgcy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZS5zZXRPcmllbnRhdGlvbiA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgICBpZiAodGhpcy5fcGFubmVyLm9yaWVudGF0aW9uWCkge1xuICAgICAgICB2YXIgcyA9IHRoaXMubm93KCk7XG4gICAgICAgIHRoaXMuX3Bhbm5lci5vcmllbnRhdGlvblguc2V0VGFyZ2V0QXRUaW1lKHQsIHMsIHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpLCB0aGlzLl9wYW5uZXIub3JpZW50YXRpb25ZLnNldFRhcmdldEF0VGltZShlLCBzLCB0aGlzLl9yYW1wVGltZUNvbnN0YW50KSwgdGhpcy5fcGFubmVyLm9yaWVudGF0aW9uWi5zZXRUYXJnZXRBdFRpbWUoaSwgcywgdGhpcy5fcmFtcFRpbWVDb25zdGFudCk7XG4gICAgICB9IGVsc2UgdGhpcy5fcGFubmVyLnNldE9yaWVudGF0aW9uKHQsIGUsIGkpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb24gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLCB0aGlzO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLCBcInBvc2l0aW9uWFwiLCB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uWzBdID0gdCwgdGhpcy5zZXRQb3NpdGlvbi5hcHBseSh0aGlzLCB0aGlzLl9wb3NpdGlvbik7XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvblswXTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5uZXIzRC5wcm90b3R5cGUsIFwicG9zaXRpb25ZXCIsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fcG9zaXRpb25bMV0gPSB0LCB0aGlzLnNldFBvc2l0aW9uLmFwcGx5KHRoaXMsIHRoaXMuX3Bvc2l0aW9uKTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uWzFdO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZSwgXCJwb3NpdGlvblpcIiwge1xuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9wb3NpdGlvblsyXSA9IHQsIHRoaXMuc2V0UG9zaXRpb24uYXBwbHkodGhpcywgdGhpcy5fcG9zaXRpb24pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb25bMl07XG4gICAgICB9XG4gICAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLCBcIm9yaWVudGF0aW9uWFwiLCB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX29yaWVudGF0aW9uWzBdID0gdCwgdGhpcy5zZXRPcmllbnRhdGlvbi5hcHBseSh0aGlzLCB0aGlzLl9vcmllbnRhdGlvbik7XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvblswXTtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5uZXIzRC5wcm90b3R5cGUsIFwib3JpZW50YXRpb25ZXCIsIHtcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fb3JpZW50YXRpb25bMV0gPSB0LCB0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsIHRoaXMuX29yaWVudGF0aW9uKTtcbiAgICAgIH0sXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWzFdO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZSwgXCJvcmllbnRhdGlvblpcIiwge1xuICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLl9vcmllbnRhdGlvblsyXSA9IHQsIHRoaXMuc2V0T3JpZW50YXRpb24uYXBwbHkodGhpcywgdGhpcy5fb3JpZW50YXRpb24pO1xuICAgICAgfSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMl07XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5QYW5uZXIzRC5fYWxpYXNQcm9wZXJ0eSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZSwgdCwge1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdGhpcy5fcGFubmVyW3RdID0gZTtcbiAgICAgICAgfSxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Bhbm5lclt0XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgcy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwicGFubmluZ01vZGVsXCIpLCBzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHkoXCJyZWZEaXN0YW5jZVwiKSwgcy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwicm9sbG9mZkZhY3RvclwiKSwgcy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwiZGlzdGFuY2VNb2RlbFwiKSwgcy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwiY29uZUlubmVyQW5nbGVcIiksIHMuZGVmYXVsdC5QYW5uZXIzRC5fYWxpYXNQcm9wZXJ0eShcImNvbmVPdXRlckFuZ2xlXCIpLCBzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHkoXCJjb25lT3V0ZXJHYWluXCIpLCBzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHkoXCJtYXhEaXN0YW5jZVwiKSwgcy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fcGFubmVyLmRpc2Nvbm5lY3QoKSwgdGhpcy5fcGFubmVyID0gbnVsbCwgdGhpcy5fb3JpZW50YXRpb24gPSBudWxsLCB0aGlzLl9wb3NpdGlvbiA9IG51bGwsIHRoaXM7XG4gICAgfSwgZS5kZWZhdWx0ID0gcy5kZWZhdWx0LlBhbm5lcjNEO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDYwKSwgaSg0MyksIGkoMSk7XG4gICAgcy5kZWZhdWx0Lk11bHRpYmFuZENvbXByZXNzb3IgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcoYXJndW1lbnRzLCBzLmRlZmF1bHQuTXVsdGliYW5kQ29tcHJlc3Nvci5kZWZhdWx0cyksIHRoaXMuX3NwbGl0dGVyID0gdGhpcy5pbnB1dCA9IG5ldyBzLmRlZmF1bHQuTXVsdGliYW5kU3BsaXQoe1xuICAgICAgICBsb3dGcmVxdWVuY3k6IHQubG93RnJlcXVlbmN5LFxuICAgICAgICBoaWdoRnJlcXVlbmN5OiB0LmhpZ2hGcmVxdWVuY3lcbiAgICAgIH0pLCB0aGlzLmxvd0ZyZXF1ZW5jeSA9IHRoaXMuX3NwbGl0dGVyLmxvd0ZyZXF1ZW5jeSwgdGhpcy5oaWdoRnJlcXVlbmN5ID0gdGhpcy5fc3BsaXR0ZXIuaGlnaEZyZXF1ZW5jeSwgdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5sb3cgPSBuZXcgcy5kZWZhdWx0LkNvbXByZXNzb3IodC5sb3cpLCB0aGlzLm1pZCA9IG5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0Lm1pZCksIHRoaXMuaGlnaCA9IG5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0LmhpZ2gpLCB0aGlzLl9zcGxpdHRlci5sb3cuY2hhaW4odGhpcy5sb3csIHRoaXMub3V0cHV0KSwgdGhpcy5fc3BsaXR0ZXIubWlkLmNoYWluKHRoaXMubWlkLCB0aGlzLm91dHB1dCksIHRoaXMuX3NwbGl0dGVyLmhpZ2guY2hhaW4odGhpcy5oaWdoLCB0aGlzLm91dHB1dCksIHRoaXMuX3JlYWRPbmx5KFtcImhpZ2hcIiwgXCJtaWRcIiwgXCJsb3dcIiwgXCJoaWdoRnJlcXVlbmN5XCIsIFwibG93RnJlcXVlbmN5XCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NdWx0aWJhbmRDb21wcmVzc29yLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0Lk11bHRpYmFuZENvbXByZXNzb3IuZGVmYXVsdHMgPSB7XG4gICAgICBsb3c6IHMuZGVmYXVsdC5Db21wcmVzc29yLmRlZmF1bHRzLFxuICAgICAgbWlkOiBzLmRlZmF1bHQuQ29tcHJlc3Nvci5kZWZhdWx0cyxcbiAgICAgIGhpZ2g6IHMuZGVmYXVsdC5Db21wcmVzc29yLmRlZmF1bHRzLFxuICAgICAgbG93RnJlcXVlbmN5OiAyNTAsXG4gICAgICBoaWdoRnJlcXVlbmN5OiAyZTNcbiAgICB9LCBzLmRlZmF1bHQuTXVsdGliYW5kQ29tcHJlc3Nvci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksIHRoaXMuX3NwbGl0dGVyLmRpc3Bvc2UoKSwgdGhpcy5fd3JpdGFibGUoW1wiaGlnaFwiLCBcIm1pZFwiLCBcImxvd1wiLCBcImhpZ2hGcmVxdWVuY3lcIiwgXCJsb3dGcmVxdWVuY3lcIl0pLCB0aGlzLmxvdy5kaXNwb3NlKCksIHRoaXMubWlkLmRpc3Bvc2UoKSwgdGhpcy5oaWdoLmRpc3Bvc2UoKSwgdGhpcy5fc3BsaXR0ZXIgPSBudWxsLCB0aGlzLmxvdyA9IG51bGwsIHRoaXMubWlkID0gbnVsbCwgdGhpcy5oaWdoID0gbnVsbCwgdGhpcy5sb3dGcmVxdWVuY3kgPSBudWxsLCB0aGlzLmhpZ2hGcmVxdWVuY3kgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NdWx0aWJhbmRDb21wcmVzc29yO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDEwKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuTW9ubyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5jcmVhdGVJbnNPdXRzKDEsIDApLCB0aGlzLl9tZXJnZSA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5NZXJnZSgpLCBzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LCB0aGlzLl9tZXJnZSwgMCwgMCksIHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuaW5wdXQsIHRoaXMuX21lcmdlLCAwLCAxKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Nb25vLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0Lk1vbm8ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9tZXJnZS5kaXNwb3NlKCksIHRoaXMuX21lcmdlID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTW9ubztcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSg1MyksIGkoNTIpLCBpKDQzKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuTWlkU2lkZUNvbXByZXNzb3IgPSBmdW5jdGlvbiAodCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0ID0gcy5kZWZhdWx0LmRlZmF1bHRBcmcodCwgcy5kZWZhdWx0Lk1pZFNpZGVDb21wcmVzc29yLmRlZmF1bHRzKSwgdGhpcy5fbWlkU2lkZVNwbGl0ID0gdGhpcy5pbnB1dCA9IG5ldyBzLmRlZmF1bHQuTWlkU2lkZVNwbGl0KCksIHRoaXMuX21pZFNpZGVNZXJnZSA9IHRoaXMub3V0cHV0ID0gbmV3IHMuZGVmYXVsdC5NaWRTaWRlTWVyZ2UoKSwgdGhpcy5taWQgPSBuZXcgcy5kZWZhdWx0LkNvbXByZXNzb3IodC5taWQpLCB0aGlzLnNpZGUgPSBuZXcgcy5kZWZhdWx0LkNvbXByZXNzb3IodC5zaWRlKSwgdGhpcy5fbWlkU2lkZVNwbGl0Lm1pZC5jaGFpbih0aGlzLm1pZCwgdGhpcy5fbWlkU2lkZU1lcmdlLm1pZCksIHRoaXMuX21pZFNpZGVTcGxpdC5zaWRlLmNoYWluKHRoaXMuc2lkZSwgdGhpcy5fbWlkU2lkZU1lcmdlLnNpZGUpLCB0aGlzLl9yZWFkT25seShbXCJtaWRcIiwgXCJzaWRlXCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3Nvciwgcy5kZWZhdWx0LkF1ZGlvTm9kZSksIHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3Nvci5kZWZhdWx0cyA9IHtcbiAgICAgIG1pZDoge1xuICAgICAgICByYXRpbzogMyxcbiAgICAgICAgdGhyZXNob2xkOiAtMjQsXG4gICAgICAgIHJlbGVhc2U6IC4wMyxcbiAgICAgICAgYXR0YWNrOiAuMDIsXG4gICAgICAgIGtuZWU6IDE2XG4gICAgICB9LFxuICAgICAgc2lkZToge1xuICAgICAgICByYXRpbzogNixcbiAgICAgICAgdGhyZXNob2xkOiAtMzAsXG4gICAgICAgIHJlbGVhc2U6IC4yNSxcbiAgICAgICAgYXR0YWNrOiAuMDMsXG4gICAgICAgIGtuZWU6IDEwXG4gICAgICB9XG4gICAgfSwgcy5kZWZhdWx0Lk1pZFNpZGVDb21wcmVzc29yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wibWlkXCIsIFwic2lkZVwiXSksIHRoaXMubWlkLmRpc3Bvc2UoKSwgdGhpcy5taWQgPSBudWxsLCB0aGlzLnNpZGUuZGlzcG9zZSgpLCB0aGlzLnNpZGUgPSBudWxsLCB0aGlzLl9taWRTaWRlU3BsaXQuZGlzcG9zZSgpLCB0aGlzLl9taWRTaWRlU3BsaXQgPSBudWxsLCB0aGlzLl9taWRTaWRlTWVyZ2UuZGlzcG9zZSgpLCB0aGlzLl9taWRTaWRlTWVyZ2UgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3NvcjtcbiAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGkucihlKTtcbiAgICB2YXIgcyA9IGkoMCk7XG4gICAgaSgzNiksIGkoMSk7XG4gICAgcy5kZWZhdWx0Lk1ldGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJzbW9vdGhpbmdcIl0sIHMuZGVmYXVsdC5NZXRlcik7XG4gICAgICBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksIHRoaXMuc21vb3RoaW5nID0gdC5zbW9vdGhpbmcsIHRoaXMuX3JtcyA9IDAsIHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IHRoaXMuX2FuYWx5c2VyID0gbmV3IHMuZGVmYXVsdC5BbmFseXNlcihcIndhdmVmb3JtXCIsIDI1Nik7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWV0ZXIsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuTWV0ZXIuZGVmYXVsdHMgPSB7XG4gICAgICBzbW9vdGhpbmc6IC44XG4gICAgfSwgcy5kZWZhdWx0Lk1ldGVyLnByb3RvdHlwZS5nZXRMZXZlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIHQgPSB0aGlzLl9hbmFseXNlci5nZXRWYWx1ZSgpLCBlID0gMCwgaSA9IDA7IGkgPCB0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBuID0gdFtpXTtcbiAgICAgICAgZSArPSBuICogbjtcbiAgICAgIH1cblxuICAgICAgdmFyIG8gPSBNYXRoLnNxcnQoZSAvIHQubGVuZ3RoKTtcbiAgICAgIHJldHVybiB0aGlzLl9ybXMgPSBNYXRoLm1heChvLCB0aGlzLl9ybXMgKiB0aGlzLnNtb290aGluZyksIHMuZGVmYXVsdC5nYWluVG9EYih0aGlzLl9ybXMpO1xuICAgIH0sIHMuZGVmYXVsdC5NZXRlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYW5hbHlzZXIuZ2V0VmFsdWUoKVswXTtcbiAgICB9LCBzLmRlZmF1bHQuTWV0ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9hbmFseXNlci5kaXNwb3NlKCksIHRoaXMuX2FuYWx5c2VyID0gbnVsbCwgdGhpcztcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuTWV0ZXI7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoNDMpLCBpKDEpO1xuICAgIHMuZGVmYXVsdC5MaW1pdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJ0aHJlc2hvbGRcIl0sIHMuZGVmYXVsdC5MaW1pdGVyKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5fY29tcHJlc3NvciA9IHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih7XG4gICAgICAgIGF0dGFjazogLjAwMSxcbiAgICAgICAgZGVjYXk6IC4wMDEsXG4gICAgICAgIHRocmVzaG9sZDogdC50aHJlc2hvbGRcbiAgICAgIH0pLCB0aGlzLnRocmVzaG9sZCA9IHRoaXMuX2NvbXByZXNzb3IudGhyZXNob2xkLCB0aGlzLl9yZWFkT25seShcInRocmVzaG9sZFwiKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5MaW1pdGVyLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkxpbWl0ZXIuZGVmYXVsdHMgPSB7XG4gICAgICB0aHJlc2hvbGQ6IC0xMlxuICAgIH0sIHMuZGVmYXVsdC5MaW1pdGVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fY29tcHJlc3Nvci5kaXNwb3NlKCksIHRoaXMuX2NvbXByZXNzb3IgPSBudWxsLCB0aGlzLl93cml0YWJsZShcInRocmVzaG9sZFwiKSwgdGhpcy50aHJlc2hvbGQgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5MaW1pdGVyO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDU4KSwgaSg4NSksIGkoMSk7XG4gICAgcy5kZWZhdWx0LkdhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdCA9IHMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsIFtcInRocmVzaG9sZFwiLCBcInNtb290aGluZ1wiXSwgcy5kZWZhdWx0LkdhdGUpO1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLmNyZWF0ZUluc091dHMoMSwgMSksIHRoaXMuX2ZvbGxvd2VyID0gbmV3IHMuZGVmYXVsdC5Gb2xsb3dlcih0LnNtb290aGluZyksIHRoaXMuX2d0ID0gbmV3IHMuZGVmYXVsdC5HcmVhdGVyVGhhbihzLmRlZmF1bHQuZGJUb0dhaW4odC50aHJlc2hvbGQpKSwgcy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCwgdGhpcy5vdXRwdXQpLCBzLmRlZmF1bHQuY29ubmVjdFNlcmllcyh0aGlzLmlucHV0LCB0aGlzLl9mb2xsb3dlciwgdGhpcy5fZ3QsIHRoaXMub3V0cHV0LmdhaW4pO1xuICAgIH0sIHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdhdGUsIHMuZGVmYXVsdC5BdWRpb05vZGUpLCBzLmRlZmF1bHQuR2F0ZS5kZWZhdWx0cyA9IHtcbiAgICAgIHNtb290aGluZzogLjEsXG4gICAgICB0aHJlc2hvbGQ6IC00MFxuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR2F0ZS5wcm90b3R5cGUsIFwidGhyZXNob2xkXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcy5kZWZhdWx0LmdhaW5Ub0RiKHRoaXMuX2d0LnZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2d0LnZhbHVlID0gcy5kZWZhdWx0LmRiVG9HYWluKHQpO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkdhdGUucHJvdG90eXBlLCBcInNtb290aGluZ1wiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZvbGxvd2VyLnNtb290aGluZztcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2ZvbGxvd2VyLnNtb290aGluZyA9IHQ7XG4gICAgICB9XG4gICAgfSksIHMuZGVmYXVsdC5HYXRlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fZm9sbG93ZXIuZGlzcG9zZSgpLCB0aGlzLl9ndC5kaXNwb3NlKCksIHRoaXMuX2ZvbGxvd2VyID0gbnVsbCwgdGhpcy5fZ3QgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5HYXRlO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDM2KSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuRkZUID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJzaXplXCJdLCBzLmRlZmF1bHQuRkZUKTtcbiAgICAgIHQudHlwZSA9IHMuZGVmYXVsdC5BbmFseXNlci5UeXBlLkZGVCwgcy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLCB0aGlzLl9hbmFseXNlciA9IHRoaXMuaW5wdXQgPSB0aGlzLm91dHB1dCA9IG5ldyBzLmRlZmF1bHQuQW5hbHlzZXIodCk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRkZULCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkZGVC5kZWZhdWx0cyA9IHtcbiAgICAgIHNpemU6IDEwMjRcbiAgICB9LCBzLmRlZmF1bHQuRkZULnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9hbmFseXNlci5nZXRWYWx1ZSgpO1xuICAgIH0sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRkZULnByb3RvdHlwZSwgXCJzaXplXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYW5hbHlzZXIuc2l6ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX2FuYWx5c2VyLnNpemUgPSB0O1xuICAgICAgfVxuICAgIH0pLCBzLmRlZmF1bHQuRkZULnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl9hbmFseXNlci5kaXNwb3NlKCksIHRoaXMuX2FuYWx5c2VyID0gbnVsbDtcbiAgICB9LCBlLmRlZmF1bHQgPSBzLmRlZmF1bHQuRkZUO1xuICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaS5yKGUpO1xuICAgIHZhciBzID0gaSgwKTtcbiAgICBpKDYwKSwgaSgzKSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuRVEzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHQgPSBzLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLCBbXCJsb3dcIiwgXCJtaWRcIiwgXCJoaWdoXCJdLCBzLmRlZmF1bHQuRVEzKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSwgdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LkdhaW4oKSwgdGhpcy5fbXVsdGliYW5kU3BsaXQgPSB0aGlzLmlucHV0ID0gbmV3IHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdCh7XG4gICAgICAgIGxvd0ZyZXF1ZW5jeTogdC5sb3dGcmVxdWVuY3ksXG4gICAgICAgIGhpZ2hGcmVxdWVuY3k6IHQuaGlnaEZyZXF1ZW5jeVxuICAgICAgfSksIHRoaXMuX2xvd0dhaW4gPSBuZXcgcy5kZWZhdWx0LkdhaW4odC5sb3csIHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzKSwgdGhpcy5fbWlkR2FpbiA9IG5ldyBzLmRlZmF1bHQuR2Fpbih0Lm1pZCwgcy5kZWZhdWx0LlR5cGUuRGVjaWJlbHMpLCB0aGlzLl9oaWdoR2FpbiA9IG5ldyBzLmRlZmF1bHQuR2Fpbih0LmhpZ2gsIHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzKSwgdGhpcy5sb3cgPSB0aGlzLl9sb3dHYWluLmdhaW4sIHRoaXMubWlkID0gdGhpcy5fbWlkR2Fpbi5nYWluLCB0aGlzLmhpZ2ggPSB0aGlzLl9oaWdoR2Fpbi5nYWluLCB0aGlzLlEgPSB0aGlzLl9tdWx0aWJhbmRTcGxpdC5RLCB0aGlzLmxvd0ZyZXF1ZW5jeSA9IHRoaXMuX211bHRpYmFuZFNwbGl0Lmxvd0ZyZXF1ZW5jeSwgdGhpcy5oaWdoRnJlcXVlbmN5ID0gdGhpcy5fbXVsdGliYW5kU3BsaXQuaGlnaEZyZXF1ZW5jeSwgdGhpcy5fbXVsdGliYW5kU3BsaXQubG93LmNoYWluKHRoaXMuX2xvd0dhaW4sIHRoaXMub3V0cHV0KSwgdGhpcy5fbXVsdGliYW5kU3BsaXQubWlkLmNoYWluKHRoaXMuX21pZEdhaW4sIHRoaXMub3V0cHV0KSwgdGhpcy5fbXVsdGliYW5kU3BsaXQuaGlnaC5jaGFpbih0aGlzLl9oaWdoR2FpbiwgdGhpcy5vdXRwdXQpLCB0aGlzLl9yZWFkT25seShbXCJsb3dcIiwgXCJtaWRcIiwgXCJoaWdoXCIsIFwibG93RnJlcXVlbmN5XCIsIFwiaGlnaEZyZXF1ZW5jeVwiXSk7XG4gICAgfSwgcy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRVEzLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkVRMy5kZWZhdWx0cyA9IHtcbiAgICAgIGxvdzogMCxcbiAgICAgIG1pZDogMCxcbiAgICAgIGhpZ2g6IDAsXG4gICAgICBsb3dGcmVxdWVuY3k6IDQwMCxcbiAgICAgIGhpZ2hGcmVxdWVuY3k6IDI1MDBcbiAgICB9LCBzLmRlZmF1bHQuRVEzLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSwgdGhpcy5fd3JpdGFibGUoW1wibG93XCIsIFwibWlkXCIsIFwiaGlnaFwiLCBcImxvd0ZyZXF1ZW5jeVwiLCBcImhpZ2hGcmVxdWVuY3lcIl0pLCB0aGlzLl9tdWx0aWJhbmRTcGxpdC5kaXNwb3NlKCksIHRoaXMuX211bHRpYmFuZFNwbGl0ID0gbnVsbCwgdGhpcy5sb3dGcmVxdWVuY3kgPSBudWxsLCB0aGlzLmhpZ2hGcmVxdWVuY3kgPSBudWxsLCB0aGlzLl9sb3dHYWluLmRpc3Bvc2UoKSwgdGhpcy5fbG93R2FpbiA9IG51bGwsIHRoaXMuX21pZEdhaW4uZGlzcG9zZSgpLCB0aGlzLl9taWRHYWluID0gbnVsbCwgdGhpcy5faGlnaEdhaW4uZGlzcG9zZSgpLCB0aGlzLl9oaWdoR2FpbiA9IG51bGwsIHRoaXMubG93ID0gbnVsbCwgdGhpcy5taWQgPSBudWxsLCB0aGlzLmhpZ2ggPSBudWxsLCB0aGlzLlEgPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5FUTM7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpLnIoZSk7XG4gICAgdmFyIHMgPSBpKDApO1xuICAgIGkoOTEpLCBpKDg4KSwgaSgxKTtcbiAgICBzLmRlZmF1bHQuQ2hhbm5lbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB0ID0gcy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cywgW1widm9sdW1lXCIsIFwicGFuXCJdLCBzLmRlZmF1bHQuUGFuVm9sKTtcbiAgICAgIHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLCB0KSwgdGhpcy5fc29sbyA9IHRoaXMuaW5wdXQgPSBuZXcgcy5kZWZhdWx0LlNvbG8odC5zb2xvKSwgdGhpcy5fcGFuVm9sID0gdGhpcy5vdXRwdXQgPSBuZXcgcy5kZWZhdWx0LlBhblZvbCh7XG4gICAgICAgIHBhbjogdC5wYW4sXG4gICAgICAgIHZvbHVtZTogdC52b2x1bWUsXG4gICAgICAgIG11dGU6IHQubXV0ZVxuICAgICAgfSksIHRoaXMucGFuID0gdGhpcy5fcGFuVm9sLnBhbiwgdGhpcy52b2x1bWUgPSB0aGlzLl9wYW5Wb2wudm9sdW1lLCB0aGlzLl9zb2xvLmNvbm5lY3QodGhpcy5fcGFuVm9sKSwgdGhpcy5fcmVhZE9ubHkoW1wicGFuXCIsIFwidm9sdW1lXCJdKTtcbiAgICB9LCBzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DaGFubmVsLCBzLmRlZmF1bHQuQXVkaW9Ob2RlKSwgcy5kZWZhdWx0LkNoYW5uZWwuZGVmYXVsdHMgPSB7XG4gICAgICBwYW46IDAsXG4gICAgICB2b2x1bWU6IDAsXG4gICAgICBtdXRlOiAhMSxcbiAgICAgIHNvbG86ICExXG4gICAgfSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaGFubmVsLnByb3RvdHlwZSwgXCJzb2xvXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc29sby5zb2xvO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5fc29sby5zb2xvID0gdDtcbiAgICAgIH1cbiAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaGFubmVsLnByb3RvdHlwZSwgXCJtdXRlZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NvbG8ubXV0ZWQgfHwgdGhpcy5tdXRlO1xuICAgICAgfVxuICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNoYW5uZWwucHJvdG90eXBlLCBcIm11dGVcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYW5Wb2wubXV0ZTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHRoaXMuX3BhblZvbC5tdXRlID0gdDtcbiAgICAgIH1cbiAgICB9KSwgcy5kZWZhdWx0LkNoYW5uZWwucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLCB0aGlzLl93cml0YWJsZShbXCJwYW5cIiwgXCJ2b2x1bWVcIl0pLCB0aGlzLl9wYW5Wb2wuZGlzcG9zZSgpLCB0aGlzLl9wYW5Wb2wgPSBudWxsLCB0aGlzLnBhbiA9IG51bGwsIHRoaXMudm9sdW1lID0gbnVsbCwgdGhpcy5fc29sby5kaXNwb3NlKCksIHRoaXMuX3NvbG8gPSBudWxsLCB0aGlzO1xuICAgIH0sIGUuZGVmYXVsdCA9IHMuZGVmYXVsdC5DaGFubmVsO1xuICB9LCBmdW5jdGlvbiAodCwgZSkge1xuICAgIHZhciBpO1xuXG4gICAgaSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0oKTtcblxuICAgIHRyeSB7XG4gICAgICBpID0gaSB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCkgfHwgKDAsIGV2YWwpKFwidGhpc1wiKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICBcIm9iamVjdFwiID09IHR5cGVvZiB3aW5kb3cgJiYgKGkgPSB3aW5kb3cpO1xuICAgIH1cblxuICAgIHQuZXhwb3J0cyA9IGk7XG4gIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XG4gICAgaSgzMSksIGkoMzYpLCBpKDE0NiksIGkoNDMpLCBpKDIzKSwgaSg0NyksIGkoMTQ1KSwgaSg1OSksIGkoMTQ0KSwgaSg5KSwgaSg1OCksIGkoNDEpLCBpKDE0MyksIGkoMTIpLCBpKDE0MiksIGkoNTQpLCBpKDEwKSwgaSgxNDEpLCBpKDE0MCksIGkoNTIpLCBpKDUzKSwgaSgxMzkpLCBpKDEzOCksIGkoNjApLCBpKDQ4KSwgaSgxMzcpLCBpKDkxKSwgaSg4NiksIGkoODgpLCBpKDE5KSwgaSgyNyksIGkoMTM2KSwgaSgxMzUpLCBpKDEzNCksIGkoNzkpLCBpKDEzMyksIGkoMSksIGkoMTEpLCBpKDc4KSwgaSgxMzIpLCBpKDgzKSwgaSgyMCksIGkoMTgpLCBpKDEzMSksIGkoMzUpLCBpKDMpLCBpKDgxKSwgaSgxMzApLCBpKDQwKSwgaSg3NyksIGkoNzYpLCBpKDE0KSwgaSgyNCksIGkoMzQpLCBpKDE2KSwgaSg1NiksIGkoODApLCBpKDEyOSksIGkoMTI4KSwgaSgxMjcpLCBpKDEyNiksIGkoMTI1KSwgaSgxMjQpLCBpKDc0KSwgaSgxMjMpLCBpKDgpLCBpKDEyMiksIGkoMzMpLCBpKDEyMSksIGkoMTIwKSwgaSg3MyksIGkoMTE5KSwgaSgxMTgpLCBpKDExNyksIGkoMTE2KSwgaSgxNSksIGkoMTE1KSwgaSgxMTQpLCBpKDcyKSwgaSgxMTMpLCBpKDExMiksIGkoNTEpLCBpKDcxKSwgaSg3MCksIGkoMTExKSwgaSgxMTApLCBpKDEwOSksIGkoMTA4KSwgaSgxMDcpLCBpKDIxKSwgaSgxMDYpLCBpKDEwNSksIGkoMjUpLCBpKDY2KSwgaSgxMDQpLCBpKDEwMyksIGkoMTAyKSwgaSgxMDEpLCBpKDM4KSwgaSg4NyksIGkoMjkpLCBpKDIyKSwgaSg4OSksIGkoMTAwKSwgaSg4NSksIGkoODQpLCBpKDc1KSwgaSg1KSwgaSg5MCksIGkoOTkpLCBpKDYxKSwgaSgyNiksIGkoNDIpLCBpKDIpLCBpKDMwKSwgaSgxMyksIGkoODIpLCBpKDk4KSwgaSg3KSwgaSgyOCksIGkoNjgpLCBpKDMyKSwgaSg2NyksIGkoNDkpLCBpKDk3KSwgaSgzOSksIGkoMzcpLCBpKDE3KSwgaSg2NCksIGkoNjUpLCBpKDk2KSwgaSg1MCksIGkoNjkpLCBpKDYpLCBpKDU3KSwgaSg5NSksIGkoNDYpLCBpKDk0KSwgaSg1NSksIGkoNjMpLCBpKDYyKSwgaSg0NSksIGkoNCksIHQuZXhwb3J0cyA9IGkoMCkuZGVmYXVsdDtcbiAgfV0pO1xufSk7IiwiaW1wb3J0IFwiLi9zdHlsZXMvaW5kZXguc2Nzc1wiO1xuaW1wb3J0IFwicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzXCI7XG5pbXBvcnQgKiBhcyBUb25lIGZyb20gJ3RvbmUnO1xuXG5cbmZ1bmN0aW9uIHNlcXVlbmNlcigpIHtcblxuLy8vLy8vLy8vXG4gIC8vIGNvbnN0IGF1ZGlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYXVkaW8nKTtcbiAgLy8gY29uc3QgYWN0eCAgPSBUb25lLmNvbnRleHQ7XG4gIC8vIGNvbnN0IGRlc3QgID0gYWN0eC5jcmVhdGVNZWRpYVN0cmVhbURlc3RpbmF0aW9uKCk7XG4gIC8vIGNvbnN0IHJlY29yZGVyID0gbmV3IE1lZGlhUmVjb3JkZXIoZGVzdC5zdHJlYW0pO1xuICAvLyBjb25zdCBjaHVua3MgPSBbXTtcblxuXG5cbi8vIHJlY29yZGVyLm9uZGF0YWF2YWlsYWJsZSA9IGV2dCA9PiBjaHVua3MucHVzaChldnQuZGF0YSk7XG4vLyByZWNvcmRlci5vbnN0b3AgPSBldnQgPT4ge1xuLy8gICAgIGxldCBibG9iID0gbmV3IEJsb2IoY2h1bmtzLCB7IHR5cGU6ICdhdWRpby9vZ2c7IGNvZGVjcz1vcHVzJyB9KTtcbi8vICAgICBhdWRpby5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuLy8gfVxuXG4vLyBUb25lLlRyYW5zcG9ydC5zdGFydCgpO1xuLy8vLy8vLy8vXG5cblxuICBjb25zdCBraWNrID0gbmV3IFRvbmUuUGxheWVyKFwiLi9zcmMvc291bmRzL2RydW1zL2tpY2stODA4LndhdlwiKS50b01hc3RlcigpO1xuICBjb25zdCBzbmFyZSA9IG5ldyBUb25lLlBsYXllcihcIi4vc3JjL3NvdW5kcy9kcnVtcy9zbmFyZS04MDgud2F2XCIpLnRvTWFzdGVyKCk7XG4gIGNvbnN0IGhhdCA9IG5ldyBUb25lLlBsYXllcihcIi4vc3JjL3NvdW5kcy9kcnVtcy9oaWhhdC1hbmFsb2cud2F2XCIpLnRvTWFzdGVyKCk7XG4gIGNvbnN0IGNsYXAgPSBuZXcgVG9uZS5QbGF5ZXIoXCIuL3NyYy9zb3VuZHMvZHJ1bXMvY2xhcC10YXBlLndhdlwiKS50b01hc3RlcigpO1xuICBjb25zdCBwZXJjID0gbmV3IFRvbmUuUGxheWVyKFwiLi9zcmMvc291bmRzL2RydW1zL3BlcmMtODA4LndhdlwiKS50b01hc3RlcigpO1xuICBjb25zdCBzaGFrZXIgPSBuZXcgVG9uZS5QbGF5ZXIoXCIuL3NyYy9zb3VuZHMvZHJ1bXMvc2hha2VyLXNodWZmbGUud2F2XCIpLnRvTWFzdGVyKCk7XG5cbiAgY29uc3QgJGtpY2tSb3dzID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKFwiZGl2LmtpY2tcIik7XG4gIGNvbnN0ICRzbmFyZVJvd3MgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoXCJkaXYuc25hcmVcIik7XG4gIGNvbnN0ICRoYXRzUm93cyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbChcImRpdi5oYXRcIik7XG4gIGNvbnN0ICRjbGFwc1Jvd3MgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoXCJkaXYuY2xhcFwiKTtcbiAgY29uc3QgJHBlcmNzUm93cyA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbChcImRpdi5wZXJjXCIpO1xuICBjb25zdCAkc2hha2Vyc1Jvd3MgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3JBbGwoXCJkaXYuc2hha2VyXCIpO1xuXG4gIGNvbnN0IGtpY2tJbnB1dCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnZGl2LmRydW1zICBkaXYua2ljayAgaW5wdXQnKTtcbiAgY29uc3Qgc25hcmVJbnB1dCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnZGl2LmRydW1zICBkaXYuc25hcmUgIGlucHV0Jyk7XG4gIGNvbnN0IGhhdElucHV0ID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdkaXYuZHJ1bXMgIGRpdi5oYXQgIGlucHV0Jyk7XG4gIGNvbnN0IGNsYXBJbnB1dCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnZGl2LmRydW1zICBkaXYuY2xhcCAgaW5wdXQnKTtcbiAgY29uc3QgcGVyY0lucHV0ID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yQWxsKCdkaXYuZHJ1bXMgIGRpdi5wZXJjICBpbnB1dCcpO1xuICBjb25zdCBzaGFrZXJJbnB1dCA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnZGl2LmRydW1zICBkaXYuc2hha2VyICBpbnB1dCcpO1xuICBjb25zdCBjaGVjayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPWNoZWNrYm94XVwiKTtcblxuICBsZXQgaW5kZXggPSAwO1xuXG4gIGNvbnN0IHBsYXkgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoXCIucGxheS1idG5cIik7XG5cbiAgcGxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgIFRvbmUuc3RhcnQoKTtcbiAgICBUb25lLlRyYW5zcG9ydC5zdGFydCgpO1xuICAgIC8vIHJlY29yZGVyLnN0YXJ0KCk7XG4gIH0pO1xuXG4gIGNvbnN0IHN0b3AgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoXCIuc3RvcC1idG5cIik7XG5cbiAgc3RvcC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgIFRvbmUuVHJhbnNwb3J0LnRvZ2dsZSgpO1xuICAgIC8vIHJlY29yZGVyLnN0b3AoKTtcbiAgfSk7XG5cbiAgY29uc3QgY2xlYXIgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1idG4nKTtcblxuXG4gIGNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYygpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hlY2subGVuZ3RoOyBpKyspe1xuICAgICAgICBpZihjaGVja1tpXS5jaGVja2VkKXtcbiAgICAgICAgICAgIGNoZWNrW2ldLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNoZWNrLmxlbmd0aDsgaisrKSB7XG4gICAgICAgaWYgKGogIT09IDApIHtcbiAgICAgICAgIGtpY2tJbnB1dFtqIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgIHNuYXJlSW5wdXRbaiAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgICBoYXRJbnB1dFtqIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgIGNsYXBJbnB1dFtqIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgIHBlcmNJbnB1dFtqIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgIHNoYWtlcklucHV0W2ogLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgIH0gZWxzZSBpZiAoaiA9PT0gMCkge1xuICAgICAgICAga2lja0lucHV0W2tpY2tJbnB1dC5sZW5ndGggLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICAgc25hcmVJbnB1dFtraWNrSW5wdXQubGVuZ3RoIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgIGhhdElucHV0W2tpY2tJbnB1dC5sZW5ndGggLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICAgY2xhcElucHV0W2tpY2tJbnB1dC5sZW5ndGggLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICAgcGVyY0lucHV0W2tpY2tJbnB1dC5sZW5ndGggLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICAgc2hha2VySW5wdXRba2lja0lucHV0Lmxlbmd0aCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgfVxuICAgICAgfVxuICB9KVxuXG4gIFRvbmUuVHJhbnNwb3J0LnNjaGVkdWxlUmVwZWF0KHJlcGVhdCwgXCI4blwiKTtcblxuICBmdW5jdGlvbiByZXBlYXQoKSB7XG4gICAgbGV0IHN0ZXAgPSBpbmRleCAlIDE2O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJGtpY2tSb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgJGtpY2tSb3cgPSAka2lja1Jvd3NbaV07XG4gICAgICBsZXQgJHNuYXJlUm93ID0gJHNuYXJlUm93c1tpXTtcbiAgICAgIGxldCAkaGF0Um93ID0gJGhhdHNSb3dzW2ldO1xuICAgICAgbGV0ICRjbGFwUm93ID0gJGNsYXBzUm93c1tpXTtcbiAgICAgIGxldCAkcGVyY1JvdyA9ICRwZXJjc1Jvd3NbaV07XG4gICAgICBsZXQgJHNoYWtlclJvdyA9ICRzaGFrZXJzUm93c1tpXSxcbiAgICAgICRraWNrSW5wdXQgPSAka2lja1Jvdy5xdWVyeVNlbGVjdG9yKGBpbnB1dDpudGgtY2hpbGQoJHtzdGVwICsgMX0pYCksXG4gICAgICAkc25hcmVJbnB1dCA9ICRzbmFyZVJvdy5xdWVyeVNlbGVjdG9yKGBpbnB1dDpudGgtY2hpbGQoJHtzdGVwICsgMX0pYCksXG4gICAgICAkaGF0SW5wdXQgPSAkaGF0Um93LnF1ZXJ5U2VsZWN0b3IoYGlucHV0Om50aC1jaGlsZCgke3N0ZXAgKyAxfSlgKSxcbiAgICAgICRjbGFwSW5wdXQgPSAkY2xhcFJvdy5xdWVyeVNlbGVjdG9yKGBpbnB1dDpudGgtY2hpbGQoJHtzdGVwICsgMX0pYCksXG4gICAgICAkcGVyY0lucHV0ID0gJHBlcmNSb3cucXVlcnlTZWxlY3RvcihgaW5wdXQ6bnRoLWNoaWxkKCR7c3RlcCArIDF9KWApLFxuICAgICAgJHNoYWtlcklucHV0ID0gJHNoYWtlclJvdy5xdWVyeVNlbGVjdG9yKGBpbnB1dDpudGgtY2hpbGQoJHtzdGVwICsgMX0pYCk7XG5cblxuICAgICAgJGtpY2tJbnB1dC5zdHlsZS5ib3hTaGFkb3cgPSBcIjAgMCAxcHggZ3JleSwwIDAgMnB4IGdyZXksIDAgMCA0cHggZ3JleVwiO1xuICAgICAgJHNuYXJlSW5wdXQuc3R5bGUuYm94U2hhZG93ID0gXCIwIDAgMXB4IGdyZXksMCAwIDJweCBncmV5LCAwIDAgNHB4IGdyZXlcIjtcbiAgICAgICRoYXRJbnB1dC5zdHlsZS5ib3hTaGFkb3cgPSBcIjAgMCAxcHggZ3JleSwwIDAgMnB4IGdyZXksIDAgMCA0cHggZ3JleVwiO1xuICAgICAgJGNsYXBJbnB1dC5zdHlsZS5ib3hTaGFkb3cgPSBcIjAgMCAxcHggZ3JleSwwIDAgMnB4IGdyZXksIDAgMCA0cHggZ3JleVwiO1xuICAgICAgJHBlcmNJbnB1dC5zdHlsZS5ib3hTaGFkb3cgPSBcIjAgMCAxcHggZ3JleSwwIDAgMnB4IGdyZXksIDAgMCA0cHggZ3JleVwiO1xuICAgICAgJHNoYWtlcklucHV0LnN0eWxlLmJveFNoYWRvdyA9IFwiMCAwIDFweCBncmV5LDAgMCAycHggZ3JleSwgMCAwIDRweCBncmV5XCI7XG5cbiAgICAgIGlmIChzdGVwICE9PSAwKSB7XG4gICAgICAgIGtpY2tJbnB1dFtzdGVwIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgc25hcmVJbnB1dFtzdGVwIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgaGF0SW5wdXRbc3RlcCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgIGNsYXBJbnB1dFtzdGVwIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgcGVyY0lucHV0W3N0ZXAgLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICBzaGFrZXJJbnB1dFtzdGVwIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgIH0gZWxzZSBpZiAoc3RlcCA9PT0gMCkge1xuICAgICAgICBraWNrSW5wdXRba2lja0lucHV0Lmxlbmd0aCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgIHNuYXJlSW5wdXRba2lja0lucHV0Lmxlbmd0aCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgIGhhdElucHV0W2tpY2tJbnB1dC5sZW5ndGggLSAxXS5zdHlsZS5ib3hTaGFkb3cgPSBcIlwiO1xuICAgICAgICBjbGFwSW5wdXRba2lja0lucHV0Lmxlbmd0aCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICAgIHBlcmNJbnB1dFtraWNrSW5wdXQubGVuZ3RoIC0gMV0uc3R5bGUuYm94U2hhZG93ID0gXCJcIjtcbiAgICAgICAgc2hha2VySW5wdXRba2lja0lucHV0Lmxlbmd0aCAtIDFdLnN0eWxlLmJveFNoYWRvdyA9IFwiXCI7XG4gICAgICB9XG5cbiAgICAgIGlmICgka2lja0lucHV0LmNoZWNrZWQpIHtcbiAgICAgICAga2ljay5zdGFydCgpO1xuICAgICAgfVxuICAgICAgaWYgKCRzbmFyZUlucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgc25hcmUuc3RhcnQoKTtcbiAgICAgIH1cbiAgICAgIGlmICgkaGF0SW5wdXQuY2hlY2tlZCkge1xuICAgICAgICBoYXQuc3RhcnQoKTtcbiAgICAgIH1cblxuXG5cbiAgICAgIGlmICgkY2xhcElucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgY2xhcC5zdGFydCgpO1xuICAgICAgfVxuICAgICAgaWYgKCRwZXJjSW5wdXQuY2hlY2tlZCkge1xuICAgICAgICBwZXJjLnN0YXJ0KCk7XG4gICAgICB9XG4gICAgICBpZiAoJHNoYWtlcklucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgc2hha2VyLnN0YXJ0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIGluZGV4Kys7XG4gIH1cbn1cblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbnNlcXVlbmNlcigpXG59KTtcblxuIiwiLy8gZXh0cmFjdGVkIGJ5IG1pbmktY3NzLWV4dHJhY3QtcGx1Z2luIl0sInNvdXJjZVJvb3QiOiIifQ==